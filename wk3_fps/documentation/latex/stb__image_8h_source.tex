\hypertarget{stb__image_8h_source}{}\doxysection{stb\+\_\+image.\+h}
\mbox{\hyperlink{stb__image_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* stb\_image -\/ v2.27 -\/ public domain image loader -\/ http://nothings.org/stb}}
\DoxyCodeLine{2 \textcolor{comment}{                                  no warranty implied; use at your own risk}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{   Do this:}}
\DoxyCodeLine{5 \textcolor{comment}{      \#define STB\_IMAGE\_IMPLEMENTATION}}
\DoxyCodeLine{6 \textcolor{comment}{   before you include this file in *one* C or C++ file to create the implementation.}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{   // i.e. it should look like this:}}
\DoxyCodeLine{9 \textcolor{comment}{   \#include ...}}
\DoxyCodeLine{10 \textcolor{comment}{   \#include ...}}
\DoxyCodeLine{11 \textcolor{comment}{   \#include ...}}
\DoxyCodeLine{12 \textcolor{comment}{   \#define STB\_IMAGE\_IMPLEMENTATION}}
\DoxyCodeLine{13 \textcolor{comment}{   \#include "{}stb\_image.h"{}}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{   You can \#define STBI\_ASSERT(x) before the \#include to avoid using assert.h.}}
\DoxyCodeLine{16 \textcolor{comment}{   And \#define STBI\_MALLOC, STBI\_REALLOC, and STBI\_FREE to avoid using malloc,realloc,free}}
\DoxyCodeLine{17 \textcolor{comment}{}}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{   QUICK NOTES:}}
\DoxyCodeLine{20 \textcolor{comment}{      Primarily of interest to game developers and other people who can}}
\DoxyCodeLine{21 \textcolor{comment}{          avoid problematic images and only need the trivial interface}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{      JPEG baseline \& progressive (12 bpc/arithmetic not supported, same as stock IJG lib)}}
\DoxyCodeLine{24 \textcolor{comment}{      PNG 1/2/4/8/16-\/bit-\/per-\/channel}}
\DoxyCodeLine{25 \textcolor{comment}{}}
\DoxyCodeLine{26 \textcolor{comment}{      TGA (not sure what subset, if a subset)}}
\DoxyCodeLine{27 \textcolor{comment}{      BMP non-\/1bpp, non-\/RLE}}
\DoxyCodeLine{28 \textcolor{comment}{      PSD (composited view only, no extra channels, 8/16 bit-\/per-\/channel)}}
\DoxyCodeLine{29 \textcolor{comment}{}}
\DoxyCodeLine{30 \textcolor{comment}{      GIF (*comp always reports as 4-\/channel)}}
\DoxyCodeLine{31 \textcolor{comment}{      HDR (radiance rgbE format)}}
\DoxyCodeLine{32 \textcolor{comment}{      PIC (Softimage PIC)}}
\DoxyCodeLine{33 \textcolor{comment}{      PNM (PPM and PGM binary only)}}
\DoxyCodeLine{34 \textcolor{comment}{}}
\DoxyCodeLine{35 \textcolor{comment}{      Animated GIF still needs a proper API, but here's one way to do it:}}
\DoxyCodeLine{36 \textcolor{comment}{          http://gist.github.com/urraka/685d9a6340b26b830d49}}
\DoxyCodeLine{37 \textcolor{comment}{}}
\DoxyCodeLine{38 \textcolor{comment}{      -\/ decode from memory or through FILE (define STBI\_NO\_STDIO to remove code)}}
\DoxyCodeLine{39 \textcolor{comment}{      -\/ decode from arbitrary I/O callbacks}}
\DoxyCodeLine{40 \textcolor{comment}{      -\/ SIMD acceleration on x86/x64 (SSE2) and ARM (NEON)}}
\DoxyCodeLine{41 \textcolor{comment}{}}
\DoxyCodeLine{42 \textcolor{comment}{   Full documentation under "{}DOCUMENTATION"{} below.}}
\DoxyCodeLine{43 \textcolor{comment}{}}
\DoxyCodeLine{44 \textcolor{comment}{}}
\DoxyCodeLine{45 \textcolor{comment}{LICENSE}}
\DoxyCodeLine{46 \textcolor{comment}{}}
\DoxyCodeLine{47 \textcolor{comment}{  See end of file for license information.}}
\DoxyCodeLine{48 \textcolor{comment}{}}
\DoxyCodeLine{49 \textcolor{comment}{RECENT REVISION HISTORY:}}
\DoxyCodeLine{50 \textcolor{comment}{}}
\DoxyCodeLine{51 \textcolor{comment}{      2.27  (2021-\/07-\/11) document stbi\_info better, 16-\/bit PNM support, bug fixes}}
\DoxyCodeLine{52 \textcolor{comment}{      2.26  (2020-\/07-\/13) many minor fixes}}
\DoxyCodeLine{53 \textcolor{comment}{      2.25  (2020-\/02-\/02) fix warnings}}
\DoxyCodeLine{54 \textcolor{comment}{      2.24  (2020-\/02-\/02) fix warnings; thread-\/local failure\_reason and flip\_vertically}}
\DoxyCodeLine{55 \textcolor{comment}{      2.23  (2019-\/08-\/11) fix clang static analysis warning}}
\DoxyCodeLine{56 \textcolor{comment}{      2.22  (2019-\/03-\/04) gif fixes, fix warnings}}
\DoxyCodeLine{57 \textcolor{comment}{      2.21  (2019-\/02-\/25) fix typo in comment}}
\DoxyCodeLine{58 \textcolor{comment}{      2.20  (2019-\/02-\/07) support utf8 filenames in Windows; fix warnings and platform ifdefs}}
\DoxyCodeLine{59 \textcolor{comment}{      2.19  (2018-\/02-\/11) fix warning}}
\DoxyCodeLine{60 \textcolor{comment}{      2.18  (2018-\/01-\/30) fix warnings}}
\DoxyCodeLine{61 \textcolor{comment}{      2.17  (2018-\/01-\/29) bugfix, 1-\/bit BMP, 16-\/bitness query, fix warnings}}
\DoxyCodeLine{62 \textcolor{comment}{      2.16  (2017-\/07-\/23) all functions have 16-\/bit variants; optimizations; bugfixes}}
\DoxyCodeLine{63 \textcolor{comment}{      2.15  (2017-\/03-\/18) fix png-\/1,2,4; all Imagenet JPGs; no runtime SSE detection on GCC}}
\DoxyCodeLine{64 \textcolor{comment}{      2.14  (2017-\/03-\/03) remove deprecated STBI\_JPEG\_OLD; fixes for Imagenet JPGs}}
\DoxyCodeLine{65 \textcolor{comment}{      2.13  (2016-\/12-\/04) experimental 16-\/bit API, only for PNG so far; fixes}}
\DoxyCodeLine{66 \textcolor{comment}{      2.12  (2016-\/04-\/02) fix typo in 2.11 PSD fix that caused crashes}}
\DoxyCodeLine{67 \textcolor{comment}{      2.11  (2016-\/04-\/02) 16-\/bit PNGS; enable SSE2 in non-\/gcc x64}}
\DoxyCodeLine{68 \textcolor{comment}{                         RGB-\/format JPEG; remove white matting in PSD;}}
\DoxyCodeLine{69 \textcolor{comment}{                         allocate large structures on the stack;}}
\DoxyCodeLine{70 \textcolor{comment}{                         correct channel count for PNG \& BMP}}
\DoxyCodeLine{71 \textcolor{comment}{      2.10  (2016-\/01-\/22) avoid warning introduced in 2.09}}
\DoxyCodeLine{72 \textcolor{comment}{      2.09  (2016-\/01-\/16) 16-\/bit TGA; comments in PNM files; STBI\_REALLOC\_SIZED}}
\DoxyCodeLine{73 \textcolor{comment}{}}
\DoxyCodeLine{74 \textcolor{comment}{   See end of file for full revision history.}}
\DoxyCodeLine{75 \textcolor{comment}{}}
\DoxyCodeLine{76 \textcolor{comment}{}}
\DoxyCodeLine{77 \textcolor{comment}{ ============================    Contributors    =========================}}
\DoxyCodeLine{78 \textcolor{comment}{}}
\DoxyCodeLine{79 \textcolor{comment}{ Image formats                          Extensions, features}}
\DoxyCodeLine{80 \textcolor{comment}{    Sean Barrett (jpeg, png, bmp)          Jetro Lauha (stbi\_info)}}
\DoxyCodeLine{81 \textcolor{comment}{    Nicolas Schulz (hdr, psd)              Martin "{}SpartanJ"{} Golini (stbi\_info)}}
\DoxyCodeLine{82 \textcolor{comment}{    Jonathan Dummer (tga)                  James "{}moose2000"{} Brown (iPhone PNG)}}
\DoxyCodeLine{83 \textcolor{comment}{    Jean-\/Marc Lienher (gif)                Ben "{}Disch"{} Wenger (io callbacks)}}
\DoxyCodeLine{84 \textcolor{comment}{    Tom Seddon (pic)                       Omar Cornut (1/2/4-\/bit PNG)}}
\DoxyCodeLine{85 \textcolor{comment}{    Thatcher Ulrich (psd)                  Nicolas Guillemot (vertical flip)}}
\DoxyCodeLine{86 \textcolor{comment}{    Ken Miller (pgm, ppm)                  Richard Mitton (16-\/bit PSD)}}
\DoxyCodeLine{87 \textcolor{comment}{    github:urraka (animated gif)           Junggon Kim (PNM comments)}}
\DoxyCodeLine{88 \textcolor{comment}{    Christopher Forseth (animated gif)     Daniel Gibson (16-\/bit TGA)}}
\DoxyCodeLine{89 \textcolor{comment}{                                           socks-\/the-\/fox (16-\/bit PNG)}}
\DoxyCodeLine{90 \textcolor{comment}{                                           Jeremy Sawicki (handle all ImageNet JPGs)}}
\DoxyCodeLine{91 \textcolor{comment}{ Optimizations \& bugfixes                  Mikhail Morozov (1-\/bit BMP)}}
\DoxyCodeLine{92 \textcolor{comment}{    Fabian "{}ryg"{} Giesen                    Anael Seghezzi (is-\/16-\/bit query)}}
\DoxyCodeLine{93 \textcolor{comment}{    Arseny Kapoulkine                      Simon Breuss (16-\/bit PNM)}}
\DoxyCodeLine{94 \textcolor{comment}{    John-\/Mark Allen}}
\DoxyCodeLine{95 \textcolor{comment}{    Carmelo J Fdez-\/Aguera}}
\DoxyCodeLine{96 \textcolor{comment}{}}
\DoxyCodeLine{97 \textcolor{comment}{ Bug \& warning fixes}}
\DoxyCodeLine{98 \textcolor{comment}{    Marc LeBlanc            David Woo          Guillaume George     Martins Mozeiko}}
\DoxyCodeLine{99 \textcolor{comment}{    Christpher Lloyd        Jerry Jansson      Joseph Thomson       Blazej Dariusz Roszkowski}}
\DoxyCodeLine{100 \textcolor{comment}{    Phil Jordan                                Dave Moore           Roy Eltham}}
\DoxyCodeLine{101 \textcolor{comment}{    Hayaki Saito            Nathan Reed        Won Chun}}
\DoxyCodeLine{102 \textcolor{comment}{    Luke Graham             Johan Duparc       Nick Verigakis       the Horde3D community}}
\DoxyCodeLine{103 \textcolor{comment}{    Thomas Ruf              Ronny Chevalier                         github:rlyeh}}
\DoxyCodeLine{104 \textcolor{comment}{    Janez Zemva             John Bartholomew   Michal Cichon        github:romigrou}}
\DoxyCodeLine{105 \textcolor{comment}{    Jonathan Blow           Ken Hamada         Tero Hanninen        github:svdijk}}
\DoxyCodeLine{106 \textcolor{comment}{    Eugene Golushkov        Laurent Gomila     Cort Stratton        github:snagar}}
\DoxyCodeLine{107 \textcolor{comment}{    Aruelien Pocheville     Sergio Gonzalez    Thibault Reuille     github:Zelex}}
\DoxyCodeLine{108 \textcolor{comment}{    Cass Everitt            Ryamond Barbiero                        github:grim210}}
\DoxyCodeLine{109 \textcolor{comment}{    Paul Du Bois            Engin Manap        Aldo Culquicondor    github:sammyhw}}
\DoxyCodeLine{110 \textcolor{comment}{    Philipp Wiesemann       Dale Weiler        Oriol Ferrer Mesia   github:phprus}}
\DoxyCodeLine{111 \textcolor{comment}{    Josh Tobin                                 Matthew Gregan       github:poppolopoppo}}
\DoxyCodeLine{112 \textcolor{comment}{    Julian Raschke          Gregory Mullen     Christian Floisand   github:darealshinji}}
\DoxyCodeLine{113 \textcolor{comment}{    Baldur Karlsson         Kevin Schmidt      JR Smith             github:Michaelangel007}}
\DoxyCodeLine{114 \textcolor{comment}{                            Brad Weinberger    Matvey Cherevko      github:mosra}}
\DoxyCodeLine{115 \textcolor{comment}{    Luca Sas                Alexander Veselov  Zack Middleton       [reserved]}}
\DoxyCodeLine{116 \textcolor{comment}{    Ryan C. Gordon          [reserved]                              [reserved]}}
\DoxyCodeLine{117 \textcolor{comment}{                     DO NOT ADD YOUR NAME HERE}}
\DoxyCodeLine{118 \textcolor{comment}{}}
\DoxyCodeLine{119 \textcolor{comment}{                     Jacko Dirks}}
\DoxyCodeLine{120 \textcolor{comment}{}}
\DoxyCodeLine{121 \textcolor{comment}{  To add your name to the credits, pick a random blank space in the middle and fill it.}}
\DoxyCodeLine{122 \textcolor{comment}{  80\% of merge conflicts on stb PRs are due to people adding their name at the end}}
\DoxyCodeLine{123 \textcolor{comment}{  of the credits.}}
\DoxyCodeLine{124 \textcolor{comment}{*/}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 \textcolor{preprocessor}{\#ifndef STBI\_INCLUDE\_STB\_IMAGE\_H}}
\DoxyCodeLine{127 \textcolor{preprocessor}{\#define STBI\_INCLUDE\_STB\_IMAGE\_H}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{comment}{// DOCUMENTATION}}
\DoxyCodeLine{130 \textcolor{comment}{//}}
\DoxyCodeLine{131 \textcolor{comment}{// Limitations:}}
\DoxyCodeLine{132 \textcolor{comment}{//    -\/ no 12-\/bit-\/per-\/channel JPEG}}
\DoxyCodeLine{133 \textcolor{comment}{//    -\/ no JPEGs with arithmetic coding}}
\DoxyCodeLine{134 \textcolor{comment}{//    -\/ GIF always returns *comp=4}}
\DoxyCodeLine{135 \textcolor{comment}{//}}
\DoxyCodeLine{136 \textcolor{comment}{// Basic usage (see HDR discussion below for HDR usage):}}
\DoxyCodeLine{137 \textcolor{comment}{//    int x,y,n;}}
\DoxyCodeLine{138 \textcolor{comment}{//    unsigned char *data = stbi\_load(filename, \&x, \&y, \&n, 0);}}
\DoxyCodeLine{139 \textcolor{comment}{//    // ... process data if not NULL ...}}
\DoxyCodeLine{140 \textcolor{comment}{//    // ... x = width, y = height, n = \# 8-\/bit components per pixel ...}}
\DoxyCodeLine{141 \textcolor{comment}{//    // ... replace '0' with '1'..'4' to force that many components per pixel}}
\DoxyCodeLine{142 \textcolor{comment}{//    // ... but 'n' will always be the number that it would have been if you said 0}}
\DoxyCodeLine{143 \textcolor{comment}{//    stbi\_image\_free(data)}}
\DoxyCodeLine{144 \textcolor{comment}{//}}
\DoxyCodeLine{145 \textcolor{comment}{// Standard parameters:}}
\DoxyCodeLine{146 \textcolor{comment}{//    int *x                 -\/-\/ outputs image width in pixels}}
\DoxyCodeLine{147 \textcolor{comment}{//    int *y                 -\/-\/ outputs image height in pixels}}
\DoxyCodeLine{148 \textcolor{comment}{//    int *channels\_in\_file  -\/-\/ outputs \# of image components in image file}}
\DoxyCodeLine{149 \textcolor{comment}{//    int desired\_channels   -\/-\/ if non-\/zero, \# of image components requested in result}}
\DoxyCodeLine{150 \textcolor{comment}{//}}
\DoxyCodeLine{151 \textcolor{comment}{// The return value from an image loader is an 'unsigned char *' which points}}
\DoxyCodeLine{152 \textcolor{comment}{// to the pixel data, or NULL on an allocation failure or if the image is}}
\DoxyCodeLine{153 \textcolor{comment}{// corrupt or invalid. The pixel data consists of *y scanlines of *x pixels,}}
\DoxyCodeLine{154 \textcolor{comment}{// with each pixel consisting of N interleaved 8-\/bit components; the first}}
\DoxyCodeLine{155 \textcolor{comment}{// pixel pointed to is top-\/left-\/most in the image. There is no padding between}}
\DoxyCodeLine{156 \textcolor{comment}{// image scanlines or between pixels, regardless of format. The number of}}
\DoxyCodeLine{157 \textcolor{comment}{// components N is 'desired\_channels' if desired\_channels is non-\/zero, or}}
\DoxyCodeLine{158 \textcolor{comment}{// *channels\_in\_file otherwise. If desired\_channels is non-\/zero,}}
\DoxyCodeLine{159 \textcolor{comment}{// *channels\_in\_file has the number of components that \_would\_ have been}}
\DoxyCodeLine{160 \textcolor{comment}{// output otherwise. E.g. if you set desired\_channels to 4, you will always}}
\DoxyCodeLine{161 \textcolor{comment}{// get RGBA output, but you can check *channels\_in\_file to see if it's trivially}}
\DoxyCodeLine{162 \textcolor{comment}{// opaque because e.g. there were only 3 channels in the source image.}}
\DoxyCodeLine{163 \textcolor{comment}{//}}
\DoxyCodeLine{164 \textcolor{comment}{// An output image with N components has the following components interleaved}}
\DoxyCodeLine{165 \textcolor{comment}{// in this order in each pixel:}}
\DoxyCodeLine{166 \textcolor{comment}{//}}
\DoxyCodeLine{167 \textcolor{comment}{//     N=\#comp     components}}
\DoxyCodeLine{168 \textcolor{comment}{//       1           grey}}
\DoxyCodeLine{169 \textcolor{comment}{//       2           grey, alpha}}
\DoxyCodeLine{170 \textcolor{comment}{//       3           red, green, blue}}
\DoxyCodeLine{171 \textcolor{comment}{//       4           red, green, blue, alpha}}
\DoxyCodeLine{172 \textcolor{comment}{//}}
\DoxyCodeLine{173 \textcolor{comment}{// If image loading fails for any reason, the return value will be NULL,}}
\DoxyCodeLine{174 \textcolor{comment}{// and *x, *y, *channels\_in\_file will be unchanged. The function}}
\DoxyCodeLine{175 \textcolor{comment}{// stbi\_failure\_reason() can be queried for an extremely brief, end-\/user}}
\DoxyCodeLine{176 \textcolor{comment}{// unfriendly explanation of why the load failed. Define STBI\_NO\_FAILURE\_STRINGS}}
\DoxyCodeLine{177 \textcolor{comment}{// to avoid compiling these strings at all, and STBI\_FAILURE\_USERMSG to get slightly}}
\DoxyCodeLine{178 \textcolor{comment}{// more user-\/friendly ones.}}
\DoxyCodeLine{179 \textcolor{comment}{//}}
\DoxyCodeLine{180 \textcolor{comment}{// Paletted PNG, BMP, GIF, and PIC images are automatically depalettized.}}
\DoxyCodeLine{181 \textcolor{comment}{//}}
\DoxyCodeLine{182 \textcolor{comment}{// To query the width, height and component count of an image without having to}}
\DoxyCodeLine{183 \textcolor{comment}{// decode the full file, you can use the stbi\_info family of functions:}}
\DoxyCodeLine{184 \textcolor{comment}{//}}
\DoxyCodeLine{185 \textcolor{comment}{//   int x,y,n,ok;}}
\DoxyCodeLine{186 \textcolor{comment}{//   ok = stbi\_info(filename, \&x, \&y, \&n);}}
\DoxyCodeLine{187 \textcolor{comment}{//   // returns ok=1 and sets x, y, n if image is a supported format,}}
\DoxyCodeLine{188 \textcolor{comment}{//   // 0 otherwise.}}
\DoxyCodeLine{189 \textcolor{comment}{//}}
\DoxyCodeLine{190 \textcolor{comment}{// Note that stb\_image pervasively uses ints in its public API for sizes,}}
\DoxyCodeLine{191 \textcolor{comment}{// including sizes of memory buffers. This is now part of the API and thus}}
\DoxyCodeLine{192 \textcolor{comment}{// hard to change without causing breakage. As a result, the various image}}
\DoxyCodeLine{193 \textcolor{comment}{// loaders all have certain limits on image size; these differ somewhat}}
\DoxyCodeLine{194 \textcolor{comment}{// by format but generally boil down to either just under 2GB or just under}}
\DoxyCodeLine{195 \textcolor{comment}{// 1GB. When the decoded image would be larger than this, stb\_image decoding}}
\DoxyCodeLine{196 \textcolor{comment}{// will fail.}}
\DoxyCodeLine{197 \textcolor{comment}{//}}
\DoxyCodeLine{198 \textcolor{comment}{// Additionally, stb\_image will reject image files that have any of their}}
\DoxyCodeLine{199 \textcolor{comment}{// dimensions set to a larger value than the configurable STBI\_MAX\_DIMENSIONS,}}
\DoxyCodeLine{200 \textcolor{comment}{// which defaults to 2**24 = 16777216 pixels. Due to the above memory limit,}}
\DoxyCodeLine{201 \textcolor{comment}{// the only way to have an image with such dimensions load correctly}}
\DoxyCodeLine{202 \textcolor{comment}{// is for it to have a rather extreme aspect ratio. Either way, the}}
\DoxyCodeLine{203 \textcolor{comment}{// assumption here is that such larger images are likely to be malformed}}
\DoxyCodeLine{204 \textcolor{comment}{// or malicious. If you do need to load an image with individual dimensions}}
\DoxyCodeLine{205 \textcolor{comment}{// larger than that, and it still fits in the overall size limit, you can}}
\DoxyCodeLine{206 \textcolor{comment}{// \#define STBI\_MAX\_DIMENSIONS on your own to be something larger.}}
\DoxyCodeLine{207 \textcolor{comment}{//}}
\DoxyCodeLine{208 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{209 \textcolor{comment}{//}}
\DoxyCodeLine{210 \textcolor{comment}{// UNICODE:}}
\DoxyCodeLine{211 \textcolor{comment}{//}}
\DoxyCodeLine{212 \textcolor{comment}{//   If compiling for Windows and you wish to use Unicode filenames, compile}}
\DoxyCodeLine{213 \textcolor{comment}{//   with}}
\DoxyCodeLine{214 \textcolor{comment}{//       \#define STBI\_WINDOWS\_UTF8}}
\DoxyCodeLine{215 \textcolor{comment}{//   and pass utf8-\/encoded filenames. Call stbi\_convert\_wchar\_to\_utf8 to convert}}
\DoxyCodeLine{216 \textcolor{comment}{//   Windows wchar\_t filenames to utf8.}}
\DoxyCodeLine{217 \textcolor{comment}{//}}
\DoxyCodeLine{218 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{219 \textcolor{comment}{//}}
\DoxyCodeLine{220 \textcolor{comment}{// Philosophy}}
\DoxyCodeLine{221 \textcolor{comment}{//}}
\DoxyCodeLine{222 \textcolor{comment}{// stb libraries are designed with the following priorities:}}
\DoxyCodeLine{223 \textcolor{comment}{//}}
\DoxyCodeLine{224 \textcolor{comment}{//    1. easy to use}}
\DoxyCodeLine{225 \textcolor{comment}{//    2. easy to maintain}}
\DoxyCodeLine{226 \textcolor{comment}{//    3. good performance}}
\DoxyCodeLine{227 \textcolor{comment}{//}}
\DoxyCodeLine{228 \textcolor{comment}{// Sometimes I let "{}good performance"{} creep up in priority over "{}easy to maintain"{},}}
\DoxyCodeLine{229 \textcolor{comment}{// and for best performance I may provide less-\/easy-\/to-\/use APIs that give higher}}
\DoxyCodeLine{230 \textcolor{comment}{// performance, in addition to the easy-\/to-\/use ones. Nevertheless, it's important}}
\DoxyCodeLine{231 \textcolor{comment}{// to keep in mind that from the standpoint of you, a client of this library,}}
\DoxyCodeLine{232 \textcolor{comment}{// all you care about is \#1 and \#3, and stb libraries DO NOT emphasize \#3 above all.}}
\DoxyCodeLine{233 \textcolor{comment}{//}}
\DoxyCodeLine{234 \textcolor{comment}{// Some secondary priorities arise directly from the first two, some of which}}
\DoxyCodeLine{235 \textcolor{comment}{// provide more explicit reasons why performance can't be emphasized.}}
\DoxyCodeLine{236 \textcolor{comment}{//}}
\DoxyCodeLine{237 \textcolor{comment}{//    -\/ Portable ("{}ease of use"{})}}
\DoxyCodeLine{238 \textcolor{comment}{//    -\/ Small source code footprint ("{}easy to maintain"{})}}
\DoxyCodeLine{239 \textcolor{comment}{//    -\/ No dependencies ("{}ease of use"{})}}
\DoxyCodeLine{240 \textcolor{comment}{//}}
\DoxyCodeLine{241 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{242 \textcolor{comment}{//}}
\DoxyCodeLine{243 \textcolor{comment}{// I/O callbacks}}
\DoxyCodeLine{244 \textcolor{comment}{//}}
\DoxyCodeLine{245 \textcolor{comment}{// I/O callbacks allow you to read from arbitrary sources, like packaged}}
\DoxyCodeLine{246 \textcolor{comment}{// files or some other source. Data read from callbacks are processed}}
\DoxyCodeLine{247 \textcolor{comment}{// through a small internal buffer (currently 128 bytes) to try to reduce}}
\DoxyCodeLine{248 \textcolor{comment}{// overhead.}}
\DoxyCodeLine{249 \textcolor{comment}{//}}
\DoxyCodeLine{250 \textcolor{comment}{// The three functions you must define are "{}read"{} (reads some bytes of data),}}
\DoxyCodeLine{251 \textcolor{comment}{// "{}skip"{} (skips some bytes of data), "{}eof"{} (reports if the stream is at the end).}}
\DoxyCodeLine{252 \textcolor{comment}{//}}
\DoxyCodeLine{253 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{254 \textcolor{comment}{//}}
\DoxyCodeLine{255 \textcolor{comment}{// SIMD support}}
\DoxyCodeLine{256 \textcolor{comment}{//}}
\DoxyCodeLine{257 \textcolor{comment}{// The JPEG decoder will try to automatically use SIMD kernels on x86 when}}
\DoxyCodeLine{258 \textcolor{comment}{// supported by the compiler. For ARM Neon support, you must explicitly}}
\DoxyCodeLine{259 \textcolor{comment}{// request it.}}
\DoxyCodeLine{260 \textcolor{comment}{//}}
\DoxyCodeLine{261 \textcolor{comment}{// (The old do-\/it-\/yourself SIMD API is no longer supported in the current}}
\DoxyCodeLine{262 \textcolor{comment}{// code.)}}
\DoxyCodeLine{263 \textcolor{comment}{//}}
\DoxyCodeLine{264 \textcolor{comment}{// On x86, SSE2 will automatically be used when available based on a run-\/time}}
\DoxyCodeLine{265 \textcolor{comment}{// test; if not, the generic C versions are used as a fall-\/back. On ARM targets,}}
\DoxyCodeLine{266 \textcolor{comment}{// the typical path is to have separate builds for NEON and non-\/NEON devices}}
\DoxyCodeLine{267 \textcolor{comment}{// (at least this is true for iOS and Android). Therefore, the NEON support is}}
\DoxyCodeLine{268 \textcolor{comment}{// toggled by a build flag: define STBI\_NEON to get NEON loops.}}
\DoxyCodeLine{269 \textcolor{comment}{//}}
\DoxyCodeLine{270 \textcolor{comment}{// If for some reason you do not want to use any of SIMD code, or if}}
\DoxyCodeLine{271 \textcolor{comment}{// you have issues compiling it, you can disable it entirely by}}
\DoxyCodeLine{272 \textcolor{comment}{// defining STBI\_NO\_SIMD.}}
\DoxyCodeLine{273 \textcolor{comment}{//}}
\DoxyCodeLine{274 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{275 \textcolor{comment}{//}}
\DoxyCodeLine{276 \textcolor{comment}{// HDR image support   (disable by defining STBI\_NO\_HDR)}}
\DoxyCodeLine{277 \textcolor{comment}{//}}
\DoxyCodeLine{278 \textcolor{comment}{// stb\_image supports loading HDR images in general, and currently the Radiance}}
\DoxyCodeLine{279 \textcolor{comment}{// .HDR file format specifically. You can still load any file through the existing}}
\DoxyCodeLine{280 \textcolor{comment}{// interface; if you attempt to load an HDR file, it will be automatically remapped}}
\DoxyCodeLine{281 \textcolor{comment}{// to LDR, assuming gamma 2.2 and an arbitrary scale factor defaulting to 1;}}
\DoxyCodeLine{282 \textcolor{comment}{// both of these constants can be reconfigured through this interface:}}
\DoxyCodeLine{283 \textcolor{comment}{//}}
\DoxyCodeLine{284 \textcolor{comment}{//     stbi\_hdr\_to\_ldr\_gamma(2.2f);}}
\DoxyCodeLine{285 \textcolor{comment}{//     stbi\_hdr\_to\_ldr\_scale(1.0f);}}
\DoxyCodeLine{286 \textcolor{comment}{//}}
\DoxyCodeLine{287 \textcolor{comment}{// (note, do not use \_inverse\_ constants; stbi\_image will invert them}}
\DoxyCodeLine{288 \textcolor{comment}{// appropriately).}}
\DoxyCodeLine{289 \textcolor{comment}{//}}
\DoxyCodeLine{290 \textcolor{comment}{// Additionally, there is a new, parallel interface for loading files as}}
\DoxyCodeLine{291 \textcolor{comment}{// (linear) floats to preserve the full dynamic range:}}
\DoxyCodeLine{292 \textcolor{comment}{//}}
\DoxyCodeLine{293 \textcolor{comment}{//    float *data = stbi\_loadf(filename, \&x, \&y, \&n, 0);}}
\DoxyCodeLine{294 \textcolor{comment}{//}}
\DoxyCodeLine{295 \textcolor{comment}{// If you load LDR images through this interface, those images will}}
\DoxyCodeLine{296 \textcolor{comment}{// be promoted to floating point values, run through the inverse of}}
\DoxyCodeLine{297 \textcolor{comment}{// constants corresponding to the above:}}
\DoxyCodeLine{298 \textcolor{comment}{//}}
\DoxyCodeLine{299 \textcolor{comment}{//     stbi\_ldr\_to\_hdr\_scale(1.0f);}}
\DoxyCodeLine{300 \textcolor{comment}{//     stbi\_ldr\_to\_hdr\_gamma(2.2f);}}
\DoxyCodeLine{301 \textcolor{comment}{//}}
\DoxyCodeLine{302 \textcolor{comment}{// Finally, given a filename (or an open file or memory block-\/-\/see header}}
\DoxyCodeLine{303 \textcolor{comment}{// file for details) containing image data, you can query for the "{}most}}
\DoxyCodeLine{304 \textcolor{comment}{// appropriate"{} interface to use (that is, whether the image is HDR or}}
\DoxyCodeLine{305 \textcolor{comment}{// not), using:}}
\DoxyCodeLine{306 \textcolor{comment}{//}}
\DoxyCodeLine{307 \textcolor{comment}{//     stbi\_is\_hdr(char *filename);}}
\DoxyCodeLine{308 \textcolor{comment}{//}}
\DoxyCodeLine{309 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{310 \textcolor{comment}{//}}
\DoxyCodeLine{311 \textcolor{comment}{// iPhone PNG support:}}
\DoxyCodeLine{312 \textcolor{comment}{//}}
\DoxyCodeLine{313 \textcolor{comment}{// We optionally support converting iPhone-\/formatted PNGs (which store}}
\DoxyCodeLine{314 \textcolor{comment}{// premultiplied BGRA) back to RGB, even though they're internally encoded}}
\DoxyCodeLine{315 \textcolor{comment}{// differently. To enable this conversion, call}}
\DoxyCodeLine{316 \textcolor{comment}{// stbi\_convert\_iphone\_png\_to\_rgb(1).}}
\DoxyCodeLine{317 \textcolor{comment}{//}}
\DoxyCodeLine{318 \textcolor{comment}{// Call stbi\_set\_unpremultiply\_on\_load(1) as well to force a divide per}}
\DoxyCodeLine{319 \textcolor{comment}{// pixel to remove any premultiplied alpha *only* if the image file explicitly}}
\DoxyCodeLine{320 \textcolor{comment}{// says there's premultiplied data (currently only happens in iPhone images,}}
\DoxyCodeLine{321 \textcolor{comment}{// and only if iPhone convert-\/to-\/rgb processing is on).}}
\DoxyCodeLine{322 \textcolor{comment}{//}}
\DoxyCodeLine{323 \textcolor{comment}{// ===========================================================================}}
\DoxyCodeLine{324 \textcolor{comment}{//}}
\DoxyCodeLine{325 \textcolor{comment}{// ADDITIONAL CONFIGURATION}}
\DoxyCodeLine{326 \textcolor{comment}{//}}
\DoxyCodeLine{327 \textcolor{comment}{//  -\/ You can suppress implementation of any of the decoders to reduce}}
\DoxyCodeLine{328 \textcolor{comment}{//    your code footprint by \#defining one or more of the following}}
\DoxyCodeLine{329 \textcolor{comment}{//    symbols before creating the implementation.}}
\DoxyCodeLine{330 \textcolor{comment}{//}}
\DoxyCodeLine{331 \textcolor{comment}{//        STBI\_NO\_JPEG}}
\DoxyCodeLine{332 \textcolor{comment}{//        STBI\_NO\_PNG}}
\DoxyCodeLine{333 \textcolor{comment}{//        STBI\_NO\_BMP}}
\DoxyCodeLine{334 \textcolor{comment}{//        STBI\_NO\_PSD}}
\DoxyCodeLine{335 \textcolor{comment}{//        STBI\_NO\_TGA}}
\DoxyCodeLine{336 \textcolor{comment}{//        STBI\_NO\_GIF}}
\DoxyCodeLine{337 \textcolor{comment}{//        STBI\_NO\_HDR}}
\DoxyCodeLine{338 \textcolor{comment}{//        STBI\_NO\_PIC}}
\DoxyCodeLine{339 \textcolor{comment}{//        STBI\_NO\_PNM   (.ppm and .pgm)}}
\DoxyCodeLine{340 \textcolor{comment}{//}}
\DoxyCodeLine{341 \textcolor{comment}{//  -\/ You can request *only* certain decoders and suppress all other ones}}
\DoxyCodeLine{342 \textcolor{comment}{//    (this will be more forward-\/compatible, as addition of new decoders}}
\DoxyCodeLine{343 \textcolor{comment}{//    doesn't require you to disable them explicitly):}}
\DoxyCodeLine{344 \textcolor{comment}{//}}
\DoxyCodeLine{345 \textcolor{comment}{//        STBI\_ONLY\_JPEG}}
\DoxyCodeLine{346 \textcolor{comment}{//        STBI\_ONLY\_PNG}}
\DoxyCodeLine{347 \textcolor{comment}{//        STBI\_ONLY\_BMP}}
\DoxyCodeLine{348 \textcolor{comment}{//        STBI\_ONLY\_PSD}}
\DoxyCodeLine{349 \textcolor{comment}{//        STBI\_ONLY\_TGA}}
\DoxyCodeLine{350 \textcolor{comment}{//        STBI\_ONLY\_GIF}}
\DoxyCodeLine{351 \textcolor{comment}{//        STBI\_ONLY\_HDR}}
\DoxyCodeLine{352 \textcolor{comment}{//        STBI\_ONLY\_PIC}}
\DoxyCodeLine{353 \textcolor{comment}{//        STBI\_ONLY\_PNM   (.ppm and .pgm)}}
\DoxyCodeLine{354 \textcolor{comment}{//}}
\DoxyCodeLine{355 \textcolor{comment}{//   -\/ If you use STBI\_NO\_PNG (or \_ONLY\_ without PNG), and you still}}
\DoxyCodeLine{356 \textcolor{comment}{//     want the zlib decoder to be available, \#define STBI\_SUPPORT\_ZLIB}}
\DoxyCodeLine{357 \textcolor{comment}{//}}
\DoxyCodeLine{358 \textcolor{comment}{//  -\/ If you define STBI\_MAX\_DIMENSIONS, stb\_image will reject images greater}}
\DoxyCodeLine{359 \textcolor{comment}{//    than that size (in either width or height) without further processing.}}
\DoxyCodeLine{360 \textcolor{comment}{//    This is to let programs in the wild set an upper bound to prevent}}
\DoxyCodeLine{361 \textcolor{comment}{//    denial-\/of-\/service attacks on untrusted data, as one could generate a}}
\DoxyCodeLine{362 \textcolor{comment}{//    valid image of gigantic dimensions and force stb\_image to allocate a}}
\DoxyCodeLine{363 \textcolor{comment}{//    huge block of memory and spend disproportionate time decoding it. By}}
\DoxyCodeLine{364 \textcolor{comment}{//    default this is set to (1 << 24), which is 16777216, but that's still}}
\DoxyCodeLine{365 \textcolor{comment}{//    very big.}}
\DoxyCodeLine{366 }
\DoxyCodeLine{367 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{368 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{369 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_NO\_STDIO}}
\DoxyCodeLine{370 }
\DoxyCodeLine{371 \textcolor{preprocessor}{\#define STBI\_VERSION 1}}
\DoxyCodeLine{372 }
\DoxyCodeLine{373 \textcolor{keyword}{enum}}
\DoxyCodeLine{374 \{}
\DoxyCodeLine{375     \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5a0177ac2c5002f4f251bb766d41752029}{STBI\_default}} = 0, \textcolor{comment}{// only used for desired\_channels}}
\DoxyCodeLine{376 }
\DoxyCodeLine{377     \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5ad1eb95ca1fa7706bf732bf35a0ed40aa}{STBI\_grey}} = 1,}
\DoxyCodeLine{378     \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5af5829d16d4cca6077465c5abd346e2f8}{STBI\_grey\_alpha}} = 2,}
\DoxyCodeLine{379     \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5aa59123e5d0af25f9b1539f5cf1facddf}{STBI\_rgb}} = 3,}
\DoxyCodeLine{380     \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5aa7b1af0c9f0310c3ada2aa29a32de293}{STBI\_rgb\_alpha}} = 4}
\DoxyCodeLine{381 \};}
\DoxyCodeLine{382 }
\DoxyCodeLine{383 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{384 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}};}
\DoxyCodeLine{385 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}};}
\DoxyCodeLine{386 }
\DoxyCodeLine{387 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{388 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{389 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{390 }
\DoxyCodeLine{391 \textcolor{preprocessor}{\#ifndef STBIDEF}}
\DoxyCodeLine{392 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_STATIC}}
\DoxyCodeLine{393 \textcolor{preprocessor}{\#define STBIDEF static}}
\DoxyCodeLine{394 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{395 \textcolor{preprocessor}{\#define STBIDEF extern}}
\DoxyCodeLine{396 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{397 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{398 }
\DoxyCodeLine{400     \textcolor{comment}{//}}
\DoxyCodeLine{401     \textcolor{comment}{// PRIMARY API -\/ works on images of any type}}
\DoxyCodeLine{402     \textcolor{comment}{//}}
\DoxyCodeLine{403 }
\DoxyCodeLine{404     \textcolor{comment}{//}}
\DoxyCodeLine{405     \textcolor{comment}{// load image by filename, open file, or memory buffer}}
\DoxyCodeLine{406     \textcolor{comment}{//}}
\DoxyCodeLine{407 }
\DoxyCodeLine{408     \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{409     \{}
\DoxyCodeLine{410         int      (*read)  (\textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{char}* data, \textcolor{keywordtype}{int} size);   \textcolor{comment}{// fill 'data' with 'size' bytes.  return number of bytes actually read}}
\DoxyCodeLine{411         void     (*skip)  (\textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int} n);                 \textcolor{comment}{// skip the next 'n' bytes, or 'unget' the last -\/n bytes if negative}}
\DoxyCodeLine{412         int      (*eof)   (\textcolor{keywordtype}{void}* user);                       \textcolor{comment}{// returns nonzero if we are at end of file/data}}
\DoxyCodeLine{413     \} \mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}};}
\DoxyCodeLine{414 }
\DoxyCodeLine{416     \textcolor{comment}{//}}
\DoxyCodeLine{417     \textcolor{comment}{// 8-\/bits-\/per-\/channel interface}}
\DoxyCodeLine{418     \textcolor{comment}{//}}
\DoxyCodeLine{419 }
\DoxyCodeLine{420     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a5bf9d78a27dc1cb216005798fb704bdf}{stbi\_load\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}           \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{421     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a354f2a6f7939cf1792db087ad3b2220a}{stbi\_load\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{422 }
\DoxyCodeLine{423 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{424     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_ad3fc296ba0778df0a8094e20da82deab}{stbi\_load}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{425     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a093f86b90423ff020846c6d002c3296c}{stbi\_load\_from\_file}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{426     \textcolor{comment}{// for stbi\_load\_from\_file, file pointer is left pointing immediately after image}}
\DoxyCodeLine{427 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{428 }
\DoxyCodeLine{429 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{430     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a1d5ab90f79c38ced898becd050cfb910}{stbi\_load\_gif\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}** delays, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* z, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp);}
\DoxyCodeLine{431 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433 \textcolor{preprocessor}{\#ifdef STBI\_WINDOWS\_UTF8}}
\DoxyCodeLine{434     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} stbi\_convert\_wchar\_to\_utf8(\textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{size\_t} bufferlen, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* input);}
\DoxyCodeLine{435 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{436 }
\DoxyCodeLine{438     \textcolor{comment}{//}}
\DoxyCodeLine{439     \textcolor{comment}{// 16-\/bits-\/per-\/channel interface}}
\DoxyCodeLine{440     \textcolor{comment}{//}}
\DoxyCodeLine{441 }
\DoxyCodeLine{442     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_a2ce4a73cca165fd30e0a23d012d8e770}{stbi\_load\_16\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{443     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_aa93c0e91f15bf7b1aca8369bf39c5e41}{stbi\_load\_16\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{444 }
\DoxyCodeLine{445 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{446     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_a2202a8c0f947dd555c286f7fee1fc39d}{stbi\_load\_16}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{447     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_a077867644e156572eaf54d118f65e5a1}{stbi\_load\_from\_file\_16}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{448 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{449 }
\DoxyCodeLine{451     \textcolor{comment}{//}}
\DoxyCodeLine{452     \textcolor{comment}{// float-\/per-\/channel interface}}
\DoxyCodeLine{453     \textcolor{comment}{//}}
\DoxyCodeLine{454 \textcolor{preprocessor}{\#ifndef STBI\_NO\_LINEAR}}
\DoxyCodeLine{455     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a09c9f8ddfda96cc62461b86daccf0f77}{stbi\_loadf\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{456     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a7573a229fe25afc452dffddbded8e5a8}{stbi\_loadf\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{457 }
\DoxyCodeLine{458 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{459     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a4fe9e7c92b7f8e8df8939b776a49cfa8}{stbi\_loadf}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{460     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a9099e31f34506c8630d58b737aa5a049}{stbi\_loadf\_from\_file}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels);}
\DoxyCodeLine{461 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{462 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{463 }
\DoxyCodeLine{464 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{465     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_ab18889e43518d6b4421b705782bb1b5e}{stbi\_hdr\_to\_ldr\_gamma}}(\textcolor{keywordtype}{float} gamma);}
\DoxyCodeLine{466     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_ae21cc1184eeb5cc814699f1ed62c5258}{stbi\_hdr\_to\_ldr\_scale}}(\textcolor{keywordtype}{float} scale);}
\DoxyCodeLine{467 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_NO\_HDR}}
\DoxyCodeLine{468 }
\DoxyCodeLine{469 \textcolor{preprocessor}{\#ifndef STBI\_NO\_LINEAR}}
\DoxyCodeLine{470     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_a1feccdcf726dcc6b5502e3efa85b7dbb}{stbi\_ldr\_to\_hdr\_gamma}}(\textcolor{keywordtype}{float} gamma);}
\DoxyCodeLine{471     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_af946583656a362a316b40c0421c20561}{stbi\_ldr\_to\_hdr\_scale}}(\textcolor{keywordtype}{float} scale);}
\DoxyCodeLine{472 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_NO\_LINEAR}}
\DoxyCodeLine{473 }
\DoxyCodeLine{474     \textcolor{comment}{// stbi\_is\_hdr is always defined, but always returns false if STBI\_NO\_HDR}}
\DoxyCodeLine{475     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}    \mbox{\hyperlink{stb__image_8h_af0e94f316fe1848f632517ca3c11d077}{stbi\_is\_hdr\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user);}
\DoxyCodeLine{476     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}    \mbox{\hyperlink{stb__image_8h_a5cbc6f5cbb3b2d0d87ee959fcee9d23e}{stbi\_is\_hdr\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len);}
\DoxyCodeLine{477 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{478     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_ae70f9a302f7e87fd971075e7f758d55c}{stbi\_is\_hdr}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename);}
\DoxyCodeLine{479     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_aaf10d41631e1e9214fde1688bdbd8524}{stbi\_is\_hdr\_from\_file}}(FILE* f);}
\DoxyCodeLine{480 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_NO\_STDIO}}
\DoxyCodeLine{481 }
\DoxyCodeLine{482 }
\DoxyCodeLine{483     \textcolor{comment}{// get a VERY brief reason for failure}}
\DoxyCodeLine{484     \textcolor{comment}{// on most compilers (and ALL modern mainstream compilers) this is threadsafe}}
\DoxyCodeLine{485     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_ac72f312f610a7df1519ea0f2a2f94be9}{stbi\_failure\_reason}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{486 }
\DoxyCodeLine{487     \textcolor{comment}{// free the loaded image -\/-\/ this is just free()}}
\DoxyCodeLine{488     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}     \mbox{\hyperlink{stb__image_8h_ad3e11bb44412a7ba348acfbad09caacb}{stbi\_image\_free}}(\textcolor{keywordtype}{void}* retval\_from\_stbi\_load);}
\DoxyCodeLine{489 }
\DoxyCodeLine{490     \textcolor{comment}{// get image dimensions \& components without fully decoding}}
\DoxyCodeLine{491     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_acfef077febce3bc3f1f339de478f3315}{stbi\_info\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{492     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_a86291c64cb663f41a34647d5e1abf363}{stbi\_info\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{493     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_a548d486e07e0eb95671cb200d3a9530f}{stbi\_is\_16\_bit\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len);}
\DoxyCodeLine{494     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_a990e0e38ab6e600bd9cbf5d30abd2f8f}{stbi\_is\_16\_bit\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user);}
\DoxyCodeLine{495 }
\DoxyCodeLine{496 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{497     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_aede708cca1304520b2afcf4d5eb61d70}{stbi\_info}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{498     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_a28abedef4a0a93909332080df6be0021}{stbi\_info\_from\_file}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{499     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_a7d9af55a35382c011cc186f7b62c00af}{stbi\_is\_16\_bit}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename);}
\DoxyCodeLine{500     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_a42fa266b80bfde22a0781ba2112d1c62}{stbi\_is\_16\_bit\_from\_file}}(FILE* f);}
\DoxyCodeLine{501 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{502 }
\DoxyCodeLine{503 }
\DoxyCodeLine{504 }
\DoxyCodeLine{505     \textcolor{comment}{// for image formats that explicitly notate that they have premultiplied alpha,}}
\DoxyCodeLine{506     \textcolor{comment}{// we just return the colors as stored in the file. set this flag to force}}
\DoxyCodeLine{507     \textcolor{comment}{// unpremultiplication. results are undefined if the unpremultiply overflow.}}
\DoxyCodeLine{508     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_a3f02e0053e1c8d08a3ed436e6a82c7c9}{stbi\_set\_unpremultiply\_on\_load}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_unpremultiply);}
\DoxyCodeLine{509 }
\DoxyCodeLine{510     \textcolor{comment}{// indicate whether we should process iphone images back to canonical format,}}
\DoxyCodeLine{511     \textcolor{comment}{// or just pass them through "{}as-\/is"{}}}
\DoxyCodeLine{512     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_a23525ef2b882f3de426b47ecf8d9151b}{stbi\_convert\_iphone\_png\_to\_rgb}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_convert);}
\DoxyCodeLine{513 }
\DoxyCodeLine{514     \textcolor{comment}{// flip the image vertically, so the first pixel in the output array is the bottom left}}
\DoxyCodeLine{515     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_ab89c177fc52f1bb2dc1c05e48129a0a4}{stbi\_set\_flip\_vertically\_on\_load}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_flip);}
\DoxyCodeLine{516 }
\DoxyCodeLine{517     \textcolor{comment}{// as above, but only applies to images loaded on the thread that calls the function}}
\DoxyCodeLine{518     \textcolor{comment}{// this function is only available if your compiler supports thread-\/local variables;}}
\DoxyCodeLine{519     \textcolor{comment}{// calling it will fail to link if your compiler doesn't}}
\DoxyCodeLine{520     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_acf48dffaa1b2bb00f5a8d9af697c6aca}{stbi\_set\_unpremultiply\_on\_load\_thread}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_unpremultiply);}
\DoxyCodeLine{521     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_aff26696e30b62a40dd00bc12415343f6}{stbi\_convert\_iphone\_png\_to\_rgb\_thread}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_convert);}
\DoxyCodeLine{522     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_ad683202a3f6ec89729b5ad9220ae98ee}{stbi\_set\_flip\_vertically\_on\_load\_thread}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_flip);}
\DoxyCodeLine{523 }
\DoxyCodeLine{524     \textcolor{comment}{// ZLIB client -\/ used by PNG, available for other purposes}}
\DoxyCodeLine{525 }
\DoxyCodeLine{526     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_acba137e5310f3c0fe9bb198e4bee3dce}{stbi\_zlib\_decode\_malloc\_guesssize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} initial\_size, \textcolor{keywordtype}{int}* outlen);}
\DoxyCodeLine{527     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_adc3de199aa29f7370a699ad545155541}{stbi\_zlib\_decode\_malloc\_guesssize\_headerflag}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} initial\_size, \textcolor{keywordtype}{int}* outlen, \textcolor{keywordtype}{int} parse\_header);}
\DoxyCodeLine{528     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_afec644d4e1a3cd858dfe0f9c55a1e55c}{stbi\_zlib\_decode\_malloc}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* outlen);}
\DoxyCodeLine{529     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}   \mbox{\hyperlink{stb__image_8h_ae8447830c49bc17f8491e12c1f0ded48}{stbi\_zlib\_decode\_buffer}}(\textcolor{keywordtype}{char}* obuffer, \textcolor{keywordtype}{int} olen, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* ibuffer, \textcolor{keywordtype}{int} ilen);}
\DoxyCodeLine{530 }
\DoxyCodeLine{531     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_ad6b5cd73a89037832ee2b2872a17bd1b}{stbi\_zlib\_decode\_noheader\_malloc}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* outlen);}
\DoxyCodeLine{532     \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}   \mbox{\hyperlink{stb__image_8h_a0d12efc011adfff7521f3b924feb0b0e}{stbi\_zlib\_decode\_noheader\_buffer}}(\textcolor{keywordtype}{char}* obuffer, \textcolor{keywordtype}{int} olen, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* ibuffer, \textcolor{keywordtype}{int} ilen);}
\DoxyCodeLine{533 }
\DoxyCodeLine{534 }
\DoxyCodeLine{535 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{536 \}}
\DoxyCodeLine{537 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{538 }
\DoxyCodeLine{539 \textcolor{comment}{//}}
\DoxyCodeLine{540 \textcolor{comment}{//}}
\DoxyCodeLine{542 \textcolor{comment}{}\textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_INCLUDE\_STB\_IMAGE\_H}}
\DoxyCodeLine{543 }
\DoxyCodeLine{544 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_IMPLEMENTATION}}
\DoxyCodeLine{545 }
\DoxyCodeLine{546 \textcolor{preprocessor}{\#if defined(STBI\_ONLY\_JPEG) || defined(STBI\_ONLY\_PNG) || defined(STBI\_ONLY\_BMP) \(\backslash\)}}
\DoxyCodeLine{547 \textcolor{preprocessor}{  || defined(STBI\_ONLY\_TGA) || defined(STBI\_ONLY\_GIF) || defined(STBI\_ONLY\_PSD) \(\backslash\)}}
\DoxyCodeLine{548 \textcolor{preprocessor}{  || defined(STBI\_ONLY\_HDR) || defined(STBI\_ONLY\_PIC) || defined(STBI\_ONLY\_PNM) \(\backslash\)}}
\DoxyCodeLine{549 \textcolor{preprocessor}{  || defined(STBI\_ONLY\_ZLIB)}}
\DoxyCodeLine{550 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_JPEG}}
\DoxyCodeLine{551 \textcolor{preprocessor}{\#define STBI\_NO\_JPEG}}
\DoxyCodeLine{552 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{553 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_PNG}}
\DoxyCodeLine{554 \textcolor{preprocessor}{\#define STBI\_NO\_PNG}}
\DoxyCodeLine{555 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{556 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_BMP}}
\DoxyCodeLine{557 \textcolor{preprocessor}{\#define STBI\_NO\_BMP}}
\DoxyCodeLine{558 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{559 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_PSD}}
\DoxyCodeLine{560 \textcolor{preprocessor}{\#define STBI\_NO\_PSD}}
\DoxyCodeLine{561 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{562 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_TGA}}
\DoxyCodeLine{563 \textcolor{preprocessor}{\#define STBI\_NO\_TGA}}
\DoxyCodeLine{564 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{565 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_GIF}}
\DoxyCodeLine{566 \textcolor{preprocessor}{\#define STBI\_NO\_GIF}}
\DoxyCodeLine{567 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{568 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_HDR}}
\DoxyCodeLine{569 \textcolor{preprocessor}{\#define STBI\_NO\_HDR}}
\DoxyCodeLine{570 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{571 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_PIC}}
\DoxyCodeLine{572 \textcolor{preprocessor}{\#define STBI\_NO\_PIC}}
\DoxyCodeLine{573 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{574 \textcolor{preprocessor}{\#ifndef STBI\_ONLY\_PNM}}
\DoxyCodeLine{575 \textcolor{preprocessor}{\#define STBI\_NO\_PNM}}
\DoxyCodeLine{576 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{577 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{578 }
\DoxyCodeLine{579 \textcolor{preprocessor}{\#if defined(STBI\_NO\_PNG) \&\& !defined(STBI\_SUPPORT\_ZLIB) \&\& !defined(STBI\_NO\_ZLIB)}}
\DoxyCodeLine{580 \textcolor{preprocessor}{\#define STBI\_NO\_ZLIB}}
\DoxyCodeLine{581 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583 }
\DoxyCodeLine{584 \textcolor{preprocessor}{\#include <stdarg.h>}}
\DoxyCodeLine{585 \textcolor{preprocessor}{\#include <stddef.h>} \textcolor{comment}{// ptrdiff\_t on osx}}
\DoxyCodeLine{586 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{587 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{588 \textcolor{preprocessor}{\#include <limits.h>}}
\DoxyCodeLine{589 }
\DoxyCodeLine{590 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_LINEAR) || !defined(STBI\_NO\_HDR)}}
\DoxyCodeLine{591 \textcolor{preprocessor}{\#include <math.h>}  \textcolor{comment}{// ldexp, pow}}
\DoxyCodeLine{592 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{593 }
\DoxyCodeLine{594 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{595 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{596 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{597 }
\DoxyCodeLine{598 \textcolor{preprocessor}{\#ifndef STBI\_ASSERT}}
\DoxyCodeLine{599 \textcolor{preprocessor}{\#include <assert.h>}}
\DoxyCodeLine{600 \textcolor{preprocessor}{\#define STBI\_ASSERT(x) assert(x)}}
\DoxyCodeLine{601 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{602 }
\DoxyCodeLine{603 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{604 \textcolor{preprocessor}{\#define STBI\_EXTERN extern "{}C"{}}}
\DoxyCodeLine{605 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{606 \textcolor{preprocessor}{\#define STBI\_EXTERN extern}}
\DoxyCodeLine{607 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{608 }
\DoxyCodeLine{609 }
\DoxyCodeLine{610 \textcolor{preprocessor}{\#ifndef \_MSC\_VER}}
\DoxyCodeLine{611 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{612 \textcolor{preprocessor}{\#define stbi\_inline inline}}
\DoxyCodeLine{613 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{614 \textcolor{preprocessor}{\#define stbi\_inline}}
\DoxyCodeLine{615 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{616 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{617 \textcolor{preprocessor}{\#define stbi\_inline \_\_forceinline}}
\DoxyCodeLine{618 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{619 }
\DoxyCodeLine{620 \textcolor{preprocessor}{\#ifndef STBI\_NO\_THREAD\_LOCALS}}
\DoxyCodeLine{621 \textcolor{preprocessor}{\#if defined(\_\_cplusplus) \&\&  \_\_cplusplus >= 201103L}}
\DoxyCodeLine{622 \textcolor{preprocessor}{\#define STBI\_THREAD\_LOCAL       thread\_local}}
\DoxyCodeLine{623 \textcolor{preprocessor}{\#elif defined(\_\_GNUC\_\_) \&\& \_\_GNUC\_\_ < 5}}
\DoxyCodeLine{624 \textcolor{preprocessor}{\#define STBI\_THREAD\_LOCAL       \_\_thread}}
\DoxyCodeLine{625 \textcolor{preprocessor}{\#elif defined(\_MSC\_VER)}}
\DoxyCodeLine{626 \textcolor{preprocessor}{\#define STBI\_THREAD\_LOCAL       \_\_declspec(thread)}}
\DoxyCodeLine{627 \textcolor{preprocessor}{\#elif defined (\_\_STDC\_VERSION\_\_) \&\& \_\_STDC\_VERSION\_\_ >= 201112L \&\& !defined(\_\_STDC\_NO\_THREADS\_\_)}}
\DoxyCodeLine{628 \textcolor{preprocessor}{\#define STBI\_THREAD\_LOCAL       \_Thread\_local}}
\DoxyCodeLine{629 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{630 }
\DoxyCodeLine{631 \textcolor{preprocessor}{\#ifndef STBI\_THREAD\_LOCAL}}
\DoxyCodeLine{632 \textcolor{preprocessor}{\#if defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{633 \textcolor{preprocessor}{\#define STBI\_THREAD\_LOCAL       \_\_thread}}
\DoxyCodeLine{634 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{635 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{636 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{637 }
\DoxyCodeLine{638 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{639 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} stbi\_\_uint16;}
\DoxyCodeLine{640 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{short} stbi\_\_int16;}
\DoxyCodeLine{641 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}   stbi\_\_uint32;}
\DoxyCodeLine{642 \textcolor{keyword}{typedef}   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{int}   stbi\_\_int32;}
\DoxyCodeLine{643 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{644 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{645 \textcolor{keyword}{typedef} uint16\_t stbi\_\_uint16;}
\DoxyCodeLine{646 \textcolor{keyword}{typedef} int16\_t  stbi\_\_int16;}
\DoxyCodeLine{647 \textcolor{keyword}{typedef} uint32\_t stbi\_\_uint32;}
\DoxyCodeLine{648 \textcolor{keyword}{typedef} int32\_t  stbi\_\_int32;}
\DoxyCodeLine{649 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{650 }
\DoxyCodeLine{651 \textcolor{comment}{// should produce compiler error if size is wrong}}
\DoxyCodeLine{652 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} validate\_uint32[\textcolor{keyword}{sizeof}(stbi\_\_uint32) == 4 ? 1 : -\/1];}
\DoxyCodeLine{653 }
\DoxyCodeLine{654 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{655 \textcolor{preprocessor}{\#define STBI\_NOTUSED(v)  (void)(v)}}
\DoxyCodeLine{656 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{657 \textcolor{preprocessor}{\#define STBI\_NOTUSED(v)  (void)sizeof(v)}}
\DoxyCodeLine{658 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{659 }
\DoxyCodeLine{660 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{661 \textcolor{preprocessor}{\#define STBI\_HAS\_LROTL}}
\DoxyCodeLine{662 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{663 }
\DoxyCodeLine{664 \textcolor{preprocessor}{\#ifdef STBI\_HAS\_LROTL}}
\DoxyCodeLine{665 \textcolor{preprocessor}{\#define stbi\_lrot(x,y)  \_lrotl(x,y)}}
\DoxyCodeLine{666 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{667 \textcolor{preprocessor}{\#define stbi\_lrot(x,y)  (((x) << (y)) | ((x) >> (-\/(y) \& 31)))}}
\DoxyCodeLine{668 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{669 }
\DoxyCodeLine{670 \textcolor{preprocessor}{\#if defined(STBI\_MALLOC) \&\& defined(STBI\_FREE) \&\& (defined(STBI\_REALLOC) || defined(STBI\_REALLOC\_SIZED))}}
\DoxyCodeLine{671 \textcolor{comment}{// ok}}
\DoxyCodeLine{672 \textcolor{preprocessor}{\#elif !defined(STBI\_MALLOC) \&\& !defined(STBI\_FREE) \&\& !defined(STBI\_REALLOC) \&\& !defined(STBI\_REALLOC\_SIZED)}}
\DoxyCodeLine{673 \textcolor{comment}{// ok}}
\DoxyCodeLine{674 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{675 \textcolor{preprocessor}{\#error "{}Must define all or none of STBI\_MALLOC, STBI\_FREE, and STBI\_REALLOC (or STBI\_REALLOC\_SIZED)."{}}}
\DoxyCodeLine{676 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{677 }
\DoxyCodeLine{678 \textcolor{preprocessor}{\#ifndef STBI\_MALLOC}}
\DoxyCodeLine{679 \textcolor{preprocessor}{\#define STBI\_MALLOC(sz)           malloc(sz)}}
\DoxyCodeLine{680 \textcolor{preprocessor}{\#define STBI\_REALLOC(p,newsz)     realloc(p,newsz)}}
\DoxyCodeLine{681 \textcolor{preprocessor}{\#define STBI\_FREE(p)              free(p)}}
\DoxyCodeLine{682 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{683 }
\DoxyCodeLine{684 \textcolor{preprocessor}{\#ifndef STBI\_REALLOC\_SIZED}}
\DoxyCodeLine{685 \textcolor{preprocessor}{\#define STBI\_REALLOC\_SIZED(p,oldsz,newsz) STBI\_REALLOC(p,newsz)}}
\DoxyCodeLine{686 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{687 }
\DoxyCodeLine{688 \textcolor{comment}{// x86/x64 detection}}
\DoxyCodeLine{689 \textcolor{preprocessor}{\#if defined(\_\_x86\_64\_\_) || defined(\_M\_X64)}}
\DoxyCodeLine{690 \textcolor{preprocessor}{\#define STBI\_\_X64\_TARGET}}
\DoxyCodeLine{691 \textcolor{preprocessor}{\#elif defined(\_\_i386) || defined(\_M\_IX86)}}
\DoxyCodeLine{692 \textcolor{preprocessor}{\#define STBI\_\_X86\_TARGET}}
\DoxyCodeLine{693 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{694 }
\DoxyCodeLine{695 \textcolor{preprocessor}{\#if defined(\_\_GNUC\_\_) \&\& defined(STBI\_\_X86\_TARGET) \&\& !defined(\_\_SSE2\_\_) \&\& !defined(STBI\_NO\_SIMD)}}
\DoxyCodeLine{696 \textcolor{comment}{// gcc doesn't support sse2 intrinsics unless you compile with -\/msse2,}}
\DoxyCodeLine{697 \textcolor{comment}{// which in turn means it gets to use SSE2 everywhere. This is unfortunate,}}
\DoxyCodeLine{698 \textcolor{comment}{// but previous attempts to provide the SSE2 functions with runtime}}
\DoxyCodeLine{699 \textcolor{comment}{// detection caused numerous issues. The way architecture extensions are}}
\DoxyCodeLine{700 \textcolor{comment}{// exposed in GCC/Clang is, sadly, not really suited for one-\/file libs.}}
\DoxyCodeLine{701 \textcolor{comment}{// New behavior: if compiled with -\/msse2, we use SSE2 without any}}
\DoxyCodeLine{702 \textcolor{comment}{// detection; if not, we don't use it at all.}}
\DoxyCodeLine{703 \textcolor{preprocessor}{\#define STBI\_NO\_SIMD}}
\DoxyCodeLine{704 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{705 }
\DoxyCodeLine{706 \textcolor{preprocessor}{\#if defined(\_\_MINGW32\_\_) \&\& defined(STBI\_\_X86\_TARGET) \&\& !defined(STBI\_MINGW\_ENABLE\_SSE2) \&\& !defined(STBI\_NO\_SIMD)}}
\DoxyCodeLine{707 \textcolor{comment}{// Note that \_\_MINGW32\_\_ doesn't actually mean 32-\/bit, so we have to avoid STBI\_\_X64\_TARGET}}
\DoxyCodeLine{708 \textcolor{comment}{//}}
\DoxyCodeLine{709 \textcolor{comment}{// 32-\/bit MinGW wants ESP to be 16-\/byte aligned, but this is not in the}}
\DoxyCodeLine{710 \textcolor{comment}{// Windows ABI and VC++ as well as Windows DLLs don't maintain that invariant.}}
\DoxyCodeLine{711 \textcolor{comment}{// As a result, enabling SSE2 on 32-\/bit MinGW is dangerous when not}}
\DoxyCodeLine{712 \textcolor{comment}{// simultaneously enabling "{}-\/mstackrealign"{}.}}
\DoxyCodeLine{713 \textcolor{comment}{//}}
\DoxyCodeLine{714 \textcolor{comment}{// See https://github.com/nothings/stb/issues/81 for more information.}}
\DoxyCodeLine{715 \textcolor{comment}{//}}
\DoxyCodeLine{716 \textcolor{comment}{// So default to no SSE2 on 32-\/bit MinGW. If you've read this far and added}}
\DoxyCodeLine{717 \textcolor{comment}{// -\/mstackrealign to your build settings, feel free to \#define STBI\_MINGW\_ENABLE\_SSE2.}}
\DoxyCodeLine{718 \textcolor{preprocessor}{\#define STBI\_NO\_SIMD}}
\DoxyCodeLine{719 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{720 }
\DoxyCodeLine{721 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_SIMD) \&\& (defined(STBI\_\_X86\_TARGET) || defined(STBI\_\_X64\_TARGET))}}
\DoxyCodeLine{722 \textcolor{preprocessor}{\#define STBI\_SSE2}}
\DoxyCodeLine{723 \textcolor{preprocessor}{\#include <emmintrin.h>}}
\DoxyCodeLine{724 }
\DoxyCodeLine{725 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{726 }
\DoxyCodeLine{727 \textcolor{preprocessor}{\#if \_MSC\_VER >= 1400  }\textcolor{comment}{// not VC6}}
\DoxyCodeLine{728 \textcolor{preprocessor}{\#include <intrin.h>} \textcolor{comment}{// \_\_cpuid}}
\DoxyCodeLine{729 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_cpuid3(\textcolor{keywordtype}{void})}
\DoxyCodeLine{730 \{}
\DoxyCodeLine{731     \textcolor{keywordtype}{int} info[4];}
\DoxyCodeLine{732     \_\_cpuid(info, 1);}
\DoxyCodeLine{733     \textcolor{keywordflow}{return} info[3];}
\DoxyCodeLine{734 \}}
\DoxyCodeLine{735 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{736 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_cpuid3(\textcolor{keywordtype}{void})}
\DoxyCodeLine{737 \{}
\DoxyCodeLine{738     \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{739     \_\_asm \{}
\DoxyCodeLine{740         mov  eax, 1}
\DoxyCodeLine{741         cpuid}
\DoxyCodeLine{742         mov  res, edx}
\DoxyCodeLine{743     \}}
\DoxyCodeLine{744     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{745 \}}
\DoxyCodeLine{746 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{747 }
\DoxyCodeLine{748 \textcolor{preprocessor}{\#define STBI\_SIMD\_ALIGN(type, name) \_\_declspec(align(16)) type name}}
\DoxyCodeLine{749 }
\DoxyCodeLine{750 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_JPEG) \&\& defined(STBI\_SSE2)}}
\DoxyCodeLine{751 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_sse2\_available(\textcolor{keywordtype}{void})}
\DoxyCodeLine{752 \{}
\DoxyCodeLine{753     \textcolor{keywordtype}{int} info3 = stbi\_\_cpuid3();}
\DoxyCodeLine{754     \textcolor{keywordflow}{return} ((info3 >> 26) \& 1) != 0;}
\DoxyCodeLine{755 \}}
\DoxyCodeLine{756 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{757 }
\DoxyCodeLine{758 \textcolor{preprocessor}{\#else }\textcolor{comment}{// assume GCC-\/style if not VC++}}
\DoxyCodeLine{759 \textcolor{preprocessor}{\#define STBI\_SIMD\_ALIGN(type, name) type name \_\_attribute\_\_((aligned(16)))}}
\DoxyCodeLine{760 }
\DoxyCodeLine{761 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_JPEG) \&\& defined(STBI\_SSE2)}}
\DoxyCodeLine{762 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_sse2\_available(\textcolor{keywordtype}{void})}
\DoxyCodeLine{763 \{}
\DoxyCodeLine{764     \textcolor{comment}{// If we're even attempting to compile this on GCC/Clang, that means}}
\DoxyCodeLine{765     \textcolor{comment}{// -\/msse2 is on, which means the compiler is allowed to use SSE2}}
\DoxyCodeLine{766     \textcolor{comment}{// instructions at will, and so are we.}}
\DoxyCodeLine{767     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{768 \}}
\DoxyCodeLine{769 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{770 }
\DoxyCodeLine{771 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{772 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{773 }
\DoxyCodeLine{774 \textcolor{comment}{// ARM NEON}}
\DoxyCodeLine{775 \textcolor{preprocessor}{\#if defined(STBI\_NO\_SIMD) \&\& defined(STBI\_NEON)}}
\DoxyCodeLine{776 \textcolor{preprocessor}{\#undef STBI\_NEON}}
\DoxyCodeLine{777 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{778 }
\DoxyCodeLine{779 \textcolor{preprocessor}{\#ifdef STBI\_NEON}}
\DoxyCodeLine{780 \textcolor{preprocessor}{\#include <arm\_neon.h>}}
\DoxyCodeLine{781 \textcolor{preprocessor}{\#ifdef \_MSC\_VER}}
\DoxyCodeLine{782 \textcolor{preprocessor}{\#define STBI\_SIMD\_ALIGN(type, name) \_\_declspec(align(16)) type name}}
\DoxyCodeLine{783 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{784 \textcolor{preprocessor}{\#define STBI\_SIMD\_ALIGN(type, name) type name \_\_attribute\_\_((aligned(16)))}}
\DoxyCodeLine{785 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{786 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{787 }
\DoxyCodeLine{788 \textcolor{preprocessor}{\#ifndef STBI\_SIMD\_ALIGN}}
\DoxyCodeLine{789 \textcolor{preprocessor}{\#define STBI\_SIMD\_ALIGN(type, name) type name}}
\DoxyCodeLine{790 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{791 }
\DoxyCodeLine{792 \textcolor{preprocessor}{\#ifndef STBI\_MAX\_DIMENSIONS}}
\DoxyCodeLine{793 \textcolor{preprocessor}{\#define STBI\_MAX\_DIMENSIONS (1 << 24)}}
\DoxyCodeLine{794 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{795 }
\DoxyCodeLine{797 \textcolor{comment}{//}}
\DoxyCodeLine{798 \textcolor{comment}{//  stbi\_\_context struct and start\_xxx functions}}
\DoxyCodeLine{799 }
\DoxyCodeLine{800 \textcolor{comment}{// stbi\_\_context structure is our basic context used by all images, so it}}
\DoxyCodeLine{801 \textcolor{comment}{// contains all the IO context, plus some basic image information}}
\DoxyCodeLine{802 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{803 \{}
\DoxyCodeLine{804     stbi\_\_uint32 img\_x, img\_y;}
\DoxyCodeLine{805     \textcolor{keywordtype}{int} img\_n, img\_out\_n;}
\DoxyCodeLine{806 }
\DoxyCodeLine{807     \mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} io;}
\DoxyCodeLine{808     \textcolor{keywordtype}{void}* io\_user\_data;}
\DoxyCodeLine{809 }
\DoxyCodeLine{810     \textcolor{keywordtype}{int} read\_from\_callbacks;}
\DoxyCodeLine{811     \textcolor{keywordtype}{int} buflen;}
\DoxyCodeLine{812     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} buffer\_start[128];}
\DoxyCodeLine{813     \textcolor{keywordtype}{int} callback\_already\_read;}
\DoxyCodeLine{814 }
\DoxyCodeLine{815     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* img\_buffer, * img\_buffer\_end;}
\DoxyCodeLine{816     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* img\_buffer\_original, * img\_buffer\_original\_end;}
\DoxyCodeLine{817 \} stbi\_\_context;}
\DoxyCodeLine{818 }
\DoxyCodeLine{819 }
\DoxyCodeLine{820 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_refill\_buffer(stbi\_\_context* s);}
\DoxyCodeLine{821 }
\DoxyCodeLine{822 \textcolor{comment}{// initialize a memory-\/decode context}}
\DoxyCodeLine{823 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_start\_mem(stbi\_\_context* s, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len)}
\DoxyCodeLine{824 \{}
\DoxyCodeLine{825     s-\/>io.read = NULL;}
\DoxyCodeLine{826     s-\/>read\_from\_callbacks = 0;}
\DoxyCodeLine{827     s-\/>callback\_already\_read = 0;}
\DoxyCodeLine{828     s-\/>img\_buffer = s-\/>img\_buffer\_original = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer;}
\DoxyCodeLine{829     s-\/>img\_buffer\_end = s-\/>img\_buffer\_original\_end = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer + len;}
\DoxyCodeLine{830 \}}
\DoxyCodeLine{831 }
\DoxyCodeLine{832 \textcolor{comment}{// initialize a callback-\/based context}}
\DoxyCodeLine{833 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_start\_callbacks(stbi\_\_context* s, \mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}* c, \textcolor{keywordtype}{void}* user)}
\DoxyCodeLine{834 \{}
\DoxyCodeLine{835     s-\/>io = *c;}
\DoxyCodeLine{836     s-\/>io\_user\_data = user;}
\DoxyCodeLine{837     s-\/>buflen = \textcolor{keyword}{sizeof}(s-\/>buffer\_start);}
\DoxyCodeLine{838     s-\/>read\_from\_callbacks = 1;}
\DoxyCodeLine{839     s-\/>callback\_already\_read = 0;}
\DoxyCodeLine{840     s-\/>img\_buffer = s-\/>img\_buffer\_original = s-\/>buffer\_start;}
\DoxyCodeLine{841     stbi\_\_refill\_buffer(s);}
\DoxyCodeLine{842     s-\/>img\_buffer\_original\_end = s-\/>img\_buffer\_end;}
\DoxyCodeLine{843 \}}
\DoxyCodeLine{844 }
\DoxyCodeLine{845 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{846 }
\DoxyCodeLine{847 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_stdio\_read(\textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{char}* data, \textcolor{keywordtype}{int} size)}
\DoxyCodeLine{848 \{}
\DoxyCodeLine{849     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})fread(data, 1, size, (FILE*)user);}
\DoxyCodeLine{850 \}}
\DoxyCodeLine{851 }
\DoxyCodeLine{852 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_stdio\_skip(\textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{853 \{}
\DoxyCodeLine{854     \textcolor{keywordtype}{int} ch;}
\DoxyCodeLine{855     fseek((FILE*)user, n, SEEK\_CUR);}
\DoxyCodeLine{856     ch = fgetc((FILE*)user);  \textcolor{comment}{/* have to read a byte to reset feof()'s flag */}}
\DoxyCodeLine{857     \textcolor{keywordflow}{if} (ch != EOF) \{}
\DoxyCodeLine{858         ungetc(ch, (FILE*)user);  \textcolor{comment}{/* push byte back onto stream if valid. */}}
\DoxyCodeLine{859     \}}
\DoxyCodeLine{860 \}}
\DoxyCodeLine{861 }
\DoxyCodeLine{862 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_stdio\_eof(\textcolor{keywordtype}{void}* user)}
\DoxyCodeLine{863 \{}
\DoxyCodeLine{864     \textcolor{keywordflow}{return} feof((FILE*)user) || ferror((FILE*)user);}
\DoxyCodeLine{865 \}}
\DoxyCodeLine{866 }
\DoxyCodeLine{867 \textcolor{keyword}{static} \mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} stbi\_\_stdio\_callbacks =}
\DoxyCodeLine{868 \{}
\DoxyCodeLine{869    stbi\_\_stdio\_read,}
\DoxyCodeLine{870    stbi\_\_stdio\_skip,}
\DoxyCodeLine{871    stbi\_\_stdio\_eof,}
\DoxyCodeLine{872 \};}
\DoxyCodeLine{873 }
\DoxyCodeLine{874 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_start\_file(stbi\_\_context* s, FILE* f)}
\DoxyCodeLine{875 \{}
\DoxyCodeLine{876     stbi\_\_start\_callbacks(s, \&stbi\_\_stdio\_callbacks, (\textcolor{keywordtype}{void}*)f);}
\DoxyCodeLine{877 \}}
\DoxyCodeLine{878 }
\DoxyCodeLine{879 \textcolor{comment}{//static void stop\_file(stbi\_\_context *s) \{ \}}}
\DoxyCodeLine{880 }
\DoxyCodeLine{881 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_NO\_STDIO}}
\DoxyCodeLine{882 }
\DoxyCodeLine{883 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_rewind(stbi\_\_context* s)}
\DoxyCodeLine{884 \{}
\DoxyCodeLine{885     \textcolor{comment}{// conceptually rewind SHOULD rewind to the beginning of the stream,}}
\DoxyCodeLine{886     \textcolor{comment}{// but we just rewind to the beginning of the initial buffer, because}}
\DoxyCodeLine{887     \textcolor{comment}{// we only use it after doing 'test', which only ever looks at at most 92 bytes}}
\DoxyCodeLine{888     s-\/>img\_buffer = s-\/>img\_buffer\_original;}
\DoxyCodeLine{889     s-\/>img\_buffer\_end = s-\/>img\_buffer\_original\_end;}
\DoxyCodeLine{890 \}}
\DoxyCodeLine{891 }
\DoxyCodeLine{892 \textcolor{keyword}{enum}}
\DoxyCodeLine{893 \{}
\DoxyCodeLine{894     STBI\_ORDER\_RGB,}
\DoxyCodeLine{895     STBI\_ORDER\_BGR}
\DoxyCodeLine{896 \};}
\DoxyCodeLine{897 }
\DoxyCodeLine{898 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{899 \{}
\DoxyCodeLine{900     \textcolor{keywordtype}{int} bits\_per\_channel;}
\DoxyCodeLine{901     \textcolor{keywordtype}{int} num\_channels;}
\DoxyCodeLine{902     \textcolor{keywordtype}{int} channel\_order;}
\DoxyCodeLine{903 \} stbi\_\_result\_info;}
\DoxyCodeLine{904 }
\DoxyCodeLine{905 \textcolor{preprocessor}{\#ifndef STBI\_NO\_JPEG}}
\DoxyCodeLine{906 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_jpeg\_test(stbi\_\_context* s);}
\DoxyCodeLine{907 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_jpeg\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{908 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_jpeg\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{909 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{910 }
\DoxyCodeLine{911 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNG}}
\DoxyCodeLine{912 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_png\_test(stbi\_\_context* s);}
\DoxyCodeLine{913 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_png\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{914 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_png\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{915 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_png\_is16(stbi\_\_context* s);}
\DoxyCodeLine{916 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{917 }
\DoxyCodeLine{918 \textcolor{preprocessor}{\#ifndef STBI\_NO\_BMP}}
\DoxyCodeLine{919 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_bmp\_test(stbi\_\_context* s);}
\DoxyCodeLine{920 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_bmp\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{921 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_bmp\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{922 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{923 }
\DoxyCodeLine{924 \textcolor{preprocessor}{\#ifndef STBI\_NO\_TGA}}
\DoxyCodeLine{925 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_tga\_test(stbi\_\_context* s);}
\DoxyCodeLine{926 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_tga\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{927 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_tga\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{928 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{929 }
\DoxyCodeLine{930 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PSD}}
\DoxyCodeLine{931 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_psd\_test(stbi\_\_context* s);}
\DoxyCodeLine{932 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_psd\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri, \textcolor{keywordtype}{int} bpc);}
\DoxyCodeLine{933 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_psd\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{934 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_psd\_is16(stbi\_\_context* s);}
\DoxyCodeLine{935 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{936 }
\DoxyCodeLine{937 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{938 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_hdr\_test(stbi\_\_context* s);}
\DoxyCodeLine{939 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbi\_\_hdr\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{940 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_hdr\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{941 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{942 }
\DoxyCodeLine{943 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PIC}}
\DoxyCodeLine{944 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pic\_test(stbi\_\_context* s);}
\DoxyCodeLine{945 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_pic\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{946 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pic\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{947 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{948 }
\DoxyCodeLine{949 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{950 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_gif\_test(stbi\_\_context* s);}
\DoxyCodeLine{951 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_gif\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{952 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_load\_gif\_main(stbi\_\_context* s, \textcolor{keywordtype}{int}** delays, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* z, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp);}
\DoxyCodeLine{953 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_gif\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{954 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{955 }
\DoxyCodeLine{956 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNM}}
\DoxyCodeLine{957 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_test(stbi\_\_context* s);}
\DoxyCodeLine{958 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_pnm\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri);}
\DoxyCodeLine{959 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp);}
\DoxyCodeLine{960 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_is16(stbi\_\_context* s);}
\DoxyCodeLine{961 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{962 }
\DoxyCodeLine{963 \textcolor{keyword}{static}}
\DoxyCodeLine{964 \textcolor{preprocessor}{\#ifdef STBI\_THREAD\_LOCAL}}
\DoxyCodeLine{965 STBI\_THREAD\_LOCAL}
\DoxyCodeLine{966 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{967 \textcolor{keyword}{const} \textcolor{keywordtype}{char}* stbi\_\_g\_failure\_reason;}
\DoxyCodeLine{968 }
\DoxyCodeLine{969 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_ac72f312f610a7df1519ea0f2a2f94be9}{stbi\_failure\_reason}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{970 \{}
\DoxyCodeLine{971     \textcolor{keywordflow}{return} stbi\_\_g\_failure\_reason;}
\DoxyCodeLine{972 \}}
\DoxyCodeLine{973 }
\DoxyCodeLine{974 \textcolor{preprocessor}{\#ifndef STBI\_NO\_FAILURE\_STRINGS}}
\DoxyCodeLine{975 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_err(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* str)}
\DoxyCodeLine{976 \{}
\DoxyCodeLine{977     stbi\_\_g\_failure\_reason = str;}
\DoxyCodeLine{978     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{979 \}}
\DoxyCodeLine{980 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{981 }
\DoxyCodeLine{982 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_malloc(\textcolor{keywordtype}{size\_t} size)}
\DoxyCodeLine{983 \{}
\DoxyCodeLine{984     \textcolor{keywordflow}{return} STBI\_MALLOC(size);}
\DoxyCodeLine{985 \}}
\DoxyCodeLine{986 }
\DoxyCodeLine{987 \textcolor{comment}{// stb\_image uses ints pervasively, including for offset calculations.}}
\DoxyCodeLine{988 \textcolor{comment}{// therefore the largest decoded image size we can support with the}}
\DoxyCodeLine{989 \textcolor{comment}{// current code, even on 64-\/bit targets, is INT\_MAX. this is not a}}
\DoxyCodeLine{990 \textcolor{comment}{// significant limitation for the intended use case.}}
\DoxyCodeLine{991 \textcolor{comment}{//}}
\DoxyCodeLine{992 \textcolor{comment}{// we do, however, need to make sure our size calculations don't}}
\DoxyCodeLine{993 \textcolor{comment}{// overflow. hence a few helper functions for size calculations that}}
\DoxyCodeLine{994 \textcolor{comment}{// multiply integers together, making sure that they're non-\/negative}}
\DoxyCodeLine{995 \textcolor{comment}{// and no overflow occurs.}}
\DoxyCodeLine{996 }
\DoxyCodeLine{997 \textcolor{comment}{// return 1 if the sum is valid, 0 on overflow.}}
\DoxyCodeLine{998 \textcolor{comment}{// negative terms are considered invalid.}}
\DoxyCodeLine{999 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_addsizes\_valid(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b)}
\DoxyCodeLine{1000 \{}
\DoxyCodeLine{1001     \textcolor{keywordflow}{if} (b < 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1002     \textcolor{comment}{// now 0 <= b <= INT\_MAX, hence also}}
\DoxyCodeLine{1003     \textcolor{comment}{// 0 <= INT\_MAX -\/ b <= INTMAX.}}
\DoxyCodeLine{1004     \textcolor{comment}{// And "{}a + b <= INT\_MAX"{} (which might overflow) is the}}
\DoxyCodeLine{1005     \textcolor{comment}{// same as a <= INT\_MAX -\/ b (no overflow)}}
\DoxyCodeLine{1006     \textcolor{keywordflow}{return} a <= INT\_MAX -\/ b;}
\DoxyCodeLine{1007 \}}
\DoxyCodeLine{1008 }
\DoxyCodeLine{1009 \textcolor{comment}{// returns 1 if the product is valid, 0 on overflow.}}
\DoxyCodeLine{1010 \textcolor{comment}{// negative factors are considered invalid.}}
\DoxyCodeLine{1011 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_mul2sizes\_valid(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b)}
\DoxyCodeLine{1012 \{}
\DoxyCodeLine{1013     \textcolor{keywordflow}{if} (a < 0 || b < 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1014     \textcolor{keywordflow}{if} (b == 0) \textcolor{keywordflow}{return} 1; \textcolor{comment}{// mul-\/by-\/0 is always safe}}
\DoxyCodeLine{1015     \textcolor{comment}{// portable way to check for no overflows in a*b}}
\DoxyCodeLine{1016     \textcolor{keywordflow}{return} a <= INT\_MAX / b;}
\DoxyCodeLine{1017 \}}
\DoxyCodeLine{1018 }
\DoxyCodeLine{1019 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_JPEG) || !defined(STBI\_NO\_PNG) || !defined(STBI\_NO\_TGA) || !defined(STBI\_NO\_HDR)}}
\DoxyCodeLine{1020 \textcolor{comment}{// returns 1 if "{}a*b + add"{} has no negative terms/factors and doesn't overflow}}
\DoxyCodeLine{1021 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_mad2sizes\_valid(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} add)}
\DoxyCodeLine{1022 \{}
\DoxyCodeLine{1023     \textcolor{keywordflow}{return} stbi\_\_mul2sizes\_valid(a, b) \&\& stbi\_\_addsizes\_valid(a * b, add);}
\DoxyCodeLine{1024 \}}
\DoxyCodeLine{1025 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1026 }
\DoxyCodeLine{1027 \textcolor{comment}{// returns 1 if "{}a*b*c + add"{} has no negative terms/factors and doesn't overflow}}
\DoxyCodeLine{1028 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_mad3sizes\_valid(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} add)}
\DoxyCodeLine{1029 \{}
\DoxyCodeLine{1030     \textcolor{keywordflow}{return} stbi\_\_mul2sizes\_valid(a, b) \&\& stbi\_\_mul2sizes\_valid(a * b, c) \&\&}
\DoxyCodeLine{1031         stbi\_\_addsizes\_valid(a * b * c, add);}
\DoxyCodeLine{1032 \}}
\DoxyCodeLine{1033 }
\DoxyCodeLine{1034 \textcolor{comment}{// returns 1 if "{}a*b*c*d + add"{} has no negative terms/factors and doesn't overflow}}
\DoxyCodeLine{1035 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_LINEAR) || !defined(STBI\_NO\_HDR) || !defined(STBI\_NO\_PNM)}}
\DoxyCodeLine{1036 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_mad4sizes\_valid(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} d, \textcolor{keywordtype}{int} add)}
\DoxyCodeLine{1037 \{}
\DoxyCodeLine{1038     \textcolor{keywordflow}{return} stbi\_\_mul2sizes\_valid(a, b) \&\& stbi\_\_mul2sizes\_valid(a * b, c) \&\&}
\DoxyCodeLine{1039         stbi\_\_mul2sizes\_valid(a * b * c, d) \&\& stbi\_\_addsizes\_valid(a * b * c * d, add);}
\DoxyCodeLine{1040 \}}
\DoxyCodeLine{1041 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1042 }
\DoxyCodeLine{1043 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_JPEG) || !defined(STBI\_NO\_PNG) || !defined(STBI\_NO\_TGA) || !defined(STBI\_NO\_HDR)}}
\DoxyCodeLine{1044 \textcolor{comment}{// mallocs with size overflow checking}}
\DoxyCodeLine{1045 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_malloc\_mad2(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} add)}
\DoxyCodeLine{1046 \{}
\DoxyCodeLine{1047     \textcolor{keywordflow}{if} (!stbi\_\_mad2sizes\_valid(a, b, add)) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1048     \textcolor{keywordflow}{return} stbi\_\_malloc(a * b + add);}
\DoxyCodeLine{1049 \}}
\DoxyCodeLine{1050 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1051 }
\DoxyCodeLine{1052 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_malloc\_mad3(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} add)}
\DoxyCodeLine{1053 \{}
\DoxyCodeLine{1054     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(a, b, c, add)) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1055     \textcolor{keywordflow}{return} stbi\_\_malloc(a * b * c + add);}
\DoxyCodeLine{1056 \}}
\DoxyCodeLine{1057 }
\DoxyCodeLine{1058 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_LINEAR) || !defined(STBI\_NO\_HDR) || !defined(STBI\_NO\_PNM)}}
\DoxyCodeLine{1059 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_malloc\_mad4(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} d, \textcolor{keywordtype}{int} add)}
\DoxyCodeLine{1060 \{}
\DoxyCodeLine{1061     \textcolor{keywordflow}{if} (!stbi\_\_mad4sizes\_valid(a, b, c, d, add)) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1062     \textcolor{keywordflow}{return} stbi\_\_malloc(a * b * c * d + add);}
\DoxyCodeLine{1063 \}}
\DoxyCodeLine{1064 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1065 }
\DoxyCodeLine{1066 \textcolor{comment}{// stbi\_\_err -\/ error}}
\DoxyCodeLine{1067 \textcolor{comment}{// stbi\_\_errpf -\/ error returning pointer to float}}
\DoxyCodeLine{1068 \textcolor{comment}{// stbi\_\_errpuc -\/ error returning pointer to unsigned char}}
\DoxyCodeLine{1069 }
\DoxyCodeLine{1070 \textcolor{preprocessor}{\#ifdef STBI\_NO\_FAILURE\_STRINGS}}
\DoxyCodeLine{1071 \textcolor{preprocessor}{\#define stbi\_\_err(x,y)  0}}
\DoxyCodeLine{1072 \textcolor{preprocessor}{\#elif defined(STBI\_FAILURE\_USERMSG)}}
\DoxyCodeLine{1073 \textcolor{preprocessor}{\#define stbi\_\_err(x,y)  stbi\_\_err(y)}}
\DoxyCodeLine{1074 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1075 \textcolor{preprocessor}{\#define stbi\_\_err(x,y)  stbi\_\_err(x)}}
\DoxyCodeLine{1076 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1077 }
\DoxyCodeLine{1078 \textcolor{preprocessor}{\#define stbi\_\_errpf(x,y)   ((float *)(size\_t) (stbi\_\_err(x,y)?NULL:NULL))}}
\DoxyCodeLine{1079 \textcolor{preprocessor}{\#define stbi\_\_errpuc(x,y)  ((unsigned char *)(size\_t) (stbi\_\_err(x,y)?NULL:NULL))}}
\DoxyCodeLine{1080 }
\DoxyCodeLine{1081 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_ad3e11bb44412a7ba348acfbad09caacb}{stbi\_image\_free}}(\textcolor{keywordtype}{void}* retval\_from\_stbi\_load)}
\DoxyCodeLine{1082 \{}
\DoxyCodeLine{1083     STBI\_FREE(retval\_from\_stbi\_load);}
\DoxyCodeLine{1084 \}}
\DoxyCodeLine{1085 }
\DoxyCodeLine{1086 \textcolor{preprocessor}{\#ifndef STBI\_NO\_LINEAR}}
\DoxyCodeLine{1087 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbi\_\_ldr\_to\_hdr(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* data, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp);}
\DoxyCodeLine{1088 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1089 }
\DoxyCodeLine{1090 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1091 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_hdr\_to\_ldr(\textcolor{keywordtype}{float}* data, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp);}
\DoxyCodeLine{1092 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1093 }
\DoxyCodeLine{1094 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_vertically\_flip\_on\_load\_global = 0;}
\DoxyCodeLine{1095 }
\DoxyCodeLine{1096 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_ab89c177fc52f1bb2dc1c05e48129a0a4}{stbi\_set\_flip\_vertically\_on\_load}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_flip)}
\DoxyCodeLine{1097 \{}
\DoxyCodeLine{1098     stbi\_\_vertically\_flip\_on\_load\_global = flag\_true\_if\_should\_flip;}
\DoxyCodeLine{1099 \}}
\DoxyCodeLine{1100 }
\DoxyCodeLine{1101 \textcolor{preprocessor}{\#ifndef STBI\_THREAD\_LOCAL}}
\DoxyCodeLine{1102 \textcolor{preprocessor}{\#define stbi\_\_vertically\_flip\_on\_load  stbi\_\_vertically\_flip\_on\_load\_global}}
\DoxyCodeLine{1103 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1104 \textcolor{keyword}{static} STBI\_THREAD\_LOCAL \textcolor{keywordtype}{int} stbi\_\_vertically\_flip\_on\_load\_local, stbi\_\_vertically\_flip\_on\_load\_set;}
\DoxyCodeLine{1105 }
\DoxyCodeLine{1106 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_ad683202a3f6ec89729b5ad9220ae98ee}{stbi\_set\_flip\_vertically\_on\_load\_thread}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_flip)}
\DoxyCodeLine{1107 \{}
\DoxyCodeLine{1108     stbi\_\_vertically\_flip\_on\_load\_local = flag\_true\_if\_should\_flip;}
\DoxyCodeLine{1109     stbi\_\_vertically\_flip\_on\_load\_set = 1;}
\DoxyCodeLine{1110 \}}
\DoxyCodeLine{1111 }
\DoxyCodeLine{1112 \textcolor{preprocessor}{\#define stbi\_\_vertically\_flip\_on\_load  (stbi\_\_vertically\_flip\_on\_load\_set       \(\backslash\)}}
\DoxyCodeLine{1113 \textcolor{preprocessor}{                                         ? stbi\_\_vertically\_flip\_on\_load\_local  \(\backslash\)}}
\DoxyCodeLine{1114 \textcolor{preprocessor}{                                         : stbi\_\_vertically\_flip\_on\_load\_global)}}
\DoxyCodeLine{1115 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_THREAD\_LOCAL}}
\DoxyCodeLine{1116 }
\DoxyCodeLine{1117 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_load\_main(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri, \textcolor{keywordtype}{int} bpc)}
\DoxyCodeLine{1118 \{}
\DoxyCodeLine{1119     memset(ri, 0, \textcolor{keyword}{sizeof}(*ri)); \textcolor{comment}{// make sure it's initialized if we add new fields}}
\DoxyCodeLine{1120     ri-\/>bits\_per\_channel = 8; \textcolor{comment}{// default is 8 so most paths don't have to be changed}}
\DoxyCodeLine{1121     ri-\/>channel\_order = STBI\_ORDER\_RGB; \textcolor{comment}{// all current input \& output are this, but this is here so we can add BGR order}}
\DoxyCodeLine{1122     ri-\/>num\_channels = 0;}
\DoxyCodeLine{1123 }
\DoxyCodeLine{1124     \textcolor{comment}{// test the formats with a very explicit header first (at least a FOURCC}}
\DoxyCodeLine{1125     \textcolor{comment}{// or distinctive magic number first)}}
\DoxyCodeLine{1126 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNG}}
\DoxyCodeLine{1127     \textcolor{keywordflow}{if} (stbi\_\_png\_test(s))  \textcolor{keywordflow}{return} stbi\_\_png\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1128 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1129 \textcolor{preprocessor}{\#ifndef STBI\_NO\_BMP}}
\DoxyCodeLine{1130     \textcolor{keywordflow}{if} (stbi\_\_bmp\_test(s))  \textcolor{keywordflow}{return} stbi\_\_bmp\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1131 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1132 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{1133     \textcolor{keywordflow}{if} (stbi\_\_gif\_test(s))  \textcolor{keywordflow}{return} stbi\_\_gif\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1134 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1135 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PSD}}
\DoxyCodeLine{1136     \textcolor{keywordflow}{if} (stbi\_\_psd\_test(s))  \textcolor{keywordflow}{return} stbi\_\_psd\_load(s, x, y, comp, req\_comp, ri, bpc);}
\DoxyCodeLine{1137 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1138     STBI\_NOTUSED(bpc);}
\DoxyCodeLine{1139 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1140 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PIC}}
\DoxyCodeLine{1141     \textcolor{keywordflow}{if} (stbi\_\_pic\_test(s))  \textcolor{keywordflow}{return} stbi\_\_pic\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1142 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1143 }
\DoxyCodeLine{1144     \textcolor{comment}{// then the formats that can end up attempting to load with just 1 or 2}}
\DoxyCodeLine{1145     \textcolor{comment}{// bytes matching expectations; these are prone to false positives, so}}
\DoxyCodeLine{1146     \textcolor{comment}{// try them later}}
\DoxyCodeLine{1147 \textcolor{preprocessor}{\#ifndef STBI\_NO\_JPEG}}
\DoxyCodeLine{1148     \textcolor{keywordflow}{if} (stbi\_\_jpeg\_test(s)) \textcolor{keywordflow}{return} stbi\_\_jpeg\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1149 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1150 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNM}}
\DoxyCodeLine{1151     \textcolor{keywordflow}{if} (stbi\_\_pnm\_test(s))  \textcolor{keywordflow}{return} stbi\_\_pnm\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1152 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1153 }
\DoxyCodeLine{1154 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1155     \textcolor{keywordflow}{if} (stbi\_\_hdr\_test(s)) \{}
\DoxyCodeLine{1156         \textcolor{keywordtype}{float}* hdr = stbi\_\_hdr\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1157         \textcolor{keywordflow}{return} stbi\_\_hdr\_to\_ldr(hdr, *x, *y, req\_comp ? req\_comp : *comp);}
\DoxyCodeLine{1158     \}}
\DoxyCodeLine{1159 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1160 }
\DoxyCodeLine{1161 \textcolor{preprocessor}{\#ifndef STBI\_NO\_TGA}}
\DoxyCodeLine{1162     \textcolor{comment}{// test tga last because it's a crappy test!}}
\DoxyCodeLine{1163     \textcolor{keywordflow}{if} (stbi\_\_tga\_test(s))}
\DoxyCodeLine{1164         \textcolor{keywordflow}{return} stbi\_\_tga\_load(s, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{1165 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1166 }
\DoxyCodeLine{1167     \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}unknown image type"{}}, \textcolor{stringliteral}{"{}Image not of any known type, or corrupt"{}});}
\DoxyCodeLine{1168 \}}
\DoxyCodeLine{1169 }
\DoxyCodeLine{1170 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_convert\_16\_to\_8(stbi\_\_uint16* orig, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} channels)}
\DoxyCodeLine{1171 \{}
\DoxyCodeLine{1172     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1173     \textcolor{keywordtype}{int} img\_len = w * h * channels;}
\DoxyCodeLine{1174     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* reduced;}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176     reduced = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(img\_len);}
\DoxyCodeLine{1177     \textcolor{keywordflow}{if} (reduced == NULL) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{1178 }
\DoxyCodeLine{1179     \textcolor{keywordflow}{for} (i = 0; i < img\_len; ++i)}
\DoxyCodeLine{1180         reduced[i] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})((orig[i] >> 8) \& 0xFF); \textcolor{comment}{// top half of each byte is sufficient approx of 16-\/>8 bit scaling}}
\DoxyCodeLine{1181 }
\DoxyCodeLine{1182     STBI\_FREE(orig);}
\DoxyCodeLine{1183     \textcolor{keywordflow}{return} reduced;}
\DoxyCodeLine{1184 \}}
\DoxyCodeLine{1185 }
\DoxyCodeLine{1186 \textcolor{keyword}{static} stbi\_\_uint16* stbi\_\_convert\_8\_to\_16(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* orig, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} channels)}
\DoxyCodeLine{1187 \{}
\DoxyCodeLine{1188     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1189     \textcolor{keywordtype}{int} img\_len = w * h * channels;}
\DoxyCodeLine{1190     stbi\_\_uint16* enlarged;}
\DoxyCodeLine{1191 }
\DoxyCodeLine{1192     enlarged = (stbi\_\_uint16*)stbi\_\_malloc(img\_len * 2);}
\DoxyCodeLine{1193     \textcolor{keywordflow}{if} (enlarged == NULL) \textcolor{keywordflow}{return} (stbi\_\_uint16*)stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{1194 }
\DoxyCodeLine{1195     \textcolor{keywordflow}{for} (i = 0; i < img\_len; ++i)}
\DoxyCodeLine{1196         enlarged[i] = (stbi\_\_uint16)((orig[i] << 8) + orig[i]); \textcolor{comment}{// replicate to high and low byte, maps 0-\/>0, 255-\/>0xffff}}
\DoxyCodeLine{1197 }
\DoxyCodeLine{1198     STBI\_FREE(orig);}
\DoxyCodeLine{1199     \textcolor{keywordflow}{return} enlarged;}
\DoxyCodeLine{1200 \}}
\DoxyCodeLine{1201 }
\DoxyCodeLine{1202 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_vertical\_flip(\textcolor{keywordtype}{void}* image, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} bytes\_per\_pixel)}
\DoxyCodeLine{1203 \{}
\DoxyCodeLine{1204     \textcolor{keywordtype}{int} row;}
\DoxyCodeLine{1205     \textcolor{keywordtype}{size\_t} bytes\_per\_row = (size\_t)w * bytes\_per\_pixel;}
\DoxyCodeLine{1206     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} temp[2048];}
\DoxyCodeLine{1207     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* bytes = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)image;}
\DoxyCodeLine{1208 }
\DoxyCodeLine{1209     \textcolor{keywordflow}{for} (row = 0; row < (h >> 1); row++) \{}
\DoxyCodeLine{1210         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* row0 = bytes + row * bytes\_per\_row;}
\DoxyCodeLine{1211         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* row1 = bytes + (h -\/ row -\/ 1) * bytes\_per\_row;}
\DoxyCodeLine{1212         \textcolor{comment}{// swap row0 with row1}}
\DoxyCodeLine{1213         \textcolor{keywordtype}{size\_t} bytes\_left = bytes\_per\_row;}
\DoxyCodeLine{1214         \textcolor{keywordflow}{while} (bytes\_left) \{}
\DoxyCodeLine{1215             \textcolor{keywordtype}{size\_t} bytes\_copy = (bytes\_left < \textcolor{keyword}{sizeof}(temp)) ? bytes\_left : \textcolor{keyword}{sizeof}(temp);}
\DoxyCodeLine{1216             memcpy(temp, row0, bytes\_copy);}
\DoxyCodeLine{1217             memcpy(row0, row1, bytes\_copy);}
\DoxyCodeLine{1218             memcpy(row1, temp, bytes\_copy);}
\DoxyCodeLine{1219             row0 += bytes\_copy;}
\DoxyCodeLine{1220             row1 += bytes\_copy;}
\DoxyCodeLine{1221             bytes\_left -\/= bytes\_copy;}
\DoxyCodeLine{1222         \}}
\DoxyCodeLine{1223     \}}
\DoxyCodeLine{1224 \}}
\DoxyCodeLine{1225 }
\DoxyCodeLine{1226 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{1227 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_vertical\_flip\_slices(\textcolor{keywordtype}{void}* image, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} z, \textcolor{keywordtype}{int} bytes\_per\_pixel)}
\DoxyCodeLine{1228 \{}
\DoxyCodeLine{1229     \textcolor{keywordtype}{int} slice;}
\DoxyCodeLine{1230     \textcolor{keywordtype}{int} slice\_size = w * h * bytes\_per\_pixel;}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* bytes = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)image;}
\DoxyCodeLine{1233     \textcolor{keywordflow}{for} (slice = 0; slice < z; ++slice) \{}
\DoxyCodeLine{1234         stbi\_\_vertical\_flip(bytes, w, h, bytes\_per\_pixel);}
\DoxyCodeLine{1235         bytes += slice\_size;}
\DoxyCodeLine{1236     \}}
\DoxyCodeLine{1237 \}}
\DoxyCodeLine{1238 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1239 }
\DoxyCodeLine{1240 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* stbi\_\_load\_and\_postprocess\_8bit(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1241 \{}
\DoxyCodeLine{1242     stbi\_\_result\_info ri;}
\DoxyCodeLine{1243     \textcolor{keywordtype}{void}* result = stbi\_\_load\_main(s, x, y, comp, req\_comp, \&ri, 8);}
\DoxyCodeLine{1244 }
\DoxyCodeLine{1245     \textcolor{keywordflow}{if} (result == NULL)}
\DoxyCodeLine{1246         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1247 }
\DoxyCodeLine{1248     \textcolor{comment}{// it is the responsibility of the loaders to make sure we get either 8 or 16 bit.}}
\DoxyCodeLine{1249     STBI\_ASSERT(ri.bits\_per\_channel == 8 || ri.bits\_per\_channel == 16);}
\DoxyCodeLine{1250 }
\DoxyCodeLine{1251     \textcolor{keywordflow}{if} (ri.bits\_per\_channel != 8) \{}
\DoxyCodeLine{1252         result = stbi\_\_convert\_16\_to\_8((stbi\_\_uint16*)result, *x, *y, req\_comp == 0 ? *comp : req\_comp);}
\DoxyCodeLine{1253         ri.bits\_per\_channel = 8;}
\DoxyCodeLine{1254     \}}
\DoxyCodeLine{1255 }
\DoxyCodeLine{1256     \textcolor{comment}{// @TODO: move stbi\_\_convert\_format to here}}
\DoxyCodeLine{1257 }
\DoxyCodeLine{1258     \textcolor{keywordflow}{if} (stbi\_\_vertically\_flip\_on\_load) \{}
\DoxyCodeLine{1259         \textcolor{keywordtype}{int} channels = req\_comp ? req\_comp : *comp;}
\DoxyCodeLine{1260         stbi\_\_vertical\_flip(result, *x, *y, channels * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}));}
\DoxyCodeLine{1261     \}}
\DoxyCodeLine{1262 }
\DoxyCodeLine{1263     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)result;}
\DoxyCodeLine{1264 \}}
\DoxyCodeLine{1265 }
\DoxyCodeLine{1266 \textcolor{keyword}{static} stbi\_\_uint16* stbi\_\_load\_and\_postprocess\_16bit(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1267 \{}
\DoxyCodeLine{1268     stbi\_\_result\_info ri;}
\DoxyCodeLine{1269     \textcolor{keywordtype}{void}* result = stbi\_\_load\_main(s, x, y, comp, req\_comp, \&ri, 16);}
\DoxyCodeLine{1270 }
\DoxyCodeLine{1271     \textcolor{keywordflow}{if} (result == NULL)}
\DoxyCodeLine{1272         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1273 }
\DoxyCodeLine{1274     \textcolor{comment}{// it is the responsibility of the loaders to make sure we get either 8 or 16 bit.}}
\DoxyCodeLine{1275     STBI\_ASSERT(ri.bits\_per\_channel == 8 || ri.bits\_per\_channel == 16);}
\DoxyCodeLine{1276 }
\DoxyCodeLine{1277     \textcolor{keywordflow}{if} (ri.bits\_per\_channel != 16) \{}
\DoxyCodeLine{1278         result = stbi\_\_convert\_8\_to\_16((\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)result, *x, *y, req\_comp == 0 ? *comp : req\_comp);}
\DoxyCodeLine{1279         ri.bits\_per\_channel = 16;}
\DoxyCodeLine{1280     \}}
\DoxyCodeLine{1281 }
\DoxyCodeLine{1282     \textcolor{comment}{// @TODO: move stbi\_\_convert\_format16 to here}}
\DoxyCodeLine{1283     \textcolor{comment}{// @TODO: special case RGB-\/to-\/Y (and RGBA-\/to-\/YA) for 8-\/bit-\/to-\/16-\/bit case to keep more precision}}
\DoxyCodeLine{1284 }
\DoxyCodeLine{1285     \textcolor{keywordflow}{if} (stbi\_\_vertically\_flip\_on\_load) \{}
\DoxyCodeLine{1286         \textcolor{keywordtype}{int} channels = req\_comp ? req\_comp : *comp;}
\DoxyCodeLine{1287         stbi\_\_vertical\_flip(result, *x, *y, channels * \textcolor{keyword}{sizeof}(stbi\_\_uint16));}
\DoxyCodeLine{1288     \}}
\DoxyCodeLine{1289 }
\DoxyCodeLine{1290     \textcolor{keywordflow}{return} (stbi\_\_uint16*)result;}
\DoxyCodeLine{1291 \}}
\DoxyCodeLine{1292 }
\DoxyCodeLine{1293 \textcolor{preprocessor}{\#if !defined(STBI\_NO\_HDR) \&\& !defined(STBI\_NO\_LINEAR)}}
\DoxyCodeLine{1294 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_float\_postprocess(\textcolor{keywordtype}{float}* result, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1295 \{}
\DoxyCodeLine{1296     \textcolor{keywordflow}{if} (stbi\_\_vertically\_flip\_on\_load \&\& result != NULL) \{}
\DoxyCodeLine{1297         \textcolor{keywordtype}{int} channels = req\_comp ? req\_comp : *comp;}
\DoxyCodeLine{1298         stbi\_\_vertical\_flip(result, *x, *y, channels * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{1299     \}}
\DoxyCodeLine{1300 \}}
\DoxyCodeLine{1301 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1302 }
\DoxyCodeLine{1303 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{1304 }
\DoxyCodeLine{1305 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& defined(STBI\_WINDOWS\_UTF8)}}
\DoxyCodeLine{1306 STBI\_EXTERN \_\_declspec(dllimport) \textcolor{keywordtype}{int} \_\_stdcall MultiByteToWideChar(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} flags, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* str, \textcolor{keywordtype}{int} cbmb, \textcolor{keywordtype}{wchar\_t}* widestr, \textcolor{keywordtype}{int} cchwide);}
\DoxyCodeLine{1307 STBI\_EXTERN \_\_declspec(dllimport) \textcolor{keywordtype}{int} \_\_stdcall WideCharToMultiByte(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} flags, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* widestr, \textcolor{keywordtype}{int} cchwide, \textcolor{keywordtype}{char}* str, \textcolor{keywordtype}{int} cbmb, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* defchar, \textcolor{keywordtype}{int}* used\_default);}
\DoxyCodeLine{1308 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1309 }
\DoxyCodeLine{1310 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& defined(STBI\_WINDOWS\_UTF8)}}
\DoxyCodeLine{1311 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} stbi\_convert\_wchar\_to\_utf8(\textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{size\_t} bufferlen, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* input)}
\DoxyCodeLine{1312 \{}
\DoxyCodeLine{1313     \textcolor{keywordflow}{return} WideCharToMultiByte(65001 \textcolor{comment}{/* UTF8 */}, 0, input, -\/1, buffer, (\textcolor{keywordtype}{int})bufferlen, NULL, NULL);}
\DoxyCodeLine{1314 \}}
\DoxyCodeLine{1315 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1316 }
\DoxyCodeLine{1317 \textcolor{keyword}{static} FILE* stbi\_\_fopen(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{char} \textcolor{keyword}{const}* mode)}
\DoxyCodeLine{1318 \{}
\DoxyCodeLine{1319     FILE* f;}
\DoxyCodeLine{1320 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& defined(STBI\_WINDOWS\_UTF8)}}
\DoxyCodeLine{1321     \textcolor{keywordtype}{wchar\_t} wMode[64];}
\DoxyCodeLine{1322     \textcolor{keywordtype}{wchar\_t} wFilename[1024];}
\DoxyCodeLine{1323     \textcolor{keywordflow}{if} (0 == MultiByteToWideChar(65001 \textcolor{comment}{/* UTF8 */}, 0, filename, -\/1, wFilename, \textcolor{keyword}{sizeof}(wFilename) / \textcolor{keyword}{sizeof}(*wFilename)))}
\DoxyCodeLine{1324         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326     \textcolor{keywordflow}{if} (0 == MultiByteToWideChar(65001 \textcolor{comment}{/* UTF8 */}, 0, mode, -\/1, wMode, \textcolor{keyword}{sizeof}(wMode) / \textcolor{keyword}{sizeof}(*wMode)))}
\DoxyCodeLine{1327         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1328 }
\DoxyCodeLine{1329 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{1330     \textcolor{keywordflow}{if} (0 != \_wfopen\_s(\&f, wFilename, wMode))}
\DoxyCodeLine{1331         f = 0;}
\DoxyCodeLine{1332 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1333     f = \_wfopen(wFilename, wMode);}
\DoxyCodeLine{1334 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1335 }
\DoxyCodeLine{1336 \textcolor{preprocessor}{\#elif defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{1337     \textcolor{keywordflow}{if} (0 != fopen\_s(\&f, filename, mode))}
\DoxyCodeLine{1338         f = 0;}
\DoxyCodeLine{1339 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1340     f = fopen(filename, mode);}
\DoxyCodeLine{1341 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1342     \textcolor{keywordflow}{return} f;}
\DoxyCodeLine{1343 \}}
\DoxyCodeLine{1344 }
\DoxyCodeLine{1345 }
\DoxyCodeLine{1346 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_ad3fc296ba0778df0a8094e20da82deab}{stbi\_load}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1347 \{}
\DoxyCodeLine{1348     FILE* f = stbi\_\_fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{1349     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* result;}
\DoxyCodeLine{1350     \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}can't fopen"{}}, \textcolor{stringliteral}{"{}Unable to open file"{}});}
\DoxyCodeLine{1351     result = \mbox{\hyperlink{stb__image_8h_a093f86b90423ff020846c6d002c3296c}{stbi\_load\_from\_file}}(f, x, y, comp, req\_comp);}
\DoxyCodeLine{1352     fclose(f);}
\DoxyCodeLine{1353     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1354 \}}
\DoxyCodeLine{1355 }
\DoxyCodeLine{1356 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a093f86b90423ff020846c6d002c3296c}{stbi\_load\_from\_file}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1357 \{}
\DoxyCodeLine{1358     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* result;}
\DoxyCodeLine{1359     stbi\_\_context s;}
\DoxyCodeLine{1360     stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{1361     result = stbi\_\_load\_and\_postprocess\_8bit(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1362     \textcolor{keywordflow}{if} (result) \{}
\DoxyCodeLine{1363         \textcolor{comment}{// need to 'unget' all the characters in the IO buffer}}
\DoxyCodeLine{1364         fseek(f, -\/(\textcolor{keywordtype}{int})(s.img\_buffer\_end -\/ s.img\_buffer), SEEK\_CUR);}
\DoxyCodeLine{1365     \}}
\DoxyCodeLine{1366     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1367 \}}
\DoxyCodeLine{1368 }
\DoxyCodeLine{1369 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} stbi\_\_uint16* \mbox{\hyperlink{stb__image_8h_a077867644e156572eaf54d118f65e5a1}{stbi\_load\_from\_file\_16}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1370 \{}
\DoxyCodeLine{1371     stbi\_\_uint16* result;}
\DoxyCodeLine{1372     stbi\_\_context s;}
\DoxyCodeLine{1373     stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{1374     result = stbi\_\_load\_and\_postprocess\_16bit(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1375     \textcolor{keywordflow}{if} (result) \{}
\DoxyCodeLine{1376         \textcolor{comment}{// need to 'unget' all the characters in the IO buffer}}
\DoxyCodeLine{1377         fseek(f, -\/(\textcolor{keywordtype}{int})(s.img\_buffer\_end -\/ s.img\_buffer), SEEK\_CUR);}
\DoxyCodeLine{1378     \}}
\DoxyCodeLine{1379     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1380 \}}
\DoxyCodeLine{1381 }
\DoxyCodeLine{1382 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_a2202a8c0f947dd555c286f7fee1fc39d}{stbi\_load\_16}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1383 \{}
\DoxyCodeLine{1384     FILE* f = stbi\_\_fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{1385     stbi\_\_uint16* result;}
\DoxyCodeLine{1386     \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} (\mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}*)stbi\_\_errpuc(\textcolor{stringliteral}{"{}can't fopen"{}}, \textcolor{stringliteral}{"{}Unable to open file"{}});}
\DoxyCodeLine{1387     result = \mbox{\hyperlink{stb__image_8h_a077867644e156572eaf54d118f65e5a1}{stbi\_load\_from\_file\_16}}(f, x, y, comp, req\_comp);}
\DoxyCodeLine{1388     fclose(f);}
\DoxyCodeLine{1389     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1390 \}}
\DoxyCodeLine{1391 }
\DoxyCodeLine{1392 }
\DoxyCodeLine{1393 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{1394 }
\DoxyCodeLine{1395 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_a2ce4a73cca165fd30e0a23d012d8e770}{stbi\_load\_16\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels)}
\DoxyCodeLine{1396 \{}
\DoxyCodeLine{1397     stbi\_\_context s;}
\DoxyCodeLine{1398     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{1399     \textcolor{keywordflow}{return} stbi\_\_load\_and\_postprocess\_16bit(\&s, x, y, channels\_in\_file, desired\_channels);}
\DoxyCodeLine{1400 \}}
\DoxyCodeLine{1401 }
\DoxyCodeLine{1402 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a648037d4c55689328ba08c8f5d293df2}{stbi\_us}}* \mbox{\hyperlink{stb__image_8h_aa93c0e91f15bf7b1aca8369bf39c5e41}{stbi\_load\_16\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* channels\_in\_file, \textcolor{keywordtype}{int} desired\_channels)}
\DoxyCodeLine{1403 \{}
\DoxyCodeLine{1404     stbi\_\_context s;}
\DoxyCodeLine{1405     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}*)clbk, user);}
\DoxyCodeLine{1406     \textcolor{keywordflow}{return} stbi\_\_load\_and\_postprocess\_16bit(\&s, x, y, channels\_in\_file, desired\_channels);}
\DoxyCodeLine{1407 \}}
\DoxyCodeLine{1408 }
\DoxyCodeLine{1409 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a5bf9d78a27dc1cb216005798fb704bdf}{stbi\_load\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1410 \{}
\DoxyCodeLine{1411     stbi\_\_context s;}
\DoxyCodeLine{1412     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{1413     \textcolor{keywordflow}{return} stbi\_\_load\_and\_postprocess\_8bit(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1414 \}}
\DoxyCodeLine{1415 }
\DoxyCodeLine{1416 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a354f2a6f7939cf1792db087ad3b2220a}{stbi\_load\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1417 \{}
\DoxyCodeLine{1418     stbi\_\_context s;}
\DoxyCodeLine{1419     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}*)clbk, user);}
\DoxyCodeLine{1420     \textcolor{keywordflow}{return} stbi\_\_load\_and\_postprocess\_8bit(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1421 \}}
\DoxyCodeLine{1422 }
\DoxyCodeLine{1423 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{1424 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \mbox{\hyperlink{stb__image_8h_a1d5ab90f79c38ced898becd050cfb910}{stbi\_load\_gif\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}** delays, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* z, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1425 \{}
\DoxyCodeLine{1426     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* result;}
\DoxyCodeLine{1427     stbi\_\_context s;}
\DoxyCodeLine{1428     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{1429 }
\DoxyCodeLine{1430     result = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)stbi\_\_load\_gif\_main(\&s, delays, x, y, z, comp, req\_comp);}
\DoxyCodeLine{1431     \textcolor{keywordflow}{if} (stbi\_\_vertically\_flip\_on\_load) \{}
\DoxyCodeLine{1432         stbi\_\_vertical\_flip\_slices(result, *x, *y, *z, *comp);}
\DoxyCodeLine{1433     \}}
\DoxyCodeLine{1434 }
\DoxyCodeLine{1435     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1436 \}}
\DoxyCodeLine{1437 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1438 }
\DoxyCodeLine{1439 \textcolor{preprocessor}{\#ifndef STBI\_NO\_LINEAR}}
\DoxyCodeLine{1440 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbi\_\_loadf\_main(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1441 \{}
\DoxyCodeLine{1442     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* data;}
\DoxyCodeLine{1443 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1444     \textcolor{keywordflow}{if} (stbi\_\_hdr\_test(s)) \{}
\DoxyCodeLine{1445         stbi\_\_result\_info ri;}
\DoxyCodeLine{1446         \textcolor{keywordtype}{float}* hdr\_data = stbi\_\_hdr\_load(s, x, y, comp, req\_comp, \&ri);}
\DoxyCodeLine{1447         \textcolor{keywordflow}{if} (hdr\_data)}
\DoxyCodeLine{1448             stbi\_\_float\_postprocess(hdr\_data, x, y, comp, req\_comp);}
\DoxyCodeLine{1449         \textcolor{keywordflow}{return} hdr\_data;}
\DoxyCodeLine{1450     \}}
\DoxyCodeLine{1451 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1452     data = stbi\_\_load\_and\_postprocess\_8bit(s, x, y, comp, req\_comp);}
\DoxyCodeLine{1453     \textcolor{keywordflow}{if} (data)}
\DoxyCodeLine{1454         \textcolor{keywordflow}{return} stbi\_\_ldr\_to\_hdr(data, *x, *y, req\_comp ? req\_comp : *comp);}
\DoxyCodeLine{1455     \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}unknown image type"{}}, \textcolor{stringliteral}{"{}Image not of any known type, or corrupt"{}});}
\DoxyCodeLine{1456 \}}
\DoxyCodeLine{1457 }
\DoxyCodeLine{1458 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a09c9f8ddfda96cc62461b86daccf0f77}{stbi\_loadf\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1459 \{}
\DoxyCodeLine{1460     stbi\_\_context s;}
\DoxyCodeLine{1461     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{1462     \textcolor{keywordflow}{return} stbi\_\_loadf\_main(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1463 \}}
\DoxyCodeLine{1464 }
\DoxyCodeLine{1465 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a7573a229fe25afc452dffddbded8e5a8}{stbi\_loadf\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1466 \{}
\DoxyCodeLine{1467     stbi\_\_context s;}
\DoxyCodeLine{1468     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}*)clbk, user);}
\DoxyCodeLine{1469     \textcolor{keywordflow}{return} stbi\_\_loadf\_main(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1470 \}}
\DoxyCodeLine{1471 }
\DoxyCodeLine{1472 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{1473 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a4fe9e7c92b7f8e8df8939b776a49cfa8}{stbi\_loadf}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1474 \{}
\DoxyCodeLine{1475     \textcolor{keywordtype}{float}* result;}
\DoxyCodeLine{1476     FILE* f = stbi\_\_fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{1477     \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}can't fopen"{}}, \textcolor{stringliteral}{"{}Unable to open file"{}});}
\DoxyCodeLine{1478     result = \mbox{\hyperlink{stb__image_8h_a9099e31f34506c8630d58b737aa5a049}{stbi\_loadf\_from\_file}}(f, x, y, comp, req\_comp);}
\DoxyCodeLine{1479     fclose(f);}
\DoxyCodeLine{1480     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1481 \}}
\DoxyCodeLine{1482 }
\DoxyCodeLine{1483 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{float}* \mbox{\hyperlink{stb__image_8h_a9099e31f34506c8630d58b737aa5a049}{stbi\_loadf\_from\_file}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{1484 \{}
\DoxyCodeLine{1485     stbi\_\_context s;}
\DoxyCodeLine{1486     stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{1487     \textcolor{keywordflow}{return} stbi\_\_loadf\_main(\&s, x, y, comp, req\_comp);}
\DoxyCodeLine{1488 \}}
\DoxyCodeLine{1489 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_NO\_STDIO}}
\DoxyCodeLine{1490 }
\DoxyCodeLine{1491 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_NO\_LINEAR}}
\DoxyCodeLine{1492 }
\DoxyCodeLine{1493 \textcolor{comment}{// these is-\/hdr-\/or-\/not is defined independent of whether STBI\_NO\_LINEAR is}}
\DoxyCodeLine{1494 \textcolor{comment}{// defined, for API simplicity; if STBI\_NO\_LINEAR is defined, it always}}
\DoxyCodeLine{1495 \textcolor{comment}{// reports false!}}
\DoxyCodeLine{1496 }
\DoxyCodeLine{1497 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a5cbc6f5cbb3b2d0d87ee959fcee9d23e}{stbi\_is\_hdr\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len)}
\DoxyCodeLine{1498 \{}
\DoxyCodeLine{1499 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1500     stbi\_\_context s;}
\DoxyCodeLine{1501     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{1502     \textcolor{keywordflow}{return} stbi\_\_hdr\_test(\&s);}
\DoxyCodeLine{1503 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1504     STBI\_NOTUSED(buffer);}
\DoxyCodeLine{1505     STBI\_NOTUSED(len);}
\DoxyCodeLine{1506     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1507 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1508 \}}
\DoxyCodeLine{1509 }
\DoxyCodeLine{1510 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{1511 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_ae70f9a302f7e87fd971075e7f758d55c}{stbi\_is\_hdr}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename)}
\DoxyCodeLine{1512 \{}
\DoxyCodeLine{1513     FILE* f = stbi\_\_fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{1514     \textcolor{keywordtype}{int} result = 0;}
\DoxyCodeLine{1515     \textcolor{keywordflow}{if} (f) \{}
\DoxyCodeLine{1516         result = \mbox{\hyperlink{stb__image_8h_aaf10d41631e1e9214fde1688bdbd8524}{stbi\_is\_hdr\_from\_file}}(f);}
\DoxyCodeLine{1517         fclose(f);}
\DoxyCodeLine{1518     \}}
\DoxyCodeLine{1519     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{1520 \}}
\DoxyCodeLine{1521 }
\DoxyCodeLine{1522 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_aaf10d41631e1e9214fde1688bdbd8524}{stbi\_is\_hdr\_from\_file}}(FILE* f)}
\DoxyCodeLine{1523 \{}
\DoxyCodeLine{1524 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1525     \textcolor{keywordtype}{long} pos = ftell(f);}
\DoxyCodeLine{1526     \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{1527     stbi\_\_context s;}
\DoxyCodeLine{1528     stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{1529     res = stbi\_\_hdr\_test(\&s);}
\DoxyCodeLine{1530     fseek(f, pos, SEEK\_SET);}
\DoxyCodeLine{1531     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{1532 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1533     STBI\_NOTUSED(f);}
\DoxyCodeLine{1534     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1535 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1536 \}}
\DoxyCodeLine{1537 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_NO\_STDIO}}
\DoxyCodeLine{1538 }
\DoxyCodeLine{1539 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int}      \mbox{\hyperlink{stb__image_8h_af0e94f316fe1848f632517ca3c11d077}{stbi\_is\_hdr\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* clbk, \textcolor{keywordtype}{void}* user)}
\DoxyCodeLine{1540 \{}
\DoxyCodeLine{1541 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1542     stbi\_\_context s;}
\DoxyCodeLine{1543     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}*)clbk, user);}
\DoxyCodeLine{1544     \textcolor{keywordflow}{return} stbi\_\_hdr\_test(\&s);}
\DoxyCodeLine{1545 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1546     STBI\_NOTUSED(clbk);}
\DoxyCodeLine{1547     STBI\_NOTUSED(user);}
\DoxyCodeLine{1548     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1549 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1550 \}}
\DoxyCodeLine{1551 }
\DoxyCodeLine{1552 \textcolor{preprocessor}{\#ifndef STBI\_NO\_LINEAR}}
\DoxyCodeLine{1553 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbi\_\_l2h\_gamma = 2.2f, stbi\_\_l2h\_scale = 1.0f;}
\DoxyCodeLine{1554 }
\DoxyCodeLine{1555 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_a1feccdcf726dcc6b5502e3efa85b7dbb}{stbi\_ldr\_to\_hdr\_gamma}}(\textcolor{keywordtype}{float} gamma) \{ stbi\_\_l2h\_gamma = gamma; \}}
\DoxyCodeLine{1556 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_af946583656a362a316b40c0421c20561}{stbi\_ldr\_to\_hdr\_scale}}(\textcolor{keywordtype}{float} scale) \{ stbi\_\_l2h\_scale = scale; \}}
\DoxyCodeLine{1557 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1558 }
\DoxyCodeLine{1559 \textcolor{keyword}{static} \textcolor{keywordtype}{float} stbi\_\_h2l\_gamma\_i = 1.0f / 2.2f, stbi\_\_h2l\_scale\_i = 1.0f;}
\DoxyCodeLine{1560 }
\DoxyCodeLine{1561 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_ab18889e43518d6b4421b705782bb1b5e}{stbi\_hdr\_to\_ldr\_gamma}}(\textcolor{keywordtype}{float} gamma) \{ stbi\_\_h2l\_gamma\_i = 1 / gamma; \}}
\DoxyCodeLine{1562 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void}   \mbox{\hyperlink{stb__image_8h_ae21cc1184eeb5cc814699f1ed62c5258}{stbi\_hdr\_to\_ldr\_scale}}(\textcolor{keywordtype}{float} scale) \{ stbi\_\_h2l\_scale\_i = 1 / scale; \}}
\DoxyCodeLine{1563 }
\DoxyCodeLine{1564 }
\DoxyCodeLine{1566 \textcolor{comment}{//}}
\DoxyCodeLine{1567 \textcolor{comment}{// Common code used by all image loaders}}
\DoxyCodeLine{1568 \textcolor{comment}{//}}
\DoxyCodeLine{1569 }
\DoxyCodeLine{1570 \textcolor{keyword}{enum}}
\DoxyCodeLine{1571 \{}
\DoxyCodeLine{1572     STBI\_\_SCAN\_load = 0,}
\DoxyCodeLine{1573     STBI\_\_SCAN\_type,}
\DoxyCodeLine{1574     STBI\_\_SCAN\_header}
\DoxyCodeLine{1575 \};}
\DoxyCodeLine{1576 }
\DoxyCodeLine{1577 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_refill\_buffer(stbi\_\_context* s)}
\DoxyCodeLine{1578 \{}
\DoxyCodeLine{1579     \textcolor{keywordtype}{int} n = (s-\/>io.read)(s-\/>io\_user\_data, (\textcolor{keywordtype}{char}*)s-\/>buffer\_start, s-\/>buflen);}
\DoxyCodeLine{1580     s-\/>callback\_already\_read += (int)(s-\/>img\_buffer -\/ s-\/>img\_buffer\_original);}
\DoxyCodeLine{1581     \textcolor{keywordflow}{if} (n == 0) \{}
\DoxyCodeLine{1582         \textcolor{comment}{// at end of file, treat same as if from memory, but need to handle case}}
\DoxyCodeLine{1583         \textcolor{comment}{// where s-\/>img\_buffer isn't pointing to safe memory, e.g. 0-\/byte file}}
\DoxyCodeLine{1584         s-\/>read\_from\_callbacks = 0;}
\DoxyCodeLine{1585         s-\/>img\_buffer = s-\/>buffer\_start;}
\DoxyCodeLine{1586         s-\/>img\_buffer\_end = s-\/>buffer\_start + 1;}
\DoxyCodeLine{1587         *s-\/>img\_buffer = 0;}
\DoxyCodeLine{1588     \}}
\DoxyCodeLine{1589     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1590         s-\/>img\_buffer = s-\/>buffer\_start;}
\DoxyCodeLine{1591         s-\/>img\_buffer\_end = s-\/>buffer\_start + n;}
\DoxyCodeLine{1592     \}}
\DoxyCodeLine{1593 \}}
\DoxyCodeLine{1594 }
\DoxyCodeLine{1595 stbi\_inline \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_get8(stbi\_\_context* s)}
\DoxyCodeLine{1596 \{}
\DoxyCodeLine{1597     \textcolor{keywordflow}{if} (s-\/>img\_buffer < s-\/>img\_buffer\_end)}
\DoxyCodeLine{1598         \textcolor{keywordflow}{return} *s-\/>img\_buffer++;}
\DoxyCodeLine{1599     \textcolor{keywordflow}{if} (s-\/>read\_from\_callbacks) \{}
\DoxyCodeLine{1600         stbi\_\_refill\_buffer(s);}
\DoxyCodeLine{1601         \textcolor{keywordflow}{return} *s-\/>img\_buffer++;}
\DoxyCodeLine{1602     \}}
\DoxyCodeLine{1603     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1604 \}}
\DoxyCodeLine{1605 }
\DoxyCodeLine{1606 \textcolor{preprocessor}{\#if defined(STBI\_NO\_JPEG) \&\& defined(STBI\_NO\_HDR) \&\& defined(STBI\_NO\_PIC) \&\& defined(STBI\_NO\_PNM)}}
\DoxyCodeLine{1607 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1608 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1609 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_at\_eof(stbi\_\_context* s)}
\DoxyCodeLine{1610 \{}
\DoxyCodeLine{1611     \textcolor{keywordflow}{if} (s-\/>io.read) \{}
\DoxyCodeLine{1612         \textcolor{keywordflow}{if} (!(s-\/>io.eof)(s-\/>io\_user\_data)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1613         \textcolor{comment}{// if feof() is true, check if buffer = end}}
\DoxyCodeLine{1614         \textcolor{comment}{// special case: we've only got the special 0 character at the end}}
\DoxyCodeLine{1615         \textcolor{keywordflow}{if} (s-\/>read\_from\_callbacks == 0) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1616     \}}
\DoxyCodeLine{1617 }
\DoxyCodeLine{1618     \textcolor{keywordflow}{return} s-\/>img\_buffer >= s-\/>img\_buffer\_end;}
\DoxyCodeLine{1619 \}}
\DoxyCodeLine{1620 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1621 }
\DoxyCodeLine{1622 \textcolor{preprocessor}{\#if defined(STBI\_NO\_JPEG) \&\& defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_BMP) \&\& defined(STBI\_NO\_PSD) \&\& defined(STBI\_NO\_TGA) \&\& defined(STBI\_NO\_GIF) \&\& defined(STBI\_NO\_PIC)}}
\DoxyCodeLine{1623 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1624 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1625 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_skip(stbi\_\_context* s, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1626 \{}
\DoxyCodeLine{1627     \textcolor{keywordflow}{if} (n == 0) \textcolor{keywordflow}{return};  \textcolor{comment}{// already there!}}
\DoxyCodeLine{1628     \textcolor{keywordflow}{if} (n < 0) \{}
\DoxyCodeLine{1629         s-\/>img\_buffer = s-\/>img\_buffer\_end;}
\DoxyCodeLine{1630         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1631     \}}
\DoxyCodeLine{1632     \textcolor{keywordflow}{if} (s-\/>io.read) \{}
\DoxyCodeLine{1633         \textcolor{keywordtype}{int} blen = (int)(s-\/>img\_buffer\_end -\/ s-\/>img\_buffer);}
\DoxyCodeLine{1634         \textcolor{keywordflow}{if} (blen < n) \{}
\DoxyCodeLine{1635             s-\/>img\_buffer = s-\/>img\_buffer\_end;}
\DoxyCodeLine{1636             (s-\/>io.skip)(s-\/>io\_user\_data, n -\/ blen);}
\DoxyCodeLine{1637             \textcolor{keywordflow}{return};}
\DoxyCodeLine{1638         \}}
\DoxyCodeLine{1639     \}}
\DoxyCodeLine{1640     s-\/>img\_buffer += n;}
\DoxyCodeLine{1641 \}}
\DoxyCodeLine{1642 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1643 }
\DoxyCodeLine{1644 \textcolor{preprocessor}{\#if defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_TGA) \&\& defined(STBI\_NO\_HDR) \&\& defined(STBI\_NO\_PNM)}}
\DoxyCodeLine{1645 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1646 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1647 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_getn(stbi\_\_context* s, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* buffer, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{1648 \{}
\DoxyCodeLine{1649     \textcolor{keywordflow}{if} (s-\/>io.read) \{}
\DoxyCodeLine{1650         \textcolor{keywordtype}{int} blen = (int)(s-\/>img\_buffer\_end -\/ s-\/>img\_buffer);}
\DoxyCodeLine{1651         \textcolor{keywordflow}{if} (blen < n) \{}
\DoxyCodeLine{1652             \textcolor{keywordtype}{int} res, count;}
\DoxyCodeLine{1653 }
\DoxyCodeLine{1654             memcpy(buffer, s-\/>img\_buffer, blen);}
\DoxyCodeLine{1655 }
\DoxyCodeLine{1656             count = (s-\/>io.read)(s-\/>io\_user\_data, (\textcolor{keywordtype}{char}*)buffer + blen, n -\/ blen);}
\DoxyCodeLine{1657             res = (count == (n -\/ blen));}
\DoxyCodeLine{1658             s-\/>img\_buffer = s-\/>img\_buffer\_end;}
\DoxyCodeLine{1659             \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{1660         \}}
\DoxyCodeLine{1661     \}}
\DoxyCodeLine{1662 }
\DoxyCodeLine{1663     \textcolor{keywordflow}{if} (s-\/>img\_buffer + n <= s-\/>img\_buffer\_end) \{}
\DoxyCodeLine{1664         memcpy(buffer, s-\/>img\_buffer, n);}
\DoxyCodeLine{1665         s-\/>img\_buffer += n;}
\DoxyCodeLine{1666         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1667     \}}
\DoxyCodeLine{1668     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1669         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1670 \}}
\DoxyCodeLine{1671 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1672 }
\DoxyCodeLine{1673 \textcolor{preprocessor}{\#if defined(STBI\_NO\_JPEG) \&\& defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_PSD) \&\& defined(STBI\_NO\_PIC)}}
\DoxyCodeLine{1674 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1675 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1676 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_get16be(stbi\_\_context* s)}
\DoxyCodeLine{1677 \{}
\DoxyCodeLine{1678     \textcolor{keywordtype}{int} z = stbi\_\_get8(s);}
\DoxyCodeLine{1679     \textcolor{keywordflow}{return} (z << 8) + stbi\_\_get8(s);}
\DoxyCodeLine{1680 \}}
\DoxyCodeLine{1681 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1682 }
\DoxyCodeLine{1683 \textcolor{preprocessor}{\#if defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_PSD) \&\& defined(STBI\_NO\_PIC)}}
\DoxyCodeLine{1684 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1685 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1686 \textcolor{keyword}{static} stbi\_\_uint32 stbi\_\_get32be(stbi\_\_context* s)}
\DoxyCodeLine{1687 \{}
\DoxyCodeLine{1688     stbi\_\_uint32 z = stbi\_\_get16be(s);}
\DoxyCodeLine{1689     \textcolor{keywordflow}{return} (z << 16) + stbi\_\_get16be(s);}
\DoxyCodeLine{1690 \}}
\DoxyCodeLine{1691 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693 \textcolor{preprocessor}{\#if defined(STBI\_NO\_BMP) \&\& defined(STBI\_NO\_TGA) \&\& defined(STBI\_NO\_GIF)}}
\DoxyCodeLine{1694 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1695 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1696 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_get16le(stbi\_\_context* s)}
\DoxyCodeLine{1697 \{}
\DoxyCodeLine{1698     \textcolor{keywordtype}{int} z = stbi\_\_get8(s);}
\DoxyCodeLine{1699     \textcolor{keywordflow}{return} z + (stbi\_\_get8(s) << 8);}
\DoxyCodeLine{1700 \}}
\DoxyCodeLine{1701 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1702 }
\DoxyCodeLine{1703 \textcolor{preprocessor}{\#ifndef STBI\_NO\_BMP}}
\DoxyCodeLine{1704 \textcolor{keyword}{static} stbi\_\_uint32 stbi\_\_get32le(stbi\_\_context* s)}
\DoxyCodeLine{1705 \{}
\DoxyCodeLine{1706     stbi\_\_uint32 z = stbi\_\_get16le(s);}
\DoxyCodeLine{1707     z += (stbi\_\_uint32)stbi\_\_get16le(s) << 16;}
\DoxyCodeLine{1708     \textcolor{keywordflow}{return} z;}
\DoxyCodeLine{1709 \}}
\DoxyCodeLine{1710 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1711 }
\DoxyCodeLine{1712 \textcolor{preprocessor}{\#define STBI\_\_BYTECAST(x)  ((stbi\_uc) ((x) \& 255))  }\textcolor{comment}{// truncate int to byte without warnings}}
\DoxyCodeLine{1713 }
\DoxyCodeLine{1714 \textcolor{preprocessor}{\#if defined(STBI\_NO\_JPEG) \&\& defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_BMP) \&\& defined(STBI\_NO\_PSD) \&\& defined(STBI\_NO\_TGA) \&\& defined(STBI\_NO\_GIF) \&\& defined(STBI\_NO\_PIC) \&\& defined(STBI\_NO\_PNM)}}
\DoxyCodeLine{1715 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1716 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1718 \textcolor{comment}{//}}
\DoxyCodeLine{1719 \textcolor{comment}{//  generic converter from built-\/in img\_n to req\_comp}}
\DoxyCodeLine{1720 \textcolor{comment}{//    individual types do this automatically as much as possible (e.g. jpeg}}
\DoxyCodeLine{1721 \textcolor{comment}{//    does all cases internally since it needs to colorspace convert anyway,}}
\DoxyCodeLine{1722 \textcolor{comment}{//    and it never has alpha, so very few cases ). png can automatically}}
\DoxyCodeLine{1723 \textcolor{comment}{//    interleave an alpha=255 channel, but falls back to this for other cases}}
\DoxyCodeLine{1724 \textcolor{comment}{//}}
\DoxyCodeLine{1725 \textcolor{comment}{//  assume data buffer is malloced, so malloc a new one and free that one}}
\DoxyCodeLine{1726 \textcolor{comment}{//  only failure mode is malloc failing}}
\DoxyCodeLine{1727 }
\DoxyCodeLine{1728 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_compute\_y(\textcolor{keywordtype}{int} r, \textcolor{keywordtype}{int} g, \textcolor{keywordtype}{int} b)}
\DoxyCodeLine{1729 \{}
\DoxyCodeLine{1730     \textcolor{keywordflow}{return} (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})(((r * 77) + (g * 150) + (29 * b)) >> 8);}
\DoxyCodeLine{1731 \}}
\DoxyCodeLine{1732 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1733 }
\DoxyCodeLine{1734 \textcolor{preprocessor}{\#if defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_BMP) \&\& defined(STBI\_NO\_PSD) \&\& defined(STBI\_NO\_TGA) \&\& defined(STBI\_NO\_GIF) \&\& defined(STBI\_NO\_PIC) \&\& defined(STBI\_NO\_PNM)}}
\DoxyCodeLine{1735 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1736 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1737 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* stbi\_\_convert\_format(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* data, \textcolor{keywordtype}{int} img\_n, \textcolor{keywordtype}{int} req\_comp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y)}
\DoxyCodeLine{1738 \{}
\DoxyCodeLine{1739     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{1740     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* good;}
\DoxyCodeLine{1741 }
\DoxyCodeLine{1742     \textcolor{keywordflow}{if} (req\_comp == img\_n) \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{1743     STBI\_ASSERT(req\_comp >= 1 \&\& req\_comp <= 4);}
\DoxyCodeLine{1744 }
\DoxyCodeLine{1745     good = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)stbi\_\_malloc\_mad3(req\_comp, x, y, 0);}
\DoxyCodeLine{1746     \textcolor{keywordflow}{if} (good == NULL) \{}
\DoxyCodeLine{1747         STBI\_FREE(data);}
\DoxyCodeLine{1748         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{1749     \}}
\DoxyCodeLine{1750 }
\DoxyCodeLine{1751     \textcolor{keywordflow}{for} (j = 0; j < (int)y; ++j) \{}
\DoxyCodeLine{1752         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* src = data + j * x * img\_n;}
\DoxyCodeLine{1753         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* dest = good + j * x * req\_comp;}
\DoxyCodeLine{1754 }
\DoxyCodeLine{1755 \textcolor{preprocessor}{\#define STBI\_\_COMBO(a,b)  ((a)*8+(b))}}
\DoxyCodeLine{1756 \textcolor{preprocessor}{\#define STBI\_\_CASE(a,b)   case STBI\_\_COMBO(a,b): for(i=x-\/1; i >= 0; -\/-\/i, src += a, dest += b)}}
\DoxyCodeLine{1757         \textcolor{comment}{// convert source image with img\_n components to one with req\_comp components;}}
\DoxyCodeLine{1758         \textcolor{comment}{// avoid switch per pixel, so use switch per scanline and massive macros}}
\DoxyCodeLine{1759         \textcolor{keywordflow}{switch} (STBI\_\_COMBO(img\_n, req\_comp)) \{}
\DoxyCodeLine{1760             STBI\_\_CASE(1, 2) \{ dest[0] = src[0]; dest[1] = 255; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1761             STBI\_\_CASE(1, 3) \{ dest[0] = dest[1] = dest[2] = src[0]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1762             STBI\_\_CASE(1, 4) \{ dest[0] = dest[1] = dest[2] = src[0]; dest[3] = 255; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1763             STBI\_\_CASE(2, 1) \{ dest[0] = src[0]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1764             STBI\_\_CASE(2, 3) \{ dest[0] = dest[1] = dest[2] = src[0]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1765             STBI\_\_CASE(2, 4) \{ dest[0] = dest[1] = dest[2] = src[0]; dest[3] = src[1]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1766             STBI\_\_CASE(3, 4) \{ dest[0] = src[0]; dest[1] = src[1]; dest[2] = src[2]; dest[3] = 255; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1767             STBI\_\_CASE(3, 1) \{ dest[0] = stbi\_\_compute\_y(src[0], src[1], src[2]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1768             STBI\_\_CASE(3, 2) \{ dest[0] = stbi\_\_compute\_y(src[0], src[1], src[2]); dest[1] = 255; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1769             STBI\_\_CASE(4, 1) \{ dest[0] = stbi\_\_compute\_y(src[0], src[1], src[2]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1770             STBI\_\_CASE(4, 2) \{ dest[0] = stbi\_\_compute\_y(src[0], src[1], src[2]); dest[1] = src[3]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1771             STBI\_\_CASE(4, 3) \{ dest[0] = src[0]; dest[1] = src[1]; dest[2] = src[2]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1772         \textcolor{keywordflow}{default}: STBI\_ASSERT(0); STBI\_FREE(data); STBI\_FREE(good); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}unsupported"{}}, \textcolor{stringliteral}{"{}Unsupported format conversion"{}});}
\DoxyCodeLine{1773         \}}
\DoxyCodeLine{1774 \textcolor{preprocessor}{\#undef STBI\_\_CASE}}
\DoxyCodeLine{1775     \}}
\DoxyCodeLine{1776 }
\DoxyCodeLine{1777     STBI\_FREE(data);}
\DoxyCodeLine{1778     \textcolor{keywordflow}{return} good;}
\DoxyCodeLine{1779 \}}
\DoxyCodeLine{1780 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1781 }
\DoxyCodeLine{1782 \textcolor{preprocessor}{\#if defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_PSD)}}
\DoxyCodeLine{1783 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1784 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1785 \textcolor{keyword}{static} stbi\_\_uint16 stbi\_\_compute\_y\_16(\textcolor{keywordtype}{int} r, \textcolor{keywordtype}{int} g, \textcolor{keywordtype}{int} b)}
\DoxyCodeLine{1786 \{}
\DoxyCodeLine{1787     \textcolor{keywordflow}{return} (stbi\_\_uint16)(((r * 77) + (g * 150) + (29 * b)) >> 8);}
\DoxyCodeLine{1788 \}}
\DoxyCodeLine{1789 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1790 }
\DoxyCodeLine{1791 \textcolor{preprocessor}{\#if defined(STBI\_NO\_PNG) \&\& defined(STBI\_NO\_PSD)}}
\DoxyCodeLine{1792 \textcolor{comment}{// nothing}}
\DoxyCodeLine{1793 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1794 \textcolor{keyword}{static} stbi\_\_uint16* stbi\_\_convert\_format16(stbi\_\_uint16* data, \textcolor{keywordtype}{int} img\_n, \textcolor{keywordtype}{int} req\_comp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y)}
\DoxyCodeLine{1795 \{}
\DoxyCodeLine{1796     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{1797     stbi\_\_uint16* good;}
\DoxyCodeLine{1798 }
\DoxyCodeLine{1799     \textcolor{keywordflow}{if} (req\_comp == img\_n) \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{1800     STBI\_ASSERT(req\_comp >= 1 \&\& req\_comp <= 4);}
\DoxyCodeLine{1801 }
\DoxyCodeLine{1802     good = (stbi\_\_uint16*)stbi\_\_malloc(req\_comp * x * y * 2);}
\DoxyCodeLine{1803     \textcolor{keywordflow}{if} (good == NULL) \{}
\DoxyCodeLine{1804         STBI\_FREE(data);}
\DoxyCodeLine{1805         \textcolor{keywordflow}{return} (stbi\_\_uint16*)stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{1806     \}}
\DoxyCodeLine{1807 }
\DoxyCodeLine{1808     \textcolor{keywordflow}{for} (j = 0; j < (int)y; ++j) \{}
\DoxyCodeLine{1809         stbi\_\_uint16* src = data + j * x * img\_n;}
\DoxyCodeLine{1810         stbi\_\_uint16* dest = good + j * x * req\_comp;}
\DoxyCodeLine{1811 }
\DoxyCodeLine{1812 \textcolor{preprocessor}{\#define STBI\_\_COMBO(a,b)  ((a)*8+(b))}}
\DoxyCodeLine{1813 \textcolor{preprocessor}{\#define STBI\_\_CASE(a,b)   case STBI\_\_COMBO(a,b): for(i=x-\/1; i >= 0; -\/-\/i, src += a, dest += b)}}
\DoxyCodeLine{1814         \textcolor{comment}{// convert source image with img\_n components to one with req\_comp components;}}
\DoxyCodeLine{1815         \textcolor{comment}{// avoid switch per pixel, so use switch per scanline and massive macros}}
\DoxyCodeLine{1816         \textcolor{keywordflow}{switch} (STBI\_\_COMBO(img\_n, req\_comp)) \{}
\DoxyCodeLine{1817             STBI\_\_CASE(1, 2) \{ dest[0] = src[0]; dest[1] = 0xffff; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1818             STBI\_\_CASE(1, 3) \{ dest[0] = dest[1] = dest[2] = src[0]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1819             STBI\_\_CASE(1, 4) \{ dest[0] = dest[1] = dest[2] = src[0]; dest[3] = 0xffff; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1820             STBI\_\_CASE(2, 1) \{ dest[0] = src[0]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1821             STBI\_\_CASE(2, 3) \{ dest[0] = dest[1] = dest[2] = src[0]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1822             STBI\_\_CASE(2, 4) \{ dest[0] = dest[1] = dest[2] = src[0]; dest[3] = src[1]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1823             STBI\_\_CASE(3, 4) \{ dest[0] = src[0]; dest[1] = src[1]; dest[2] = src[2]; dest[3] = 0xffff; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1824             STBI\_\_CASE(3, 1) \{ dest[0] = stbi\_\_compute\_y\_16(src[0], src[1], src[2]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1825             STBI\_\_CASE(3, 2) \{ dest[0] = stbi\_\_compute\_y\_16(src[0], src[1], src[2]); dest[1] = 0xffff; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1826             STBI\_\_CASE(4, 1) \{ dest[0] = stbi\_\_compute\_y\_16(src[0], src[1], src[2]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1827             STBI\_\_CASE(4, 2) \{ dest[0] = stbi\_\_compute\_y\_16(src[0], src[1], src[2]); dest[1] = src[3]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1828             STBI\_\_CASE(4, 3) \{ dest[0] = src[0]; dest[1] = src[1]; dest[2] = src[2]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{1829         \textcolor{keywordflow}{default}: STBI\_ASSERT(0); STBI\_FREE(data); STBI\_FREE(good); \textcolor{keywordflow}{return} (stbi\_\_uint16*)stbi\_\_errpuc(\textcolor{stringliteral}{"{}unsupported"{}}, \textcolor{stringliteral}{"{}Unsupported format conversion"{}});}
\DoxyCodeLine{1830         \}}
\DoxyCodeLine{1831 \textcolor{preprocessor}{\#undef STBI\_\_CASE}}
\DoxyCodeLine{1832     \}}
\DoxyCodeLine{1833 }
\DoxyCodeLine{1834     STBI\_FREE(data);}
\DoxyCodeLine{1835     \textcolor{keywordflow}{return} good;}
\DoxyCodeLine{1836 \}}
\DoxyCodeLine{1837 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1838 }
\DoxyCodeLine{1839 \textcolor{preprocessor}{\#ifndef STBI\_NO\_LINEAR}}
\DoxyCodeLine{1840 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbi\_\_ldr\_to\_hdr(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* data, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp)}
\DoxyCodeLine{1841 \{}
\DoxyCodeLine{1842     \textcolor{keywordtype}{int} i, k, n;}
\DoxyCodeLine{1843     \textcolor{keywordtype}{float}* output;}
\DoxyCodeLine{1844     \textcolor{keywordflow}{if} (!data) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1845     output = (\textcolor{keywordtype}{float}*)stbi\_\_malloc\_mad4(x, y, comp, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}), 0);}
\DoxyCodeLine{1846     \textcolor{keywordflow}{if} (output == NULL) \{ STBI\_FREE(data); \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}}); \}}
\DoxyCodeLine{1847     \textcolor{comment}{// compute number of non-\/alpha components}}
\DoxyCodeLine{1848     \textcolor{keywordflow}{if} (comp \& 1) n = comp; \textcolor{keywordflow}{else} n = comp -\/ 1;}
\DoxyCodeLine{1849     \textcolor{keywordflow}{for} (i = 0; i < x * y; ++i) \{}
\DoxyCodeLine{1850         \textcolor{keywordflow}{for} (k = 0; k < n; ++k) \{}
\DoxyCodeLine{1851             output[i * comp + k] = (float)(pow(data[i * comp + k] / 255.0f, stbi\_\_l2h\_gamma) * stbi\_\_l2h\_scale);}
\DoxyCodeLine{1852         \}}
\DoxyCodeLine{1853     \}}
\DoxyCodeLine{1854     \textcolor{keywordflow}{if} (n < comp) \{}
\DoxyCodeLine{1855         \textcolor{keywordflow}{for} (i = 0; i < x * y; ++i) \{}
\DoxyCodeLine{1856             output[i * comp + n] = data[i * comp + n] / 255.0f;}
\DoxyCodeLine{1857         \}}
\DoxyCodeLine{1858     \}}
\DoxyCodeLine{1859     STBI\_FREE(data);}
\DoxyCodeLine{1860     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{1861 \}}
\DoxyCodeLine{1862 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1863 }
\DoxyCodeLine{1864 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{1865 \textcolor{preprocessor}{\#define stbi\_\_float2int(x)   ((int) (x))}}
\DoxyCodeLine{1866 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_hdr\_to\_ldr(\textcolor{keywordtype}{float}* data, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp)}
\DoxyCodeLine{1867 \{}
\DoxyCodeLine{1868     \textcolor{keywordtype}{int} i, k, n;}
\DoxyCodeLine{1869     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* output;}
\DoxyCodeLine{1870     \textcolor{keywordflow}{if} (!data) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{1871     output = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(x, y, comp, 0);}
\DoxyCodeLine{1872     \textcolor{keywordflow}{if} (output == NULL) \{ STBI\_FREE(data); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}}); \}}
\DoxyCodeLine{1873     \textcolor{comment}{// compute number of non-\/alpha components}}
\DoxyCodeLine{1874     \textcolor{keywordflow}{if} (comp \& 1) n = comp; \textcolor{keywordflow}{else} n = comp -\/ 1;}
\DoxyCodeLine{1875     \textcolor{keywordflow}{for} (i = 0; i < x * y; ++i) \{}
\DoxyCodeLine{1876         \textcolor{keywordflow}{for} (k = 0; k < n; ++k) \{}
\DoxyCodeLine{1877             \textcolor{keywordtype}{float} z = (float)pow(data[i * comp + k] * stbi\_\_h2l\_scale\_i, stbi\_\_h2l\_gamma\_i) * 255 + 0.5f;}
\DoxyCodeLine{1878             \textcolor{keywordflow}{if} (z < 0) z = 0;}
\DoxyCodeLine{1879             \textcolor{keywordflow}{if} (z > 255) z = 255;}
\DoxyCodeLine{1880             output[i * comp + k] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})stbi\_\_float2int(z);}
\DoxyCodeLine{1881         \}}
\DoxyCodeLine{1882         \textcolor{keywordflow}{if} (k < comp) \{}
\DoxyCodeLine{1883             \textcolor{keywordtype}{float} z = data[i * comp + k] * 255 + 0.5f;}
\DoxyCodeLine{1884             \textcolor{keywordflow}{if} (z < 0) z = 0;}
\DoxyCodeLine{1885             \textcolor{keywordflow}{if} (z > 255) z = 255;}
\DoxyCodeLine{1886             output[i * comp + k] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})stbi\_\_float2int(z);}
\DoxyCodeLine{1887         \}}
\DoxyCodeLine{1888     \}}
\DoxyCodeLine{1889     STBI\_FREE(data);}
\DoxyCodeLine{1890     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{1891 \}}
\DoxyCodeLine{1892 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1893 }
\DoxyCodeLine{1895 \textcolor{comment}{//}}
\DoxyCodeLine{1896 \textcolor{comment}{//  "{}baseline"{} JPEG/JFIF decoder}}
\DoxyCodeLine{1897 \textcolor{comment}{//}}
\DoxyCodeLine{1898 \textcolor{comment}{//    simple implementation}}
\DoxyCodeLine{1899 \textcolor{comment}{//      -\/ doesn't support delayed output of y-\/dimension}}
\DoxyCodeLine{1900 \textcolor{comment}{//      -\/ simple interface (only one output format: 8-\/bit interleaved RGB)}}
\DoxyCodeLine{1901 \textcolor{comment}{//      -\/ doesn't try to recover corrupt jpegs}}
\DoxyCodeLine{1902 \textcolor{comment}{//      -\/ doesn't allow partial loading, loading multiple at once}}
\DoxyCodeLine{1903 \textcolor{comment}{//      -\/ still fast on x86 (copying globals into locals doesn't help x86)}}
\DoxyCodeLine{1904 \textcolor{comment}{//      -\/ allocates lots of intermediate memory (full size of all components)}}
\DoxyCodeLine{1905 \textcolor{comment}{//        -\/ non-\/interleaved case requires this anyway}}
\DoxyCodeLine{1906 \textcolor{comment}{//        -\/ allows good upsampling (see next)}}
\DoxyCodeLine{1907 \textcolor{comment}{//    high-\/quality}}
\DoxyCodeLine{1908 \textcolor{comment}{//      -\/ upsampled channels are bilinearly interpolated, even across blocks}}
\DoxyCodeLine{1909 \textcolor{comment}{//      -\/ quality integer IDCT derived from IJG's 'slow'}}
\DoxyCodeLine{1910 \textcolor{comment}{//    performance}}
\DoxyCodeLine{1911 \textcolor{comment}{//      -\/ fast huffman; reasonable integer IDCT}}
\DoxyCodeLine{1912 \textcolor{comment}{//      -\/ some SIMD kernels for common paths on targets with SSE2/NEON}}
\DoxyCodeLine{1913 \textcolor{comment}{//      -\/ uses a lot of intermediate memory, could cache poorly}}
\DoxyCodeLine{1914 }
\DoxyCodeLine{1915 \textcolor{preprocessor}{\#ifndef STBI\_NO\_JPEG}}
\DoxyCodeLine{1916 }
\DoxyCodeLine{1917 \textcolor{comment}{// huffman decoding acceleration}}
\DoxyCodeLine{1918 \textcolor{preprocessor}{\#define FAST\_BITS   9  }\textcolor{comment}{// larger handles more cases; smaller stomps less cache}}
\DoxyCodeLine{1919 }
\DoxyCodeLine{1920 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{1921 \{}
\DoxyCodeLine{1922     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}  fast[1 << FAST\_BITS];}
\DoxyCodeLine{1923     \textcolor{comment}{// weirdly, repacking this into AoS is a 10\% speed loss, instead of a win}}
\DoxyCodeLine{1924     stbi\_\_uint16 code[256];}
\DoxyCodeLine{1925     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}  values[256];}
\DoxyCodeLine{1926     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}  size[257];}
\DoxyCodeLine{1927     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} maxcode[18];}
\DoxyCodeLine{1928     \textcolor{keywordtype}{int}    delta[17];   \textcolor{comment}{// old 'firstsymbol' -\/ old 'firstcode'}}
\DoxyCodeLine{1929 \} stbi\_\_huffman;}
\DoxyCodeLine{1930 }
\DoxyCodeLine{1931 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{1932 \{}
\DoxyCodeLine{1933     stbi\_\_context* s;}
\DoxyCodeLine{1934     stbi\_\_huffman huff\_dc[4];}
\DoxyCodeLine{1935     stbi\_\_huffman huff\_ac[4];}
\DoxyCodeLine{1936     stbi\_\_uint16 dequant[4][64];}
\DoxyCodeLine{1937     stbi\_\_int16 fast\_ac[4][1 << FAST\_BITS];}
\DoxyCodeLine{1938 }
\DoxyCodeLine{1939     \textcolor{comment}{// sizes for components, interleaved MCUs}}
\DoxyCodeLine{1940     \textcolor{keywordtype}{int} img\_h\_max, img\_v\_max;}
\DoxyCodeLine{1941     \textcolor{keywordtype}{int} img\_mcu\_x, img\_mcu\_y;}
\DoxyCodeLine{1942     \textcolor{keywordtype}{int} img\_mcu\_w, img\_mcu\_h;}
\DoxyCodeLine{1943 }
\DoxyCodeLine{1944     \textcolor{comment}{// definition of jpeg image component}}
\DoxyCodeLine{1945     \textcolor{keyword}{struct}}
\DoxyCodeLine{1946     \{}
\DoxyCodeLine{1947         \textcolor{keywordtype}{int} id;}
\DoxyCodeLine{1948         \textcolor{keywordtype}{int} h, v;}
\DoxyCodeLine{1949         \textcolor{keywordtype}{int} tq;}
\DoxyCodeLine{1950         \textcolor{keywordtype}{int} hd, ha;}
\DoxyCodeLine{1951         \textcolor{keywordtype}{int} dc\_pred;}
\DoxyCodeLine{1952 }
\DoxyCodeLine{1953         \textcolor{keywordtype}{int} x, y, w2, h2;}
\DoxyCodeLine{1954         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* data;}
\DoxyCodeLine{1955         \textcolor{keywordtype}{void}* raw\_data, * raw\_coeff;}
\DoxyCodeLine{1956         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* linebuf;}
\DoxyCodeLine{1957         \textcolor{keywordtype}{short}* coeff;   \textcolor{comment}{// progressive only}}
\DoxyCodeLine{1958         \textcolor{keywordtype}{int}      coeff\_w, coeff\_h; \textcolor{comment}{// number of 8x8 coefficient blocks}}
\DoxyCodeLine{1959     \} img\_comp[4];}
\DoxyCodeLine{1960 }
\DoxyCodeLine{1961     stbi\_\_uint32   code\_buffer; \textcolor{comment}{// jpeg entropy-\/coded buffer}}
\DoxyCodeLine{1962     \textcolor{keywordtype}{int}            code\_bits;   \textcolor{comment}{// number of valid bits}}
\DoxyCodeLine{1963     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}  marker;      \textcolor{comment}{// marker seen while filling entropy buffer}}
\DoxyCodeLine{1964     \textcolor{keywordtype}{int}            nomore;      \textcolor{comment}{// flag if we saw a marker so must stop}}
\DoxyCodeLine{1965 }
\DoxyCodeLine{1966     \textcolor{keywordtype}{int}            progressive;}
\DoxyCodeLine{1967     \textcolor{keywordtype}{int}            spec\_start;}
\DoxyCodeLine{1968     \textcolor{keywordtype}{int}            spec\_end;}
\DoxyCodeLine{1969     \textcolor{keywordtype}{int}            succ\_high;}
\DoxyCodeLine{1970     \textcolor{keywordtype}{int}            succ\_low;}
\DoxyCodeLine{1971     \textcolor{keywordtype}{int}            eob\_run;}
\DoxyCodeLine{1972     \textcolor{keywordtype}{int}            jfif;}
\DoxyCodeLine{1973     \textcolor{keywordtype}{int}            app14\_color\_transform; \textcolor{comment}{// Adobe APP14 tag}}
\DoxyCodeLine{1974     \textcolor{keywordtype}{int}            rgb;}
\DoxyCodeLine{1975 }
\DoxyCodeLine{1976     \textcolor{keywordtype}{int} scan\_n, order[4];}
\DoxyCodeLine{1977     \textcolor{keywordtype}{int} restart\_interval, todo;}
\DoxyCodeLine{1978 }
\DoxyCodeLine{1979     \textcolor{comment}{// kernels}}
\DoxyCodeLine{1980     void (*idct\_block\_kernel)(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keywordtype}{int} out\_stride, \textcolor{keywordtype}{short} data[64]);}
\DoxyCodeLine{1981     void (*YCbCr\_to\_RGB\_kernel)(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* y, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* pcb, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* pcr, \textcolor{keywordtype}{int} count, \textcolor{keywordtype}{int} step);}
\DoxyCodeLine{1982     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* (*resample\_row\_hv\_2\_kernel)(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs);}
\DoxyCodeLine{1983 \} stbi\_\_jpeg;}
\DoxyCodeLine{1984 }
\DoxyCodeLine{1985 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_build\_huffman(stbi\_\_huffman* h, \textcolor{keywordtype}{int}* count)}
\DoxyCodeLine{1986 \{}
\DoxyCodeLine{1987     \textcolor{keywordtype}{int} i, j, k = 0;}
\DoxyCodeLine{1988     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} code;}
\DoxyCodeLine{1989     \textcolor{comment}{// build size list for each symbol (from JPEG spec)}}
\DoxyCodeLine{1990     \textcolor{keywordflow}{for} (i = 0; i < 16; ++i)}
\DoxyCodeLine{1991         \textcolor{keywordflow}{for} (j = 0; j < count[i]; ++j)}
\DoxyCodeLine{1992             h-\/>size[k++] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})(i + 1);}
\DoxyCodeLine{1993     h-\/>size[k] = 0;}
\DoxyCodeLine{1994 }
\DoxyCodeLine{1995     \textcolor{comment}{// compute actual symbols (from jpeg spec)}}
\DoxyCodeLine{1996     code = 0;}
\DoxyCodeLine{1997     k = 0;}
\DoxyCodeLine{1998     \textcolor{keywordflow}{for} (j = 1; j <= 16; ++j) \{}
\DoxyCodeLine{1999         \textcolor{comment}{// compute delta to add to code to compute symbol id}}
\DoxyCodeLine{2000         h-\/>delta[j] = k -\/ code;}
\DoxyCodeLine{2001         \textcolor{keywordflow}{if} (h-\/>size[k] == j) \{}
\DoxyCodeLine{2002             \textcolor{keywordflow}{while} (h-\/>size[k] == j)}
\DoxyCodeLine{2003                 h-\/>code[k++] = (stbi\_\_uint16)(code++);}
\DoxyCodeLine{2004             \textcolor{keywordflow}{if} (code -\/ 1 >= (1u << j)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad code lengths"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2005         \}}
\DoxyCodeLine{2006         \textcolor{comment}{// compute largest code + 1 for this size, preshifted as needed later}}
\DoxyCodeLine{2007         h-\/>maxcode[j] = code << (16 -\/ j);}
\DoxyCodeLine{2008         code <<= 1;}
\DoxyCodeLine{2009     \}}
\DoxyCodeLine{2010     h-\/>maxcode[j] = 0xffffffff;}
\DoxyCodeLine{2011 }
\DoxyCodeLine{2012     \textcolor{comment}{// build non-\/spec acceleration table; 255 is flag for not-\/accelerated}}
\DoxyCodeLine{2013     memset(h-\/>fast, 255, 1 << FAST\_BITS);}
\DoxyCodeLine{2014     \textcolor{keywordflow}{for} (i = 0; i < k; ++i) \{}
\DoxyCodeLine{2015         \textcolor{keywordtype}{int} s = h-\/>size[i];}
\DoxyCodeLine{2016         \textcolor{keywordflow}{if} (s <= FAST\_BITS) \{}
\DoxyCodeLine{2017             \textcolor{keywordtype}{int} c = h-\/>code[i] << (FAST\_BITS -\/ s);}
\DoxyCodeLine{2018             \textcolor{keywordtype}{int} m = 1 << (FAST\_BITS -\/ s);}
\DoxyCodeLine{2019             \textcolor{keywordflow}{for} (j = 0; j < m; ++j) \{}
\DoxyCodeLine{2020                 h-\/>fast[c + j] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})i;}
\DoxyCodeLine{2021             \}}
\DoxyCodeLine{2022         \}}
\DoxyCodeLine{2023     \}}
\DoxyCodeLine{2024     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2025 \}}
\DoxyCodeLine{2026 }
\DoxyCodeLine{2027 \textcolor{comment}{// build a table that decodes both magnitude and value of small ACs in}}
\DoxyCodeLine{2028 \textcolor{comment}{// one go.}}
\DoxyCodeLine{2029 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_build\_fast\_ac(stbi\_\_int16* fast\_ac, stbi\_\_huffman* h)}
\DoxyCodeLine{2030 \{}
\DoxyCodeLine{2031     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{2032     \textcolor{keywordflow}{for} (i = 0; i < (1 << FAST\_BITS); ++i) \{}
\DoxyCodeLine{2033         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} fast = h-\/>fast[i];}
\DoxyCodeLine{2034         fast\_ac[i] = 0;}
\DoxyCodeLine{2035         \textcolor{keywordflow}{if} (fast < 255) \{}
\DoxyCodeLine{2036             \textcolor{keywordtype}{int} rs = h-\/>values[fast];}
\DoxyCodeLine{2037             \textcolor{keywordtype}{int} run = (rs >> 4) \& 15;}
\DoxyCodeLine{2038             \textcolor{keywordtype}{int} magbits = rs \& 15;}
\DoxyCodeLine{2039             \textcolor{keywordtype}{int} len = h-\/>size[fast];}
\DoxyCodeLine{2040 }
\DoxyCodeLine{2041             \textcolor{keywordflow}{if} (magbits \&\& len + magbits <= FAST\_BITS) \{}
\DoxyCodeLine{2042                 \textcolor{comment}{// magnitude code followed by receive\_extend code}}
\DoxyCodeLine{2043                 \textcolor{keywordtype}{int} k = ((i << len) \& ((1 << FAST\_BITS) -\/ 1)) >> (FAST\_BITS -\/ magbits);}
\DoxyCodeLine{2044                 \textcolor{keywordtype}{int} m = 1 << (magbits -\/ 1);}
\DoxyCodeLine{2045                 \textcolor{keywordflow}{if} (k < m) k += (\string~0U << magbits) + 1;}
\DoxyCodeLine{2046                 \textcolor{comment}{// if the result is small enough, we can fit it in fast\_ac table}}
\DoxyCodeLine{2047                 \textcolor{keywordflow}{if} (k >= -\/128 \&\& k <= 127)}
\DoxyCodeLine{2048                     fast\_ac[i] = (stbi\_\_int16)((k * 256) + (run * 16) + (len + magbits));}
\DoxyCodeLine{2049             \}}
\DoxyCodeLine{2050         \}}
\DoxyCodeLine{2051     \}}
\DoxyCodeLine{2052 \}}
\DoxyCodeLine{2053 }
\DoxyCodeLine{2054 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_grow\_buffer\_unsafe(stbi\_\_jpeg* j)}
\DoxyCodeLine{2055 \{}
\DoxyCodeLine{2056     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{2057         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} b = j-\/>nomore ? 0 : stbi\_\_get8(j-\/>s);}
\DoxyCodeLine{2058         \textcolor{keywordflow}{if} (b == 0xff) \{}
\DoxyCodeLine{2059             \textcolor{keywordtype}{int} c = stbi\_\_get8(j-\/>s);}
\DoxyCodeLine{2060             \textcolor{keywordflow}{while} (c == 0xff) c = stbi\_\_get8(j-\/>s); \textcolor{comment}{// consume fill bytes}}
\DoxyCodeLine{2061             \textcolor{keywordflow}{if} (c != 0) \{}
\DoxyCodeLine{2062                 j-\/>marker = (\textcolor{keywordtype}{unsigned} char)c;}
\DoxyCodeLine{2063                 j-\/>nomore = 1;}
\DoxyCodeLine{2064                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2065             \}}
\DoxyCodeLine{2066         \}}
\DoxyCodeLine{2067         j-\/>code\_buffer |= b << (24 -\/ j-\/>code\_bits);}
\DoxyCodeLine{2068         j-\/>code\_bits += 8;}
\DoxyCodeLine{2069     \} \textcolor{keywordflow}{while} (j-\/>code\_bits <= 24);}
\DoxyCodeLine{2070 \}}
\DoxyCodeLine{2071 }
\DoxyCodeLine{2072 \textcolor{comment}{// (1 << n) -\/ 1}}
\DoxyCodeLine{2073 \textcolor{keyword}{static} \textcolor{keyword}{const} stbi\_\_uint32 stbi\_\_bmask[17] = \{ 0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535 \};}
\DoxyCodeLine{2074 }
\DoxyCodeLine{2075 \textcolor{comment}{// decode a jpeg huffman value from the bitstream}}
\DoxyCodeLine{2076 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_huff\_decode(stbi\_\_jpeg* j, stbi\_\_huffman* h)}
\DoxyCodeLine{2077 \{}
\DoxyCodeLine{2078     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} temp;}
\DoxyCodeLine{2079     \textcolor{keywordtype}{int} c, k;}
\DoxyCodeLine{2080 }
\DoxyCodeLine{2081     \textcolor{keywordflow}{if} (j-\/>code\_bits < 16) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2082 }
\DoxyCodeLine{2083     \textcolor{comment}{// look at the top FAST\_BITS and determine what symbol ID it is,}}
\DoxyCodeLine{2084     \textcolor{comment}{// if the code is <= FAST\_BITS}}
\DoxyCodeLine{2085     c = (j-\/>code\_buffer >> (32 -\/ FAST\_BITS)) \& ((1 << FAST\_BITS) -\/ 1);}
\DoxyCodeLine{2086     k = h-\/>fast[c];}
\DoxyCodeLine{2087     \textcolor{keywordflow}{if} (k < 255) \{}
\DoxyCodeLine{2088         \textcolor{keywordtype}{int} s = h-\/>size[k];}
\DoxyCodeLine{2089         \textcolor{keywordflow}{if} (s > j-\/>code\_bits)}
\DoxyCodeLine{2090             \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{2091         j-\/>code\_buffer <<= s;}
\DoxyCodeLine{2092         j-\/>code\_bits -\/= s;}
\DoxyCodeLine{2093         \textcolor{keywordflow}{return} h-\/>values[k];}
\DoxyCodeLine{2094     \}}
\DoxyCodeLine{2095 }
\DoxyCodeLine{2096     \textcolor{comment}{// naive test is to shift the code\_buffer down so k bits are}}
\DoxyCodeLine{2097     \textcolor{comment}{// valid, then test against maxcode. To speed this up, we've}}
\DoxyCodeLine{2098     \textcolor{comment}{// preshifted maxcode left so that it has (16-\/k) 0s at the}}
\DoxyCodeLine{2099     \textcolor{comment}{// end; in other words, regardless of the number of bits, it}}
\DoxyCodeLine{2100     \textcolor{comment}{// wants to be compared against something shifted to have 16;}}
\DoxyCodeLine{2101     \textcolor{comment}{// that way we don't need to shift inside the loop.}}
\DoxyCodeLine{2102     temp = j-\/>code\_buffer >> 16;}
\DoxyCodeLine{2103     \textcolor{keywordflow}{for} (k = FAST\_BITS + 1; ; ++k)}
\DoxyCodeLine{2104         \textcolor{keywordflow}{if} (temp < h-\/>maxcode[k])}
\DoxyCodeLine{2105             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2106     \textcolor{keywordflow}{if} (k == 17) \{}
\DoxyCodeLine{2107         \textcolor{comment}{// error! code not found}}
\DoxyCodeLine{2108         j-\/>code\_bits -\/= 16;}
\DoxyCodeLine{2109         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{2110     \}}
\DoxyCodeLine{2111 }
\DoxyCodeLine{2112     \textcolor{keywordflow}{if} (k > j-\/>code\_bits)}
\DoxyCodeLine{2113         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{2114 }
\DoxyCodeLine{2115     \textcolor{comment}{// convert the huffman code to the symbol id}}
\DoxyCodeLine{2116     c = ((j-\/>code\_buffer >> (32 -\/ k)) \& stbi\_\_bmask[k]) + h-\/>delta[k];}
\DoxyCodeLine{2117     STBI\_ASSERT((((j-\/>code\_buffer) >> (32 -\/ h-\/>size[c])) \& stbi\_\_bmask[h-\/>size[c]]) == h-\/>code[c]);}
\DoxyCodeLine{2118 }
\DoxyCodeLine{2119     \textcolor{comment}{// convert the id to a symbol}}
\DoxyCodeLine{2120     j-\/>code\_bits -\/= k;}
\DoxyCodeLine{2121     j-\/>code\_buffer <<= k;}
\DoxyCodeLine{2122     \textcolor{keywordflow}{return} h-\/>values[c];}
\DoxyCodeLine{2123 \}}
\DoxyCodeLine{2124 }
\DoxyCodeLine{2125 \textcolor{comment}{// bias[n] = (-\/1<<n) + 1}}
\DoxyCodeLine{2126 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} stbi\_\_jbias[16] = \{ 0,-\/1,-\/3,-\/7,-\/15,-\/31,-\/63,-\/127,-\/255,-\/511,-\/1023,-\/2047,-\/4095,-\/8191,-\/16383,-\/32767 \};}
\DoxyCodeLine{2127 }
\DoxyCodeLine{2128 \textcolor{comment}{// combined JPEG 'receive' and JPEG 'extend', since baseline}}
\DoxyCodeLine{2129 \textcolor{comment}{// always extends everything it receives.}}
\DoxyCodeLine{2130 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_extend\_receive(stbi\_\_jpeg* j, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{2131 \{}
\DoxyCodeLine{2132     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{2133     \textcolor{keywordtype}{int} sgn;}
\DoxyCodeLine{2134     \textcolor{keywordflow}{if} (j-\/>code\_bits < n) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2135 }
\DoxyCodeLine{2136     sgn = j-\/>code\_buffer >> 31; \textcolor{comment}{// sign bit always in MSB; 0 if MSB clear (positive), 1 if MSB set (negative)}}
\DoxyCodeLine{2137     k = stbi\_lrot(j-\/>code\_buffer, n);}
\DoxyCodeLine{2138     j-\/>code\_buffer = k \& \string~stbi\_\_bmask[n];}
\DoxyCodeLine{2139     k \&= stbi\_\_bmask[n];}
\DoxyCodeLine{2140     j-\/>code\_bits -\/= n;}
\DoxyCodeLine{2141     \textcolor{keywordflow}{return} k + (stbi\_\_jbias[n] \& (sgn -\/ 1));}
\DoxyCodeLine{2142 \}}
\DoxyCodeLine{2143 }
\DoxyCodeLine{2144 \textcolor{comment}{// get some unsigned bits}}
\DoxyCodeLine{2145 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_get\_bits(stbi\_\_jpeg* j, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{2146 \{}
\DoxyCodeLine{2147     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{2148     \textcolor{keywordflow}{if} (j-\/>code\_bits < n) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2149     k = stbi\_lrot(j-\/>code\_buffer, n);}
\DoxyCodeLine{2150     j-\/>code\_buffer = k \& \string~stbi\_\_bmask[n];}
\DoxyCodeLine{2151     k \&= stbi\_\_bmask[n];}
\DoxyCodeLine{2152     j-\/>code\_bits -\/= n;}
\DoxyCodeLine{2153     \textcolor{keywordflow}{return} k;}
\DoxyCodeLine{2154 \}}
\DoxyCodeLine{2155 }
\DoxyCodeLine{2156 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_get\_bit(stbi\_\_jpeg* j)}
\DoxyCodeLine{2157 \{}
\DoxyCodeLine{2158     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{2159     \textcolor{keywordflow}{if} (j-\/>code\_bits < 1) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2160     k = j-\/>code\_buffer;}
\DoxyCodeLine{2161     j-\/>code\_buffer <<= 1;}
\DoxyCodeLine{2162     -\/-\/j-\/>code\_bits;}
\DoxyCodeLine{2163     \textcolor{keywordflow}{return} k \& 0x80000000;}
\DoxyCodeLine{2164 \}}
\DoxyCodeLine{2165 }
\DoxyCodeLine{2166 \textcolor{comment}{// given a value that's at position X in the zigzag stream,}}
\DoxyCodeLine{2167 \textcolor{comment}{// where does it appear in the 8x8 matrix coded as row-\/major?}}
\DoxyCodeLine{2168 \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_jpeg\_dezigzag[64 + 15] =}
\DoxyCodeLine{2169 \{}
\DoxyCodeLine{2170     0,  1,  8, 16,  9,  2,  3, 10,}
\DoxyCodeLine{2171    17, 24, 32, 25, 18, 11,  4,  5,}
\DoxyCodeLine{2172    12, 19, 26, 33, 40, 48, 41, 34,}
\DoxyCodeLine{2173    27, 20, 13,  6,  7, 14, 21, 28,}
\DoxyCodeLine{2174    35, 42, 49, 56, 57, 50, 43, 36,}
\DoxyCodeLine{2175    29, 22, 15, 23, 30, 37, 44, 51,}
\DoxyCodeLine{2176    58, 59, 52, 45, 38, 31, 39, 46,}
\DoxyCodeLine{2177    53, 60, 61, 54, 47, 55, 62, 63,}
\DoxyCodeLine{2178    \textcolor{comment}{// let corrupt input sample past end}}
\DoxyCodeLine{2179    63, 63, 63, 63, 63, 63, 63, 63,}
\DoxyCodeLine{2180    63, 63, 63, 63, 63, 63, 63}
\DoxyCodeLine{2181 \};}
\DoxyCodeLine{2182 }
\DoxyCodeLine{2183 \textcolor{comment}{// decode one 64-\/entry block-\/-\/}}
\DoxyCodeLine{2184 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_decode\_block(stbi\_\_jpeg* j, \textcolor{keywordtype}{short} data[64], stbi\_\_huffman* hdc, stbi\_\_huffman* hac, stbi\_\_int16* fac, \textcolor{keywordtype}{int} b, stbi\_\_uint16* dequant)}
\DoxyCodeLine{2185 \{}
\DoxyCodeLine{2186     \textcolor{keywordtype}{int} diff, dc, k;}
\DoxyCodeLine{2187     \textcolor{keywordtype}{int} t;}
\DoxyCodeLine{2188 }
\DoxyCodeLine{2189     \textcolor{keywordflow}{if} (j-\/>code\_bits < 16) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2190     t = stbi\_\_jpeg\_huff\_decode(j, hdc);}
\DoxyCodeLine{2191     \textcolor{keywordflow}{if} (t < 0 || t > 15) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2192 }
\DoxyCodeLine{2193     \textcolor{comment}{// 0 all the ac values now so we can do it 32-\/bits at a time}}
\DoxyCodeLine{2194     memset(data, 0, 64 * \textcolor{keyword}{sizeof}(data[0]));}
\DoxyCodeLine{2195 }
\DoxyCodeLine{2196     diff = t ? stbi\_\_extend\_receive(j, t) : 0;}
\DoxyCodeLine{2197     dc = j-\/>img\_comp[b].dc\_pred + diff;}
\DoxyCodeLine{2198     j-\/>img\_comp[b].dc\_pred = dc;}
\DoxyCodeLine{2199     data[0] = (short)(dc * dequant[0]);}
\DoxyCodeLine{2200 }
\DoxyCodeLine{2201     \textcolor{comment}{// decode AC components, see JPEG spec}}
\DoxyCodeLine{2202     k = 1;}
\DoxyCodeLine{2203     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{2204         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} zig;}
\DoxyCodeLine{2205         \textcolor{keywordtype}{int} c, r, s;}
\DoxyCodeLine{2206         \textcolor{keywordflow}{if} (j-\/>code\_bits < 16) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2207         c = (j-\/>code\_buffer >> (32 -\/ FAST\_BITS)) \& ((1 << FAST\_BITS) -\/ 1);}
\DoxyCodeLine{2208         r = fac[c];}
\DoxyCodeLine{2209         \textcolor{keywordflow}{if} (r) \{ \textcolor{comment}{// fast-\/AC path}}
\DoxyCodeLine{2210             k += (r >> 4) \& 15; \textcolor{comment}{// run}}
\DoxyCodeLine{2211             s = r \& 15; \textcolor{comment}{// combined length}}
\DoxyCodeLine{2212             j-\/>code\_buffer <<= s;}
\DoxyCodeLine{2213             j-\/>code\_bits -\/= s;}
\DoxyCodeLine{2214             \textcolor{comment}{// decode into unzigzag'd location}}
\DoxyCodeLine{2215             zig = stbi\_\_jpeg\_dezigzag[k++];}
\DoxyCodeLine{2216             data[zig] = (short)((r >> 8) * dequant[zig]);}
\DoxyCodeLine{2217         \}}
\DoxyCodeLine{2218         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2219             \textcolor{keywordtype}{int} rs = stbi\_\_jpeg\_huff\_decode(j, hac);}
\DoxyCodeLine{2220             \textcolor{keywordflow}{if} (rs < 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2221             s = rs \& 15;}
\DoxyCodeLine{2222             r = rs >> 4;}
\DoxyCodeLine{2223             \textcolor{keywordflow}{if} (s == 0) \{}
\DoxyCodeLine{2224                 \textcolor{keywordflow}{if} (rs != 0xf0) \textcolor{keywordflow}{break}; \textcolor{comment}{// end block}}
\DoxyCodeLine{2225                 k += 16;}
\DoxyCodeLine{2226             \}}
\DoxyCodeLine{2227             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2228                 k += r;}
\DoxyCodeLine{2229                 \textcolor{comment}{// decode into unzigzag'd location}}
\DoxyCodeLine{2230                 zig = stbi\_\_jpeg\_dezigzag[k++];}
\DoxyCodeLine{2231                 data[zig] = (short)(stbi\_\_extend\_receive(j, s) * dequant[zig]);}
\DoxyCodeLine{2232             \}}
\DoxyCodeLine{2233         \}}
\DoxyCodeLine{2234     \} \textcolor{keywordflow}{while} (k < 64);}
\DoxyCodeLine{2235     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2236 \}}
\DoxyCodeLine{2237 }
\DoxyCodeLine{2238 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_decode\_block\_prog\_dc(stbi\_\_jpeg* j, \textcolor{keywordtype}{short} data[64], stbi\_\_huffman* hdc, \textcolor{keywordtype}{int} b)}
\DoxyCodeLine{2239 \{}
\DoxyCodeLine{2240     \textcolor{keywordtype}{int} diff, dc;}
\DoxyCodeLine{2241     \textcolor{keywordtype}{int} t;}
\DoxyCodeLine{2242     \textcolor{keywordflow}{if} (j-\/>spec\_end != 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}can't merge dc and ac"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2243 }
\DoxyCodeLine{2244     \textcolor{keywordflow}{if} (j-\/>code\_bits < 16) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2245 }
\DoxyCodeLine{2246     \textcolor{keywordflow}{if} (j-\/>succ\_high == 0) \{}
\DoxyCodeLine{2247         \textcolor{comment}{// first scan for DC coefficient, must be first}}
\DoxyCodeLine{2248         memset(data, 0, 64 * \textcolor{keyword}{sizeof}(data[0])); \textcolor{comment}{// 0 all the ac values now}}
\DoxyCodeLine{2249         t = stbi\_\_jpeg\_huff\_decode(j, hdc);}
\DoxyCodeLine{2250         \textcolor{keywordflow}{if} (t < 0 || t > 15) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}can't merge dc and ac"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2251         diff = t ? stbi\_\_extend\_receive(j, t) : 0;}
\DoxyCodeLine{2252 }
\DoxyCodeLine{2253         dc = j-\/>img\_comp[b].dc\_pred + diff;}
\DoxyCodeLine{2254         j-\/>img\_comp[b].dc\_pred = dc;}
\DoxyCodeLine{2255         data[0] = (short)(dc * (1 << j-\/>succ\_low));}
\DoxyCodeLine{2256     \}}
\DoxyCodeLine{2257     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2258         \textcolor{comment}{// refinement scan for DC coefficient}}
\DoxyCodeLine{2259         \textcolor{keywordflow}{if} (stbi\_\_jpeg\_get\_bit(j))}
\DoxyCodeLine{2260             data[0] += (\textcolor{keywordtype}{short})(1 << j-\/>succ\_low);}
\DoxyCodeLine{2261     \}}
\DoxyCodeLine{2262     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2263 \}}
\DoxyCodeLine{2264 }
\DoxyCodeLine{2265 \textcolor{comment}{// @OPTIMIZE: store non-\/zigzagged during the decode passes,}}
\DoxyCodeLine{2266 \textcolor{comment}{// and only de-\/zigzag when dequantizing}}
\DoxyCodeLine{2267 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_decode\_block\_prog\_ac(stbi\_\_jpeg* j, \textcolor{keywordtype}{short} data[64], stbi\_\_huffman* hac, stbi\_\_int16* fac)}
\DoxyCodeLine{2268 \{}
\DoxyCodeLine{2269     \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{2270     \textcolor{keywordflow}{if} (j-\/>spec\_start == 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}can't merge dc and ac"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2271 }
\DoxyCodeLine{2272     \textcolor{keywordflow}{if} (j-\/>succ\_high == 0) \{}
\DoxyCodeLine{2273         \textcolor{keywordtype}{int} shift = j-\/>succ\_low;}
\DoxyCodeLine{2274 }
\DoxyCodeLine{2275         \textcolor{keywordflow}{if} (j-\/>eob\_run) \{}
\DoxyCodeLine{2276             -\/-\/j-\/>eob\_run;}
\DoxyCodeLine{2277             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2278         \}}
\DoxyCodeLine{2279 }
\DoxyCodeLine{2280         k = j-\/>spec\_start;}
\DoxyCodeLine{2281         \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{2282             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} zig;}
\DoxyCodeLine{2283             \textcolor{keywordtype}{int} c, r, s;}
\DoxyCodeLine{2284             \textcolor{keywordflow}{if} (j-\/>code\_bits < 16) stbi\_\_grow\_buffer\_unsafe(j);}
\DoxyCodeLine{2285             c = (j-\/>code\_buffer >> (32 -\/ FAST\_BITS)) \& ((1 << FAST\_BITS) -\/ 1);}
\DoxyCodeLine{2286             r = fac[c];}
\DoxyCodeLine{2287             \textcolor{keywordflow}{if} (r) \{ \textcolor{comment}{// fast-\/AC path}}
\DoxyCodeLine{2288                 k += (r >> 4) \& 15; \textcolor{comment}{// run}}
\DoxyCodeLine{2289                 s = r \& 15; \textcolor{comment}{// combined length}}
\DoxyCodeLine{2290                 j-\/>code\_buffer <<= s;}
\DoxyCodeLine{2291                 j-\/>code\_bits -\/= s;}
\DoxyCodeLine{2292                 zig = stbi\_\_jpeg\_dezigzag[k++];}
\DoxyCodeLine{2293                 data[zig] = (short)((r >> 8) * (1 << shift));}
\DoxyCodeLine{2294             \}}
\DoxyCodeLine{2295             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2296                 \textcolor{keywordtype}{int} rs = stbi\_\_jpeg\_huff\_decode(j, hac);}
\DoxyCodeLine{2297                 \textcolor{keywordflow}{if} (rs < 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2298                 s = rs \& 15;}
\DoxyCodeLine{2299                 r = rs >> 4;}
\DoxyCodeLine{2300                 \textcolor{keywordflow}{if} (s == 0) \{}
\DoxyCodeLine{2301                     \textcolor{keywordflow}{if} (r < 15) \{}
\DoxyCodeLine{2302                         j-\/>eob\_run = (1 << r);}
\DoxyCodeLine{2303                         \textcolor{keywordflow}{if} (r)}
\DoxyCodeLine{2304                             j-\/>eob\_run += stbi\_\_jpeg\_get\_bits(j, r);}
\DoxyCodeLine{2305                         -\/-\/j-\/>eob\_run;}
\DoxyCodeLine{2306                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{2307                     \}}
\DoxyCodeLine{2308                     k += 16;}
\DoxyCodeLine{2309                 \}}
\DoxyCodeLine{2310                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2311                     k += r;}
\DoxyCodeLine{2312                     zig = stbi\_\_jpeg\_dezigzag[k++];}
\DoxyCodeLine{2313                     data[zig] = (short)(stbi\_\_extend\_receive(j, s) * (1 << shift));}
\DoxyCodeLine{2314                 \}}
\DoxyCodeLine{2315             \}}
\DoxyCodeLine{2316         \} \textcolor{keywordflow}{while} (k <= j-\/>spec\_end);}
\DoxyCodeLine{2317     \}}
\DoxyCodeLine{2318     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2319         \textcolor{comment}{// refinement scan for these AC coefficients}}
\DoxyCodeLine{2320 }
\DoxyCodeLine{2321         \textcolor{keywordtype}{short} bit = (short)(1 << j-\/>succ\_low);}
\DoxyCodeLine{2322 }
\DoxyCodeLine{2323         \textcolor{keywordflow}{if} (j-\/>eob\_run) \{}
\DoxyCodeLine{2324             -\/-\/j-\/>eob\_run;}
\DoxyCodeLine{2325             \textcolor{keywordflow}{for} (k = j-\/>spec\_start; k <= j-\/>spec\_end; ++k) \{}
\DoxyCodeLine{2326                 \textcolor{keywordtype}{short}* p = \&data[stbi\_\_jpeg\_dezigzag[k]];}
\DoxyCodeLine{2327                 \textcolor{keywordflow}{if} (*p != 0)}
\DoxyCodeLine{2328                     \textcolor{keywordflow}{if} (stbi\_\_jpeg\_get\_bit(j))}
\DoxyCodeLine{2329                         \textcolor{keywordflow}{if} ((*p \& bit) == 0) \{}
\DoxyCodeLine{2330                             \textcolor{keywordflow}{if} (*p > 0)}
\DoxyCodeLine{2331                                 *p += bit;}
\DoxyCodeLine{2332                             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2333                                 *p -\/= bit;}
\DoxyCodeLine{2334                         \}}
\DoxyCodeLine{2335             \}}
\DoxyCodeLine{2336         \}}
\DoxyCodeLine{2337         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2338             k = j-\/>spec\_start;}
\DoxyCodeLine{2339             \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{2340                 \textcolor{keywordtype}{int} r, s;}
\DoxyCodeLine{2341                 \textcolor{keywordtype}{int} rs = stbi\_\_jpeg\_huff\_decode(j, hac); \textcolor{comment}{// @OPTIMIZE see if we can use the fast path here, advance-\/by-\/r is so slow, eh}}
\DoxyCodeLine{2342                 \textcolor{keywordflow}{if} (rs < 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2343                 s = rs \& 15;}
\DoxyCodeLine{2344                 r = rs >> 4;}
\DoxyCodeLine{2345                 \textcolor{keywordflow}{if} (s == 0) \{}
\DoxyCodeLine{2346                     \textcolor{keywordflow}{if} (r < 15) \{}
\DoxyCodeLine{2347                         j-\/>eob\_run = (1 << r) -\/ 1;}
\DoxyCodeLine{2348                         \textcolor{keywordflow}{if} (r)}
\DoxyCodeLine{2349                             j-\/>eob\_run += stbi\_\_jpeg\_get\_bits(j, r);}
\DoxyCodeLine{2350                         r = 64; \textcolor{comment}{// force end of block}}
\DoxyCodeLine{2351                     \}}
\DoxyCodeLine{2352                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2353                         \textcolor{comment}{// r=15 s=0 should write 16 0s, so we just do}}
\DoxyCodeLine{2354                         \textcolor{comment}{// a run of 15 0s and then write s (which is 0),}}
\DoxyCodeLine{2355                         \textcolor{comment}{// so we don't have to do anything special here}}
\DoxyCodeLine{2356                     \}}
\DoxyCodeLine{2357                 \}}
\DoxyCodeLine{2358                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2359                     \textcolor{keywordflow}{if} (s != 1) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{2360                     \textcolor{comment}{// sign bit}}
\DoxyCodeLine{2361                     \textcolor{keywordflow}{if} (stbi\_\_jpeg\_get\_bit(j))}
\DoxyCodeLine{2362                         s = bit;}
\DoxyCodeLine{2363                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2364                         s = -\/bit;}
\DoxyCodeLine{2365                 \}}
\DoxyCodeLine{2366 }
\DoxyCodeLine{2367                 \textcolor{comment}{// advance by r}}
\DoxyCodeLine{2368                 \textcolor{keywordflow}{while} (k <= j-\/>spec\_end) \{}
\DoxyCodeLine{2369                     \textcolor{keywordtype}{short}* p = \&data[stbi\_\_jpeg\_dezigzag[k++]];}
\DoxyCodeLine{2370                     \textcolor{keywordflow}{if} (*p != 0) \{}
\DoxyCodeLine{2371                         \textcolor{keywordflow}{if} (stbi\_\_jpeg\_get\_bit(j))}
\DoxyCodeLine{2372                             \textcolor{keywordflow}{if} ((*p \& bit) == 0) \{}
\DoxyCodeLine{2373                                 \textcolor{keywordflow}{if} (*p > 0)}
\DoxyCodeLine{2374                                     *p += bit;}
\DoxyCodeLine{2375                                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{2376                                     *p -\/= bit;}
\DoxyCodeLine{2377                             \}}
\DoxyCodeLine{2378                     \}}
\DoxyCodeLine{2379                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2380                         \textcolor{keywordflow}{if} (r == 0) \{}
\DoxyCodeLine{2381                             *p = (short)s;}
\DoxyCodeLine{2382                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2383                         \}}
\DoxyCodeLine{2384                         -\/-\/r;}
\DoxyCodeLine{2385                     \}}
\DoxyCodeLine{2386                 \}}
\DoxyCodeLine{2387             \} \textcolor{keywordflow}{while} (k <= j-\/>spec\_end);}
\DoxyCodeLine{2388         \}}
\DoxyCodeLine{2389     \}}
\DoxyCodeLine{2390     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2391 \}}
\DoxyCodeLine{2392 }
\DoxyCodeLine{2393 \textcolor{comment}{// take a -\/128..127 value and stbi\_\_clamp it and convert to 0..255}}
\DoxyCodeLine{2394 stbi\_inline \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_clamp(\textcolor{keywordtype}{int} x)}
\DoxyCodeLine{2395 \{}
\DoxyCodeLine{2396     \textcolor{comment}{// trick to use a single test to catch both cases}}
\DoxyCodeLine{2397     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})x > 255) \{}
\DoxyCodeLine{2398         \textcolor{keywordflow}{if} (x < 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2399         \textcolor{keywordflow}{if} (x > 255) \textcolor{keywordflow}{return} 255;}
\DoxyCodeLine{2400     \}}
\DoxyCodeLine{2401     \textcolor{keywordflow}{return} (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})x;}
\DoxyCodeLine{2402 \}}
\DoxyCodeLine{2403 }
\DoxyCodeLine{2404 \textcolor{preprocessor}{\#define stbi\_\_f2f(x)  ((int) (((x) * 4096 + 0.5)))}}
\DoxyCodeLine{2405 \textcolor{preprocessor}{\#define stbi\_\_fsh(x)  ((x) * 4096)}}
\DoxyCodeLine{2406 }
\DoxyCodeLine{2407 \textcolor{comment}{// derived from jidctint -\/-\/ DCT\_ISLOW}}
\DoxyCodeLine{2408 \textcolor{preprocessor}{\#define STBI\_\_IDCT\_1D(s0,s1,s2,s3,s4,s5,s6,s7) \(\backslash\)}}
\DoxyCodeLine{2409 \textcolor{preprocessor}{   int t0,t1,t2,t3,p1,p2,p3,p4,p5,x0,x1,x2,x3; \(\backslash\)}}
\DoxyCodeLine{2410 \textcolor{preprocessor}{   p2 = s2;                                    \(\backslash\)}}
\DoxyCodeLine{2411 \textcolor{preprocessor}{   p3 = s6;                                    \(\backslash\)}}
\DoxyCodeLine{2412 \textcolor{preprocessor}{   p1 = (p2+p3) * stbi\_\_f2f(0.5411961f);       \(\backslash\)}}
\DoxyCodeLine{2413 \textcolor{preprocessor}{   t2 = p1 + p3*stbi\_\_f2f(-\/1.847759065f);      \(\backslash\)}}
\DoxyCodeLine{2414 \textcolor{preprocessor}{   t3 = p1 + p2*stbi\_\_f2f( 0.765366865f);      \(\backslash\)}}
\DoxyCodeLine{2415 \textcolor{preprocessor}{   p2 = s0;                                    \(\backslash\)}}
\DoxyCodeLine{2416 \textcolor{preprocessor}{   p3 = s4;                                    \(\backslash\)}}
\DoxyCodeLine{2417 \textcolor{preprocessor}{   t0 = stbi\_\_fsh(p2+p3);                      \(\backslash\)}}
\DoxyCodeLine{2418 \textcolor{preprocessor}{   t1 = stbi\_\_fsh(p2-\/p3);                      \(\backslash\)}}
\DoxyCodeLine{2419 \textcolor{preprocessor}{   x0 = t0+t3;                                 \(\backslash\)}}
\DoxyCodeLine{2420 \textcolor{preprocessor}{   x3 = t0-\/t3;                                 \(\backslash\)}}
\DoxyCodeLine{2421 \textcolor{preprocessor}{   x1 = t1+t2;                                 \(\backslash\)}}
\DoxyCodeLine{2422 \textcolor{preprocessor}{   x2 = t1-\/t2;                                 \(\backslash\)}}
\DoxyCodeLine{2423 \textcolor{preprocessor}{   t0 = s7;                                    \(\backslash\)}}
\DoxyCodeLine{2424 \textcolor{preprocessor}{   t1 = s5;                                    \(\backslash\)}}
\DoxyCodeLine{2425 \textcolor{preprocessor}{   t2 = s3;                                    \(\backslash\)}}
\DoxyCodeLine{2426 \textcolor{preprocessor}{   t3 = s1;                                    \(\backslash\)}}
\DoxyCodeLine{2427 \textcolor{preprocessor}{   p3 = t0+t2;                                 \(\backslash\)}}
\DoxyCodeLine{2428 \textcolor{preprocessor}{   p4 = t1+t3;                                 \(\backslash\)}}
\DoxyCodeLine{2429 \textcolor{preprocessor}{   p1 = t0+t3;                                 \(\backslash\)}}
\DoxyCodeLine{2430 \textcolor{preprocessor}{   p2 = t1+t2;                                 \(\backslash\)}}
\DoxyCodeLine{2431 \textcolor{preprocessor}{   p5 = (p3+p4)*stbi\_\_f2f( 1.175875602f);      \(\backslash\)}}
\DoxyCodeLine{2432 \textcolor{preprocessor}{   t0 = t0*stbi\_\_f2f( 0.298631336f);           \(\backslash\)}}
\DoxyCodeLine{2433 \textcolor{preprocessor}{   t1 = t1*stbi\_\_f2f( 2.053119869f);           \(\backslash\)}}
\DoxyCodeLine{2434 \textcolor{preprocessor}{   t2 = t2*stbi\_\_f2f( 3.072711026f);           \(\backslash\)}}
\DoxyCodeLine{2435 \textcolor{preprocessor}{   t3 = t3*stbi\_\_f2f( 1.501321110f);           \(\backslash\)}}
\DoxyCodeLine{2436 \textcolor{preprocessor}{   p1 = p5 + p1*stbi\_\_f2f(-\/0.899976223f);      \(\backslash\)}}
\DoxyCodeLine{2437 \textcolor{preprocessor}{   p2 = p5 + p2*stbi\_\_f2f(-\/2.562915447f);      \(\backslash\)}}
\DoxyCodeLine{2438 \textcolor{preprocessor}{   p3 = p3*stbi\_\_f2f(-\/1.961570560f);           \(\backslash\)}}
\DoxyCodeLine{2439 \textcolor{preprocessor}{   p4 = p4*stbi\_\_f2f(-\/0.390180644f);           \(\backslash\)}}
\DoxyCodeLine{2440 \textcolor{preprocessor}{   t3 += p1+p4;                                \(\backslash\)}}
\DoxyCodeLine{2441 \textcolor{preprocessor}{   t2 += p2+p3;                                \(\backslash\)}}
\DoxyCodeLine{2442 \textcolor{preprocessor}{   t1 += p2+p4;                                \(\backslash\)}}
\DoxyCodeLine{2443 \textcolor{preprocessor}{   t0 += p1+p3;}}
\DoxyCodeLine{2444 }
\DoxyCodeLine{2445 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_idct\_block(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keywordtype}{int} out\_stride, \textcolor{keywordtype}{short} data[64])}
\DoxyCodeLine{2446 \{}
\DoxyCodeLine{2447     \textcolor{keywordtype}{int} i, val[64], * v = val;}
\DoxyCodeLine{2448     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* o;}
\DoxyCodeLine{2449     \textcolor{keywordtype}{short}* d = data;}
\DoxyCodeLine{2450 }
\DoxyCodeLine{2451     \textcolor{comment}{// columns}}
\DoxyCodeLine{2452     \textcolor{keywordflow}{for} (i = 0; i < 8; ++i, ++d, ++v) \{}
\DoxyCodeLine{2453         \textcolor{comment}{// if all zeroes, shortcut -\/-\/ this avoids dequantizing 0s and IDCTing}}
\DoxyCodeLine{2454         \textcolor{keywordflow}{if} (d[8] == 0 \&\& d[16] == 0 \&\& d[24] == 0 \&\& d[32] == 0}
\DoxyCodeLine{2455             \&\& d[40] == 0 \&\& d[48] == 0 \&\& d[56] == 0) \{}
\DoxyCodeLine{2456             \textcolor{comment}{//    no shortcut                 0     seconds}}
\DoxyCodeLine{2457             \textcolor{comment}{//    (1|2|3|4|5|6|7)==0          0     seconds}}
\DoxyCodeLine{2458             \textcolor{comment}{//    all separate               -\/0.047 seconds}}
\DoxyCodeLine{2459             \textcolor{comment}{//    1 \&\& 2|3 \&\& 4|5 \&\& 6|7:    -\/0.047 seconds}}
\DoxyCodeLine{2460             \textcolor{keywordtype}{int} dcterm = d[0] * 4;}
\DoxyCodeLine{2461             v[0] = v[8] = v[16] = v[24] = v[32] = v[40] = v[48] = v[56] = dcterm;}
\DoxyCodeLine{2462         \}}
\DoxyCodeLine{2463         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2464             STBI\_\_IDCT\_1D(d[0], d[8], d[16], d[24], d[32], d[40], d[48], d[56])}
\DoxyCodeLine{2465                 \textcolor{comment}{// constants scaled things up by 1<<12; let's bring them back}}
\DoxyCodeLine{2466                 \textcolor{comment}{// down, but keep 2 extra bits of precision}}
\DoxyCodeLine{2467                 x0 += 512; x1 += 512; x2 += 512; x3 += 512;}
\DoxyCodeLine{2468             v[0] = (x0 + t3) >> 10;}
\DoxyCodeLine{2469             v[56] = (x0 -\/ t3) >> 10;}
\DoxyCodeLine{2470             v[8] = (x1 + t2) >> 10;}
\DoxyCodeLine{2471             v[48] = (x1 -\/ t2) >> 10;}
\DoxyCodeLine{2472             v[16] = (x2 + t1) >> 10;}
\DoxyCodeLine{2473             v[40] = (x2 -\/ t1) >> 10;}
\DoxyCodeLine{2474             v[24] = (x3 + t0) >> 10;}
\DoxyCodeLine{2475             v[32] = (x3 -\/ t0) >> 10;}
\DoxyCodeLine{2476         \}}
\DoxyCodeLine{2477     \}}
\DoxyCodeLine{2478 }
\DoxyCodeLine{2479     \textcolor{keywordflow}{for} (i = 0, v = val, o = out; i < 8; ++i, v += 8, o += out\_stride) \{}
\DoxyCodeLine{2480         \textcolor{comment}{// no fast case since the first 1D IDCT spread components out}}
\DoxyCodeLine{2481         STBI\_\_IDCT\_1D(v[0], v[1], v[2], v[3], v[4], v[5], v[6], v[7])}
\DoxyCodeLine{2482             \textcolor{comment}{// constants scaled things up by 1<<12, plus we had 1<<2 from first}}
\DoxyCodeLine{2483             \textcolor{comment}{// loop, plus horizontal and vertical each scale by sqrt(8) so together}}
\DoxyCodeLine{2484             \textcolor{comment}{// we've got an extra 1<<3, so 1<<17 total we need to remove.}}
\DoxyCodeLine{2485             \textcolor{comment}{// so we want to round that, which means adding 0.5 * 1<<17,}}
\DoxyCodeLine{2486             \textcolor{comment}{// aka 65536. Also, we'll end up with -\/128 to 127 that we want}}
\DoxyCodeLine{2487             \textcolor{comment}{// to encode as 0..255 by adding 128, so we'll add that before the shift}}
\DoxyCodeLine{2488             x0 += 65536 + (128 << 17);}
\DoxyCodeLine{2489         x1 += 65536 + (128 << 17);}
\DoxyCodeLine{2490         x2 += 65536 + (128 << 17);}
\DoxyCodeLine{2491         x3 += 65536 + (128 << 17);}
\DoxyCodeLine{2492         \textcolor{comment}{// tried computing the shifts into temps, or'ing the temps to see}}
\DoxyCodeLine{2493         \textcolor{comment}{// if any were out of range, but that was slower}}
\DoxyCodeLine{2494         o[0] = stbi\_\_clamp((x0 + t3) >> 17);}
\DoxyCodeLine{2495         o[7] = stbi\_\_clamp((x0 -\/ t3) >> 17);}
\DoxyCodeLine{2496         o[1] = stbi\_\_clamp((x1 + t2) >> 17);}
\DoxyCodeLine{2497         o[6] = stbi\_\_clamp((x1 -\/ t2) >> 17);}
\DoxyCodeLine{2498         o[2] = stbi\_\_clamp((x2 + t1) >> 17);}
\DoxyCodeLine{2499         o[5] = stbi\_\_clamp((x2 -\/ t1) >> 17);}
\DoxyCodeLine{2500         o[3] = stbi\_\_clamp((x3 + t0) >> 17);}
\DoxyCodeLine{2501         o[4] = stbi\_\_clamp((x3 -\/ t0) >> 17);}
\DoxyCodeLine{2502     \}}
\DoxyCodeLine{2503 \}}
\DoxyCodeLine{2504 }
\DoxyCodeLine{2505 \textcolor{preprocessor}{\#ifdef STBI\_SSE2}}
\DoxyCodeLine{2506 \textcolor{comment}{// sse2 integer IDCT. not the fastest possible implementation but it}}
\DoxyCodeLine{2507 \textcolor{comment}{// produces bit-\/identical results to the generic C version so it's}}
\DoxyCodeLine{2508 \textcolor{comment}{// fully "{}transparent"{}.}}
\DoxyCodeLine{2509 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_idct\_simd(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keywordtype}{int} out\_stride, \textcolor{keywordtype}{short} data[64])}
\DoxyCodeLine{2510 \{}
\DoxyCodeLine{2511     \textcolor{comment}{// This is constructed to match our regular (generic) integer IDCT exactly.}}
\DoxyCodeLine{2512     \_\_m128i row0, row1, row2, row3, row4, row5, row6, row7;}
\DoxyCodeLine{2513     \_\_m128i tmp;}
\DoxyCodeLine{2514 }
\DoxyCodeLine{2515     \textcolor{comment}{// dot product constant: even elems=x, odd elems=y}}
\DoxyCodeLine{2516 \textcolor{preprocessor}{\#define dct\_const(x,y)  \_mm\_setr\_epi16((x),(y),(x),(y),(x),(y),(x),(y))}}
\DoxyCodeLine{2517 }
\DoxyCodeLine{2518 \textcolor{comment}{// out(0) = c0[even]*x + c0[odd]*y   (c0, x, y 16-\/bit, out 32-\/bit)}}
\DoxyCodeLine{2519 \textcolor{comment}{// out(1) = c1[even]*x + c1[odd]*y}}
\DoxyCodeLine{2520 \textcolor{preprocessor}{\#define dct\_rot(out0,out1, x,y,c0,c1) \(\backslash\)}}
\DoxyCodeLine{2521 \textcolor{preprocessor}{      \_\_m128i c0\#\#lo = \_mm\_unpacklo\_epi16((x),(y)); \(\backslash\)}}
\DoxyCodeLine{2522 \textcolor{preprocessor}{      \_\_m128i c0\#\#hi = \_mm\_unpackhi\_epi16((x),(y)); \(\backslash\)}}
\DoxyCodeLine{2523 \textcolor{preprocessor}{      \_\_m128i out0\#\#\_l = \_mm\_madd\_epi16(c0\#\#lo, c0); \(\backslash\)}}
\DoxyCodeLine{2524 \textcolor{preprocessor}{      \_\_m128i out0\#\#\_h = \_mm\_madd\_epi16(c0\#\#hi, c0); \(\backslash\)}}
\DoxyCodeLine{2525 \textcolor{preprocessor}{      \_\_m128i out1\#\#\_l = \_mm\_madd\_epi16(c0\#\#lo, c1); \(\backslash\)}}
\DoxyCodeLine{2526 \textcolor{preprocessor}{      \_\_m128i out1\#\#\_h = \_mm\_madd\_epi16(c0\#\#hi, c1)}}
\DoxyCodeLine{2527 }
\DoxyCodeLine{2528    \textcolor{comment}{// out = in << 12  (in 16-\/bit, out 32-\/bit)}}
\DoxyCodeLine{2529 \textcolor{preprocessor}{\#define dct\_widen(out, in) \(\backslash\)}}
\DoxyCodeLine{2530 \textcolor{preprocessor}{      \_\_m128i out\#\#\_l = \_mm\_srai\_epi32(\_mm\_unpacklo\_epi16(\_mm\_setzero\_si128(), (in)), 4); \(\backslash\)}}
\DoxyCodeLine{2531 \textcolor{preprocessor}{      \_\_m128i out\#\#\_h = \_mm\_srai\_epi32(\_mm\_unpackhi\_epi16(\_mm\_setzero\_si128(), (in)), 4)}}
\DoxyCodeLine{2532 }
\DoxyCodeLine{2533    \textcolor{comment}{// wide add}}
\DoxyCodeLine{2534 \textcolor{preprocessor}{\#define dct\_wadd(out, a, b) \(\backslash\)}}
\DoxyCodeLine{2535 \textcolor{preprocessor}{      \_\_m128i out\#\#\_l = \_mm\_add\_epi32(a\#\#\_l, b\#\#\_l); \(\backslash\)}}
\DoxyCodeLine{2536 \textcolor{preprocessor}{      \_\_m128i out\#\#\_h = \_mm\_add\_epi32(a\#\#\_h, b\#\#\_h)}}
\DoxyCodeLine{2537 }
\DoxyCodeLine{2538    \textcolor{comment}{// wide sub}}
\DoxyCodeLine{2539 \textcolor{preprocessor}{\#define dct\_wsub(out, a, b) \(\backslash\)}}
\DoxyCodeLine{2540 \textcolor{preprocessor}{      \_\_m128i out\#\#\_l = \_mm\_sub\_epi32(a\#\#\_l, b\#\#\_l); \(\backslash\)}}
\DoxyCodeLine{2541 \textcolor{preprocessor}{      \_\_m128i out\#\#\_h = \_mm\_sub\_epi32(a\#\#\_h, b\#\#\_h)}}
\DoxyCodeLine{2542 }
\DoxyCodeLine{2543    \textcolor{comment}{// butterfly a/b, add bias, then shift by "{}s"{} and pack}}
\DoxyCodeLine{2544 \textcolor{preprocessor}{\#define dct\_bfly32o(out0, out1, a,b,bias,s) \(\backslash\)}}
\DoxyCodeLine{2545 \textcolor{preprocessor}{      \{ \(\backslash\)}}
\DoxyCodeLine{2546 \textcolor{preprocessor}{         \_\_m128i abiased\_l = \_mm\_add\_epi32(a\#\#\_l, bias); \(\backslash\)}}
\DoxyCodeLine{2547 \textcolor{preprocessor}{         \_\_m128i abiased\_h = \_mm\_add\_epi32(a\#\#\_h, bias); \(\backslash\)}}
\DoxyCodeLine{2548 \textcolor{preprocessor}{         dct\_wadd(sum, abiased, b); \(\backslash\)}}
\DoxyCodeLine{2549 \textcolor{preprocessor}{         dct\_wsub(dif, abiased, b); \(\backslash\)}}
\DoxyCodeLine{2550 \textcolor{preprocessor}{         out0 = \_mm\_packs\_epi32(\_mm\_srai\_epi32(sum\_l, s), \_mm\_srai\_epi32(sum\_h, s)); \(\backslash\)}}
\DoxyCodeLine{2551 \textcolor{preprocessor}{         out1 = \_mm\_packs\_epi32(\_mm\_srai\_epi32(dif\_l, s), \_mm\_srai\_epi32(dif\_h, s)); \(\backslash\)}}
\DoxyCodeLine{2552 \textcolor{preprocessor}{      \}}}
\DoxyCodeLine{2553 }
\DoxyCodeLine{2554    \textcolor{comment}{// 8-\/bit interleave step (for transposes)}}
\DoxyCodeLine{2555 \textcolor{preprocessor}{\#define dct\_interleave8(a, b) \(\backslash\)}}
\DoxyCodeLine{2556 \textcolor{preprocessor}{      tmp = a; \(\backslash\)}}
\DoxyCodeLine{2557 \textcolor{preprocessor}{      a = \_mm\_unpacklo\_epi8(a, b); \(\backslash\)}}
\DoxyCodeLine{2558 \textcolor{preprocessor}{      b = \_mm\_unpackhi\_epi8(tmp, b)}}
\DoxyCodeLine{2559 }
\DoxyCodeLine{2560    \textcolor{comment}{// 16-\/bit interleave step (for transposes)}}
\DoxyCodeLine{2561 \textcolor{preprocessor}{\#define dct\_interleave16(a, b) \(\backslash\)}}
\DoxyCodeLine{2562 \textcolor{preprocessor}{      tmp = a; \(\backslash\)}}
\DoxyCodeLine{2563 \textcolor{preprocessor}{      a = \_mm\_unpacklo\_epi16(a, b); \(\backslash\)}}
\DoxyCodeLine{2564 \textcolor{preprocessor}{      b = \_mm\_unpackhi\_epi16(tmp, b)}}
\DoxyCodeLine{2565 }
\DoxyCodeLine{2566 \textcolor{preprocessor}{\#define dct\_pass(bias,shift) \(\backslash\)}}
\DoxyCodeLine{2567 \textcolor{preprocessor}{      \{ \(\backslash\)}}
\DoxyCodeLine{2568 \textcolor{preprocessor}{         }\textcolor{comment}{/* even part */}\textcolor{preprocessor}{ \(\backslash\)}}
\DoxyCodeLine{2569 \textcolor{preprocessor}{         dct\_rot(t2e,t3e, row2,row6, rot0\_0,rot0\_1); \(\backslash\)}}
\DoxyCodeLine{2570 \textcolor{preprocessor}{         \_\_m128i sum04 = \_mm\_add\_epi16(row0, row4); \(\backslash\)}}
\DoxyCodeLine{2571 \textcolor{preprocessor}{         \_\_m128i dif04 = \_mm\_sub\_epi16(row0, row4); \(\backslash\)}}
\DoxyCodeLine{2572 \textcolor{preprocessor}{         dct\_widen(t0e, sum04); \(\backslash\)}}
\DoxyCodeLine{2573 \textcolor{preprocessor}{         dct\_widen(t1e, dif04); \(\backslash\)}}
\DoxyCodeLine{2574 \textcolor{preprocessor}{         dct\_wadd(x0, t0e, t3e); \(\backslash\)}}
\DoxyCodeLine{2575 \textcolor{preprocessor}{         dct\_wsub(x3, t0e, t3e); \(\backslash\)}}
\DoxyCodeLine{2576 \textcolor{preprocessor}{         dct\_wadd(x1, t1e, t2e); \(\backslash\)}}
\DoxyCodeLine{2577 \textcolor{preprocessor}{         dct\_wsub(x2, t1e, t2e); \(\backslash\)}}
\DoxyCodeLine{2578 \textcolor{preprocessor}{         }\textcolor{comment}{/* odd part */}\textcolor{preprocessor}{ \(\backslash\)}}
\DoxyCodeLine{2579 \textcolor{preprocessor}{         dct\_rot(y0o,y2o, row7,row3, rot2\_0,rot2\_1); \(\backslash\)}}
\DoxyCodeLine{2580 \textcolor{preprocessor}{         dct\_rot(y1o,y3o, row5,row1, rot3\_0,rot3\_1); \(\backslash\)}}
\DoxyCodeLine{2581 \textcolor{preprocessor}{         \_\_m128i sum17 = \_mm\_add\_epi16(row1, row7); \(\backslash\)}}
\DoxyCodeLine{2582 \textcolor{preprocessor}{         \_\_m128i sum35 = \_mm\_add\_epi16(row3, row5); \(\backslash\)}}
\DoxyCodeLine{2583 \textcolor{preprocessor}{         dct\_rot(y4o,y5o, sum17,sum35, rot1\_0,rot1\_1); \(\backslash\)}}
\DoxyCodeLine{2584 \textcolor{preprocessor}{         dct\_wadd(x4, y0o, y4o); \(\backslash\)}}
\DoxyCodeLine{2585 \textcolor{preprocessor}{         dct\_wadd(x5, y1o, y5o); \(\backslash\)}}
\DoxyCodeLine{2586 \textcolor{preprocessor}{         dct\_wadd(x6, y2o, y5o); \(\backslash\)}}
\DoxyCodeLine{2587 \textcolor{preprocessor}{         dct\_wadd(x7, y3o, y4o); \(\backslash\)}}
\DoxyCodeLine{2588 \textcolor{preprocessor}{         dct\_bfly32o(row0,row7, x0,x7,bias,shift); \(\backslash\)}}
\DoxyCodeLine{2589 \textcolor{preprocessor}{         dct\_bfly32o(row1,row6, x1,x6,bias,shift); \(\backslash\)}}
\DoxyCodeLine{2590 \textcolor{preprocessor}{         dct\_bfly32o(row2,row5, x2,x5,bias,shift); \(\backslash\)}}
\DoxyCodeLine{2591 \textcolor{preprocessor}{         dct\_bfly32o(row3,row4, x3,x4,bias,shift); \(\backslash\)}}
\DoxyCodeLine{2592 \textcolor{preprocessor}{      \}}}
\DoxyCodeLine{2593 }
\DoxyCodeLine{2594     \_\_m128i rot0\_0 = dct\_const(stbi\_\_f2f(0.5411961f), stbi\_\_f2f(0.5411961f) + stbi\_\_f2f(-\/1.847759065f));}
\DoxyCodeLine{2595     \_\_m128i rot0\_1 = dct\_const(stbi\_\_f2f(0.5411961f) + stbi\_\_f2f(0.765366865f), stbi\_\_f2f(0.5411961f));}
\DoxyCodeLine{2596     \_\_m128i rot1\_0 = dct\_const(stbi\_\_f2f(1.175875602f) + stbi\_\_f2f(-\/0.899976223f), stbi\_\_f2f(1.175875602f));}
\DoxyCodeLine{2597     \_\_m128i rot1\_1 = dct\_const(stbi\_\_f2f(1.175875602f), stbi\_\_f2f(1.175875602f) + stbi\_\_f2f(-\/2.562915447f));}
\DoxyCodeLine{2598     \_\_m128i rot2\_0 = dct\_const(stbi\_\_f2f(-\/1.961570560f) + stbi\_\_f2f(0.298631336f), stbi\_\_f2f(-\/1.961570560f));}
\DoxyCodeLine{2599     \_\_m128i rot2\_1 = dct\_const(stbi\_\_f2f(-\/1.961570560f), stbi\_\_f2f(-\/1.961570560f) + stbi\_\_f2f(3.072711026f));}
\DoxyCodeLine{2600     \_\_m128i rot3\_0 = dct\_const(stbi\_\_f2f(-\/0.390180644f) + stbi\_\_f2f(2.053119869f), stbi\_\_f2f(-\/0.390180644f));}
\DoxyCodeLine{2601     \_\_m128i rot3\_1 = dct\_const(stbi\_\_f2f(-\/0.390180644f), stbi\_\_f2f(-\/0.390180644f) + stbi\_\_f2f(1.501321110f));}
\DoxyCodeLine{2602 }
\DoxyCodeLine{2603     \textcolor{comment}{// rounding biases in column/row passes, see stbi\_\_idct\_block for explanation.}}
\DoxyCodeLine{2604     \_\_m128i bias\_0 = \_mm\_set1\_epi32(512);}
\DoxyCodeLine{2605     \_\_m128i bias\_1 = \_mm\_set1\_epi32(65536 + (128 << 17));}
\DoxyCodeLine{2606 }
\DoxyCodeLine{2607     \textcolor{comment}{// load}}
\DoxyCodeLine{2608     row0 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 0 * 8));}
\DoxyCodeLine{2609     row1 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 1 * 8));}
\DoxyCodeLine{2610     row2 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 2 * 8));}
\DoxyCodeLine{2611     row3 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 3 * 8));}
\DoxyCodeLine{2612     row4 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 4 * 8));}
\DoxyCodeLine{2613     row5 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 5 * 8));}
\DoxyCodeLine{2614     row6 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 6 * 8));}
\DoxyCodeLine{2615     row7 = \_mm\_load\_si128((\textcolor{keyword}{const} \_\_m128i*) (data + 7 * 8));}
\DoxyCodeLine{2616 }
\DoxyCodeLine{2617     \textcolor{comment}{// column pass}}
\DoxyCodeLine{2618     dct\_pass(bias\_0, 10);}
\DoxyCodeLine{2619 }
\DoxyCodeLine{2620     \{}
\DoxyCodeLine{2621         \textcolor{comment}{// 16bit 8x8 transpose pass 1}}
\DoxyCodeLine{2622         dct\_interleave16(row0, row4);}
\DoxyCodeLine{2623         dct\_interleave16(row1, row5);}
\DoxyCodeLine{2624         dct\_interleave16(row2, row6);}
\DoxyCodeLine{2625         dct\_interleave16(row3, row7);}
\DoxyCodeLine{2626 }
\DoxyCodeLine{2627         \textcolor{comment}{// transpose pass 2}}
\DoxyCodeLine{2628         dct\_interleave16(row0, row2);}
\DoxyCodeLine{2629         dct\_interleave16(row1, row3);}
\DoxyCodeLine{2630         dct\_interleave16(row4, row6);}
\DoxyCodeLine{2631         dct\_interleave16(row5, row7);}
\DoxyCodeLine{2632 }
\DoxyCodeLine{2633         \textcolor{comment}{// transpose pass 3}}
\DoxyCodeLine{2634         dct\_interleave16(row0, row1);}
\DoxyCodeLine{2635         dct\_interleave16(row2, row3);}
\DoxyCodeLine{2636         dct\_interleave16(row4, row5);}
\DoxyCodeLine{2637         dct\_interleave16(row6, row7);}
\DoxyCodeLine{2638     \}}
\DoxyCodeLine{2639 }
\DoxyCodeLine{2640     \textcolor{comment}{// row pass}}
\DoxyCodeLine{2641     dct\_pass(bias\_1, 17);}
\DoxyCodeLine{2642 }
\DoxyCodeLine{2643     \{}
\DoxyCodeLine{2644         \textcolor{comment}{// pack}}
\DoxyCodeLine{2645         \_\_m128i p0 = \_mm\_packus\_epi16(row0, row1); \textcolor{comment}{// a0a1a2a3...a7b0b1b2b3...b7}}
\DoxyCodeLine{2646         \_\_m128i p1 = \_mm\_packus\_epi16(row2, row3);}
\DoxyCodeLine{2647         \_\_m128i p2 = \_mm\_packus\_epi16(row4, row5);}
\DoxyCodeLine{2648         \_\_m128i p3 = \_mm\_packus\_epi16(row6, row7);}
\DoxyCodeLine{2649 }
\DoxyCodeLine{2650         \textcolor{comment}{// 8bit 8x8 transpose pass 1}}
\DoxyCodeLine{2651         dct\_interleave8(p0, p2); \textcolor{comment}{// a0e0a1e1...}}
\DoxyCodeLine{2652         dct\_interleave8(p1, p3); \textcolor{comment}{// c0g0c1g1...}}
\DoxyCodeLine{2653 }
\DoxyCodeLine{2654         \textcolor{comment}{// transpose pass 2}}
\DoxyCodeLine{2655         dct\_interleave8(p0, p1); \textcolor{comment}{// a0c0e0g0...}}
\DoxyCodeLine{2656         dct\_interleave8(p2, p3); \textcolor{comment}{// b0d0f0h0...}}
\DoxyCodeLine{2657 }
\DoxyCodeLine{2658         \textcolor{comment}{// transpose pass 3}}
\DoxyCodeLine{2659         dct\_interleave8(p0, p2); \textcolor{comment}{// a0b0c0d0...}}
\DoxyCodeLine{2660         dct\_interleave8(p1, p3); \textcolor{comment}{// a4b4c4d4...}}
\DoxyCodeLine{2661 }
\DoxyCodeLine{2662         \textcolor{comment}{// store}}
\DoxyCodeLine{2663         \_mm\_storel\_epi64((\_\_m128i*) out, p0); out += out\_stride;}
\DoxyCodeLine{2664         \_mm\_storel\_epi64((\_\_m128i*) out, \_mm\_shuffle\_epi32(p0, 0x4e)); out += out\_stride;}
\DoxyCodeLine{2665         \_mm\_storel\_epi64((\_\_m128i*) out, p2); out += out\_stride;}
\DoxyCodeLine{2666         \_mm\_storel\_epi64((\_\_m128i*) out, \_mm\_shuffle\_epi32(p2, 0x4e)); out += out\_stride;}
\DoxyCodeLine{2667         \_mm\_storel\_epi64((\_\_m128i*) out, p1); out += out\_stride;}
\DoxyCodeLine{2668         \_mm\_storel\_epi64((\_\_m128i*) out, \_mm\_shuffle\_epi32(p1, 0x4e)); out += out\_stride;}
\DoxyCodeLine{2669         \_mm\_storel\_epi64((\_\_m128i*) out, p3); out += out\_stride;}
\DoxyCodeLine{2670         \_mm\_storel\_epi64((\_\_m128i*) out, \_mm\_shuffle\_epi32(p3, 0x4e));}
\DoxyCodeLine{2671     \}}
\DoxyCodeLine{2672 }
\DoxyCodeLine{2673 \textcolor{preprocessor}{\#undef dct\_const}}
\DoxyCodeLine{2674 \textcolor{preprocessor}{\#undef dct\_rot}}
\DoxyCodeLine{2675 \textcolor{preprocessor}{\#undef dct\_widen}}
\DoxyCodeLine{2676 \textcolor{preprocessor}{\#undef dct\_wadd}}
\DoxyCodeLine{2677 \textcolor{preprocessor}{\#undef dct\_wsub}}
\DoxyCodeLine{2678 \textcolor{preprocessor}{\#undef dct\_bfly32o}}
\DoxyCodeLine{2679 \textcolor{preprocessor}{\#undef dct\_interleave8}}
\DoxyCodeLine{2680 \textcolor{preprocessor}{\#undef dct\_interleave16}}
\DoxyCodeLine{2681 \textcolor{preprocessor}{\#undef dct\_pass}}
\DoxyCodeLine{2682 \}}
\DoxyCodeLine{2683 }
\DoxyCodeLine{2684 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_SSE2}}
\DoxyCodeLine{2685 }
\DoxyCodeLine{2686 \textcolor{preprocessor}{\#ifdef STBI\_NEON}}
\DoxyCodeLine{2687 }
\DoxyCodeLine{2688 \textcolor{comment}{// NEON integer IDCT. should produce bit-\/identical}}
\DoxyCodeLine{2689 \textcolor{comment}{// results to the generic C version.}}
\DoxyCodeLine{2690 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_idct\_simd(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keywordtype}{int} out\_stride, \textcolor{keywordtype}{short} data[64])}
\DoxyCodeLine{2691 \{}
\DoxyCodeLine{2692     int16x8\_t row0, row1, row2, row3, row4, row5, row6, row7;}
\DoxyCodeLine{2693 }
\DoxyCodeLine{2694     int16x4\_t rot0\_0 = vdup\_n\_s16(stbi\_\_f2f(0.5411961f));}
\DoxyCodeLine{2695     int16x4\_t rot0\_1 = vdup\_n\_s16(stbi\_\_f2f(-\/1.847759065f));}
\DoxyCodeLine{2696     int16x4\_t rot0\_2 = vdup\_n\_s16(stbi\_\_f2f(0.765366865f));}
\DoxyCodeLine{2697     int16x4\_t rot1\_0 = vdup\_n\_s16(stbi\_\_f2f(1.175875602f));}
\DoxyCodeLine{2698     int16x4\_t rot1\_1 = vdup\_n\_s16(stbi\_\_f2f(-\/0.899976223f));}
\DoxyCodeLine{2699     int16x4\_t rot1\_2 = vdup\_n\_s16(stbi\_\_f2f(-\/2.562915447f));}
\DoxyCodeLine{2700     int16x4\_t rot2\_0 = vdup\_n\_s16(stbi\_\_f2f(-\/1.961570560f));}
\DoxyCodeLine{2701     int16x4\_t rot2\_1 = vdup\_n\_s16(stbi\_\_f2f(-\/0.390180644f));}
\DoxyCodeLine{2702     int16x4\_t rot3\_0 = vdup\_n\_s16(stbi\_\_f2f(0.298631336f));}
\DoxyCodeLine{2703     int16x4\_t rot3\_1 = vdup\_n\_s16(stbi\_\_f2f(2.053119869f));}
\DoxyCodeLine{2704     int16x4\_t rot3\_2 = vdup\_n\_s16(stbi\_\_f2f(3.072711026f));}
\DoxyCodeLine{2705     int16x4\_t rot3\_3 = vdup\_n\_s16(stbi\_\_f2f(1.501321110f));}
\DoxyCodeLine{2706 }
\DoxyCodeLine{2707 \textcolor{preprocessor}{\#define dct\_long\_mul(out, inq, coeff) \(\backslash\)}}
\DoxyCodeLine{2708 \textcolor{preprocessor}{   int32x4\_t out\#\#\_l = vmull\_s16(vget\_low\_s16(inq), coeff); \(\backslash\)}}
\DoxyCodeLine{2709 \textcolor{preprocessor}{   int32x4\_t out\#\#\_h = vmull\_s16(vget\_high\_s16(inq), coeff)}}
\DoxyCodeLine{2710 }
\DoxyCodeLine{2711 \textcolor{preprocessor}{\#define dct\_long\_mac(out, acc, inq, coeff) \(\backslash\)}}
\DoxyCodeLine{2712 \textcolor{preprocessor}{   int32x4\_t out\#\#\_l = vmlal\_s16(acc\#\#\_l, vget\_low\_s16(inq), coeff); \(\backslash\)}}
\DoxyCodeLine{2713 \textcolor{preprocessor}{   int32x4\_t out\#\#\_h = vmlal\_s16(acc\#\#\_h, vget\_high\_s16(inq), coeff)}}
\DoxyCodeLine{2714 }
\DoxyCodeLine{2715 \textcolor{preprocessor}{\#define dct\_widen(out, inq) \(\backslash\)}}
\DoxyCodeLine{2716 \textcolor{preprocessor}{   int32x4\_t out\#\#\_l = vshll\_n\_s16(vget\_low\_s16(inq), 12); \(\backslash\)}}
\DoxyCodeLine{2717 \textcolor{preprocessor}{   int32x4\_t out\#\#\_h = vshll\_n\_s16(vget\_high\_s16(inq), 12)}}
\DoxyCodeLine{2718 }
\DoxyCodeLine{2719     \textcolor{comment}{// wide add}}
\DoxyCodeLine{2720 \textcolor{preprocessor}{\#define dct\_wadd(out, a, b) \(\backslash\)}}
\DoxyCodeLine{2721 \textcolor{preprocessor}{   int32x4\_t out\#\#\_l = vaddq\_s32(a\#\#\_l, b\#\#\_l); \(\backslash\)}}
\DoxyCodeLine{2722 \textcolor{preprocessor}{   int32x4\_t out\#\#\_h = vaddq\_s32(a\#\#\_h, b\#\#\_h)}}
\DoxyCodeLine{2723 }
\DoxyCodeLine{2724 \textcolor{comment}{// wide sub}}
\DoxyCodeLine{2725 \textcolor{preprocessor}{\#define dct\_wsub(out, a, b) \(\backslash\)}}
\DoxyCodeLine{2726 \textcolor{preprocessor}{   int32x4\_t out\#\#\_l = vsubq\_s32(a\#\#\_l, b\#\#\_l); \(\backslash\)}}
\DoxyCodeLine{2727 \textcolor{preprocessor}{   int32x4\_t out\#\#\_h = vsubq\_s32(a\#\#\_h, b\#\#\_h)}}
\DoxyCodeLine{2728 }
\DoxyCodeLine{2729 \textcolor{comment}{// butterfly a/b, then shift using "{}shiftop"{} by "{}s"{} and pack}}
\DoxyCodeLine{2730 \textcolor{preprocessor}{\#define dct\_bfly32o(out0,out1, a,b,shiftop,s) \(\backslash\)}}
\DoxyCodeLine{2731 \textcolor{preprocessor}{   \{ \(\backslash\)}}
\DoxyCodeLine{2732 \textcolor{preprocessor}{      dct\_wadd(sum, a, b); \(\backslash\)}}
\DoxyCodeLine{2733 \textcolor{preprocessor}{      dct\_wsub(dif, a, b); \(\backslash\)}}
\DoxyCodeLine{2734 \textcolor{preprocessor}{      out0 = vcombine\_s16(shiftop(sum\_l, s), shiftop(sum\_h, s)); \(\backslash\)}}
\DoxyCodeLine{2735 \textcolor{preprocessor}{      out1 = vcombine\_s16(shiftop(dif\_l, s), shiftop(dif\_h, s)); \(\backslash\)}}
\DoxyCodeLine{2736 \textcolor{preprocessor}{   \}}}
\DoxyCodeLine{2737 }
\DoxyCodeLine{2738 \textcolor{preprocessor}{\#define dct\_pass(shiftop, shift) \(\backslash\)}}
\DoxyCodeLine{2739 \textcolor{preprocessor}{   \{ \(\backslash\)}}
\DoxyCodeLine{2740 \textcolor{preprocessor}{      }\textcolor{comment}{/* even part */}\textcolor{preprocessor}{ \(\backslash\)}}
\DoxyCodeLine{2741 \textcolor{preprocessor}{      int16x8\_t sum26 = vaddq\_s16(row2, row6); \(\backslash\)}}
\DoxyCodeLine{2742 \textcolor{preprocessor}{      dct\_long\_mul(p1e, sum26, rot0\_0); \(\backslash\)}}
\DoxyCodeLine{2743 \textcolor{preprocessor}{      dct\_long\_mac(t2e, p1e, row6, rot0\_1); \(\backslash\)}}
\DoxyCodeLine{2744 \textcolor{preprocessor}{      dct\_long\_mac(t3e, p1e, row2, rot0\_2); \(\backslash\)}}
\DoxyCodeLine{2745 \textcolor{preprocessor}{      int16x8\_t sum04 = vaddq\_s16(row0, row4); \(\backslash\)}}
\DoxyCodeLine{2746 \textcolor{preprocessor}{      int16x8\_t dif04 = vsubq\_s16(row0, row4); \(\backslash\)}}
\DoxyCodeLine{2747 \textcolor{preprocessor}{      dct\_widen(t0e, sum04); \(\backslash\)}}
\DoxyCodeLine{2748 \textcolor{preprocessor}{      dct\_widen(t1e, dif04); \(\backslash\)}}
\DoxyCodeLine{2749 \textcolor{preprocessor}{      dct\_wadd(x0, t0e, t3e); \(\backslash\)}}
\DoxyCodeLine{2750 \textcolor{preprocessor}{      dct\_wsub(x3, t0e, t3e); \(\backslash\)}}
\DoxyCodeLine{2751 \textcolor{preprocessor}{      dct\_wadd(x1, t1e, t2e); \(\backslash\)}}
\DoxyCodeLine{2752 \textcolor{preprocessor}{      dct\_wsub(x2, t1e, t2e); \(\backslash\)}}
\DoxyCodeLine{2753 \textcolor{preprocessor}{      }\textcolor{comment}{/* odd part */}\textcolor{preprocessor}{ \(\backslash\)}}
\DoxyCodeLine{2754 \textcolor{preprocessor}{      int16x8\_t sum15 = vaddq\_s16(row1, row5); \(\backslash\)}}
\DoxyCodeLine{2755 \textcolor{preprocessor}{      int16x8\_t sum17 = vaddq\_s16(row1, row7); \(\backslash\)}}
\DoxyCodeLine{2756 \textcolor{preprocessor}{      int16x8\_t sum35 = vaddq\_s16(row3, row5); \(\backslash\)}}
\DoxyCodeLine{2757 \textcolor{preprocessor}{      int16x8\_t sum37 = vaddq\_s16(row3, row7); \(\backslash\)}}
\DoxyCodeLine{2758 \textcolor{preprocessor}{      int16x8\_t sumodd = vaddq\_s16(sum17, sum35); \(\backslash\)}}
\DoxyCodeLine{2759 \textcolor{preprocessor}{      dct\_long\_mul(p5o, sumodd, rot1\_0); \(\backslash\)}}
\DoxyCodeLine{2760 \textcolor{preprocessor}{      dct\_long\_mac(p1o, p5o, sum17, rot1\_1); \(\backslash\)}}
\DoxyCodeLine{2761 \textcolor{preprocessor}{      dct\_long\_mac(p2o, p5o, sum35, rot1\_2); \(\backslash\)}}
\DoxyCodeLine{2762 \textcolor{preprocessor}{      dct\_long\_mul(p3o, sum37, rot2\_0); \(\backslash\)}}
\DoxyCodeLine{2763 \textcolor{preprocessor}{      dct\_long\_mul(p4o, sum15, rot2\_1); \(\backslash\)}}
\DoxyCodeLine{2764 \textcolor{preprocessor}{      dct\_wadd(sump13o, p1o, p3o); \(\backslash\)}}
\DoxyCodeLine{2765 \textcolor{preprocessor}{      dct\_wadd(sump24o, p2o, p4o); \(\backslash\)}}
\DoxyCodeLine{2766 \textcolor{preprocessor}{      dct\_wadd(sump23o, p2o, p3o); \(\backslash\)}}
\DoxyCodeLine{2767 \textcolor{preprocessor}{      dct\_wadd(sump14o, p1o, p4o); \(\backslash\)}}
\DoxyCodeLine{2768 \textcolor{preprocessor}{      dct\_long\_mac(x4, sump13o, row7, rot3\_0); \(\backslash\)}}
\DoxyCodeLine{2769 \textcolor{preprocessor}{      dct\_long\_mac(x5, sump24o, row5, rot3\_1); \(\backslash\)}}
\DoxyCodeLine{2770 \textcolor{preprocessor}{      dct\_long\_mac(x6, sump23o, row3, rot3\_2); \(\backslash\)}}
\DoxyCodeLine{2771 \textcolor{preprocessor}{      dct\_long\_mac(x7, sump14o, row1, rot3\_3); \(\backslash\)}}
\DoxyCodeLine{2772 \textcolor{preprocessor}{      dct\_bfly32o(row0,row7, x0,x7,shiftop,shift); \(\backslash\)}}
\DoxyCodeLine{2773 \textcolor{preprocessor}{      dct\_bfly32o(row1,row6, x1,x6,shiftop,shift); \(\backslash\)}}
\DoxyCodeLine{2774 \textcolor{preprocessor}{      dct\_bfly32o(row2,row5, x2,x5,shiftop,shift); \(\backslash\)}}
\DoxyCodeLine{2775 \textcolor{preprocessor}{      dct\_bfly32o(row3,row4, x3,x4,shiftop,shift); \(\backslash\)}}
\DoxyCodeLine{2776 \textcolor{preprocessor}{   \}}}
\DoxyCodeLine{2777 }
\DoxyCodeLine{2778    \textcolor{comment}{// load}}
\DoxyCodeLine{2779     row0 = vld1q\_s16(data + 0 * 8);}
\DoxyCodeLine{2780     row1 = vld1q\_s16(data + 1 * 8);}
\DoxyCodeLine{2781     row2 = vld1q\_s16(data + 2 * 8);}
\DoxyCodeLine{2782     row3 = vld1q\_s16(data + 3 * 8);}
\DoxyCodeLine{2783     row4 = vld1q\_s16(data + 4 * 8);}
\DoxyCodeLine{2784     row5 = vld1q\_s16(data + 5 * 8);}
\DoxyCodeLine{2785     row6 = vld1q\_s16(data + 6 * 8);}
\DoxyCodeLine{2786     row7 = vld1q\_s16(data + 7 * 8);}
\DoxyCodeLine{2787 }
\DoxyCodeLine{2788     \textcolor{comment}{// add DC bias}}
\DoxyCodeLine{2789     row0 = vaddq\_s16(row0, vsetq\_lane\_s16(1024, vdupq\_n\_s16(0), 0));}
\DoxyCodeLine{2790 }
\DoxyCodeLine{2791     \textcolor{comment}{// column pass}}
\DoxyCodeLine{2792     dct\_pass(vrshrn\_n\_s32, 10);}
\DoxyCodeLine{2793 }
\DoxyCodeLine{2794     \textcolor{comment}{// 16bit 8x8 transpose}}
\DoxyCodeLine{2795     \{}
\DoxyCodeLine{2796         \textcolor{comment}{// these three map to a single VTRN.16, VTRN.32, and VSWP, respectively.}}
\DoxyCodeLine{2797         \textcolor{comment}{// whether compilers actually get this is another story, sadly.}}
\DoxyCodeLine{2798 \textcolor{preprocessor}{\#define dct\_trn16(x, y) \{ int16x8x2\_t t = vtrnq\_s16(x, y); x = t.val[0]; y = t.val[1]; \}}}
\DoxyCodeLine{2799 \textcolor{preprocessor}{\#define dct\_trn32(x, y) \{ int32x4x2\_t t = vtrnq\_s32(vreinterpretq\_s32\_s16(x), vreinterpretq\_s32\_s16(y)); x = vreinterpretq\_s16\_s32(t.val[0]); y = vreinterpretq\_s16\_s32(t.val[1]); \}}}
\DoxyCodeLine{2800 \textcolor{preprocessor}{\#define dct\_trn64(x, y) \{ int16x8\_t x0 = x; int16x8\_t y0 = y; x = vcombine\_s16(vget\_low\_s16(x0), vget\_low\_s16(y0)); y = vcombine\_s16(vget\_high\_s16(x0), vget\_high\_s16(y0)); \}}}
\DoxyCodeLine{2801 }
\DoxyCodeLine{2802       \textcolor{comment}{// pass 1}}
\DoxyCodeLine{2803         dct\_trn16(row0, row1); \textcolor{comment}{// a0b0a2b2a4b4a6b6}}
\DoxyCodeLine{2804         dct\_trn16(row2, row3);}
\DoxyCodeLine{2805         dct\_trn16(row4, row5);}
\DoxyCodeLine{2806         dct\_trn16(row6, row7);}
\DoxyCodeLine{2807 }
\DoxyCodeLine{2808         \textcolor{comment}{// pass 2}}
\DoxyCodeLine{2809         dct\_trn32(row0, row2); \textcolor{comment}{// a0b0c0d0a4b4c4d4}}
\DoxyCodeLine{2810         dct\_trn32(row1, row3);}
\DoxyCodeLine{2811         dct\_trn32(row4, row6);}
\DoxyCodeLine{2812         dct\_trn32(row5, row7);}
\DoxyCodeLine{2813 }
\DoxyCodeLine{2814         \textcolor{comment}{// pass 3}}
\DoxyCodeLine{2815         dct\_trn64(row0, row4); \textcolor{comment}{// a0b0c0d0e0f0g0h0}}
\DoxyCodeLine{2816         dct\_trn64(row1, row5);}
\DoxyCodeLine{2817         dct\_trn64(row2, row6);}
\DoxyCodeLine{2818         dct\_trn64(row3, row7);}
\DoxyCodeLine{2819 }
\DoxyCodeLine{2820 \textcolor{preprocessor}{\#undef dct\_trn16}}
\DoxyCodeLine{2821 \textcolor{preprocessor}{\#undef dct\_trn32}}
\DoxyCodeLine{2822 \textcolor{preprocessor}{\#undef dct\_trn64}}
\DoxyCodeLine{2823     \}}
\DoxyCodeLine{2824 }
\DoxyCodeLine{2825     \textcolor{comment}{// row pass}}
\DoxyCodeLine{2826     \textcolor{comment}{// vrshrn\_n\_s32 only supports shifts up to 16, we need}}
\DoxyCodeLine{2827     \textcolor{comment}{// 17. so do a non-\/rounding shift of 16 first then follow}}
\DoxyCodeLine{2828     \textcolor{comment}{// up with a rounding shift by 1.}}
\DoxyCodeLine{2829     dct\_pass(vshrn\_n\_s32, 16);}
\DoxyCodeLine{2830 }
\DoxyCodeLine{2831     \{}
\DoxyCodeLine{2832         \textcolor{comment}{// pack and round}}
\DoxyCodeLine{2833         uint8x8\_t p0 = vqrshrun\_n\_s16(row0, 1);}
\DoxyCodeLine{2834         uint8x8\_t p1 = vqrshrun\_n\_s16(row1, 1);}
\DoxyCodeLine{2835         uint8x8\_t p2 = vqrshrun\_n\_s16(row2, 1);}
\DoxyCodeLine{2836         uint8x8\_t p3 = vqrshrun\_n\_s16(row3, 1);}
\DoxyCodeLine{2837         uint8x8\_t p4 = vqrshrun\_n\_s16(row4, 1);}
\DoxyCodeLine{2838         uint8x8\_t p5 = vqrshrun\_n\_s16(row5, 1);}
\DoxyCodeLine{2839         uint8x8\_t p6 = vqrshrun\_n\_s16(row6, 1);}
\DoxyCodeLine{2840         uint8x8\_t p7 = vqrshrun\_n\_s16(row7, 1);}
\DoxyCodeLine{2841 }
\DoxyCodeLine{2842         \textcolor{comment}{// again, these can translate into one instruction, but often don't.}}
\DoxyCodeLine{2843 \textcolor{preprocessor}{\#define dct\_trn8\_8(x, y) \{ uint8x8x2\_t t = vtrn\_u8(x, y); x = t.val[0]; y = t.val[1]; \}}}
\DoxyCodeLine{2844 \textcolor{preprocessor}{\#define dct\_trn8\_16(x, y) \{ uint16x4x2\_t t = vtrn\_u16(vreinterpret\_u16\_u8(x), vreinterpret\_u16\_u8(y)); x = vreinterpret\_u8\_u16(t.val[0]); y = vreinterpret\_u8\_u16(t.val[1]); \}}}
\DoxyCodeLine{2845 \textcolor{preprocessor}{\#define dct\_trn8\_32(x, y) \{ uint32x2x2\_t t = vtrn\_u32(vreinterpret\_u32\_u8(x), vreinterpret\_u32\_u8(y)); x = vreinterpret\_u8\_u32(t.val[0]); y = vreinterpret\_u8\_u32(t.val[1]); \}}}
\DoxyCodeLine{2846 }
\DoxyCodeLine{2847       \textcolor{comment}{// sadly can't use interleaved stores here since we only write}}
\DoxyCodeLine{2848       \textcolor{comment}{// 8 bytes to each scan line!}}
\DoxyCodeLine{2849 }
\DoxyCodeLine{2850       \textcolor{comment}{// 8x8 8-\/bit transpose pass 1}}
\DoxyCodeLine{2851         dct\_trn8\_8(p0, p1);}
\DoxyCodeLine{2852         dct\_trn8\_8(p2, p3);}
\DoxyCodeLine{2853         dct\_trn8\_8(p4, p5);}
\DoxyCodeLine{2854         dct\_trn8\_8(p6, p7);}
\DoxyCodeLine{2855 }
\DoxyCodeLine{2856         \textcolor{comment}{// pass 2}}
\DoxyCodeLine{2857         dct\_trn8\_16(p0, p2);}
\DoxyCodeLine{2858         dct\_trn8\_16(p1, p3);}
\DoxyCodeLine{2859         dct\_trn8\_16(p4, p6);}
\DoxyCodeLine{2860         dct\_trn8\_16(p5, p7);}
\DoxyCodeLine{2861 }
\DoxyCodeLine{2862         \textcolor{comment}{// pass 3}}
\DoxyCodeLine{2863         dct\_trn8\_32(p0, p4);}
\DoxyCodeLine{2864         dct\_trn8\_32(p1, p5);}
\DoxyCodeLine{2865         dct\_trn8\_32(p2, p6);}
\DoxyCodeLine{2866         dct\_trn8\_32(p3, p7);}
\DoxyCodeLine{2867 }
\DoxyCodeLine{2868         \textcolor{comment}{// store}}
\DoxyCodeLine{2869         vst1\_u8(out, p0); out += out\_stride;}
\DoxyCodeLine{2870         vst1\_u8(out, p1); out += out\_stride;}
\DoxyCodeLine{2871         vst1\_u8(out, p2); out += out\_stride;}
\DoxyCodeLine{2872         vst1\_u8(out, p3); out += out\_stride;}
\DoxyCodeLine{2873         vst1\_u8(out, p4); out += out\_stride;}
\DoxyCodeLine{2874         vst1\_u8(out, p5); out += out\_stride;}
\DoxyCodeLine{2875         vst1\_u8(out, p6); out += out\_stride;}
\DoxyCodeLine{2876         vst1\_u8(out, p7);}
\DoxyCodeLine{2877 }
\DoxyCodeLine{2878 \textcolor{preprocessor}{\#undef dct\_trn8\_8}}
\DoxyCodeLine{2879 \textcolor{preprocessor}{\#undef dct\_trn8\_16}}
\DoxyCodeLine{2880 \textcolor{preprocessor}{\#undef dct\_trn8\_32}}
\DoxyCodeLine{2881     \}}
\DoxyCodeLine{2882 }
\DoxyCodeLine{2883 \textcolor{preprocessor}{\#undef dct\_long\_mul}}
\DoxyCodeLine{2884 \textcolor{preprocessor}{\#undef dct\_long\_mac}}
\DoxyCodeLine{2885 \textcolor{preprocessor}{\#undef dct\_widen}}
\DoxyCodeLine{2886 \textcolor{preprocessor}{\#undef dct\_wadd}}
\DoxyCodeLine{2887 \textcolor{preprocessor}{\#undef dct\_wsub}}
\DoxyCodeLine{2888 \textcolor{preprocessor}{\#undef dct\_bfly32o}}
\DoxyCodeLine{2889 \textcolor{preprocessor}{\#undef dct\_pass}}
\DoxyCodeLine{2890 \}}
\DoxyCodeLine{2891 }
\DoxyCodeLine{2892 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_NEON}}
\DoxyCodeLine{2893 }
\DoxyCodeLine{2894 \textcolor{preprocessor}{\#define STBI\_\_MARKER\_none  0xff}}
\DoxyCodeLine{2895 \textcolor{comment}{// if there's a pending marker from the entropy stream, return that}}
\DoxyCodeLine{2896 \textcolor{comment}{// otherwise, fetch from the stream and get a marker. if there's no}}
\DoxyCodeLine{2897 \textcolor{comment}{// marker, return 0xff, which is never a valid marker value}}
\DoxyCodeLine{2898 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_get\_marker(stbi\_\_jpeg* j)}
\DoxyCodeLine{2899 \{}
\DoxyCodeLine{2900     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} x;}
\DoxyCodeLine{2901     \textcolor{keywordflow}{if} (j-\/>marker != STBI\_\_MARKER\_none) \{ x = j-\/>marker; j-\/>marker = STBI\_\_MARKER\_none; \textcolor{keywordflow}{return} x; \}}
\DoxyCodeLine{2902     x = stbi\_\_get8(j-\/>s);}
\DoxyCodeLine{2903     \textcolor{keywordflow}{if} (x != 0xff) \textcolor{keywordflow}{return} STBI\_\_MARKER\_none;}
\DoxyCodeLine{2904     \textcolor{keywordflow}{while} (x == 0xff)}
\DoxyCodeLine{2905         x = stbi\_\_get8(j-\/>s); \textcolor{comment}{// consume repeated 0xff fill bytes}}
\DoxyCodeLine{2906     \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{2907 \}}
\DoxyCodeLine{2908 }
\DoxyCodeLine{2909 \textcolor{comment}{// in each scan, we'll have scan\_n components, and the order}}
\DoxyCodeLine{2910 \textcolor{comment}{// of the components is specified by order[]}}
\DoxyCodeLine{2911 \textcolor{preprocessor}{\#define STBI\_\_RESTART(x)     ((x) >= 0xd0 \&\& (x) <= 0xd7)}}
\DoxyCodeLine{2912 }
\DoxyCodeLine{2913 \textcolor{comment}{// after a restart interval, stbi\_\_jpeg\_reset the entropy decoder and}}
\DoxyCodeLine{2914 \textcolor{comment}{// the dc prediction}}
\DoxyCodeLine{2915 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_jpeg\_reset(stbi\_\_jpeg* j)}
\DoxyCodeLine{2916 \{}
\DoxyCodeLine{2917     j-\/>code\_bits = 0;}
\DoxyCodeLine{2918     j-\/>code\_buffer = 0;}
\DoxyCodeLine{2919     j-\/>nomore = 0;}
\DoxyCodeLine{2920     j-\/>img\_comp[0].dc\_pred = j-\/>img\_comp[1].dc\_pred = j-\/>img\_comp[2].dc\_pred = j-\/>img\_comp[3].dc\_pred = 0;}
\DoxyCodeLine{2921     j-\/>marker = STBI\_\_MARKER\_none;}
\DoxyCodeLine{2922     j-\/>todo = j-\/>restart\_interval ? j-\/>restart\_interval : 0x7fffffff;}
\DoxyCodeLine{2923     j-\/>eob\_run = 0;}
\DoxyCodeLine{2924     \textcolor{comment}{// no more than 1<<31 MCUs if no restart\_interal? that's plenty safe,}}
\DoxyCodeLine{2925     \textcolor{comment}{// since we don't even allow 1<<30 pixels}}
\DoxyCodeLine{2926 \}}
\DoxyCodeLine{2927 }
\DoxyCodeLine{2928 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_parse\_entropy\_coded\_data(stbi\_\_jpeg* z)}
\DoxyCodeLine{2929 \{}
\DoxyCodeLine{2930     stbi\_\_jpeg\_reset(z);}
\DoxyCodeLine{2931     \textcolor{keywordflow}{if} (!z-\/>progressive) \{}
\DoxyCodeLine{2932         \textcolor{keywordflow}{if} (z-\/>scan\_n == 1) \{}
\DoxyCodeLine{2933             \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{2934             STBI\_SIMD\_ALIGN(\textcolor{keywordtype}{short}, data[64]);}
\DoxyCodeLine{2935             \textcolor{keywordtype}{int} n = z-\/>order[0];}
\DoxyCodeLine{2936             \textcolor{comment}{// non-\/interleaved data, we just need to process one block at a time,}}
\DoxyCodeLine{2937             \textcolor{comment}{// in trivial scanline order}}
\DoxyCodeLine{2938             \textcolor{comment}{// number of blocks to do just depends on how many actual "{}pixels"{} this}}
\DoxyCodeLine{2939             \textcolor{comment}{// component has, independent of interleaved MCU blocking and such}}
\DoxyCodeLine{2940             \textcolor{keywordtype}{int} w = (z-\/>img\_comp[n].x + 7) >> 3;}
\DoxyCodeLine{2941             \textcolor{keywordtype}{int} h = (z-\/>img\_comp[n].y + 7) >> 3;}
\DoxyCodeLine{2942             \textcolor{keywordflow}{for} (j = 0; j < h; ++j) \{}
\DoxyCodeLine{2943                 \textcolor{keywordflow}{for} (i = 0; i < w; ++i) \{}
\DoxyCodeLine{2944                     \textcolor{keywordtype}{int} ha = z-\/>img\_comp[n].ha;}
\DoxyCodeLine{2945                     \textcolor{keywordflow}{if} (!stbi\_\_jpeg\_decode\_block(z, data, z-\/>huff\_dc + z-\/>img\_comp[n].hd, z-\/>huff\_ac + ha, z-\/>fast\_ac[ha], n, z-\/>dequant[z-\/>img\_comp[n].tq])) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2946                     z-\/>idct\_block\_kernel(z-\/>img\_comp[n].data + z-\/>img\_comp[n].w2 * j * 8 + i * 8, z-\/>img\_comp[n].w2, data);}
\DoxyCodeLine{2947                     \textcolor{comment}{// every data block is an MCU, so countdown the restart interval}}
\DoxyCodeLine{2948                     \textcolor{keywordflow}{if} (-\/-\/z-\/>todo <= 0) \{}
\DoxyCodeLine{2949                         \textcolor{keywordflow}{if} (z-\/>code\_bits < 24) stbi\_\_grow\_buffer\_unsafe(z);}
\DoxyCodeLine{2950                         \textcolor{comment}{// if it's NOT a restart, then just bail, so we get corrupt data}}
\DoxyCodeLine{2951                         \textcolor{comment}{// rather than no data}}
\DoxyCodeLine{2952                         \textcolor{keywordflow}{if} (!STBI\_\_RESTART(z-\/>marker)) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2953                         stbi\_\_jpeg\_reset(z);}
\DoxyCodeLine{2954                     \}}
\DoxyCodeLine{2955                 \}}
\DoxyCodeLine{2956             \}}
\DoxyCodeLine{2957             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2958         \}}
\DoxyCodeLine{2959         \textcolor{keywordflow}{else} \{ \textcolor{comment}{// interleaved}}
\DoxyCodeLine{2960             \textcolor{keywordtype}{int} i, j, k, x, y;}
\DoxyCodeLine{2961             STBI\_SIMD\_ALIGN(\textcolor{keywordtype}{short}, data[64]);}
\DoxyCodeLine{2962             \textcolor{keywordflow}{for} (j = 0; j < z-\/>img\_mcu\_y; ++j) \{}
\DoxyCodeLine{2963                 \textcolor{keywordflow}{for} (i = 0; i < z-\/>img\_mcu\_x; ++i) \{}
\DoxyCodeLine{2964                     \textcolor{comment}{// scan an interleaved mcu... process scan\_n components in order}}
\DoxyCodeLine{2965                     \textcolor{keywordflow}{for} (k = 0; k < z-\/>scan\_n; ++k) \{}
\DoxyCodeLine{2966                         \textcolor{keywordtype}{int} n = z-\/>order[k];}
\DoxyCodeLine{2967                         \textcolor{comment}{// scan out an mcu's worth of this component; that's just determined}}
\DoxyCodeLine{2968                         \textcolor{comment}{// by the basic H and V specified for the component}}
\DoxyCodeLine{2969                         \textcolor{keywordflow}{for} (y = 0; y < z-\/>img\_comp[n].v; ++y) \{}
\DoxyCodeLine{2970                             \textcolor{keywordflow}{for} (x = 0; x < z-\/>img\_comp[n].h; ++x) \{}
\DoxyCodeLine{2971                                 \textcolor{keywordtype}{int} x2 = (i * z-\/>img\_comp[n].h + x) * 8;}
\DoxyCodeLine{2972                                 \textcolor{keywordtype}{int} y2 = (j * z-\/>img\_comp[n].v + y) * 8;}
\DoxyCodeLine{2973                                 \textcolor{keywordtype}{int} ha = z-\/>img\_comp[n].ha;}
\DoxyCodeLine{2974                                 \textcolor{keywordflow}{if} (!stbi\_\_jpeg\_decode\_block(z, data, z-\/>huff\_dc + z-\/>img\_comp[n].hd, z-\/>huff\_ac + ha, z-\/>fast\_ac[ha], n, z-\/>dequant[z-\/>img\_comp[n].tq])) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{2975                                 z-\/>idct\_block\_kernel(z-\/>img\_comp[n].data + z-\/>img\_comp[n].w2 * y2 + x2, z-\/>img\_comp[n].w2, data);}
\DoxyCodeLine{2976                             \}}
\DoxyCodeLine{2977                         \}}
\DoxyCodeLine{2978                     \}}
\DoxyCodeLine{2979                     \textcolor{comment}{// after all interleaved components, that's an interleaved MCU,}}
\DoxyCodeLine{2980                     \textcolor{comment}{// so now count down the restart interval}}
\DoxyCodeLine{2981                     \textcolor{keywordflow}{if} (-\/-\/z-\/>todo <= 0) \{}
\DoxyCodeLine{2982                         \textcolor{keywordflow}{if} (z-\/>code\_bits < 24) stbi\_\_grow\_buffer\_unsafe(z);}
\DoxyCodeLine{2983                         \textcolor{keywordflow}{if} (!STBI\_\_RESTART(z-\/>marker)) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2984                         stbi\_\_jpeg\_reset(z);}
\DoxyCodeLine{2985                     \}}
\DoxyCodeLine{2986                 \}}
\DoxyCodeLine{2987             \}}
\DoxyCodeLine{2988             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{2989         \}}
\DoxyCodeLine{2990     \}}
\DoxyCodeLine{2991     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2992         \textcolor{keywordflow}{if} (z-\/>scan\_n == 1) \{}
\DoxyCodeLine{2993             \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{2994             \textcolor{keywordtype}{int} n = z-\/>order[0];}
\DoxyCodeLine{2995             \textcolor{comment}{// non-\/interleaved data, we just need to process one block at a time,}}
\DoxyCodeLine{2996             \textcolor{comment}{// in trivial scanline order}}
\DoxyCodeLine{2997             \textcolor{comment}{// number of blocks to do just depends on how many actual "{}pixels"{} this}}
\DoxyCodeLine{2998             \textcolor{comment}{// component has, independent of interleaved MCU blocking and such}}
\DoxyCodeLine{2999             \textcolor{keywordtype}{int} w = (z-\/>img\_comp[n].x + 7) >> 3;}
\DoxyCodeLine{3000             \textcolor{keywordtype}{int} h = (z-\/>img\_comp[n].y + 7) >> 3;}
\DoxyCodeLine{3001             \textcolor{keywordflow}{for} (j = 0; j < h; ++j) \{}
\DoxyCodeLine{3002                 \textcolor{keywordflow}{for} (i = 0; i < w; ++i) \{}
\DoxyCodeLine{3003                     \textcolor{keywordtype}{short}* data = z-\/>img\_comp[n].coeff + 64 * (i + j * z-\/>img\_comp[n].coeff\_w);}
\DoxyCodeLine{3004                     \textcolor{keywordflow}{if} (z-\/>spec\_start == 0) \{}
\DoxyCodeLine{3005                         \textcolor{keywordflow}{if} (!stbi\_\_jpeg\_decode\_block\_prog\_dc(z, data, \&z-\/>huff\_dc[z-\/>img\_comp[n].hd], n))}
\DoxyCodeLine{3006                             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3007                     \}}
\DoxyCodeLine{3008                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3009                         \textcolor{keywordtype}{int} ha = z-\/>img\_comp[n].ha;}
\DoxyCodeLine{3010                         \textcolor{keywordflow}{if} (!stbi\_\_jpeg\_decode\_block\_prog\_ac(z, data, \&z-\/>huff\_ac[ha], z-\/>fast\_ac[ha]))}
\DoxyCodeLine{3011                             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3012                     \}}
\DoxyCodeLine{3013                     \textcolor{comment}{// every data block is an MCU, so countdown the restart interval}}
\DoxyCodeLine{3014                     \textcolor{keywordflow}{if} (-\/-\/z-\/>todo <= 0) \{}
\DoxyCodeLine{3015                         \textcolor{keywordflow}{if} (z-\/>code\_bits < 24) stbi\_\_grow\_buffer\_unsafe(z);}
\DoxyCodeLine{3016                         \textcolor{keywordflow}{if} (!STBI\_\_RESTART(z-\/>marker)) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3017                         stbi\_\_jpeg\_reset(z);}
\DoxyCodeLine{3018                     \}}
\DoxyCodeLine{3019                 \}}
\DoxyCodeLine{3020             \}}
\DoxyCodeLine{3021             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3022         \}}
\DoxyCodeLine{3023         \textcolor{keywordflow}{else} \{ \textcolor{comment}{// interleaved}}
\DoxyCodeLine{3024             \textcolor{keywordtype}{int} i, j, k, x, y;}
\DoxyCodeLine{3025             \textcolor{keywordflow}{for} (j = 0; j < z-\/>img\_mcu\_y; ++j) \{}
\DoxyCodeLine{3026                 \textcolor{keywordflow}{for} (i = 0; i < z-\/>img\_mcu\_x; ++i) \{}
\DoxyCodeLine{3027                     \textcolor{comment}{// scan an interleaved mcu... process scan\_n components in order}}
\DoxyCodeLine{3028                     \textcolor{keywordflow}{for} (k = 0; k < z-\/>scan\_n; ++k) \{}
\DoxyCodeLine{3029                         \textcolor{keywordtype}{int} n = z-\/>order[k];}
\DoxyCodeLine{3030                         \textcolor{comment}{// scan out an mcu's worth of this component; that's just determined}}
\DoxyCodeLine{3031                         \textcolor{comment}{// by the basic H and V specified for the component}}
\DoxyCodeLine{3032                         \textcolor{keywordflow}{for} (y = 0; y < z-\/>img\_comp[n].v; ++y) \{}
\DoxyCodeLine{3033                             \textcolor{keywordflow}{for} (x = 0; x < z-\/>img\_comp[n].h; ++x) \{}
\DoxyCodeLine{3034                                 \textcolor{keywordtype}{int} x2 = (i * z-\/>img\_comp[n].h + x);}
\DoxyCodeLine{3035                                 \textcolor{keywordtype}{int} y2 = (j * z-\/>img\_comp[n].v + y);}
\DoxyCodeLine{3036                                 \textcolor{keywordtype}{short}* data = z-\/>img\_comp[n].coeff + 64 * (x2 + y2 * z-\/>img\_comp[n].coeff\_w);}
\DoxyCodeLine{3037                                 \textcolor{keywordflow}{if} (!stbi\_\_jpeg\_decode\_block\_prog\_dc(z, data, \&z-\/>huff\_dc[z-\/>img\_comp[n].hd], n))}
\DoxyCodeLine{3038                                     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3039                             \}}
\DoxyCodeLine{3040                         \}}
\DoxyCodeLine{3041                     \}}
\DoxyCodeLine{3042                     \textcolor{comment}{// after all interleaved components, that's an interleaved MCU,}}
\DoxyCodeLine{3043                     \textcolor{comment}{// so now count down the restart interval}}
\DoxyCodeLine{3044                     \textcolor{keywordflow}{if} (-\/-\/z-\/>todo <= 0) \{}
\DoxyCodeLine{3045                         \textcolor{keywordflow}{if} (z-\/>code\_bits < 24) stbi\_\_grow\_buffer\_unsafe(z);}
\DoxyCodeLine{3046                         \textcolor{keywordflow}{if} (!STBI\_\_RESTART(z-\/>marker)) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3047                         stbi\_\_jpeg\_reset(z);}
\DoxyCodeLine{3048                     \}}
\DoxyCodeLine{3049                 \}}
\DoxyCodeLine{3050             \}}
\DoxyCodeLine{3051             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3052         \}}
\DoxyCodeLine{3053     \}}
\DoxyCodeLine{3054 \}}
\DoxyCodeLine{3055 }
\DoxyCodeLine{3056 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_jpeg\_dequantize(\textcolor{keywordtype}{short}* data, stbi\_\_uint16* dequant)}
\DoxyCodeLine{3057 \{}
\DoxyCodeLine{3058     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3059     \textcolor{keywordflow}{for} (i = 0; i < 64; ++i)}
\DoxyCodeLine{3060         data[i] *= dequant[i];}
\DoxyCodeLine{3061 \}}
\DoxyCodeLine{3062 }
\DoxyCodeLine{3063 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_jpeg\_finish(stbi\_\_jpeg* z)}
\DoxyCodeLine{3064 \{}
\DoxyCodeLine{3065     \textcolor{keywordflow}{if} (z-\/>progressive) \{}
\DoxyCodeLine{3066         \textcolor{comment}{// dequantize and idct the data}}
\DoxyCodeLine{3067         \textcolor{keywordtype}{int} i, j, n;}
\DoxyCodeLine{3068         \textcolor{keywordflow}{for} (n = 0; n < z-\/>s-\/>img\_n; ++n) \{}
\DoxyCodeLine{3069             \textcolor{keywordtype}{int} w = (z-\/>img\_comp[n].x + 7) >> 3;}
\DoxyCodeLine{3070             \textcolor{keywordtype}{int} h = (z-\/>img\_comp[n].y + 7) >> 3;}
\DoxyCodeLine{3071             \textcolor{keywordflow}{for} (j = 0; j < h; ++j) \{}
\DoxyCodeLine{3072                 \textcolor{keywordflow}{for} (i = 0; i < w; ++i) \{}
\DoxyCodeLine{3073                     \textcolor{keywordtype}{short}* data = z-\/>img\_comp[n].coeff + 64 * (i + j * z-\/>img\_comp[n].coeff\_w);}
\DoxyCodeLine{3074                     stbi\_\_jpeg\_dequantize(data, z-\/>dequant[z-\/>img\_comp[n].tq]);}
\DoxyCodeLine{3075                     z-\/>idct\_block\_kernel(z-\/>img\_comp[n].data + z-\/>img\_comp[n].w2 * j * 8 + i * 8, z-\/>img\_comp[n].w2, data);}
\DoxyCodeLine{3076                 \}}
\DoxyCodeLine{3077             \}}
\DoxyCodeLine{3078         \}}
\DoxyCodeLine{3079     \}}
\DoxyCodeLine{3080 \}}
\DoxyCodeLine{3081 }
\DoxyCodeLine{3082 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_process\_marker(stbi\_\_jpeg* z, \textcolor{keywordtype}{int} m)}
\DoxyCodeLine{3083 \{}
\DoxyCodeLine{3084     \textcolor{keywordtype}{int} L;}
\DoxyCodeLine{3085     \textcolor{keywordflow}{switch} (m) \{}
\DoxyCodeLine{3086     \textcolor{keywordflow}{case} STBI\_\_MARKER\_none: \textcolor{comment}{// no marker found}}
\DoxyCodeLine{3087         \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}expected marker"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3088 }
\DoxyCodeLine{3089     \textcolor{keywordflow}{case} 0xDD: \textcolor{comment}{// DRI -\/ specify restart interval}}
\DoxyCodeLine{3090         \textcolor{keywordflow}{if} (stbi\_\_get16be(z-\/>s) != 4) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DRI len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3091         z-\/>restart\_interval = stbi\_\_get16be(z-\/>s);}
\DoxyCodeLine{3092         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3093 }
\DoxyCodeLine{3094     \textcolor{keywordflow}{case} 0xDB: \textcolor{comment}{// DQT -\/ define quantization table}}
\DoxyCodeLine{3095         L = stbi\_\_get16be(z-\/>s) -\/ 2;}
\DoxyCodeLine{3096         \textcolor{keywordflow}{while} (L > 0) \{}
\DoxyCodeLine{3097             \textcolor{keywordtype}{int} q = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3098             \textcolor{keywordtype}{int} p = q >> 4, sixteen = (p != 0);}
\DoxyCodeLine{3099             \textcolor{keywordtype}{int} t = q \& 15, i;}
\DoxyCodeLine{3100             \textcolor{keywordflow}{if} (p != 0 \&\& p != 1) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DQT type"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3101             \textcolor{keywordflow}{if} (t > 3) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DQT table"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3102 }
\DoxyCodeLine{3103             \textcolor{keywordflow}{for} (i = 0; i < 64; ++i)}
\DoxyCodeLine{3104                 z-\/>dequant[t][stbi\_\_jpeg\_dezigzag[i]] = (stbi\_\_uint16)(sixteen ? stbi\_\_get16be(z-\/>s) : stbi\_\_get8(z-\/>s));}
\DoxyCodeLine{3105             L -\/= (sixteen ? 129 : 65);}
\DoxyCodeLine{3106         \}}
\DoxyCodeLine{3107         \textcolor{keywordflow}{return} L == 0;}
\DoxyCodeLine{3108 }
\DoxyCodeLine{3109     \textcolor{keywordflow}{case} 0xC4: \textcolor{comment}{// DHT -\/ define huffman table}}
\DoxyCodeLine{3110         L = stbi\_\_get16be(z-\/>s) -\/ 2;}
\DoxyCodeLine{3111         \textcolor{keywordflow}{while} (L > 0) \{}
\DoxyCodeLine{3112             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* v;}
\DoxyCodeLine{3113             \textcolor{keywordtype}{int} sizes[16], i, n = 0;}
\DoxyCodeLine{3114             \textcolor{keywordtype}{int} q = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3115             \textcolor{keywordtype}{int} tc = q >> 4;}
\DoxyCodeLine{3116             \textcolor{keywordtype}{int} th = q \& 15;}
\DoxyCodeLine{3117             \textcolor{keywordflow}{if} (tc > 1 || th > 3) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DHT header"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3118             \textcolor{keywordflow}{for} (i = 0; i < 16; ++i) \{}
\DoxyCodeLine{3119                 sizes[i] = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3120                 n += sizes[i];}
\DoxyCodeLine{3121             \}}
\DoxyCodeLine{3122             L -\/= 17;}
\DoxyCodeLine{3123             \textcolor{keywordflow}{if} (tc == 0) \{}
\DoxyCodeLine{3124                 \textcolor{keywordflow}{if} (!stbi\_\_build\_huffman(z-\/>huff\_dc + th, sizes)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3125                 v = z-\/>huff\_dc[th].values;}
\DoxyCodeLine{3126             \}}
\DoxyCodeLine{3127             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3128                 \textcolor{keywordflow}{if} (!stbi\_\_build\_huffman(z-\/>huff\_ac + th, sizes)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3129                 v = z-\/>huff\_ac[th].values;}
\DoxyCodeLine{3130             \}}
\DoxyCodeLine{3131             \textcolor{keywordflow}{for} (i = 0; i < n; ++i)}
\DoxyCodeLine{3132                 v[i] = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3133             \textcolor{keywordflow}{if} (tc != 0)}
\DoxyCodeLine{3134                 stbi\_\_build\_fast\_ac(z-\/>fast\_ac[th], z-\/>huff\_ac + th);}
\DoxyCodeLine{3135             L -\/= n;}
\DoxyCodeLine{3136         \}}
\DoxyCodeLine{3137         \textcolor{keywordflow}{return} L == 0;}
\DoxyCodeLine{3138     \}}
\DoxyCodeLine{3139 }
\DoxyCodeLine{3140     \textcolor{comment}{// check for comment block or APP blocks}}
\DoxyCodeLine{3141     \textcolor{keywordflow}{if} ((m >= 0xE0 \&\& m <= 0xEF) || m == 0xFE) \{}
\DoxyCodeLine{3142         L = stbi\_\_get16be(z-\/>s);}
\DoxyCodeLine{3143         \textcolor{keywordflow}{if} (L < 2) \{}
\DoxyCodeLine{3144             \textcolor{keywordflow}{if} (m == 0xFE)}
\DoxyCodeLine{3145                 \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad COM len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3146             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3147                 \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad APP len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3148         \}}
\DoxyCodeLine{3149         L -\/= 2;}
\DoxyCodeLine{3150 }
\DoxyCodeLine{3151         \textcolor{keywordflow}{if} (m == 0xE0 \&\& L >= 5) \{ \textcolor{comment}{// JFIF APP0 segment}}
\DoxyCodeLine{3152             \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} tag[5] = \{ \textcolor{charliteral}{'J'},\textcolor{charliteral}{'F'},\textcolor{charliteral}{'I'},\textcolor{charliteral}{'F'},\textcolor{charliteral}{'\(\backslash\)0'} \};}
\DoxyCodeLine{3153             \textcolor{keywordtype}{int} ok = 1;}
\DoxyCodeLine{3154             \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3155             \textcolor{keywordflow}{for} (i = 0; i < 5; ++i)}
\DoxyCodeLine{3156                 \textcolor{keywordflow}{if} (stbi\_\_get8(z-\/>s) != tag[i])}
\DoxyCodeLine{3157                     ok = 0;}
\DoxyCodeLine{3158             L -\/= 5;}
\DoxyCodeLine{3159             \textcolor{keywordflow}{if} (ok)}
\DoxyCodeLine{3160                 z-\/>jfif = 1;}
\DoxyCodeLine{3161         \}}
\DoxyCodeLine{3162         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m == 0xEE \&\& L >= 12) \{ \textcolor{comment}{// Adobe APP14 segment}}
\DoxyCodeLine{3163             \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} tag[6] = \{ \textcolor{charliteral}{'A'},\textcolor{charliteral}{'d'},\textcolor{charliteral}{'o'},\textcolor{charliteral}{'b'},\textcolor{charliteral}{'e'},\textcolor{charliteral}{'\(\backslash\)0'} \};}
\DoxyCodeLine{3164             \textcolor{keywordtype}{int} ok = 1;}
\DoxyCodeLine{3165             \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3166             \textcolor{keywordflow}{for} (i = 0; i < 6; ++i)}
\DoxyCodeLine{3167                 \textcolor{keywordflow}{if} (stbi\_\_get8(z-\/>s) != tag[i])}
\DoxyCodeLine{3168                     ok = 0;}
\DoxyCodeLine{3169             L -\/= 6;}
\DoxyCodeLine{3170             \textcolor{keywordflow}{if} (ok) \{}
\DoxyCodeLine{3171                 stbi\_\_get8(z-\/>s); \textcolor{comment}{// version}}
\DoxyCodeLine{3172                 stbi\_\_get16be(z-\/>s); \textcolor{comment}{// flags0}}
\DoxyCodeLine{3173                 stbi\_\_get16be(z-\/>s); \textcolor{comment}{// flags1}}
\DoxyCodeLine{3174                 z-\/>app14\_color\_transform = stbi\_\_get8(z-\/>s); \textcolor{comment}{// color transform}}
\DoxyCodeLine{3175                 L -\/= 6;}
\DoxyCodeLine{3176             \}}
\DoxyCodeLine{3177         \}}
\DoxyCodeLine{3178 }
\DoxyCodeLine{3179         stbi\_\_skip(z-\/>s, L);}
\DoxyCodeLine{3180         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3181     \}}
\DoxyCodeLine{3182 }
\DoxyCodeLine{3183     \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}unknown marker"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3184 \}}
\DoxyCodeLine{3185 }
\DoxyCodeLine{3186 \textcolor{comment}{// after we see SOS}}
\DoxyCodeLine{3187 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_process\_scan\_header(stbi\_\_jpeg* z)}
\DoxyCodeLine{3188 \{}
\DoxyCodeLine{3189     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3190     \textcolor{keywordtype}{int} Ls = stbi\_\_get16be(z-\/>s);}
\DoxyCodeLine{3191     z-\/>scan\_n = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3192     \textcolor{keywordflow}{if} (z-\/>scan\_n < 1 || z-\/>scan\_n > 4 || z-\/>scan\_n > (\textcolor{keywordtype}{int})z-\/>s-\/>img\_n) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOS component count"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3193     \textcolor{keywordflow}{if} (Ls != 6 + 2 * z-\/>scan\_n) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOS len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3194     \textcolor{keywordflow}{for} (i = 0; i < z-\/>scan\_n; ++i) \{}
\DoxyCodeLine{3195         \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = stbi\_\_get8(z-\/>s), which;}
\DoxyCodeLine{3196         \textcolor{keywordtype}{int} q = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3197         \textcolor{keywordflow}{for} (which = 0; which < z-\/>s-\/>img\_n; ++which)}
\DoxyCodeLine{3198             \textcolor{keywordflow}{if} (z-\/>img\_comp[which].id == \textcolor{keywordtype}{id})}
\DoxyCodeLine{3199                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{3200         \textcolor{keywordflow}{if} (which == z-\/>s-\/>img\_n) \textcolor{keywordflow}{return} 0; \textcolor{comment}{// no match}}
\DoxyCodeLine{3201         z-\/>img\_comp[which].hd = q >> 4;   \textcolor{keywordflow}{if} (z-\/>img\_comp[which].hd > 3) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DC huff"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3202         z-\/>img\_comp[which].ha = q \& 15;   \textcolor{keywordflow}{if} (z-\/>img\_comp[which].ha > 3) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad AC huff"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3203         z-\/>order[i] = which;}
\DoxyCodeLine{3204     \}}
\DoxyCodeLine{3205 }
\DoxyCodeLine{3206     \{}
\DoxyCodeLine{3207         \textcolor{keywordtype}{int} aa;}
\DoxyCodeLine{3208         z-\/>spec\_start = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3209         z-\/>spec\_end = stbi\_\_get8(z-\/>s); \textcolor{comment}{// should be 63, but might be 0}}
\DoxyCodeLine{3210         aa = stbi\_\_get8(z-\/>s);}
\DoxyCodeLine{3211         z-\/>succ\_high = (aa >> 4);}
\DoxyCodeLine{3212         z-\/>succ\_low = (aa \& 15);}
\DoxyCodeLine{3213         \textcolor{keywordflow}{if} (z-\/>progressive) \{}
\DoxyCodeLine{3214             \textcolor{keywordflow}{if} (z-\/>spec\_start > 63 || z-\/>spec\_end > 63 || z-\/>spec\_start > z-\/>spec\_end || z-\/>succ\_high > 13 || z-\/>succ\_low > 13)}
\DoxyCodeLine{3215                 \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOS"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3216         \}}
\DoxyCodeLine{3217         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3218             \textcolor{keywordflow}{if} (z-\/>spec\_start != 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOS"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3219             \textcolor{keywordflow}{if} (z-\/>succ\_high != 0 || z-\/>succ\_low != 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOS"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3220             z-\/>spec\_end = 63;}
\DoxyCodeLine{3221         \}}
\DoxyCodeLine{3222     \}}
\DoxyCodeLine{3223 }
\DoxyCodeLine{3224     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3225 \}}
\DoxyCodeLine{3226 }
\DoxyCodeLine{3227 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_free\_jpeg\_components(stbi\_\_jpeg* z, \textcolor{keywordtype}{int} ncomp, \textcolor{keywordtype}{int} why)}
\DoxyCodeLine{3228 \{}
\DoxyCodeLine{3229     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3230     \textcolor{keywordflow}{for} (i = 0; i < ncomp; ++i) \{}
\DoxyCodeLine{3231         \textcolor{keywordflow}{if} (z-\/>img\_comp[i].raw\_data) \{}
\DoxyCodeLine{3232             STBI\_FREE(z-\/>img\_comp[i].raw\_data);}
\DoxyCodeLine{3233             z-\/>img\_comp[i].raw\_data = NULL;}
\DoxyCodeLine{3234             z-\/>img\_comp[i].data = NULL;}
\DoxyCodeLine{3235         \}}
\DoxyCodeLine{3236         \textcolor{keywordflow}{if} (z-\/>img\_comp[i].raw\_coeff) \{}
\DoxyCodeLine{3237             STBI\_FREE(z-\/>img\_comp[i].raw\_coeff);}
\DoxyCodeLine{3238             z-\/>img\_comp[i].raw\_coeff = 0;}
\DoxyCodeLine{3239             z-\/>img\_comp[i].coeff = 0;}
\DoxyCodeLine{3240         \}}
\DoxyCodeLine{3241         \textcolor{keywordflow}{if} (z-\/>img\_comp[i].linebuf) \{}
\DoxyCodeLine{3242             STBI\_FREE(z-\/>img\_comp[i].linebuf);}
\DoxyCodeLine{3243             z-\/>img\_comp[i].linebuf = NULL;}
\DoxyCodeLine{3244         \}}
\DoxyCodeLine{3245     \}}
\DoxyCodeLine{3246     \textcolor{keywordflow}{return} why;}
\DoxyCodeLine{3247 \}}
\DoxyCodeLine{3248 }
\DoxyCodeLine{3249 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_process\_frame\_header(stbi\_\_jpeg* z, \textcolor{keywordtype}{int} scan)}
\DoxyCodeLine{3250 \{}
\DoxyCodeLine{3251     stbi\_\_context* s = z-\/>s;}
\DoxyCodeLine{3252     \textcolor{keywordtype}{int} Lf, p, i, q, h\_max = 1, v\_max = 1, c;}
\DoxyCodeLine{3253     Lf = stbi\_\_get16be(s);         \textcolor{keywordflow}{if} (Lf < 11) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOF len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}}); \textcolor{comment}{// JPEG}}
\DoxyCodeLine{3254     p = stbi\_\_get8(s);            \textcolor{keywordflow}{if} (p != 8) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}only 8-\/bit"{}}, \textcolor{stringliteral}{"{}JPEG format not supported: 8-\/bit only"{}}); \textcolor{comment}{// JPEG baseline}}
\DoxyCodeLine{3255     s-\/>img\_y = stbi\_\_get16be(s);   \textcolor{keywordflow}{if} (s-\/>img\_y == 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}no header height"{}}, \textcolor{stringliteral}{"{}JPEG format not supported: delayed height"{}}); \textcolor{comment}{// Legal, but we don't handle it-\/-\/but neither does IJG}}
\DoxyCodeLine{3256     s-\/>img\_x = stbi\_\_get16be(s);   \textcolor{keywordflow}{if} (s-\/>img\_x == 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}0 width"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}}); \textcolor{comment}{// JPEG requires}}
\DoxyCodeLine{3257     \textcolor{keywordflow}{if} (s-\/>img\_y > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{3258     \textcolor{keywordflow}{if} (s-\/>img\_x > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{3259     c = stbi\_\_get8(s);}
\DoxyCodeLine{3260     \textcolor{keywordflow}{if} (c != 3 \&\& c != 1 \&\& c != 4) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad component count"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3261     s-\/>img\_n = c;}
\DoxyCodeLine{3262     \textcolor{keywordflow}{for} (i = 0; i < c; ++i) \{}
\DoxyCodeLine{3263         z-\/>img\_comp[i].data = NULL;}
\DoxyCodeLine{3264         z-\/>img\_comp[i].linebuf = NULL;}
\DoxyCodeLine{3265     \}}
\DoxyCodeLine{3266 }
\DoxyCodeLine{3267     \textcolor{keywordflow}{if} (Lf != 8 + 3 * s-\/>img\_n) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad SOF len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3268 }
\DoxyCodeLine{3269     z-\/>rgb = 0;}
\DoxyCodeLine{3270     \textcolor{keywordflow}{for} (i = 0; i < s-\/>img\_n; ++i) \{}
\DoxyCodeLine{3271         \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} rgb[3] = \{ \textcolor{charliteral}{'R'}, \textcolor{charliteral}{'G'}, \textcolor{charliteral}{'B'} \};}
\DoxyCodeLine{3272         z-\/>img\_comp[i].id = stbi\_\_get8(s);}
\DoxyCodeLine{3273         \textcolor{keywordflow}{if} (s-\/>img\_n == 3 \&\& z-\/>img\_comp[i].id == rgb[i])}
\DoxyCodeLine{3274             ++z-\/>rgb;}
\DoxyCodeLine{3275         q = stbi\_\_get8(s);}
\DoxyCodeLine{3276         z-\/>img\_comp[i].h = (q >> 4);  \textcolor{keywordflow}{if} (!z-\/>img\_comp[i].h || z-\/>img\_comp[i].h > 4) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad H"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3277         z-\/>img\_comp[i].v = q \& 15;    \textcolor{keywordflow}{if} (!z-\/>img\_comp[i].v || z-\/>img\_comp[i].v > 4) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad V"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3278         z-\/>img\_comp[i].tq = stbi\_\_get8(s);  \textcolor{keywordflow}{if} (z-\/>img\_comp[i].tq > 3) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad TQ"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3279     \}}
\DoxyCodeLine{3280 }
\DoxyCodeLine{3281     \textcolor{keywordflow}{if} (scan != STBI\_\_SCAN\_load) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3282 }
\DoxyCodeLine{3283     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(s-\/>img\_x, s-\/>img\_y, s-\/>img\_n, 0)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Image too large to decode"{}});}
\DoxyCodeLine{3284 }
\DoxyCodeLine{3285     \textcolor{keywordflow}{for} (i = 0; i < s-\/>img\_n; ++i) \{}
\DoxyCodeLine{3286         \textcolor{keywordflow}{if} (z-\/>img\_comp[i].h > h\_max) h\_max = z-\/>img\_comp[i].h;}
\DoxyCodeLine{3287         \textcolor{keywordflow}{if} (z-\/>img\_comp[i].v > v\_max) v\_max = z-\/>img\_comp[i].v;}
\DoxyCodeLine{3288     \}}
\DoxyCodeLine{3289 }
\DoxyCodeLine{3290     \textcolor{comment}{// check that plane subsampling factors are integer ratios; our resamplers can't deal with fractional ratios}}
\DoxyCodeLine{3291     \textcolor{comment}{// and I've never seen a non-\/corrupted JPEG file actually use them}}
\DoxyCodeLine{3292     \textcolor{keywordflow}{for} (i = 0; i < s-\/>img\_n; ++i) \{}
\DoxyCodeLine{3293         \textcolor{keywordflow}{if} (h\_max \% z-\/>img\_comp[i].h != 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad H"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3294         \textcolor{keywordflow}{if} (v\_max \% z-\/>img\_comp[i].v != 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad V"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3295     \}}
\DoxyCodeLine{3296 }
\DoxyCodeLine{3297     \textcolor{comment}{// compute interleaved mcu info}}
\DoxyCodeLine{3298     z-\/>img\_h\_max = h\_max;}
\DoxyCodeLine{3299     z-\/>img\_v\_max = v\_max;}
\DoxyCodeLine{3300     z-\/>img\_mcu\_w = h\_max * 8;}
\DoxyCodeLine{3301     z-\/>img\_mcu\_h = v\_max * 8;}
\DoxyCodeLine{3302     \textcolor{comment}{// these sizes can't be more than 17 bits}}
\DoxyCodeLine{3303     z-\/>img\_mcu\_x = (s-\/>img\_x + z-\/>img\_mcu\_w -\/ 1) / z-\/>img\_mcu\_w;}
\DoxyCodeLine{3304     z-\/>img\_mcu\_y = (s-\/>img\_y + z-\/>img\_mcu\_h -\/ 1) / z-\/>img\_mcu\_h;}
\DoxyCodeLine{3305 }
\DoxyCodeLine{3306     \textcolor{keywordflow}{for} (i = 0; i < s-\/>img\_n; ++i) \{}
\DoxyCodeLine{3307         \textcolor{comment}{// number of effective pixels (e.g. for non-\/interleaved MCU)}}
\DoxyCodeLine{3308         z-\/>img\_comp[i].x = (s-\/>img\_x * z-\/>img\_comp[i].h + h\_max -\/ 1) / h\_max;}
\DoxyCodeLine{3309         z-\/>img\_comp[i].y = (s-\/>img\_y * z-\/>img\_comp[i].v + v\_max -\/ 1) / v\_max;}
\DoxyCodeLine{3310         \textcolor{comment}{// to simplify generation, we'll allocate enough memory to decode}}
\DoxyCodeLine{3311         \textcolor{comment}{// the bogus oversized data from using interleaved MCUs and their}}
\DoxyCodeLine{3312         \textcolor{comment}{// big blocks (e.g. a 16x16 iMCU on an image of width 33); we won't}}
\DoxyCodeLine{3313         \textcolor{comment}{// discard the extra data until colorspace conversion}}
\DoxyCodeLine{3314         \textcolor{comment}{//}}
\DoxyCodeLine{3315         \textcolor{comment}{// img\_mcu\_x, img\_mcu\_y: <=17 bits; comp[i].h and .v are <=4 (checked earlier)}}
\DoxyCodeLine{3316         \textcolor{comment}{// so these muls can't overflow with 32-\/bit ints (which we require)}}
\DoxyCodeLine{3317         z-\/>img\_comp[i].w2 = z-\/>img\_mcu\_x * z-\/>img\_comp[i].h * 8;}
\DoxyCodeLine{3318         z-\/>img\_comp[i].h2 = z-\/>img\_mcu\_y * z-\/>img\_comp[i].v * 8;}
\DoxyCodeLine{3319         z-\/>img\_comp[i].coeff = 0;}
\DoxyCodeLine{3320         z-\/>img\_comp[i].raw\_coeff = 0;}
\DoxyCodeLine{3321         z-\/>img\_comp[i].linebuf = NULL;}
\DoxyCodeLine{3322         z-\/>img\_comp[i].raw\_data = stbi\_\_malloc\_mad2(z-\/>img\_comp[i].w2, z-\/>img\_comp[i].h2, 15);}
\DoxyCodeLine{3323         \textcolor{keywordflow}{if} (z-\/>img\_comp[i].raw\_data == NULL)}
\DoxyCodeLine{3324             \textcolor{keywordflow}{return} stbi\_\_free\_jpeg\_components(z, i + 1, stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}}));}
\DoxyCodeLine{3325         \textcolor{comment}{// align blocks for idct using mmx/sse}}
\DoxyCodeLine{3326         z-\/>img\_comp[i].data = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)(((\textcolor{keywordtype}{size\_t})z-\/>img\_comp[i].raw\_data + 15) \& \string~15);}
\DoxyCodeLine{3327         \textcolor{keywordflow}{if} (z-\/>progressive) \{}
\DoxyCodeLine{3328             \textcolor{comment}{// w2, h2 are multiples of 8 (see above)}}
\DoxyCodeLine{3329             z-\/>img\_comp[i].coeff\_w = z-\/>img\_comp[i].w2 / 8;}
\DoxyCodeLine{3330             z-\/>img\_comp[i].coeff\_h = z-\/>img\_comp[i].h2 / 8;}
\DoxyCodeLine{3331             z-\/>img\_comp[i].raw\_coeff = stbi\_\_malloc\_mad3(z-\/>img\_comp[i].w2, z-\/>img\_comp[i].h2, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{short}), 15);}
\DoxyCodeLine{3332             \textcolor{keywordflow}{if} (z-\/>img\_comp[i].raw\_coeff == NULL)}
\DoxyCodeLine{3333                 \textcolor{keywordflow}{return} stbi\_\_free\_jpeg\_components(z, i + 1, stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}}));}
\DoxyCodeLine{3334             z-\/>img\_comp[i].coeff = (\textcolor{keywordtype}{short}*)(((\textcolor{keywordtype}{size\_t})z-\/>img\_comp[i].raw\_coeff + 15) \& \string~15);}
\DoxyCodeLine{3335         \}}
\DoxyCodeLine{3336     \}}
\DoxyCodeLine{3337 }
\DoxyCodeLine{3338     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3339 \}}
\DoxyCodeLine{3340 }
\DoxyCodeLine{3341 \textcolor{comment}{// use comparisons since in some cases we handle more than one case (e.g. SOF)}}
\DoxyCodeLine{3342 \textcolor{preprocessor}{\#define stbi\_\_DNL(x)         ((x) == 0xdc)}}
\DoxyCodeLine{3343 \textcolor{preprocessor}{\#define stbi\_\_SOI(x)         ((x) == 0xd8)}}
\DoxyCodeLine{3344 \textcolor{preprocessor}{\#define stbi\_\_EOI(x)         ((x) == 0xd9)}}
\DoxyCodeLine{3345 \textcolor{preprocessor}{\#define stbi\_\_SOF(x)         ((x) == 0xc0 || (x) == 0xc1 || (x) == 0xc2)}}
\DoxyCodeLine{3346 \textcolor{preprocessor}{\#define stbi\_\_SOS(x)         ((x) == 0xda)}}
\DoxyCodeLine{3347 }
\DoxyCodeLine{3348 \textcolor{preprocessor}{\#define stbi\_\_SOF\_progressive(x)   ((x) == 0xc2)}}
\DoxyCodeLine{3349 }
\DoxyCodeLine{3350 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_decode\_jpeg\_header(stbi\_\_jpeg* z, \textcolor{keywordtype}{int} scan)}
\DoxyCodeLine{3351 \{}
\DoxyCodeLine{3352     \textcolor{keywordtype}{int} m;}
\DoxyCodeLine{3353     z-\/>jfif = 0;}
\DoxyCodeLine{3354     z-\/>app14\_color\_transform = -\/1; \textcolor{comment}{// valid values are 0,1,2}}
\DoxyCodeLine{3355     z-\/>marker = STBI\_\_MARKER\_none; \textcolor{comment}{// initialize cached marker to empty}}
\DoxyCodeLine{3356     m = stbi\_\_get\_marker(z);}
\DoxyCodeLine{3357     \textcolor{keywordflow}{if} (!stbi\_\_SOI(m)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}no SOI"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3358     \textcolor{keywordflow}{if} (scan == STBI\_\_SCAN\_type) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3359     m = stbi\_\_get\_marker(z);}
\DoxyCodeLine{3360     \textcolor{keywordflow}{while} (!stbi\_\_SOF(m)) \{}
\DoxyCodeLine{3361         \textcolor{keywordflow}{if} (!stbi\_\_process\_marker(z, m)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3362         m = stbi\_\_get\_marker(z);}
\DoxyCodeLine{3363         \textcolor{keywordflow}{while} (m == STBI\_\_MARKER\_none) \{}
\DoxyCodeLine{3364             \textcolor{comment}{// some files have extra padding after their blocks, so ok, we'll scan}}
\DoxyCodeLine{3365             \textcolor{keywordflow}{if} (stbi\_\_at\_eof(z-\/>s)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}no SOF"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3366             m = stbi\_\_get\_marker(z);}
\DoxyCodeLine{3367         \}}
\DoxyCodeLine{3368     \}}
\DoxyCodeLine{3369     z-\/>progressive = stbi\_\_SOF\_progressive(m);}
\DoxyCodeLine{3370     \textcolor{keywordflow}{if} (!stbi\_\_process\_frame\_header(z, scan)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3371     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3372 \}}
\DoxyCodeLine{3373 }
\DoxyCodeLine{3374 \textcolor{comment}{// decode image to YCbCr format}}
\DoxyCodeLine{3375 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_decode\_jpeg\_image(stbi\_\_jpeg* j)}
\DoxyCodeLine{3376 \{}
\DoxyCodeLine{3377     \textcolor{keywordtype}{int} m;}
\DoxyCodeLine{3378     \textcolor{keywordflow}{for} (m = 0; m < 4; m++) \{}
\DoxyCodeLine{3379         j-\/>img\_comp[m].raw\_data = NULL;}
\DoxyCodeLine{3380         j-\/>img\_comp[m].raw\_coeff = NULL;}
\DoxyCodeLine{3381     \}}
\DoxyCodeLine{3382     j-\/>restart\_interval = 0;}
\DoxyCodeLine{3383     \textcolor{keywordflow}{if} (!stbi\_\_decode\_jpeg\_header(j, STBI\_\_SCAN\_load)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3384     m = stbi\_\_get\_marker(j);}
\DoxyCodeLine{3385     \textcolor{keywordflow}{while} (!stbi\_\_EOI(m)) \{}
\DoxyCodeLine{3386         \textcolor{keywordflow}{if} (stbi\_\_SOS(m)) \{}
\DoxyCodeLine{3387             \textcolor{keywordflow}{if} (!stbi\_\_process\_scan\_header(j)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3388             \textcolor{keywordflow}{if} (!stbi\_\_parse\_entropy\_coded\_data(j)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3389             \textcolor{keywordflow}{if} (j-\/>marker == STBI\_\_MARKER\_none) \{}
\DoxyCodeLine{3390                 \textcolor{comment}{// handle 0s at the end of image data from IP Kamera 9060}}
\DoxyCodeLine{3391                 \textcolor{keywordflow}{while} (!stbi\_\_at\_eof(j-\/>s)) \{}
\DoxyCodeLine{3392                     \textcolor{keywordtype}{int} x = stbi\_\_get8(j-\/>s);}
\DoxyCodeLine{3393                     \textcolor{keywordflow}{if} (x == 255) \{}
\DoxyCodeLine{3394                         j-\/>marker = stbi\_\_get8(j-\/>s);}
\DoxyCodeLine{3395                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{3396                     \}}
\DoxyCodeLine{3397                 \}}
\DoxyCodeLine{3398                 \textcolor{comment}{// if we reach eof without hitting a marker, stbi\_\_get\_marker() below will fail and we'll eventually return 0}}
\DoxyCodeLine{3399             \}}
\DoxyCodeLine{3400         \}}
\DoxyCodeLine{3401         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (stbi\_\_DNL(m)) \{}
\DoxyCodeLine{3402             \textcolor{keywordtype}{int} Ld = stbi\_\_get16be(j-\/>s);}
\DoxyCodeLine{3403             stbi\_\_uint32 NL = stbi\_\_get16be(j-\/>s);}
\DoxyCodeLine{3404             \textcolor{keywordflow}{if} (Ld != 4) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DNL len"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3405             \textcolor{keywordflow}{if} (NL != j-\/>s-\/>img\_y) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad DNL height"{}}, \textcolor{stringliteral}{"{}Corrupt JPEG"{}});}
\DoxyCodeLine{3406         \}}
\DoxyCodeLine{3407         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3408             \textcolor{keywordflow}{if} (!stbi\_\_process\_marker(j, m)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{3409         \}}
\DoxyCodeLine{3410         m = stbi\_\_get\_marker(j);}
\DoxyCodeLine{3411     \}}
\DoxyCodeLine{3412     \textcolor{keywordflow}{if} (j-\/>progressive)}
\DoxyCodeLine{3413         stbi\_\_jpeg\_finish(j);}
\DoxyCodeLine{3414     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{3415 \}}
\DoxyCodeLine{3416 }
\DoxyCodeLine{3417 \textcolor{comment}{// static jfif-\/centered resampling (across block boundaries)}}
\DoxyCodeLine{3418 }
\DoxyCodeLine{3419 \textcolor{keyword}{typedef} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* (*resample\_row\_func)(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in0, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in1,}
\DoxyCodeLine{3420     \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs);}
\DoxyCodeLine{3421 }
\DoxyCodeLine{3422 \textcolor{preprocessor}{\#define stbi\_\_div4(x) ((stbi\_uc) ((x) >> 2))}}
\DoxyCodeLine{3423 }
\DoxyCodeLine{3424 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* resample\_row\_1(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs)}
\DoxyCodeLine{3425 \{}
\DoxyCodeLine{3426     STBI\_NOTUSED(out);}
\DoxyCodeLine{3427     STBI\_NOTUSED(in\_far);}
\DoxyCodeLine{3428     STBI\_NOTUSED(w);}
\DoxyCodeLine{3429     STBI\_NOTUSED(hs);}
\DoxyCodeLine{3430     \textcolor{keywordflow}{return} in\_near;}
\DoxyCodeLine{3431 \}}
\DoxyCodeLine{3432 }
\DoxyCodeLine{3433 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_resample\_row\_v\_2(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs)}
\DoxyCodeLine{3434 \{}
\DoxyCodeLine{3435     \textcolor{comment}{// need to generate two samples vertically for every one in input}}
\DoxyCodeLine{3436     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3437     STBI\_NOTUSED(hs);}
\DoxyCodeLine{3438     \textcolor{keywordflow}{for} (i = 0; i < w; ++i)}
\DoxyCodeLine{3439         out[i] = stbi\_\_div4(3 * in\_near[i] + in\_far[i] + 2);}
\DoxyCodeLine{3440     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3441 \}}
\DoxyCodeLine{3442 }
\DoxyCodeLine{3443 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_resample\_row\_h\_2(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs)}
\DoxyCodeLine{3444 \{}
\DoxyCodeLine{3445     \textcolor{comment}{// need to generate two samples horizontally for every one in input}}
\DoxyCodeLine{3446     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3447     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* input = in\_near;}
\DoxyCodeLine{3448 }
\DoxyCodeLine{3449     \textcolor{keywordflow}{if} (w == 1) \{}
\DoxyCodeLine{3450         \textcolor{comment}{// if only one sample, can't do any interpolation}}
\DoxyCodeLine{3451         out[0] = out[1] = input[0];}
\DoxyCodeLine{3452         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3453     \}}
\DoxyCodeLine{3454 }
\DoxyCodeLine{3455     out[0] = input[0];}
\DoxyCodeLine{3456     out[1] = stbi\_\_div4(input[0] * 3 + input[1] + 2);}
\DoxyCodeLine{3457     \textcolor{keywordflow}{for} (i = 1; i < w -\/ 1; ++i) \{}
\DoxyCodeLine{3458         \textcolor{keywordtype}{int} n = 3 * input[i] + 2;}
\DoxyCodeLine{3459         out[i * 2 + 0] = stbi\_\_div4(n + input[i -\/ 1]);}
\DoxyCodeLine{3460         out[i * 2 + 1] = stbi\_\_div4(n + input[i + 1]);}
\DoxyCodeLine{3461     \}}
\DoxyCodeLine{3462     out[i * 2 + 0] = stbi\_\_div4(input[w -\/ 2] * 3 + input[w -\/ 1] + 2);}
\DoxyCodeLine{3463     out[i * 2 + 1] = input[w -\/ 1];}
\DoxyCodeLine{3464 }
\DoxyCodeLine{3465     STBI\_NOTUSED(in\_far);}
\DoxyCodeLine{3466     STBI\_NOTUSED(hs);}
\DoxyCodeLine{3467 }
\DoxyCodeLine{3468     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3469 \}}
\DoxyCodeLine{3470 }
\DoxyCodeLine{3471 \textcolor{preprocessor}{\#define stbi\_\_div16(x) ((stbi\_uc) ((x) >> 4))}}
\DoxyCodeLine{3472 }
\DoxyCodeLine{3473 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_resample\_row\_hv\_2(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs)}
\DoxyCodeLine{3474 \{}
\DoxyCodeLine{3475     \textcolor{comment}{// need to generate 2x2 samples for every one in input}}
\DoxyCodeLine{3476     \textcolor{keywordtype}{int} i, t0, t1;}
\DoxyCodeLine{3477     \textcolor{keywordflow}{if} (w == 1) \{}
\DoxyCodeLine{3478         out[0] = out[1] = stbi\_\_div4(3 * in\_near[0] + in\_far[0] + 2);}
\DoxyCodeLine{3479         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3480     \}}
\DoxyCodeLine{3481 }
\DoxyCodeLine{3482     t1 = 3 * in\_near[0] + in\_far[0];}
\DoxyCodeLine{3483     out[0] = stbi\_\_div4(t1 + 2);}
\DoxyCodeLine{3484     \textcolor{keywordflow}{for} (i = 1; i < w; ++i) \{}
\DoxyCodeLine{3485         t0 = t1;}
\DoxyCodeLine{3486         t1 = 3 * in\_near[i] + in\_far[i];}
\DoxyCodeLine{3487         out[i * 2 -\/ 1] = stbi\_\_div16(3 * t0 + t1 + 8);}
\DoxyCodeLine{3488         out[i * 2] = stbi\_\_div16(3 * t1 + t0 + 8);}
\DoxyCodeLine{3489     \}}
\DoxyCodeLine{3490     out[w * 2 -\/ 1] = stbi\_\_div4(t1 + 2);}
\DoxyCodeLine{3491 }
\DoxyCodeLine{3492     STBI\_NOTUSED(hs);}
\DoxyCodeLine{3493 }
\DoxyCodeLine{3494     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3495 \}}
\DoxyCodeLine{3496 }
\DoxyCodeLine{3497 \textcolor{preprocessor}{\#if defined(STBI\_SSE2) || defined(STBI\_NEON)}}
\DoxyCodeLine{3498 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_resample\_row\_hv\_2\_simd(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs)}
\DoxyCodeLine{3499 \{}
\DoxyCodeLine{3500     \textcolor{comment}{// need to generate 2x2 samples for every one in input}}
\DoxyCodeLine{3501     \textcolor{keywordtype}{int} i = 0, t0, t1;}
\DoxyCodeLine{3502 }
\DoxyCodeLine{3503     \textcolor{keywordflow}{if} (w == 1) \{}
\DoxyCodeLine{3504         out[0] = out[1] = stbi\_\_div4(3 * in\_near[0] + in\_far[0] + 2);}
\DoxyCodeLine{3505         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3506     \}}
\DoxyCodeLine{3507 }
\DoxyCodeLine{3508     t1 = 3 * in\_near[0] + in\_far[0];}
\DoxyCodeLine{3509     \textcolor{comment}{// process groups of 8 pixels for as long as we can.}}
\DoxyCodeLine{3510     \textcolor{comment}{// note we can't handle the last pixel in a row in this loop}}
\DoxyCodeLine{3511     \textcolor{comment}{// because we need to handle the filter boundary conditions.}}
\DoxyCodeLine{3512     \textcolor{keywordflow}{for} (; i < ((w -\/ 1) \& \string~7); i += 8) \{}
\DoxyCodeLine{3513 \textcolor{preprocessor}{\#if defined(STBI\_SSE2)}}
\DoxyCodeLine{3514         \textcolor{comment}{// load and perform the vertical filtering pass}}
\DoxyCodeLine{3515         \textcolor{comment}{// this uses 3*x + y = 4*x + (y -\/ x)}}
\DoxyCodeLine{3516         \_\_m128i zero = \_mm\_setzero\_si128();}
\DoxyCodeLine{3517         \_\_m128i farb = \_mm\_loadl\_epi64((\_\_m128i*) (in\_far + i));}
\DoxyCodeLine{3518         \_\_m128i nearb = \_mm\_loadl\_epi64((\_\_m128i*) (in\_near + i));}
\DoxyCodeLine{3519         \_\_m128i farw = \_mm\_unpacklo\_epi8(farb, zero);}
\DoxyCodeLine{3520         \_\_m128i nearw = \_mm\_unpacklo\_epi8(nearb, zero);}
\DoxyCodeLine{3521         \_\_m128i diff = \_mm\_sub\_epi16(farw, nearw);}
\DoxyCodeLine{3522         \_\_m128i nears = \_mm\_slli\_epi16(nearw, 2);}
\DoxyCodeLine{3523         \_\_m128i curr = \_mm\_add\_epi16(nears, diff); \textcolor{comment}{// current row}}
\DoxyCodeLine{3524 }
\DoxyCodeLine{3525         \textcolor{comment}{// horizontal filter works the same based on shifted vers of current}}
\DoxyCodeLine{3526         \textcolor{comment}{// row. "{}prev"{} is current row shifted right by 1 pixel; we need to}}
\DoxyCodeLine{3527         \textcolor{comment}{// insert the previous pixel value (from t1).}}
\DoxyCodeLine{3528         \textcolor{comment}{// "{}next"{} is current row shifted left by 1 pixel, with first pixel}}
\DoxyCodeLine{3529         \textcolor{comment}{// of next block of 8 pixels added in.}}
\DoxyCodeLine{3530         \_\_m128i prv0 = \_mm\_slli\_si128(curr, 2);}
\DoxyCodeLine{3531         \_\_m128i nxt0 = \_mm\_srli\_si128(curr, 2);}
\DoxyCodeLine{3532         \_\_m128i prev = \_mm\_insert\_epi16(prv0, t1, 0);}
\DoxyCodeLine{3533         \_\_m128i next = \_mm\_insert\_epi16(nxt0, 3 * in\_near[i + 8] + in\_far[i + 8], 7);}
\DoxyCodeLine{3534 }
\DoxyCodeLine{3535         \textcolor{comment}{// horizontal filter, polyphase implementation since it's convenient:}}
\DoxyCodeLine{3536         \textcolor{comment}{// even pixels = 3*cur + prev = cur*4 + (prev -\/ cur)}}
\DoxyCodeLine{3537         \textcolor{comment}{// odd  pixels = 3*cur + next = cur*4 + (next -\/ cur)}}
\DoxyCodeLine{3538         \textcolor{comment}{// note the shared term.}}
\DoxyCodeLine{3539         \_\_m128i bias = \_mm\_set1\_epi16(8);}
\DoxyCodeLine{3540         \_\_m128i curs = \_mm\_slli\_epi16(curr, 2);}
\DoxyCodeLine{3541         \_\_m128i prvd = \_mm\_sub\_epi16(prev, curr);}
\DoxyCodeLine{3542         \_\_m128i nxtd = \_mm\_sub\_epi16(next, curr);}
\DoxyCodeLine{3543         \_\_m128i curb = \_mm\_add\_epi16(curs, bias);}
\DoxyCodeLine{3544         \_\_m128i even = \_mm\_add\_epi16(prvd, curb);}
\DoxyCodeLine{3545         \_\_m128i odd = \_mm\_add\_epi16(nxtd, curb);}
\DoxyCodeLine{3546 }
\DoxyCodeLine{3547         \textcolor{comment}{// interleave even and odd pixels, then undo scaling.}}
\DoxyCodeLine{3548         \_\_m128i int0 = \_mm\_unpacklo\_epi16(even, odd);}
\DoxyCodeLine{3549         \_\_m128i int1 = \_mm\_unpackhi\_epi16(even, odd);}
\DoxyCodeLine{3550         \_\_m128i de0 = \_mm\_srli\_epi16(int0, 4);}
\DoxyCodeLine{3551         \_\_m128i de1 = \_mm\_srli\_epi16(int1, 4);}
\DoxyCodeLine{3552 }
\DoxyCodeLine{3553         \textcolor{comment}{// pack and write output}}
\DoxyCodeLine{3554         \_\_m128i outv = \_mm\_packus\_epi16(de0, de1);}
\DoxyCodeLine{3555         \_mm\_storeu\_si128((\_\_m128i*) (out + i * 2), outv);}
\DoxyCodeLine{3556 \textcolor{preprocessor}{\#elif defined(STBI\_NEON)}}
\DoxyCodeLine{3557         \textcolor{comment}{// load and perform the vertical filtering pass}}
\DoxyCodeLine{3558         \textcolor{comment}{// this uses 3*x + y = 4*x + (y -\/ x)}}
\DoxyCodeLine{3559         uint8x8\_t farb = vld1\_u8(in\_far + i);}
\DoxyCodeLine{3560         uint8x8\_t nearb = vld1\_u8(in\_near + i);}
\DoxyCodeLine{3561         int16x8\_t diff = vreinterpretq\_s16\_u16(vsubl\_u8(farb, nearb));}
\DoxyCodeLine{3562         int16x8\_t nears = vreinterpretq\_s16\_u16(vshll\_n\_u8(nearb, 2));}
\DoxyCodeLine{3563         int16x8\_t curr = vaddq\_s16(nears, diff); \textcolor{comment}{// current row}}
\DoxyCodeLine{3564 }
\DoxyCodeLine{3565         \textcolor{comment}{// horizontal filter works the same based on shifted vers of current}}
\DoxyCodeLine{3566         \textcolor{comment}{// row. "{}prev"{} is current row shifted right by 1 pixel; we need to}}
\DoxyCodeLine{3567         \textcolor{comment}{// insert the previous pixel value (from t1).}}
\DoxyCodeLine{3568         \textcolor{comment}{// "{}next"{} is current row shifted left by 1 pixel, with first pixel}}
\DoxyCodeLine{3569         \textcolor{comment}{// of next block of 8 pixels added in.}}
\DoxyCodeLine{3570         int16x8\_t prv0 = vextq\_s16(curr, curr, 7);}
\DoxyCodeLine{3571         int16x8\_t nxt0 = vextq\_s16(curr, curr, 1);}
\DoxyCodeLine{3572         int16x8\_t prev = vsetq\_lane\_s16(t1, prv0, 0);}
\DoxyCodeLine{3573         int16x8\_t next = vsetq\_lane\_s16(3 * in\_near[i + 8] + in\_far[i + 8], nxt0, 7);}
\DoxyCodeLine{3574 }
\DoxyCodeLine{3575         \textcolor{comment}{// horizontal filter, polyphase implementation since it's convenient:}}
\DoxyCodeLine{3576         \textcolor{comment}{// even pixels = 3*cur + prev = cur*4 + (prev -\/ cur)}}
\DoxyCodeLine{3577         \textcolor{comment}{// odd  pixels = 3*cur + next = cur*4 + (next -\/ cur)}}
\DoxyCodeLine{3578         \textcolor{comment}{// note the shared term.}}
\DoxyCodeLine{3579         int16x8\_t curs = vshlq\_n\_s16(curr, 2);}
\DoxyCodeLine{3580         int16x8\_t prvd = vsubq\_s16(prev, curr);}
\DoxyCodeLine{3581         int16x8\_t nxtd = vsubq\_s16(next, curr);}
\DoxyCodeLine{3582         int16x8\_t even = vaddq\_s16(curs, prvd);}
\DoxyCodeLine{3583         int16x8\_t odd = vaddq\_s16(curs, nxtd);}
\DoxyCodeLine{3584 }
\DoxyCodeLine{3585         \textcolor{comment}{// undo scaling and round, then store with even/odd phases interleaved}}
\DoxyCodeLine{3586         uint8x8x2\_t o;}
\DoxyCodeLine{3587         o.val[0] = vqrshrun\_n\_s16(even, 4);}
\DoxyCodeLine{3588         o.val[1] = vqrshrun\_n\_s16(odd, 4);}
\DoxyCodeLine{3589         vst2\_u8(out + i * 2, o);}
\DoxyCodeLine{3590 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3591 }
\DoxyCodeLine{3592         \textcolor{comment}{// "{}previous"{} value for next iter}}
\DoxyCodeLine{3593         t1 = 3 * in\_near[i + 7] + in\_far[i + 7];}
\DoxyCodeLine{3594     \}}
\DoxyCodeLine{3595 }
\DoxyCodeLine{3596     t0 = t1;}
\DoxyCodeLine{3597     t1 = 3 * in\_near[i] + in\_far[i];}
\DoxyCodeLine{3598     out[i * 2] = stbi\_\_div16(3 * t1 + t0 + 8);}
\DoxyCodeLine{3599 }
\DoxyCodeLine{3600     \textcolor{keywordflow}{for} (++i; i < w; ++i) \{}
\DoxyCodeLine{3601         t0 = t1;}
\DoxyCodeLine{3602         t1 = 3 * in\_near[i] + in\_far[i];}
\DoxyCodeLine{3603         out[i * 2 -\/ 1] = stbi\_\_div16(3 * t0 + t1 + 8);}
\DoxyCodeLine{3604         out[i * 2] = stbi\_\_div16(3 * t1 + t0 + 8);}
\DoxyCodeLine{3605     \}}
\DoxyCodeLine{3606     out[w * 2 -\/ 1] = stbi\_\_div4(t1 + 2);}
\DoxyCodeLine{3607 }
\DoxyCodeLine{3608     STBI\_NOTUSED(hs);}
\DoxyCodeLine{3609 }
\DoxyCodeLine{3610     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3611 \}}
\DoxyCodeLine{3612 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3613 }
\DoxyCodeLine{3614 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_resample\_row\_generic(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_near, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in\_far, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} hs)}
\DoxyCodeLine{3615 \{}
\DoxyCodeLine{3616     \textcolor{comment}{// resample with nearest-\/neighbor}}
\DoxyCodeLine{3617     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{3618     STBI\_NOTUSED(in\_far);}
\DoxyCodeLine{3619     \textcolor{keywordflow}{for} (i = 0; i < w; ++i)}
\DoxyCodeLine{3620         \textcolor{keywordflow}{for} (j = 0; j < hs; ++j)}
\DoxyCodeLine{3621             out[i * hs + j] = in\_near[i];}
\DoxyCodeLine{3622     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3623 \}}
\DoxyCodeLine{3624 }
\DoxyCodeLine{3625 \textcolor{comment}{// this is a reduced-\/precision calculation of YCbCr-\/to-\/RGB introduced}}
\DoxyCodeLine{3626 \textcolor{comment}{// to make sure the code produces the same results in both SIMD and scalar}}
\DoxyCodeLine{3627 \textcolor{preprocessor}{\#define stbi\_\_float2fixed(x)  (((int) ((x) * 4096.0f + 0.5f)) << 8)}}
\DoxyCodeLine{3628 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_YCbCr\_to\_RGB\_row(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* y, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* pcb, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* pcr, \textcolor{keywordtype}{int} count, \textcolor{keywordtype}{int} step)}
\DoxyCodeLine{3629 \{}
\DoxyCodeLine{3630     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{3631     \textcolor{keywordflow}{for} (i = 0; i < count; ++i) \{}
\DoxyCodeLine{3632         \textcolor{keywordtype}{int} y\_fixed = (y[i] << 20) + (1 << 19); \textcolor{comment}{// rounding}}
\DoxyCodeLine{3633         \textcolor{keywordtype}{int} r, g, b;}
\DoxyCodeLine{3634         \textcolor{keywordtype}{int} cr = pcr[i] -\/ 128;}
\DoxyCodeLine{3635         \textcolor{keywordtype}{int} cb = pcb[i] -\/ 128;}
\DoxyCodeLine{3636         r = y\_fixed + cr * stbi\_\_float2fixed(1.40200f);}
\DoxyCodeLine{3637         g = y\_fixed + (cr * -\/stbi\_\_float2fixed(0.71414f)) + ((cb * -\/stbi\_\_float2fixed(0.34414f)) \& 0xffff0000);}
\DoxyCodeLine{3638         b = y\_fixed + cb * stbi\_\_float2fixed(1.77200f);}
\DoxyCodeLine{3639         r >>= 20;}
\DoxyCodeLine{3640         g >>= 20;}
\DoxyCodeLine{3641         b >>= 20;}
\DoxyCodeLine{3642         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})r > 255) \{ \textcolor{keywordflow}{if} (r < 0) r = 0; \textcolor{keywordflow}{else} r = 255; \}}
\DoxyCodeLine{3643         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})g > 255) \{ \textcolor{keywordflow}{if} (g < 0) g = 0; \textcolor{keywordflow}{else} g = 255; \}}
\DoxyCodeLine{3644         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})b > 255) \{ \textcolor{keywordflow}{if} (b < 0) b = 0; \textcolor{keywordflow}{else} b = 255; \}}
\DoxyCodeLine{3645         out[0] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})r;}
\DoxyCodeLine{3646         out[1] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})g;}
\DoxyCodeLine{3647         out[2] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})b;}
\DoxyCodeLine{3648         out[3] = 255;}
\DoxyCodeLine{3649         out += step;}
\DoxyCodeLine{3650     \}}
\DoxyCodeLine{3651 \}}
\DoxyCodeLine{3652 }
\DoxyCodeLine{3653 \textcolor{preprocessor}{\#if defined(STBI\_SSE2) || defined(STBI\_NEON)}}
\DoxyCodeLine{3654 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_YCbCr\_to\_RGB\_simd(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* y, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* pcb, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* pcr, \textcolor{keywordtype}{int} count, \textcolor{keywordtype}{int} step)}
\DoxyCodeLine{3655 \{}
\DoxyCodeLine{3656     \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{3657 }
\DoxyCodeLine{3658 \textcolor{preprocessor}{\#ifdef STBI\_SSE2}}
\DoxyCodeLine{3659     \textcolor{comment}{// step == 3 is pretty ugly on the final interleave, and i'm not convinced}}
\DoxyCodeLine{3660     \textcolor{comment}{// it's useful in practice (you wouldn't use it for textures, for example).}}
\DoxyCodeLine{3661     \textcolor{comment}{// so just accelerate step == 4 case.}}
\DoxyCodeLine{3662     \textcolor{keywordflow}{if} (step == 4) \{}
\DoxyCodeLine{3663         \textcolor{comment}{// this is a fairly straightforward implementation and not super-\/optimized.}}
\DoxyCodeLine{3664         \_\_m128i signflip = \_mm\_set1\_epi8(-\/0x80);}
\DoxyCodeLine{3665         \_\_m128i cr\_const0 = \_mm\_set1\_epi16((\textcolor{keywordtype}{short})(1.40200f * 4096.0f + 0.5f));}
\DoxyCodeLine{3666         \_\_m128i cr\_const1 = \_mm\_set1\_epi16(-\/(\textcolor{keywordtype}{short})(0.71414f * 4096.0f + 0.5f));}
\DoxyCodeLine{3667         \_\_m128i cb\_const0 = \_mm\_set1\_epi16(-\/(\textcolor{keywordtype}{short})(0.34414f * 4096.0f + 0.5f));}
\DoxyCodeLine{3668         \_\_m128i cb\_const1 = \_mm\_set1\_epi16((\textcolor{keywordtype}{short})(1.77200f * 4096.0f + 0.5f));}
\DoxyCodeLine{3669         \_\_m128i y\_bias = \_mm\_set1\_epi8((\textcolor{keywordtype}{char})(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char})128);}
\DoxyCodeLine{3670         \_\_m128i xw = \_mm\_set1\_epi16(255); \textcolor{comment}{// alpha channel}}
\DoxyCodeLine{3671 }
\DoxyCodeLine{3672         \textcolor{keywordflow}{for} (; i + 7 < count; i += 8) \{}
\DoxyCodeLine{3673             \textcolor{comment}{// load}}
\DoxyCodeLine{3674             \_\_m128i y\_bytes = \_mm\_loadl\_epi64((\_\_m128i*) (y + i));}
\DoxyCodeLine{3675             \_\_m128i cr\_bytes = \_mm\_loadl\_epi64((\_\_m128i*) (pcr + i));}
\DoxyCodeLine{3676             \_\_m128i cb\_bytes = \_mm\_loadl\_epi64((\_\_m128i*) (pcb + i));}
\DoxyCodeLine{3677             \_\_m128i cr\_biased = \_mm\_xor\_si128(cr\_bytes, signflip); \textcolor{comment}{// -\/128}}
\DoxyCodeLine{3678             \_\_m128i cb\_biased = \_mm\_xor\_si128(cb\_bytes, signflip); \textcolor{comment}{// -\/128}}
\DoxyCodeLine{3679 }
\DoxyCodeLine{3680             \textcolor{comment}{// unpack to short (and left-\/shift cr, cb by 8)}}
\DoxyCodeLine{3681             \_\_m128i yw = \_mm\_unpacklo\_epi8(y\_bias, y\_bytes);}
\DoxyCodeLine{3682             \_\_m128i crw = \_mm\_unpacklo\_epi8(\_mm\_setzero\_si128(), cr\_biased);}
\DoxyCodeLine{3683             \_\_m128i cbw = \_mm\_unpacklo\_epi8(\_mm\_setzero\_si128(), cb\_biased);}
\DoxyCodeLine{3684 }
\DoxyCodeLine{3685             \textcolor{comment}{// color transform}}
\DoxyCodeLine{3686             \_\_m128i yws = \_mm\_srli\_epi16(yw, 4);}
\DoxyCodeLine{3687             \_\_m128i cr0 = \_mm\_mulhi\_epi16(cr\_const0, crw);}
\DoxyCodeLine{3688             \_\_m128i cb0 = \_mm\_mulhi\_epi16(cb\_const0, cbw);}
\DoxyCodeLine{3689             \_\_m128i cb1 = \_mm\_mulhi\_epi16(cbw, cb\_const1);}
\DoxyCodeLine{3690             \_\_m128i cr1 = \_mm\_mulhi\_epi16(crw, cr\_const1);}
\DoxyCodeLine{3691             \_\_m128i rws = \_mm\_add\_epi16(cr0, yws);}
\DoxyCodeLine{3692             \_\_m128i gwt = \_mm\_add\_epi16(cb0, yws);}
\DoxyCodeLine{3693             \_\_m128i bws = \_mm\_add\_epi16(yws, cb1);}
\DoxyCodeLine{3694             \_\_m128i gws = \_mm\_add\_epi16(gwt, cr1);}
\DoxyCodeLine{3695 }
\DoxyCodeLine{3696             \textcolor{comment}{// descale}}
\DoxyCodeLine{3697             \_\_m128i rw = \_mm\_srai\_epi16(rws, 4);}
\DoxyCodeLine{3698             \_\_m128i bw = \_mm\_srai\_epi16(bws, 4);}
\DoxyCodeLine{3699             \_\_m128i gw = \_mm\_srai\_epi16(gws, 4);}
\DoxyCodeLine{3700 }
\DoxyCodeLine{3701             \textcolor{comment}{// back to byte, set up for transpose}}
\DoxyCodeLine{3702             \_\_m128i brb = \_mm\_packus\_epi16(rw, bw);}
\DoxyCodeLine{3703             \_\_m128i gxb = \_mm\_packus\_epi16(gw, xw);}
\DoxyCodeLine{3704 }
\DoxyCodeLine{3705             \textcolor{comment}{// transpose to interleave channels}}
\DoxyCodeLine{3706             \_\_m128i t0 = \_mm\_unpacklo\_epi8(brb, gxb);}
\DoxyCodeLine{3707             \_\_m128i t1 = \_mm\_unpackhi\_epi8(brb, gxb);}
\DoxyCodeLine{3708             \_\_m128i o0 = \_mm\_unpacklo\_epi16(t0, t1);}
\DoxyCodeLine{3709             \_\_m128i o1 = \_mm\_unpackhi\_epi16(t0, t1);}
\DoxyCodeLine{3710 }
\DoxyCodeLine{3711             \textcolor{comment}{// store}}
\DoxyCodeLine{3712             \_mm\_storeu\_si128((\_\_m128i*) (out + 0), o0);}
\DoxyCodeLine{3713             \_mm\_storeu\_si128((\_\_m128i*) (out + 16), o1);}
\DoxyCodeLine{3714             out += 32;}
\DoxyCodeLine{3715         \}}
\DoxyCodeLine{3716     \}}
\DoxyCodeLine{3717 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3718 }
\DoxyCodeLine{3719 \textcolor{preprocessor}{\#ifdef STBI\_NEON}}
\DoxyCodeLine{3720     \textcolor{comment}{// in this version, step=3 support would be easy to add. but is there demand?}}
\DoxyCodeLine{3721     \textcolor{keywordflow}{if} (step == 4) \{}
\DoxyCodeLine{3722         \textcolor{comment}{// this is a fairly straightforward implementation and not super-\/optimized.}}
\DoxyCodeLine{3723         uint8x8\_t signflip = vdup\_n\_u8(0x80);}
\DoxyCodeLine{3724         int16x8\_t cr\_const0 = vdupq\_n\_s16((\textcolor{keywordtype}{short})(1.40200f * 4096.0f + 0.5f));}
\DoxyCodeLine{3725         int16x8\_t cr\_const1 = vdupq\_n\_s16(-\/(\textcolor{keywordtype}{short})(0.71414f * 4096.0f + 0.5f));}
\DoxyCodeLine{3726         int16x8\_t cb\_const0 = vdupq\_n\_s16(-\/(\textcolor{keywordtype}{short})(0.34414f * 4096.0f + 0.5f));}
\DoxyCodeLine{3727         int16x8\_t cb\_const1 = vdupq\_n\_s16((\textcolor{keywordtype}{short})(1.77200f * 4096.0f + 0.5f));}
\DoxyCodeLine{3728 }
\DoxyCodeLine{3729         \textcolor{keywordflow}{for} (; i + 7 < count; i += 8) \{}
\DoxyCodeLine{3730             \textcolor{comment}{// load}}
\DoxyCodeLine{3731             uint8x8\_t y\_bytes = vld1\_u8(y + i);}
\DoxyCodeLine{3732             uint8x8\_t cr\_bytes = vld1\_u8(pcr + i);}
\DoxyCodeLine{3733             uint8x8\_t cb\_bytes = vld1\_u8(pcb + i);}
\DoxyCodeLine{3734             int8x8\_t cr\_biased = vreinterpret\_s8\_u8(vsub\_u8(cr\_bytes, signflip));}
\DoxyCodeLine{3735             int8x8\_t cb\_biased = vreinterpret\_s8\_u8(vsub\_u8(cb\_bytes, signflip));}
\DoxyCodeLine{3736 }
\DoxyCodeLine{3737             \textcolor{comment}{// expand to s16}}
\DoxyCodeLine{3738             int16x8\_t yws = vreinterpretq\_s16\_u16(vshll\_n\_u8(y\_bytes, 4));}
\DoxyCodeLine{3739             int16x8\_t crw = vshll\_n\_s8(cr\_biased, 7);}
\DoxyCodeLine{3740             int16x8\_t cbw = vshll\_n\_s8(cb\_biased, 7);}
\DoxyCodeLine{3741 }
\DoxyCodeLine{3742             \textcolor{comment}{// color transform}}
\DoxyCodeLine{3743             int16x8\_t cr0 = vqdmulhq\_s16(crw, cr\_const0);}
\DoxyCodeLine{3744             int16x8\_t cb0 = vqdmulhq\_s16(cbw, cb\_const0);}
\DoxyCodeLine{3745             int16x8\_t cr1 = vqdmulhq\_s16(crw, cr\_const1);}
\DoxyCodeLine{3746             int16x8\_t cb1 = vqdmulhq\_s16(cbw, cb\_const1);}
\DoxyCodeLine{3747             int16x8\_t rws = vaddq\_s16(yws, cr0);}
\DoxyCodeLine{3748             int16x8\_t gws = vaddq\_s16(vaddq\_s16(yws, cb0), cr1);}
\DoxyCodeLine{3749             int16x8\_t bws = vaddq\_s16(yws, cb1);}
\DoxyCodeLine{3750 }
\DoxyCodeLine{3751             \textcolor{comment}{// undo scaling, round, convert to byte}}
\DoxyCodeLine{3752             uint8x8x4\_t o;}
\DoxyCodeLine{3753             o.val[0] = vqrshrun\_n\_s16(rws, 4);}
\DoxyCodeLine{3754             o.val[1] = vqrshrun\_n\_s16(gws, 4);}
\DoxyCodeLine{3755             o.val[2] = vqrshrun\_n\_s16(bws, 4);}
\DoxyCodeLine{3756             o.val[3] = vdup\_n\_u8(255);}
\DoxyCodeLine{3757 }
\DoxyCodeLine{3758             \textcolor{comment}{// store, interleaving r/g/b/a}}
\DoxyCodeLine{3759             vst4\_u8(out, o);}
\DoxyCodeLine{3760             out += 8 * 4;}
\DoxyCodeLine{3761         \}}
\DoxyCodeLine{3762     \}}
\DoxyCodeLine{3763 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3764 }
\DoxyCodeLine{3765     \textcolor{keywordflow}{for} (; i < count; ++i) \{}
\DoxyCodeLine{3766         \textcolor{keywordtype}{int} y\_fixed = (y[i] << 20) + (1 << 19); \textcolor{comment}{// rounding}}
\DoxyCodeLine{3767         \textcolor{keywordtype}{int} r, g, b;}
\DoxyCodeLine{3768         \textcolor{keywordtype}{int} cr = pcr[i] -\/ 128;}
\DoxyCodeLine{3769         \textcolor{keywordtype}{int} cb = pcb[i] -\/ 128;}
\DoxyCodeLine{3770         r = y\_fixed + cr * stbi\_\_float2fixed(1.40200f);}
\DoxyCodeLine{3771         g = y\_fixed + cr * -\/stbi\_\_float2fixed(0.71414f) + ((cb * -\/stbi\_\_float2fixed(0.34414f)) \& 0xffff0000);}
\DoxyCodeLine{3772         b = y\_fixed + cb * stbi\_\_float2fixed(1.77200f);}
\DoxyCodeLine{3773         r >>= 20;}
\DoxyCodeLine{3774         g >>= 20;}
\DoxyCodeLine{3775         b >>= 20;}
\DoxyCodeLine{3776         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})r > 255) \{ \textcolor{keywordflow}{if} (r < 0) r = 0; \textcolor{keywordflow}{else} r = 255; \}}
\DoxyCodeLine{3777         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})g > 255) \{ \textcolor{keywordflow}{if} (g < 0) g = 0; \textcolor{keywordflow}{else} g = 255; \}}
\DoxyCodeLine{3778         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})b > 255) \{ \textcolor{keywordflow}{if} (b < 0) b = 0; \textcolor{keywordflow}{else} b = 255; \}}
\DoxyCodeLine{3779         out[0] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})r;}
\DoxyCodeLine{3780         out[1] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})g;}
\DoxyCodeLine{3781         out[2] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})b;}
\DoxyCodeLine{3782         out[3] = 255;}
\DoxyCodeLine{3783         out += step;}
\DoxyCodeLine{3784     \}}
\DoxyCodeLine{3785 \}}
\DoxyCodeLine{3786 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3787 }
\DoxyCodeLine{3788 \textcolor{comment}{// set up the kernels}}
\DoxyCodeLine{3789 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_setup\_jpeg(stbi\_\_jpeg* j)}
\DoxyCodeLine{3790 \{}
\DoxyCodeLine{3791     j-\/>idct\_block\_kernel = stbi\_\_idct\_block;}
\DoxyCodeLine{3792     j-\/>YCbCr\_to\_RGB\_kernel = stbi\_\_YCbCr\_to\_RGB\_row;}
\DoxyCodeLine{3793     j-\/>resample\_row\_hv\_2\_kernel = stbi\_\_resample\_row\_hv\_2;}
\DoxyCodeLine{3794 }
\DoxyCodeLine{3795 \textcolor{preprocessor}{\#ifdef STBI\_SSE2}}
\DoxyCodeLine{3796     \textcolor{keywordflow}{if} (stbi\_\_sse2\_available()) \{}
\DoxyCodeLine{3797         j-\/>idct\_block\_kernel = stbi\_\_idct\_simd;}
\DoxyCodeLine{3798         j-\/>YCbCr\_to\_RGB\_kernel = stbi\_\_YCbCr\_to\_RGB\_simd;}
\DoxyCodeLine{3799         j-\/>resample\_row\_hv\_2\_kernel = stbi\_\_resample\_row\_hv\_2\_simd;}
\DoxyCodeLine{3800     \}}
\DoxyCodeLine{3801 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3802 }
\DoxyCodeLine{3803 \textcolor{preprocessor}{\#ifdef STBI\_NEON}}
\DoxyCodeLine{3804     j-\/>idct\_block\_kernel = stbi\_\_idct\_simd;}
\DoxyCodeLine{3805     j-\/>YCbCr\_to\_RGB\_kernel = stbi\_\_YCbCr\_to\_RGB\_simd;}
\DoxyCodeLine{3806     j-\/>resample\_row\_hv\_2\_kernel = stbi\_\_resample\_row\_hv\_2\_simd;}
\DoxyCodeLine{3807 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3808 \}}
\DoxyCodeLine{3809 }
\DoxyCodeLine{3810 \textcolor{comment}{// clean up the temporary component buffers}}
\DoxyCodeLine{3811 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_cleanup\_jpeg(stbi\_\_jpeg* j)}
\DoxyCodeLine{3812 \{}
\DoxyCodeLine{3813     stbi\_\_free\_jpeg\_components(j, j-\/>s-\/>img\_n, 0);}
\DoxyCodeLine{3814 \}}
\DoxyCodeLine{3815 }
\DoxyCodeLine{3816 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{3817 \{}
\DoxyCodeLine{3818     resample\_row\_func resample;}
\DoxyCodeLine{3819     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* line0, * line1;}
\DoxyCodeLine{3820     \textcolor{keywordtype}{int} hs, vs;   \textcolor{comment}{// expansion factor in each axis}}
\DoxyCodeLine{3821     \textcolor{keywordtype}{int} w\_lores; \textcolor{comment}{// horizontal pixels pre-\/expansion}}
\DoxyCodeLine{3822     \textcolor{keywordtype}{int} ystep;   \textcolor{comment}{// how far through vertical expansion we are}}
\DoxyCodeLine{3823     \textcolor{keywordtype}{int} ypos;    \textcolor{comment}{// which pre-\/expansion row we're on}}
\DoxyCodeLine{3824 \} stbi\_\_resample;}
\DoxyCodeLine{3825 }
\DoxyCodeLine{3826 \textcolor{comment}{// fast 0..255 * 0..255 => 0..255 rounded multiplication}}
\DoxyCodeLine{3827 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_blinn\_8x8(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} x, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} y)}
\DoxyCodeLine{3828 \{}
\DoxyCodeLine{3829     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} t = x * y + 128;}
\DoxyCodeLine{3830     \textcolor{keywordflow}{return} (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})((t + (t >> 8)) >> 8);}
\DoxyCodeLine{3831 \}}
\DoxyCodeLine{3832 }
\DoxyCodeLine{3833 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* load\_jpeg\_image(stbi\_\_jpeg* z, \textcolor{keywordtype}{int}* out\_x, \textcolor{keywordtype}{int}* out\_y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{3834 \{}
\DoxyCodeLine{3835     \textcolor{keywordtype}{int} n, decode\_n, is\_rgb;}
\DoxyCodeLine{3836     z-\/>s-\/>img\_n = 0; \textcolor{comment}{// make stbi\_\_cleanup\_jpeg safe}}
\DoxyCodeLine{3837 }
\DoxyCodeLine{3838     \textcolor{comment}{// validate req\_comp}}
\DoxyCodeLine{3839     \textcolor{keywordflow}{if} (req\_comp < 0 || req\_comp > 4) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad req\_comp"{}}, \textcolor{stringliteral}{"{}Internal error"{}});}
\DoxyCodeLine{3840 }
\DoxyCodeLine{3841     \textcolor{comment}{// load a jpeg image from whichever source, but leave in YCbCr format}}
\DoxyCodeLine{3842     \textcolor{keywordflow}{if} (!stbi\_\_decode\_jpeg\_image(z)) \{ stbi\_\_cleanup\_jpeg(z); \textcolor{keywordflow}{return} NULL; \}}
\DoxyCodeLine{3843 }
\DoxyCodeLine{3844     \textcolor{comment}{// determine actual number of components to generate}}
\DoxyCodeLine{3845     n = req\_comp ? req\_comp : z-\/>s-\/>img\_n >= 3 ? 3 : 1;}
\DoxyCodeLine{3846 }
\DoxyCodeLine{3847     is\_rgb = z-\/>s-\/>img\_n == 3 \&\& (z-\/>rgb == 3 || (z-\/>app14\_color\_transform == 0 \&\& !z-\/>jfif));}
\DoxyCodeLine{3848 }
\DoxyCodeLine{3849     \textcolor{keywordflow}{if} (z-\/>s-\/>img\_n == 3 \&\& n < 3 \&\& !is\_rgb)}
\DoxyCodeLine{3850         decode\_n = 1;}
\DoxyCodeLine{3851     \textcolor{keywordflow}{else}}
\DoxyCodeLine{3852         decode\_n = z-\/>s-\/>img\_n;}
\DoxyCodeLine{3853 }
\DoxyCodeLine{3854     \textcolor{comment}{// nothing to do if no components requested; check this now to avoid}}
\DoxyCodeLine{3855     \textcolor{comment}{// accessing uninitialized coutput[0] later}}
\DoxyCodeLine{3856     \textcolor{keywordflow}{if} (decode\_n <= 0) \{ stbi\_\_cleanup\_jpeg(z); \textcolor{keywordflow}{return} NULL; \}}
\DoxyCodeLine{3857 }
\DoxyCodeLine{3858     \textcolor{comment}{// resample and color-\/convert}}
\DoxyCodeLine{3859     \{}
\DoxyCodeLine{3860         \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{3861         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{3862         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* output;}
\DoxyCodeLine{3863         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* coutput[4] = \{ NULL, NULL, NULL, NULL \};}
\DoxyCodeLine{3864 }
\DoxyCodeLine{3865         stbi\_\_resample res\_comp[4];}
\DoxyCodeLine{3866 }
\DoxyCodeLine{3867         \textcolor{keywordflow}{for} (k = 0; k < decode\_n; ++k) \{}
\DoxyCodeLine{3868             stbi\_\_resample* r = \&res\_comp[k];}
\DoxyCodeLine{3869 }
\DoxyCodeLine{3870             \textcolor{comment}{// allocate line buffer big enough for upsampling off the edges}}
\DoxyCodeLine{3871             \textcolor{comment}{// with upsample factor of 4}}
\DoxyCodeLine{3872             z-\/>img\_comp[k].linebuf = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(z-\/>s-\/>img\_x + 3);}
\DoxyCodeLine{3873             \textcolor{keywordflow}{if} (!z-\/>img\_comp[k].linebuf) \{ stbi\_\_cleanup\_jpeg(z); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}}); \}}
\DoxyCodeLine{3874 }
\DoxyCodeLine{3875             r-\/>hs = z-\/>img\_h\_max / z-\/>img\_comp[k].h;}
\DoxyCodeLine{3876             r-\/>vs = z-\/>img\_v\_max / z-\/>img\_comp[k].v;}
\DoxyCodeLine{3877             r-\/>ystep = r-\/>vs >> 1;}
\DoxyCodeLine{3878             r-\/>w\_lores = (z-\/>s-\/>img\_x + r-\/>hs -\/ 1) / r-\/>hs;}
\DoxyCodeLine{3879             r-\/>ypos = 0;}
\DoxyCodeLine{3880             r-\/>line0 = r-\/>line1 = z-\/>img\_comp[k].data;}
\DoxyCodeLine{3881 }
\DoxyCodeLine{3882             if (r-\/>hs == 1 \&\& r-\/>vs == 1) r-\/>resample = resample\_row\_1;}
\DoxyCodeLine{3883             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r-\/>hs == 1 \&\& r-\/>vs == 2) r-\/>resample = stbi\_\_resample\_row\_v\_2;}
\DoxyCodeLine{3884             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r-\/>hs == 2 \&\& r-\/>vs == 1) r-\/>resample = stbi\_\_resample\_row\_h\_2;}
\DoxyCodeLine{3885             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r-\/>hs == 2 \&\& r-\/>vs == 2) r-\/>resample = z-\/>resample\_row\_hv\_2\_kernel;}
\DoxyCodeLine{3886             \textcolor{keywordflow}{else}                               r-\/>resample = stbi\_\_resample\_row\_generic;}
\DoxyCodeLine{3887         \}}
\DoxyCodeLine{3888 }
\DoxyCodeLine{3889         \textcolor{comment}{// can't error after this so, this is safe}}
\DoxyCodeLine{3890         output = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(n, z-\/>s-\/>img\_x, z-\/>s-\/>img\_y, 1);}
\DoxyCodeLine{3891         \textcolor{keywordflow}{if} (!output) \{ stbi\_\_cleanup\_jpeg(z); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}}); \}}
\DoxyCodeLine{3892 }
\DoxyCodeLine{3893         \textcolor{comment}{// now go ahead and resample}}
\DoxyCodeLine{3894         \textcolor{keywordflow}{for} (j = 0; j < z-\/>s-\/>img\_y; ++j) \{}
\DoxyCodeLine{3895             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out = output + n * z-\/>s-\/>img\_x * j;}
\DoxyCodeLine{3896             \textcolor{keywordflow}{for} (k = 0; k < decode\_n; ++k) \{}
\DoxyCodeLine{3897                 stbi\_\_resample* r = \&res\_comp[k];}
\DoxyCodeLine{3898                 \textcolor{keywordtype}{int} y\_bot = r-\/>ystep >= (r-\/>vs >> 1);}
\DoxyCodeLine{3899                 coutput[k] = r-\/>resample(z-\/>img\_comp[k].linebuf,}
\DoxyCodeLine{3900                     y\_bot ? r-\/>line1 : r-\/>line0,}
\DoxyCodeLine{3901                     y\_bot ? r-\/>line0 : r-\/>line1,}
\DoxyCodeLine{3902                     r-\/>w\_lores, r-\/>hs);}
\DoxyCodeLine{3903                 \textcolor{keywordflow}{if} (++r-\/>ystep >= r-\/>vs) \{}
\DoxyCodeLine{3904                     r-\/>ystep = 0;}
\DoxyCodeLine{3905                     r-\/>line0 = r-\/>line1;}
\DoxyCodeLine{3906                     \textcolor{keywordflow}{if} (++r-\/>ypos < z-\/>img\_comp[k].y)}
\DoxyCodeLine{3907                         r-\/>line1 += z-\/>img\_comp[k].w2;}
\DoxyCodeLine{3908                 \}}
\DoxyCodeLine{3909             \}}
\DoxyCodeLine{3910             \textcolor{keywordflow}{if} (n >= 3) \{}
\DoxyCodeLine{3911                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* y = coutput[0];}
\DoxyCodeLine{3912                 \textcolor{keywordflow}{if} (z-\/>s-\/>img\_n == 3) \{}
\DoxyCodeLine{3913                     \textcolor{keywordflow}{if} (is\_rgb) \{}
\DoxyCodeLine{3914                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{}
\DoxyCodeLine{3915                             out[0] = y[i];}
\DoxyCodeLine{3916                             out[1] = coutput[1][i];}
\DoxyCodeLine{3917                             out[2] = coutput[2][i];}
\DoxyCodeLine{3918                             out[3] = 255;}
\DoxyCodeLine{3919                             out += n;}
\DoxyCodeLine{3920                         \}}
\DoxyCodeLine{3921                     \}}
\DoxyCodeLine{3922                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3923                         z-\/>YCbCr\_to\_RGB\_kernel(out, y, coutput[1], coutput[2], z-\/>s-\/>img\_x, n);}
\DoxyCodeLine{3924                     \}}
\DoxyCodeLine{3925                 \}}
\DoxyCodeLine{3926                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (z-\/>s-\/>img\_n == 4) \{}
\DoxyCodeLine{3927                     \textcolor{keywordflow}{if} (z-\/>app14\_color\_transform == 0) \{ \textcolor{comment}{// CMYK}}
\DoxyCodeLine{3928                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{}
\DoxyCodeLine{3929                             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} m = coutput[3][i];}
\DoxyCodeLine{3930                             out[0] = stbi\_\_blinn\_8x8(coutput[0][i], m);}
\DoxyCodeLine{3931                             out[1] = stbi\_\_blinn\_8x8(coutput[1][i], m);}
\DoxyCodeLine{3932                             out[2] = stbi\_\_blinn\_8x8(coutput[2][i], m);}
\DoxyCodeLine{3933                             out[3] = 255;}
\DoxyCodeLine{3934                             out += n;}
\DoxyCodeLine{3935                         \}}
\DoxyCodeLine{3936                     \}}
\DoxyCodeLine{3937                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (z-\/>app14\_color\_transform == 2) \{ \textcolor{comment}{// YCCK}}
\DoxyCodeLine{3938                         z-\/>YCbCr\_to\_RGB\_kernel(out, y, coutput[1], coutput[2], z-\/>s-\/>img\_x, n);}
\DoxyCodeLine{3939                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{}
\DoxyCodeLine{3940                             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} m = coutput[3][i];}
\DoxyCodeLine{3941                             out[0] = stbi\_\_blinn\_8x8(255 -\/ out[0], m);}
\DoxyCodeLine{3942                             out[1] = stbi\_\_blinn\_8x8(255 -\/ out[1], m);}
\DoxyCodeLine{3943                             out[2] = stbi\_\_blinn\_8x8(255 -\/ out[2], m);}
\DoxyCodeLine{3944                             out += n;}
\DoxyCodeLine{3945                         \}}
\DoxyCodeLine{3946                     \}}
\DoxyCodeLine{3947                     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// YCbCr + alpha?  Ignore the fourth channel for now}}
\DoxyCodeLine{3948                         z-\/>YCbCr\_to\_RGB\_kernel(out, y, coutput[1], coutput[2], z-\/>s-\/>img\_x, n);}
\DoxyCodeLine{3949                     \}}
\DoxyCodeLine{3950                 \}}
\DoxyCodeLine{3951                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{3952                     \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{}
\DoxyCodeLine{3953                         out[0] = out[1] = out[2] = y[i];}
\DoxyCodeLine{3954                         out[3] = 255; \textcolor{comment}{// not used if n==3}}
\DoxyCodeLine{3955                         out += n;}
\DoxyCodeLine{3956                     \}}
\DoxyCodeLine{3957             \}}
\DoxyCodeLine{3958             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3959                 \textcolor{keywordflow}{if} (is\_rgb) \{}
\DoxyCodeLine{3960                     \textcolor{keywordflow}{if} (n == 1)}
\DoxyCodeLine{3961                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i)}
\DoxyCodeLine{3962                             *out++ = stbi\_\_compute\_y(coutput[0][i], coutput[1][i], coutput[2][i]);}
\DoxyCodeLine{3963                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3964                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i, out += 2) \{}
\DoxyCodeLine{3965                             out[0] = stbi\_\_compute\_y(coutput[0][i], coutput[1][i], coutput[2][i]);}
\DoxyCodeLine{3966                             out[1] = 255;}
\DoxyCodeLine{3967                         \}}
\DoxyCodeLine{3968                     \}}
\DoxyCodeLine{3969                 \}}
\DoxyCodeLine{3970                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (z-\/>s-\/>img\_n == 4 \&\& z-\/>app14\_color\_transform == 0) \{}
\DoxyCodeLine{3971                     \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{}
\DoxyCodeLine{3972                         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} m = coutput[3][i];}
\DoxyCodeLine{3973                         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} r = stbi\_\_blinn\_8x8(coutput[0][i], m);}
\DoxyCodeLine{3974                         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} g = stbi\_\_blinn\_8x8(coutput[1][i], m);}
\DoxyCodeLine{3975                         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} b = stbi\_\_blinn\_8x8(coutput[2][i], m);}
\DoxyCodeLine{3976                         out[0] = stbi\_\_compute\_y(r, g, b);}
\DoxyCodeLine{3977                         out[1] = 255;}
\DoxyCodeLine{3978                         out += n;}
\DoxyCodeLine{3979                     \}}
\DoxyCodeLine{3980                 \}}
\DoxyCodeLine{3981                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (z-\/>s-\/>img\_n == 4 \&\& z-\/>app14\_color\_transform == 2) \{}
\DoxyCodeLine{3982                     \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{}
\DoxyCodeLine{3983                         out[0] = stbi\_\_blinn\_8x8(255 -\/ coutput[0][i], coutput[3][i]);}
\DoxyCodeLine{3984                         out[1] = 255;}
\DoxyCodeLine{3985                         out += n;}
\DoxyCodeLine{3986                     \}}
\DoxyCodeLine{3987                 \}}
\DoxyCodeLine{3988                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3989                     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* y = coutput[0];}
\DoxyCodeLine{3990                     \textcolor{keywordflow}{if} (n == 1)}
\DoxyCodeLine{3991                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) out[i] = y[i];}
\DoxyCodeLine{3992                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{3993                         \textcolor{keywordflow}{for} (i = 0; i < z-\/>s-\/>img\_x; ++i) \{ *out++ = y[i]; *out++ = 255; \}}
\DoxyCodeLine{3994                 \}}
\DoxyCodeLine{3995             \}}
\DoxyCodeLine{3996         \}}
\DoxyCodeLine{3997         stbi\_\_cleanup\_jpeg(z);}
\DoxyCodeLine{3998         *out\_x = z-\/>s-\/>img\_x;}
\DoxyCodeLine{3999         *out\_y = z-\/>s-\/>img\_y;}
\DoxyCodeLine{4000         \textcolor{keywordflow}{if} (comp) *comp = z-\/>s-\/>img\_n >= 3 ? 3 : 1; \textcolor{comment}{// report original components, not output}}
\DoxyCodeLine{4001         \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{4002     \}}
\DoxyCodeLine{4003 \}}
\DoxyCodeLine{4004 }
\DoxyCodeLine{4005 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_jpeg\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{4006 \{}
\DoxyCodeLine{4007     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* result;}
\DoxyCodeLine{4008     stbi\_\_jpeg* j = (stbi\_\_jpeg*)stbi\_\_malloc(\textcolor{keyword}{sizeof}(stbi\_\_jpeg));}
\DoxyCodeLine{4009     \textcolor{keywordflow}{if} (!j) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4010     STBI\_NOTUSED(ri);}
\DoxyCodeLine{4011     j-\/>s = s;}
\DoxyCodeLine{4012     stbi\_\_setup\_jpeg(j);}
\DoxyCodeLine{4013     result = load\_jpeg\_image(j, x, y, comp, req\_comp);}
\DoxyCodeLine{4014     STBI\_FREE(j);}
\DoxyCodeLine{4015     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{4016 \}}
\DoxyCodeLine{4017 }
\DoxyCodeLine{4018 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_test(stbi\_\_context* s)}
\DoxyCodeLine{4019 \{}
\DoxyCodeLine{4020     \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{4021     stbi\_\_jpeg* j = (stbi\_\_jpeg*)stbi\_\_malloc(\textcolor{keyword}{sizeof}(stbi\_\_jpeg));}
\DoxyCodeLine{4022     \textcolor{keywordflow}{if} (!j) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4023     j-\/>s = s;}
\DoxyCodeLine{4024     stbi\_\_setup\_jpeg(j);}
\DoxyCodeLine{4025     r = stbi\_\_decode\_jpeg\_header(j, STBI\_\_SCAN\_type);}
\DoxyCodeLine{4026     stbi\_\_rewind(s);}
\DoxyCodeLine{4027     STBI\_FREE(j);}
\DoxyCodeLine{4028     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{4029 \}}
\DoxyCodeLine{4030 }
\DoxyCodeLine{4031 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_info\_raw(stbi\_\_jpeg* j, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{4032 \{}
\DoxyCodeLine{4033     \textcolor{keywordflow}{if} (!stbi\_\_decode\_jpeg\_header(j, STBI\_\_SCAN\_header)) \{}
\DoxyCodeLine{4034         stbi\_\_rewind(j-\/>s);}
\DoxyCodeLine{4035         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4036     \}}
\DoxyCodeLine{4037     \textcolor{keywordflow}{if} (x) *x = j-\/>s-\/>img\_x;}
\DoxyCodeLine{4038     \textcolor{keywordflow}{if} (y) *y = j-\/>s-\/>img\_y;}
\DoxyCodeLine{4039     \textcolor{keywordflow}{if} (comp) *comp = j-\/>s-\/>img\_n >= 3 ? 3 : 1;}
\DoxyCodeLine{4040     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4041 \}}
\DoxyCodeLine{4042 }
\DoxyCodeLine{4043 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_jpeg\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{4044 \{}
\DoxyCodeLine{4045     \textcolor{keywordtype}{int} result;}
\DoxyCodeLine{4046     stbi\_\_jpeg* j = (stbi\_\_jpeg*)(stbi\_\_malloc(\textcolor{keyword}{sizeof}(stbi\_\_jpeg)));}
\DoxyCodeLine{4047     \textcolor{keywordflow}{if} (!j) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4048     j-\/>s = s;}
\DoxyCodeLine{4049     result = stbi\_\_jpeg\_info\_raw(j, x, y, comp);}
\DoxyCodeLine{4050     STBI\_FREE(j);}
\DoxyCodeLine{4051     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{4052 \}}
\DoxyCodeLine{4053 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4054 }
\DoxyCodeLine{4055 \textcolor{comment}{// public domain zlib decode    v0.2  Sean Barrett 2006-\/11-\/18}}
\DoxyCodeLine{4056 \textcolor{comment}{//    simple implementation}}
\DoxyCodeLine{4057 \textcolor{comment}{//      -\/ all input must be provided in an upfront buffer}}
\DoxyCodeLine{4058 \textcolor{comment}{//      -\/ all output is written to a single output buffer (can malloc/realloc)}}
\DoxyCodeLine{4059 \textcolor{comment}{//    performance}}
\DoxyCodeLine{4060 \textcolor{comment}{//      -\/ fast huffman}}
\DoxyCodeLine{4061 }
\DoxyCodeLine{4062 \textcolor{preprocessor}{\#ifndef STBI\_NO\_ZLIB}}
\DoxyCodeLine{4063 }
\DoxyCodeLine{4064 \textcolor{comment}{// fast-\/way is faster to check than jpeg huffman, but slow way is slower}}
\DoxyCodeLine{4065 \textcolor{preprocessor}{\#define STBI\_\_ZFAST\_BITS  9 }\textcolor{comment}{// accelerate all cases in default tables}}
\DoxyCodeLine{4066 \textcolor{preprocessor}{\#define STBI\_\_ZFAST\_MASK  ((1 << STBI\_\_ZFAST\_BITS) -\/ 1)}}
\DoxyCodeLine{4067 \textcolor{preprocessor}{\#define STBI\_\_ZNSYMS 288 }\textcolor{comment}{// number of symbols in literal/length alphabet}}
\DoxyCodeLine{4068 }
\DoxyCodeLine{4069 \textcolor{comment}{// zlib-\/style huffman encoding}}
\DoxyCodeLine{4070 \textcolor{comment}{// (jpegs packs from left, zlib from right, so can't share code)}}
\DoxyCodeLine{4071 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{4072 \{}
\DoxyCodeLine{4073     stbi\_\_uint16 fast[1 << STBI\_\_ZFAST\_BITS];}
\DoxyCodeLine{4074     stbi\_\_uint16 firstcode[16];}
\DoxyCodeLine{4075     \textcolor{keywordtype}{int} maxcode[17];}
\DoxyCodeLine{4076     stbi\_\_uint16 firstsymbol[16];}
\DoxyCodeLine{4077     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}  size[STBI\_\_ZNSYMS];}
\DoxyCodeLine{4078     stbi\_\_uint16 \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}}[STBI\_\_ZNSYMS];}
\DoxyCodeLine{4079 \} stbi\_\_zhuffman;}
\DoxyCodeLine{4080 }
\DoxyCodeLine{4081 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bitreverse16(\textcolor{keywordtype}{int} n)}
\DoxyCodeLine{4082 \{}
\DoxyCodeLine{4083     n = ((n \& 0xAAAA) >> 1) | ((n \& 0x5555) << 1);}
\DoxyCodeLine{4084     n = ((n \& 0xCCCC) >> 2) | ((n \& 0x3333) << 2);}
\DoxyCodeLine{4085     n = ((n \& 0xF0F0) >> 4) | ((n \& 0x0F0F) << 4);}
\DoxyCodeLine{4086     n = ((n \& 0xFF00) >> 8) | ((n \& 0x00FF) << 8);}
\DoxyCodeLine{4087     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{4088 \}}
\DoxyCodeLine{4089 }
\DoxyCodeLine{4090 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bit\_reverse(\textcolor{keywordtype}{int} v, \textcolor{keywordtype}{int} bits)}
\DoxyCodeLine{4091 \{}
\DoxyCodeLine{4092     STBI\_ASSERT(bits <= 16);}
\DoxyCodeLine{4093     \textcolor{comment}{// to bit reverse n bits, reverse 16 and shift}}
\DoxyCodeLine{4094     \textcolor{comment}{// e.g. 11 bits, bit reverse and shift away 5}}
\DoxyCodeLine{4095     \textcolor{keywordflow}{return} stbi\_\_bitreverse16(v) >> (16 -\/ bits);}
\DoxyCodeLine{4096 \}}
\DoxyCodeLine{4097 }
\DoxyCodeLine{4098 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_zbuild\_huffman(stbi\_\_zhuffman* z, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* sizelist, \textcolor{keywordtype}{int} num)}
\DoxyCodeLine{4099 \{}
\DoxyCodeLine{4100     \textcolor{keywordtype}{int} i, k = 0;}
\DoxyCodeLine{4101     \textcolor{keywordtype}{int} code, next\_code[16], sizes[17];}
\DoxyCodeLine{4102 }
\DoxyCodeLine{4103     \textcolor{comment}{// DEFLATE spec for generating codes}}
\DoxyCodeLine{4104     memset(sizes, 0, \textcolor{keyword}{sizeof}(sizes));}
\DoxyCodeLine{4105     memset(z-\/>fast, 0, \textcolor{keyword}{sizeof}(z-\/>fast));}
\DoxyCodeLine{4106     \textcolor{keywordflow}{for} (i = 0; i < num; ++i)}
\DoxyCodeLine{4107         ++sizes[sizelist[i]];}
\DoxyCodeLine{4108     sizes[0] = 0;}
\DoxyCodeLine{4109     \textcolor{keywordflow}{for} (i = 1; i < 16; ++i)}
\DoxyCodeLine{4110         \textcolor{keywordflow}{if} (sizes[i] > (1 << i))}
\DoxyCodeLine{4111             \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad sizes"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4112     code = 0;}
\DoxyCodeLine{4113     \textcolor{keywordflow}{for} (i = 1; i < 16; ++i) \{}
\DoxyCodeLine{4114         next\_code[i] = code;}
\DoxyCodeLine{4115         z-\/>firstcode[i] = (stbi\_\_uint16)code;}
\DoxyCodeLine{4116         z-\/>firstsymbol[i] = (stbi\_\_uint16)k;}
\DoxyCodeLine{4117         code = (code + sizes[i]);}
\DoxyCodeLine{4118         \textcolor{keywordflow}{if} (sizes[i])}
\DoxyCodeLine{4119             \textcolor{keywordflow}{if} (code -\/ 1 >= (1 << i)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad codelengths"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4120         z-\/>maxcode[i] = code << (16 -\/ i); \textcolor{comment}{// preshift for inner loop}}
\DoxyCodeLine{4121         code <<= 1;}
\DoxyCodeLine{4122         k += sizes[i];}
\DoxyCodeLine{4123     \}}
\DoxyCodeLine{4124     z-\/>maxcode[16] = 0x10000; \textcolor{comment}{// sentinel}}
\DoxyCodeLine{4125     \textcolor{keywordflow}{for} (i = 0; i < num; ++i) \{}
\DoxyCodeLine{4126         \textcolor{keywordtype}{int} s = sizelist[i];}
\DoxyCodeLine{4127         \textcolor{keywordflow}{if} (s) \{}
\DoxyCodeLine{4128             \textcolor{keywordtype}{int} c = next\_code[s] -\/ z-\/>firstcode[s] + z-\/>firstsymbol[s];}
\DoxyCodeLine{4129             stbi\_\_uint16 fastv = (stbi\_\_uint16)((s << 9) | i);}
\DoxyCodeLine{4130             z-\/>size[c] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})s;}
\DoxyCodeLine{4131             z-\/>value[c] = (stbi\_\_uint16)i;}
\DoxyCodeLine{4132             \textcolor{keywordflow}{if} (s <= STBI\_\_ZFAST\_BITS) \{}
\DoxyCodeLine{4133                 \textcolor{keywordtype}{int} j = stbi\_\_bit\_reverse(next\_code[s], s);}
\DoxyCodeLine{4134                 \textcolor{keywordflow}{while} (j < (1 << STBI\_\_ZFAST\_BITS)) \{}
\DoxyCodeLine{4135                     z-\/>fast[j] = fastv;}
\DoxyCodeLine{4136                     j += (1 << s);}
\DoxyCodeLine{4137                 \}}
\DoxyCodeLine{4138             \}}
\DoxyCodeLine{4139             ++next\_code[s];}
\DoxyCodeLine{4140         \}}
\DoxyCodeLine{4141     \}}
\DoxyCodeLine{4142     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4143 \}}
\DoxyCodeLine{4144 }
\DoxyCodeLine{4145 \textcolor{comment}{// zlib-\/from-\/memory implementation for PNG reading}}
\DoxyCodeLine{4146 \textcolor{comment}{//    because PNG allows splitting the zlib stream arbitrarily,}}
\DoxyCodeLine{4147 \textcolor{comment}{//    and it's annoying structurally to have PNG call ZLIB call PNG,}}
\DoxyCodeLine{4148 \textcolor{comment}{//    we require PNG read all the IDATs and combine them into a single}}
\DoxyCodeLine{4149 \textcolor{comment}{//    memory buffer}}
\DoxyCodeLine{4150 }
\DoxyCodeLine{4151 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{4152 \{}
\DoxyCodeLine{4153     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* zbuffer, * zbuffer\_end;}
\DoxyCodeLine{4154     \textcolor{keywordtype}{int} num\_bits;}
\DoxyCodeLine{4155     stbi\_\_uint32 code\_buffer;}
\DoxyCodeLine{4156 }
\DoxyCodeLine{4157     \textcolor{keywordtype}{char}* zout;}
\DoxyCodeLine{4158     \textcolor{keywordtype}{char}* zout\_start;}
\DoxyCodeLine{4159     \textcolor{keywordtype}{char}* zout\_end;}
\DoxyCodeLine{4160     \textcolor{keywordtype}{int}   z\_expandable;}
\DoxyCodeLine{4161 }
\DoxyCodeLine{4162     stbi\_\_zhuffman z\_length, z\_distance;}
\DoxyCodeLine{4163 \} stbi\_\_zbuf;}
\DoxyCodeLine{4164 }
\DoxyCodeLine{4165 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_zeof(stbi\_\_zbuf* z)}
\DoxyCodeLine{4166 \{}
\DoxyCodeLine{4167     \textcolor{keywordflow}{return} (z-\/>zbuffer >= z-\/>zbuffer\_end);}
\DoxyCodeLine{4168 \}}
\DoxyCodeLine{4169 }
\DoxyCodeLine{4170 stbi\_inline \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_zget8(stbi\_\_zbuf* z)}
\DoxyCodeLine{4171 \{}
\DoxyCodeLine{4172     \textcolor{keywordflow}{return} stbi\_\_zeof(z) ? 0 : *z-\/>zbuffer++;}
\DoxyCodeLine{4173 \}}
\DoxyCodeLine{4174 }
\DoxyCodeLine{4175 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_fill\_bits(stbi\_\_zbuf* z)}
\DoxyCodeLine{4176 \{}
\DoxyCodeLine{4177     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{4178         \textcolor{keywordflow}{if} (z-\/>code\_buffer >= (1U << z-\/>num\_bits)) \{}
\DoxyCodeLine{4179             z-\/>zbuffer = z-\/>zbuffer\_end;  \textcolor{comment}{/* treat this as EOF so we fail. */}}
\DoxyCodeLine{4180             \textcolor{keywordflow}{return};}
\DoxyCodeLine{4181         \}}
\DoxyCodeLine{4182         z-\/>code\_buffer |= (\textcolor{keywordtype}{unsigned} int)stbi\_\_zget8(z) << z-\/>num\_bits;}
\DoxyCodeLine{4183         z-\/>num\_bits += 8;}
\DoxyCodeLine{4184     \} \textcolor{keywordflow}{while} (z-\/>num\_bits <= 24);}
\DoxyCodeLine{4185 \}}
\DoxyCodeLine{4186 }
\DoxyCodeLine{4187 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbi\_\_zreceive(stbi\_\_zbuf* z, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{4188 \{}
\DoxyCodeLine{4189     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{4190     \textcolor{keywordflow}{if} (z-\/>num\_bits < n) stbi\_\_fill\_bits(z);}
\DoxyCodeLine{4191     k = z-\/>code\_buffer \& ((1 << n) -\/ 1);}
\DoxyCodeLine{4192     z-\/>code\_buffer >>= n;}
\DoxyCodeLine{4193     z-\/>num\_bits -\/= n;}
\DoxyCodeLine{4194     \textcolor{keywordflow}{return} k;}
\DoxyCodeLine{4195 \}}
\DoxyCodeLine{4196 }
\DoxyCodeLine{4197 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_zhuffman\_decode\_slowpath(stbi\_\_zbuf* a, stbi\_\_zhuffman* z)}
\DoxyCodeLine{4198 \{}
\DoxyCodeLine{4199     \textcolor{keywordtype}{int} b, s, k;}
\DoxyCodeLine{4200     \textcolor{comment}{// not resolved by fast table, so compute it the slow way}}
\DoxyCodeLine{4201     \textcolor{comment}{// use jpeg approach, which requires MSbits at top}}
\DoxyCodeLine{4202     k = stbi\_\_bit\_reverse(a-\/>code\_buffer, 16);}
\DoxyCodeLine{4203     \textcolor{keywordflow}{for} (s = STBI\_\_ZFAST\_BITS + 1; ; ++s)}
\DoxyCodeLine{4204         \textcolor{keywordflow}{if} (k < z-\/>maxcode[s])}
\DoxyCodeLine{4205             \textcolor{keywordflow}{break};}
\DoxyCodeLine{4206     \textcolor{keywordflow}{if} (s >= 16) \textcolor{keywordflow}{return} -\/1; \textcolor{comment}{// invalid code!}}
\DoxyCodeLine{4207     \textcolor{comment}{// code size is s, so:}}
\DoxyCodeLine{4208     b = (k >> (16 -\/ s)) -\/ z-\/>firstcode[s] + z-\/>firstsymbol[s];}
\DoxyCodeLine{4209     \textcolor{keywordflow}{if} (b >= STBI\_\_ZNSYMS) \textcolor{keywordflow}{return} -\/1; \textcolor{comment}{// some data was corrupt somewhere!}}
\DoxyCodeLine{4210     \textcolor{keywordflow}{if} (z-\/>size[b] != s) \textcolor{keywordflow}{return} -\/1;  \textcolor{comment}{// was originally an assert, but report failure instead.}}
\DoxyCodeLine{4211     a-\/>code\_buffer >>= s;}
\DoxyCodeLine{4212     a-\/>num\_bits -\/= s;}
\DoxyCodeLine{4213     \textcolor{keywordflow}{return} z-\/>value[b];}
\DoxyCodeLine{4214 \}}
\DoxyCodeLine{4215 }
\DoxyCodeLine{4216 stbi\_inline \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_zhuffman\_decode(stbi\_\_zbuf* a, stbi\_\_zhuffman* z)}
\DoxyCodeLine{4217 \{}
\DoxyCodeLine{4218     \textcolor{keywordtype}{int} b, s;}
\DoxyCodeLine{4219     \textcolor{keywordflow}{if} (a-\/>num\_bits < 16) \{}
\DoxyCodeLine{4220         \textcolor{keywordflow}{if} (stbi\_\_zeof(a)) \{}
\DoxyCodeLine{4221             \textcolor{keywordflow}{return} -\/1;   \textcolor{comment}{/* report error for unexpected end of data. */}}
\DoxyCodeLine{4222         \}}
\DoxyCodeLine{4223         stbi\_\_fill\_bits(a);}
\DoxyCodeLine{4224     \}}
\DoxyCodeLine{4225     b = z-\/>fast[a-\/>code\_buffer \& STBI\_\_ZFAST\_MASK];}
\DoxyCodeLine{4226     \textcolor{keywordflow}{if} (b) \{}
\DoxyCodeLine{4227         s = b >> 9;}
\DoxyCodeLine{4228         a-\/>code\_buffer >>= s;}
\DoxyCodeLine{4229         a-\/>num\_bits -\/= s;}
\DoxyCodeLine{4230         \textcolor{keywordflow}{return} b \& 511;}
\DoxyCodeLine{4231     \}}
\DoxyCodeLine{4232     \textcolor{keywordflow}{return} stbi\_\_zhuffman\_decode\_slowpath(a, z);}
\DoxyCodeLine{4233 \}}
\DoxyCodeLine{4234 }
\DoxyCodeLine{4235 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_zexpand(stbi\_\_zbuf* z, \textcolor{keywordtype}{char}* zout, \textcolor{keywordtype}{int} n)  \textcolor{comment}{// need to make room for n bytes}}
\DoxyCodeLine{4236 \{}
\DoxyCodeLine{4237     \textcolor{keywordtype}{char}* q;}
\DoxyCodeLine{4238     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cur, limit, old\_limit;}
\DoxyCodeLine{4239     z-\/>zout = zout;}
\DoxyCodeLine{4240     \textcolor{keywordflow}{if} (!z-\/>z\_expandable) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}output buffer limit"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4241     cur = (\textcolor{keywordtype}{unsigned} int)(z-\/>zout -\/ z-\/>zout\_start);}
\DoxyCodeLine{4242     limit = old\_limit = (unsigned)(z-\/>zout\_end -\/ z-\/>zout\_start);}
\DoxyCodeLine{4243     \textcolor{keywordflow}{if} (UINT\_MAX -\/ cur < (\textcolor{keywordtype}{unsigned})n) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4244     \textcolor{keywordflow}{while} (cur + n > limit) \{}
\DoxyCodeLine{4245         \textcolor{keywordflow}{if} (limit > UINT\_MAX / 2) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4246         limit *= 2;}
\DoxyCodeLine{4247     \}}
\DoxyCodeLine{4248     q = (\textcolor{keywordtype}{char}*)STBI\_REALLOC\_SIZED(z-\/>zout\_start, old\_limit, limit);}
\DoxyCodeLine{4249     STBI\_NOTUSED(old\_limit);}
\DoxyCodeLine{4250     \textcolor{keywordflow}{if} (q == NULL) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4251     z-\/>zout\_start = q;}
\DoxyCodeLine{4252     z-\/>zout = q + cur;}
\DoxyCodeLine{4253     z-\/>zout\_end = q + limit;}
\DoxyCodeLine{4254     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4255 \}}
\DoxyCodeLine{4256 }
\DoxyCodeLine{4257 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} stbi\_\_zlength\_base[31] = \{}
\DoxyCodeLine{4258    3,4,5,6,7,8,9,10,11,13,}
\DoxyCodeLine{4259    15,17,19,23,27,31,35,43,51,59,}
\DoxyCodeLine{4260    67,83,99,115,131,163,195,227,258,0,0 \};}
\DoxyCodeLine{4261 }
\DoxyCodeLine{4262 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} stbi\_\_zlength\_extra[31] =}
\DoxyCodeLine{4263 \{ 0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0 \};}
\DoxyCodeLine{4264 }
\DoxyCodeLine{4265 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} stbi\_\_zdist\_base[32] = \{ 1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,}
\DoxyCodeLine{4266 257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0 \};}
\DoxyCodeLine{4267 }
\DoxyCodeLine{4268 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} stbi\_\_zdist\_extra[32] =}
\DoxyCodeLine{4269 \{ 0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13 \};}
\DoxyCodeLine{4270 }
\DoxyCodeLine{4271 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_parse\_huffman\_block(stbi\_\_zbuf* a)}
\DoxyCodeLine{4272 \{}
\DoxyCodeLine{4273     \textcolor{keywordtype}{char}* zout = a-\/>zout;}
\DoxyCodeLine{4274     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{4275         \textcolor{keywordtype}{int} z = stbi\_\_zhuffman\_decode(a, \&a-\/>z\_length);}
\DoxyCodeLine{4276         \textcolor{keywordflow}{if} (z < 256) \{}
\DoxyCodeLine{4277             \textcolor{keywordflow}{if} (z < 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}}); \textcolor{comment}{// error in huffman codes}}
\DoxyCodeLine{4278             \textcolor{keywordflow}{if} (zout >= a-\/>zout\_end) \{}
\DoxyCodeLine{4279                 \textcolor{keywordflow}{if} (!stbi\_\_zexpand(a, zout, 1)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4280                 zout = a-\/>zout;}
\DoxyCodeLine{4281             \}}
\DoxyCodeLine{4282             *zout++ = (char)z;}
\DoxyCodeLine{4283         \}}
\DoxyCodeLine{4284         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4285             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p;}
\DoxyCodeLine{4286             \textcolor{keywordtype}{int} len, dist;}
\DoxyCodeLine{4287             \textcolor{keywordflow}{if} (z == 256) \{}
\DoxyCodeLine{4288                 a-\/>zout = zout;}
\DoxyCodeLine{4289                 \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4290             \}}
\DoxyCodeLine{4291             z -\/= 257;}
\DoxyCodeLine{4292             len = stbi\_\_zlength\_base[z];}
\DoxyCodeLine{4293             \textcolor{keywordflow}{if} (stbi\_\_zlength\_extra[z]) len += stbi\_\_zreceive(a, stbi\_\_zlength\_extra[z]);}
\DoxyCodeLine{4294             z = stbi\_\_zhuffman\_decode(a, \&a-\/>z\_distance);}
\DoxyCodeLine{4295             \textcolor{keywordflow}{if} (z < 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad huffman code"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4296             dist = stbi\_\_zdist\_base[z];}
\DoxyCodeLine{4297             \textcolor{keywordflow}{if} (stbi\_\_zdist\_extra[z]) dist += stbi\_\_zreceive(a, stbi\_\_zdist\_extra[z]);}
\DoxyCodeLine{4298             \textcolor{keywordflow}{if} (zout -\/ a-\/>zout\_start < dist) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad dist"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4299             \textcolor{keywordflow}{if} (zout + len > a-\/>zout\_end) \{}
\DoxyCodeLine{4300                 \textcolor{keywordflow}{if} (!stbi\_\_zexpand(a, zout, len)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4301                 zout = a-\/>zout;}
\DoxyCodeLine{4302             \}}
\DoxyCodeLine{4303             p = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)(zout -\/ dist);}
\DoxyCodeLine{4304             \textcolor{keywordflow}{if} (dist == 1) \{ \textcolor{comment}{// run of one byte; common in images.}}
\DoxyCodeLine{4305                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} v = *p;}
\DoxyCodeLine{4306                 \textcolor{keywordflow}{if} (len) \{ \textcolor{keywordflow}{do} *zout++ = v; \textcolor{keywordflow}{while} (-\/-\/len); \}}
\DoxyCodeLine{4307             \}}
\DoxyCodeLine{4308             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4309                 \textcolor{keywordflow}{if} (len) \{ \textcolor{keywordflow}{do} *zout++ = *p++; \textcolor{keywordflow}{while} (-\/-\/len); \}}
\DoxyCodeLine{4310             \}}
\DoxyCodeLine{4311         \}}
\DoxyCodeLine{4312     \}}
\DoxyCodeLine{4313 \}}
\DoxyCodeLine{4314 }
\DoxyCodeLine{4315 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_compute\_huffman\_codes(stbi\_\_zbuf* a)}
\DoxyCodeLine{4316 \{}
\DoxyCodeLine{4317     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} length\_dezigzag[19] = \{ 16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15 \};}
\DoxyCodeLine{4318     stbi\_\_zhuffman z\_codelength;}
\DoxyCodeLine{4319     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} lencodes[286 + 32 + 137];\textcolor{comment}{//padding for maximum single op}}
\DoxyCodeLine{4320     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} codelength\_sizes[19];}
\DoxyCodeLine{4321     \textcolor{keywordtype}{int} i, n;}
\DoxyCodeLine{4322 }
\DoxyCodeLine{4323     \textcolor{keywordtype}{int} hlit = stbi\_\_zreceive(a, 5) + 257;}
\DoxyCodeLine{4324     \textcolor{keywordtype}{int} hdist = stbi\_\_zreceive(a, 5) + 1;}
\DoxyCodeLine{4325     \textcolor{keywordtype}{int} hclen = stbi\_\_zreceive(a, 4) + 4;}
\DoxyCodeLine{4326     \textcolor{keywordtype}{int} ntot = hlit + hdist;}
\DoxyCodeLine{4327 }
\DoxyCodeLine{4328     memset(codelength\_sizes, 0, \textcolor{keyword}{sizeof}(codelength\_sizes));}
\DoxyCodeLine{4329     \textcolor{keywordflow}{for} (i = 0; i < hclen; ++i) \{}
\DoxyCodeLine{4330         \textcolor{keywordtype}{int} s = stbi\_\_zreceive(a, 3);}
\DoxyCodeLine{4331         codelength\_sizes[length\_dezigzag[i]] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})s;}
\DoxyCodeLine{4332     \}}
\DoxyCodeLine{4333     \textcolor{keywordflow}{if} (!stbi\_\_zbuild\_huffman(\&z\_codelength, codelength\_sizes, 19)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4334 }
\DoxyCodeLine{4335     n = 0;}
\DoxyCodeLine{4336     \textcolor{keywordflow}{while} (n < ntot) \{}
\DoxyCodeLine{4337         \textcolor{keywordtype}{int} c = stbi\_\_zhuffman\_decode(a, \&z\_codelength);}
\DoxyCodeLine{4338         \textcolor{keywordflow}{if} (c < 0 || c >= 19) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad codelengths"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4339         \textcolor{keywordflow}{if} (c < 16)}
\DoxyCodeLine{4340             lencodes[n++] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})c;}
\DoxyCodeLine{4341         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4342             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} fill = 0;}
\DoxyCodeLine{4343             \textcolor{keywordflow}{if} (c == 16) \{}
\DoxyCodeLine{4344                 c = stbi\_\_zreceive(a, 2) + 3;}
\DoxyCodeLine{4345                 \textcolor{keywordflow}{if} (n == 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad codelengths"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4346                 fill = lencodes[n -\/ 1];}
\DoxyCodeLine{4347             \}}
\DoxyCodeLine{4348             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (c == 17) \{}
\DoxyCodeLine{4349                 c = stbi\_\_zreceive(a, 3) + 3;}
\DoxyCodeLine{4350             \}}
\DoxyCodeLine{4351             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (c == 18) \{}
\DoxyCodeLine{4352                 c = stbi\_\_zreceive(a, 7) + 11;}
\DoxyCodeLine{4353             \}}
\DoxyCodeLine{4354             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4355                 \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad codelengths"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4356             \}}
\DoxyCodeLine{4357             \textcolor{keywordflow}{if} (ntot -\/ n < c) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad codelengths"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4358             memset(lencodes + n, fill, c);}
\DoxyCodeLine{4359             n += c;}
\DoxyCodeLine{4360         \}}
\DoxyCodeLine{4361     \}}
\DoxyCodeLine{4362     \textcolor{keywordflow}{if} (n != ntot) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad codelengths"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4363     \textcolor{keywordflow}{if} (!stbi\_\_zbuild\_huffman(\&a-\/>z\_length, lencodes, hlit)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4364     \textcolor{keywordflow}{if} (!stbi\_\_zbuild\_huffman(\&a-\/>z\_distance, lencodes + hlit, hdist)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4365     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4366 \}}
\DoxyCodeLine{4367 }
\DoxyCodeLine{4368 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_parse\_uncompressed\_block(stbi\_\_zbuf* a)}
\DoxyCodeLine{4369 \{}
\DoxyCodeLine{4370     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} header[4];}
\DoxyCodeLine{4371     \textcolor{keywordtype}{int} len, nlen, k;}
\DoxyCodeLine{4372     \textcolor{keywordflow}{if} (a-\/>num\_bits \& 7)}
\DoxyCodeLine{4373         stbi\_\_zreceive(a, a-\/>num\_bits \& 7); \textcolor{comment}{// discard}}
\DoxyCodeLine{4374      \textcolor{comment}{// drain the bit-\/packed data into header}}
\DoxyCodeLine{4375     k = 0;}
\DoxyCodeLine{4376     \textcolor{keywordflow}{while} (a-\/>num\_bits > 0) \{}
\DoxyCodeLine{4377         header[k++] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})(a-\/>code\_buffer \& 255); \textcolor{comment}{// suppress MSVC run-\/time check}}
\DoxyCodeLine{4378         a-\/>code\_buffer >>= 8;}
\DoxyCodeLine{4379         a-\/>num\_bits -\/= 8;}
\DoxyCodeLine{4380     \}}
\DoxyCodeLine{4381     \textcolor{keywordflow}{if} (a-\/>num\_bits < 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}zlib corrupt"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4382     \textcolor{comment}{// now fill header the normal way}}
\DoxyCodeLine{4383     \textcolor{keywordflow}{while} (k < 4)}
\DoxyCodeLine{4384         header[k++] = stbi\_\_zget8(a);}
\DoxyCodeLine{4385     len = header[1] * 256 + header[0];}
\DoxyCodeLine{4386     nlen = header[3] * 256 + header[2];}
\DoxyCodeLine{4387     \textcolor{keywordflow}{if} (nlen != (len \string^ 0xffff)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}zlib corrupt"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4388     \textcolor{keywordflow}{if} (a-\/>zbuffer + len > a-\/>zbuffer\_end) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}read past buffer"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4389     \textcolor{keywordflow}{if} (a-\/>zout + len > a-\/>zout\_end)}
\DoxyCodeLine{4390         \textcolor{keywordflow}{if} (!stbi\_\_zexpand(a, a-\/>zout, len)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4391     memcpy(a-\/>zout, a-\/>zbuffer, len);}
\DoxyCodeLine{4392     a-\/>zbuffer += len;}
\DoxyCodeLine{4393     a-\/>zout += len;}
\DoxyCodeLine{4394     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4395 \}}
\DoxyCodeLine{4396 }
\DoxyCodeLine{4397 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_parse\_zlib\_header(stbi\_\_zbuf* a)}
\DoxyCodeLine{4398 \{}
\DoxyCodeLine{4399     \textcolor{keywordtype}{int} cmf = stbi\_\_zget8(a);}
\DoxyCodeLine{4400     \textcolor{keywordtype}{int} cm = cmf \& 15;}
\DoxyCodeLine{4401     \textcolor{comment}{/* int cinfo = cmf >> 4; */}}
\DoxyCodeLine{4402     \textcolor{keywordtype}{int} flg = stbi\_\_zget8(a);}
\DoxyCodeLine{4403     \textcolor{keywordflow}{if} (stbi\_\_zeof(a)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad zlib header"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}}); \textcolor{comment}{// zlib spec}}
\DoxyCodeLine{4404     \textcolor{keywordflow}{if} ((cmf * 256 + flg) \% 31 != 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad zlib header"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}}); \textcolor{comment}{// zlib spec}}
\DoxyCodeLine{4405     \textcolor{keywordflow}{if} (flg \& 32) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}no preset dict"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}}); \textcolor{comment}{// preset dictionary not allowed in png}}
\DoxyCodeLine{4406     \textcolor{keywordflow}{if} (cm != 8) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad compression"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}}); \textcolor{comment}{// DEFLATE required for png}}
\DoxyCodeLine{4407     \textcolor{comment}{// window = 1 << (8 + cinfo)... but who cares, we fully buffer output}}
\DoxyCodeLine{4408     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4409 \}}
\DoxyCodeLine{4410 }
\DoxyCodeLine{4411 \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_zdefault\_length[STBI\_\_ZNSYMS] =}
\DoxyCodeLine{4412 \{}
\DoxyCodeLine{4413    8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,}
\DoxyCodeLine{4414    8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,}
\DoxyCodeLine{4415    8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,}
\DoxyCodeLine{4416    8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,}
\DoxyCodeLine{4417    8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,}
\DoxyCodeLine{4418    9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9, 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,}
\DoxyCodeLine{4419    9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9, 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,}
\DoxyCodeLine{4420    9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9, 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,}
\DoxyCodeLine{4421    7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7, 7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8}
\DoxyCodeLine{4422 \};}
\DoxyCodeLine{4423 \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_zdefault\_distance[32] =}
\DoxyCodeLine{4424 \{}
\DoxyCodeLine{4425    5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5}
\DoxyCodeLine{4426 \};}
\DoxyCodeLine{4427 \textcolor{comment}{/*}}
\DoxyCodeLine{4428 \textcolor{comment}{Init algorithm:}}
\DoxyCodeLine{4429 \textcolor{comment}{\{}}
\DoxyCodeLine{4430 \textcolor{comment}{   int i;   // use <= to match clearly with spec}}
\DoxyCodeLine{4431 \textcolor{comment}{   for (i=0; i <= 143; ++i)     stbi\_\_zdefault\_length[i]   = 8;}}
\DoxyCodeLine{4432 \textcolor{comment}{   for (   ; i <= 255; ++i)     stbi\_\_zdefault\_length[i]   = 9;}}
\DoxyCodeLine{4433 \textcolor{comment}{   for (   ; i <= 279; ++i)     stbi\_\_zdefault\_length[i]   = 7;}}
\DoxyCodeLine{4434 \textcolor{comment}{   for (   ; i <= 287; ++i)     stbi\_\_zdefault\_length[i]   = 8;}}
\DoxyCodeLine{4435 \textcolor{comment}{}}
\DoxyCodeLine{4436 \textcolor{comment}{   for (i=0; i <=  31; ++i)     stbi\_\_zdefault\_distance[i] = 5;}}
\DoxyCodeLine{4437 \textcolor{comment}{\}}}
\DoxyCodeLine{4438 \textcolor{comment}{*/}}
\DoxyCodeLine{4439 }
\DoxyCodeLine{4440 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_parse\_zlib(stbi\_\_zbuf* a, \textcolor{keywordtype}{int} parse\_header)}
\DoxyCodeLine{4441 \{}
\DoxyCodeLine{4442     \textcolor{keywordtype}{int} \textcolor{keyword}{final}, type;}
\DoxyCodeLine{4443     \textcolor{keywordflow}{if} (parse\_header)}
\DoxyCodeLine{4444         \textcolor{keywordflow}{if} (!stbi\_\_parse\_zlib\_header(a)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4445     a-\/>num\_bits = 0;}
\DoxyCodeLine{4446     a-\/>code\_buffer = 0;}
\DoxyCodeLine{4447     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{4448         \textcolor{keyword}{final} = stbi\_\_zreceive(a, 1);}
\DoxyCodeLine{4449         type = stbi\_\_zreceive(a, 2);}
\DoxyCodeLine{4450         \textcolor{keywordflow}{if} (type == 0) \{}
\DoxyCodeLine{4451             \textcolor{keywordflow}{if} (!stbi\_\_parse\_uncompressed\_block(a)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4452         \}}
\DoxyCodeLine{4453         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type == 3) \{}
\DoxyCodeLine{4454             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4455         \}}
\DoxyCodeLine{4456         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4457             \textcolor{keywordflow}{if} (type == 1) \{}
\DoxyCodeLine{4458                 \textcolor{comment}{// use fixed code lengths}}
\DoxyCodeLine{4459                 \textcolor{keywordflow}{if} (!stbi\_\_zbuild\_huffman(\&a-\/>z\_length, stbi\_\_zdefault\_length, STBI\_\_ZNSYMS)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4460                 \textcolor{keywordflow}{if} (!stbi\_\_zbuild\_huffman(\&a-\/>z\_distance, stbi\_\_zdefault\_distance, 32)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4461             \}}
\DoxyCodeLine{4462             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4463                 \textcolor{keywordflow}{if} (!stbi\_\_compute\_huffman\_codes(a)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4464             \}}
\DoxyCodeLine{4465             \textcolor{keywordflow}{if} (!stbi\_\_parse\_huffman\_block(a)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4466         \}}
\DoxyCodeLine{4467     \} \textcolor{keywordflow}{while} (!\textcolor{keyword}{final});}
\DoxyCodeLine{4468     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4469 \}}
\DoxyCodeLine{4470 }
\DoxyCodeLine{4471 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_do\_zlib(stbi\_\_zbuf* a, \textcolor{keywordtype}{char}* obuf, \textcolor{keywordtype}{int} olen, \textcolor{keywordtype}{int} exp, \textcolor{keywordtype}{int} parse\_header)}
\DoxyCodeLine{4472 \{}
\DoxyCodeLine{4473     a-\/>zout\_start = obuf;}
\DoxyCodeLine{4474     a-\/>zout = obuf;}
\DoxyCodeLine{4475     a-\/>zout\_end = obuf + olen;}
\DoxyCodeLine{4476     a-\/>z\_expandable = exp;}
\DoxyCodeLine{4477 }
\DoxyCodeLine{4478     \textcolor{keywordflow}{return} stbi\_\_parse\_zlib(a, parse\_header);}
\DoxyCodeLine{4479 \}}
\DoxyCodeLine{4480 }
\DoxyCodeLine{4481 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_acba137e5310f3c0fe9bb198e4bee3dce}{stbi\_zlib\_decode\_malloc\_guesssize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} initial\_size, \textcolor{keywordtype}{int}* outlen)}
\DoxyCodeLine{4482 \{}
\DoxyCodeLine{4483     stbi\_\_zbuf a;}
\DoxyCodeLine{4484     \textcolor{keywordtype}{char}* p = (\textcolor{keywordtype}{char}*)stbi\_\_malloc(initial\_size);}
\DoxyCodeLine{4485     \textcolor{keywordflow}{if} (p == NULL) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4486     a.zbuffer = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer;}
\DoxyCodeLine{4487     a.zbuffer\_end = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer + len;}
\DoxyCodeLine{4488     \textcolor{keywordflow}{if} (stbi\_\_do\_zlib(\&a, p, initial\_size, 1, 1)) \{}
\DoxyCodeLine{4489         \textcolor{keywordflow}{if} (outlen) *outlen = (int)(a.zout -\/ a.zout\_start);}
\DoxyCodeLine{4490         \textcolor{keywordflow}{return} a.zout\_start;}
\DoxyCodeLine{4491     \}}
\DoxyCodeLine{4492     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4493         STBI\_FREE(a.zout\_start);}
\DoxyCodeLine{4494         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4495     \}}
\DoxyCodeLine{4496 \}}
\DoxyCodeLine{4497 }
\DoxyCodeLine{4498 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_afec644d4e1a3cd858dfe0f9c55a1e55c}{stbi\_zlib\_decode\_malloc}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* outlen)}
\DoxyCodeLine{4499 \{}
\DoxyCodeLine{4500     \textcolor{keywordflow}{return} \mbox{\hyperlink{stb__image_8h_acba137e5310f3c0fe9bb198e4bee3dce}{stbi\_zlib\_decode\_malloc\_guesssize}}(buffer, len, 16384, outlen);}
\DoxyCodeLine{4501 \}}
\DoxyCodeLine{4502 }
\DoxyCodeLine{4503 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_adc3de199aa29f7370a699ad545155541}{stbi\_zlib\_decode\_malloc\_guesssize\_headerflag}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} initial\_size, \textcolor{keywordtype}{int}* outlen, \textcolor{keywordtype}{int} parse\_header)}
\DoxyCodeLine{4504 \{}
\DoxyCodeLine{4505     stbi\_\_zbuf a;}
\DoxyCodeLine{4506     \textcolor{keywordtype}{char}* p = (\textcolor{keywordtype}{char}*)stbi\_\_malloc(initial\_size);}
\DoxyCodeLine{4507     \textcolor{keywordflow}{if} (p == NULL) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4508     a.zbuffer = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer;}
\DoxyCodeLine{4509     a.zbuffer\_end = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer + len;}
\DoxyCodeLine{4510     \textcolor{keywordflow}{if} (stbi\_\_do\_zlib(\&a, p, initial\_size, 1, parse\_header)) \{}
\DoxyCodeLine{4511         \textcolor{keywordflow}{if} (outlen) *outlen = (int)(a.zout -\/ a.zout\_start);}
\DoxyCodeLine{4512         \textcolor{keywordflow}{return} a.zout\_start;}
\DoxyCodeLine{4513     \}}
\DoxyCodeLine{4514     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4515         STBI\_FREE(a.zout\_start);}
\DoxyCodeLine{4516         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4517     \}}
\DoxyCodeLine{4518 \}}
\DoxyCodeLine{4519 }
\DoxyCodeLine{4520 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_ae8447830c49bc17f8491e12c1f0ded48}{stbi\_zlib\_decode\_buffer}}(\textcolor{keywordtype}{char}* obuffer, \textcolor{keywordtype}{int} olen, \textcolor{keywordtype}{char} \textcolor{keyword}{const}* ibuffer, \textcolor{keywordtype}{int} ilen)}
\DoxyCodeLine{4521 \{}
\DoxyCodeLine{4522     stbi\_\_zbuf a;}
\DoxyCodeLine{4523     a.zbuffer = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)ibuffer;}
\DoxyCodeLine{4524     a.zbuffer\_end = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)ibuffer + ilen;}
\DoxyCodeLine{4525     \textcolor{keywordflow}{if} (stbi\_\_do\_zlib(\&a, obuffer, olen, 0, 1))}
\DoxyCodeLine{4526         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})(a.zout -\/ a.zout\_start);}
\DoxyCodeLine{4527     \textcolor{keywordflow}{else}}
\DoxyCodeLine{4528         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{4529 \}}
\DoxyCodeLine{4530 }
\DoxyCodeLine{4531 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{stb__image_8h_ad6b5cd73a89037832ee2b2872a17bd1b}{stbi\_zlib\_decode\_noheader\_malloc}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* outlen)}
\DoxyCodeLine{4532 \{}
\DoxyCodeLine{4533     stbi\_\_zbuf a;}
\DoxyCodeLine{4534     \textcolor{keywordtype}{char}* p = (\textcolor{keywordtype}{char}*)stbi\_\_malloc(16384);}
\DoxyCodeLine{4535     \textcolor{keywordflow}{if} (p == NULL) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4536     a.zbuffer = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer;}
\DoxyCodeLine{4537     a.zbuffer\_end = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)buffer + len;}
\DoxyCodeLine{4538     \textcolor{keywordflow}{if} (stbi\_\_do\_zlib(\&a, p, 16384, 1, 0)) \{}
\DoxyCodeLine{4539         \textcolor{keywordflow}{if} (outlen) *outlen = (int)(a.zout -\/ a.zout\_start);}
\DoxyCodeLine{4540         \textcolor{keywordflow}{return} a.zout\_start;}
\DoxyCodeLine{4541     \}}
\DoxyCodeLine{4542     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4543         STBI\_FREE(a.zout\_start);}
\DoxyCodeLine{4544         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{4545     \}}
\DoxyCodeLine{4546 \}}
\DoxyCodeLine{4547 }
\DoxyCodeLine{4548 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a0d12efc011adfff7521f3b924feb0b0e}{stbi\_zlib\_decode\_noheader\_buffer}}(\textcolor{keywordtype}{char}* obuffer, \textcolor{keywordtype}{int} olen, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* ibuffer, \textcolor{keywordtype}{int} ilen)}
\DoxyCodeLine{4549 \{}
\DoxyCodeLine{4550     stbi\_\_zbuf a;}
\DoxyCodeLine{4551     a.zbuffer = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)ibuffer;}
\DoxyCodeLine{4552     a.zbuffer\_end = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)ibuffer + ilen;}
\DoxyCodeLine{4553     \textcolor{keywordflow}{if} (stbi\_\_do\_zlib(\&a, obuffer, olen, 0, 0))}
\DoxyCodeLine{4554         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})(a.zout -\/ a.zout\_start);}
\DoxyCodeLine{4555     \textcolor{keywordflow}{else}}
\DoxyCodeLine{4556         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{4557 \}}
\DoxyCodeLine{4558 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4559 }
\DoxyCodeLine{4560 \textcolor{comment}{// public domain "{}baseline"{} PNG decoder   v0.10  Sean Barrett 2006-\/11-\/18}}
\DoxyCodeLine{4561 \textcolor{comment}{//    simple implementation}}
\DoxyCodeLine{4562 \textcolor{comment}{//      -\/ only 8-\/bit samples}}
\DoxyCodeLine{4563 \textcolor{comment}{//      -\/ no CRC checking}}
\DoxyCodeLine{4564 \textcolor{comment}{//      -\/ allocates lots of intermediate memory}}
\DoxyCodeLine{4565 \textcolor{comment}{//        -\/ avoids problem of streaming data between subsystems}}
\DoxyCodeLine{4566 \textcolor{comment}{//        -\/ avoids explicit window management}}
\DoxyCodeLine{4567 \textcolor{comment}{//    performance}}
\DoxyCodeLine{4568 \textcolor{comment}{//      -\/ uses stb\_zlib, a PD zlib implementation with fast huffman decoding}}
\DoxyCodeLine{4569 }
\DoxyCodeLine{4570 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNG}}
\DoxyCodeLine{4571 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{4572 \{}
\DoxyCodeLine{4573     stbi\_\_uint32 length;}
\DoxyCodeLine{4574     stbi\_\_uint32 type;}
\DoxyCodeLine{4575 \} stbi\_\_pngchunk;}
\DoxyCodeLine{4576 }
\DoxyCodeLine{4577 \textcolor{keyword}{static} stbi\_\_pngchunk stbi\_\_get\_chunk\_header(stbi\_\_context* s)}
\DoxyCodeLine{4578 \{}
\DoxyCodeLine{4579     stbi\_\_pngchunk c;}
\DoxyCodeLine{4580     c.length = stbi\_\_get32be(s);}
\DoxyCodeLine{4581     c.type = stbi\_\_get32be(s);}
\DoxyCodeLine{4582     \textcolor{keywordflow}{return} c;}
\DoxyCodeLine{4583 \}}
\DoxyCodeLine{4584 }
\DoxyCodeLine{4585 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_check\_png\_header(stbi\_\_context* s)}
\DoxyCodeLine{4586 \{}
\DoxyCodeLine{4587     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} png\_sig[8] = \{ 137,80,78,71,13,10,26,10 \};}
\DoxyCodeLine{4588     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{4589     \textcolor{keywordflow}{for} (i = 0; i < 8; ++i)}
\DoxyCodeLine{4590         \textcolor{keywordflow}{if} (stbi\_\_get8(s) != png\_sig[i]) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad png sig"{}}, \textcolor{stringliteral}{"{}Not a PNG"{}});}
\DoxyCodeLine{4591     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4592 \}}
\DoxyCodeLine{4593 }
\DoxyCodeLine{4594 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{4595 \{}
\DoxyCodeLine{4596     stbi\_\_context* s;}
\DoxyCodeLine{4597     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* idata, * expanded, * out;}
\DoxyCodeLine{4598     \textcolor{keywordtype}{int} depth;}
\DoxyCodeLine{4599 \} stbi\_\_png;}
\DoxyCodeLine{4600 }
\DoxyCodeLine{4601 }
\DoxyCodeLine{4602 \textcolor{keyword}{enum} \{}
\DoxyCodeLine{4603     STBI\_\_F\_none = 0,}
\DoxyCodeLine{4604     STBI\_\_F\_sub = 1,}
\DoxyCodeLine{4605     STBI\_\_F\_up = 2,}
\DoxyCodeLine{4606     STBI\_\_F\_avg = 3,}
\DoxyCodeLine{4607     STBI\_\_F\_paeth = 4,}
\DoxyCodeLine{4608     \textcolor{comment}{// synthetic filters used for first scanline to avoid needing a dummy row of 0s}}
\DoxyCodeLine{4609     STBI\_\_F\_avg\_first,}
\DoxyCodeLine{4610     STBI\_\_F\_paeth\_first}
\DoxyCodeLine{4611 \};}
\DoxyCodeLine{4612 }
\DoxyCodeLine{4613 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} first\_row\_filter[5] =}
\DoxyCodeLine{4614 \{}
\DoxyCodeLine{4615    STBI\_\_F\_none,}
\DoxyCodeLine{4616    STBI\_\_F\_sub,}
\DoxyCodeLine{4617    STBI\_\_F\_none,}
\DoxyCodeLine{4618    STBI\_\_F\_avg\_first,}
\DoxyCodeLine{4619    STBI\_\_F\_paeth\_first}
\DoxyCodeLine{4620 \};}
\DoxyCodeLine{4621 }
\DoxyCodeLine{4622 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_paeth(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c)}
\DoxyCodeLine{4623 \{}
\DoxyCodeLine{4624     \textcolor{keywordtype}{int} p = a + b -\/ c;}
\DoxyCodeLine{4625     \textcolor{keywordtype}{int} pa = abs(p -\/ a);}
\DoxyCodeLine{4626     \textcolor{keywordtype}{int} pb = abs(p -\/ b);}
\DoxyCodeLine{4627     \textcolor{keywordtype}{int} pc = abs(p -\/ c);}
\DoxyCodeLine{4628     \textcolor{keywordflow}{if} (pa <= pb \&\& pa <= pc) \textcolor{keywordflow}{return} a;}
\DoxyCodeLine{4629     \textcolor{keywordflow}{if} (pb <= pc) \textcolor{keywordflow}{return} b;}
\DoxyCodeLine{4630     \textcolor{keywordflow}{return} c;}
\DoxyCodeLine{4631 \}}
\DoxyCodeLine{4632 }
\DoxyCodeLine{4633 \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} stbi\_\_depth\_scale\_table[9] = \{ 0, 0xff, 0x55, 0, 0x11, 0,0,0, 0x01 \};}
\DoxyCodeLine{4634 }
\DoxyCodeLine{4635 \textcolor{comment}{// create the png data from post-\/deflated data}}
\DoxyCodeLine{4636 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_create\_png\_image\_raw(stbi\_\_png* a, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* raw, stbi\_\_uint32 raw\_len, \textcolor{keywordtype}{int} out\_n, stbi\_\_uint32 x, stbi\_\_uint32 y, \textcolor{keywordtype}{int} depth, \textcolor{keywordtype}{int} color)}
\DoxyCodeLine{4637 \{}
\DoxyCodeLine{4638     \textcolor{keywordtype}{int} bytes = (depth == 16 ? 2 : 1);}
\DoxyCodeLine{4639     stbi\_\_context* s = a-\/>s;}
\DoxyCodeLine{4640     stbi\_\_uint32 i, j, stride = x * out\_n * bytes;}
\DoxyCodeLine{4641     stbi\_\_uint32 img\_len, img\_width\_bytes;}
\DoxyCodeLine{4642     \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{4643     \textcolor{keywordtype}{int} img\_n = s-\/>img\_n; \textcolor{comment}{// copy it into a local for later}}
\DoxyCodeLine{4644 }
\DoxyCodeLine{4645     \textcolor{keywordtype}{int} output\_bytes = out\_n * bytes;}
\DoxyCodeLine{4646     \textcolor{keywordtype}{int} filter\_bytes = img\_n * bytes;}
\DoxyCodeLine{4647     \textcolor{keywordtype}{int} \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = x;}
\DoxyCodeLine{4648 }
\DoxyCodeLine{4649     STBI\_ASSERT(out\_n == s-\/>img\_n || out\_n == s-\/>img\_n + 1);}
\DoxyCodeLine{4650     a-\/>out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(x, y, output\_bytes, 0); \textcolor{comment}{// extra bytes to write off the end into}}
\DoxyCodeLine{4651     \textcolor{keywordflow}{if} (!a-\/>out) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4652 }
\DoxyCodeLine{4653     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(img\_n, x, depth, 7)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4654     img\_width\_bytes = (((img\_n * x * depth) + 7) >> 3);}
\DoxyCodeLine{4655     img\_len = (img\_width\_bytes + 1) * y;}
\DoxyCodeLine{4656 }
\DoxyCodeLine{4657     \textcolor{comment}{// we used to check for exact match between raw\_len and img\_len on non-\/interlaced PNGs,}}
\DoxyCodeLine{4658     \textcolor{comment}{// but issue \#276 reported a PNG in the wild that had extra data at the end (all zeros),}}
\DoxyCodeLine{4659     \textcolor{comment}{// so just check for raw\_len < img\_len always.}}
\DoxyCodeLine{4660     \textcolor{keywordflow}{if} (raw\_len < img\_len) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}not enough pixels"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4661 }
\DoxyCodeLine{4662     \textcolor{keywordflow}{for} (j = 0; j < y; ++j) \{}
\DoxyCodeLine{4663         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* cur = a-\/>out + stride * j;}
\DoxyCodeLine{4664         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* prior;}
\DoxyCodeLine{4665         \textcolor{keywordtype}{int} filter = *raw++;}
\DoxyCodeLine{4666 }
\DoxyCodeLine{4667         \textcolor{keywordflow}{if} (filter > 4)}
\DoxyCodeLine{4668             \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}invalid filter"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4669 }
\DoxyCodeLine{4670         \textcolor{keywordflow}{if} (depth < 8) \{}
\DoxyCodeLine{4671             \textcolor{keywordflow}{if} (img\_width\_bytes > x) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}invalid width"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{4672             cur += x * out\_n -\/ img\_width\_bytes; \textcolor{comment}{// store output to the rightmost img\_len bytes, so we can decode in place}}
\DoxyCodeLine{4673             filter\_bytes = 1;}
\DoxyCodeLine{4674             \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = img\_width\_bytes;}
\DoxyCodeLine{4675         \}}
\DoxyCodeLine{4676         prior = cur -\/ stride; \textcolor{comment}{// bugfix: need to compute this after 'cur +=' computation above}}
\DoxyCodeLine{4677 }
\DoxyCodeLine{4678         \textcolor{comment}{// if first row, use special filter that doesn't sample previous row}}
\DoxyCodeLine{4679         \textcolor{keywordflow}{if} (j == 0) filter = first\_row\_filter[filter];}
\DoxyCodeLine{4680 }
\DoxyCodeLine{4681         \textcolor{comment}{// handle first byte explicitly}}
\DoxyCodeLine{4682         \textcolor{keywordflow}{for} (k = 0; k < filter\_bytes; ++k) \{}
\DoxyCodeLine{4683             \textcolor{keywordflow}{switch} (filter) \{}
\DoxyCodeLine{4684             \textcolor{keywordflow}{case} STBI\_\_F\_none: cur[k] = raw[k]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{4685             \textcolor{keywordflow}{case} STBI\_\_F\_sub: cur[k] = raw[k]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{4686             \textcolor{keywordflow}{case} STBI\_\_F\_up: cur[k] = STBI\_\_BYTECAST(raw[k] + prior[k]); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4687             \textcolor{keywordflow}{case} STBI\_\_F\_avg: cur[k] = STBI\_\_BYTECAST(raw[k] + (prior[k] >> 1)); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4688             \textcolor{keywordflow}{case} STBI\_\_F\_paeth: cur[k] = STBI\_\_BYTECAST(raw[k] + stbi\_\_paeth(0, prior[k], 0)); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4689             \textcolor{keywordflow}{case} STBI\_\_F\_avg\_first: cur[k] = raw[k]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{4690             \textcolor{keywordflow}{case} STBI\_\_F\_paeth\_first: cur[k] = raw[k]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{4691             \}}
\DoxyCodeLine{4692         \}}
\DoxyCodeLine{4693 }
\DoxyCodeLine{4694         \textcolor{keywordflow}{if} (depth == 8) \{}
\DoxyCodeLine{4695             \textcolor{keywordflow}{if} (img\_n != out\_n)}
\DoxyCodeLine{4696                 cur[img\_n] = 255; \textcolor{comment}{// first pixel}}
\DoxyCodeLine{4697             raw += img\_n;}
\DoxyCodeLine{4698             cur += out\_n;}
\DoxyCodeLine{4699             prior += out\_n;}
\DoxyCodeLine{4700         \}}
\DoxyCodeLine{4701         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (depth == 16) \{}
\DoxyCodeLine{4702             \textcolor{keywordflow}{if} (img\_n != out\_n) \{}
\DoxyCodeLine{4703                 cur[filter\_bytes] = 255; \textcolor{comment}{// first pixel top byte}}
\DoxyCodeLine{4704                 cur[filter\_bytes + 1] = 255; \textcolor{comment}{// first pixel bottom byte}}
\DoxyCodeLine{4705             \}}
\DoxyCodeLine{4706             raw += filter\_bytes;}
\DoxyCodeLine{4707             cur += output\_bytes;}
\DoxyCodeLine{4708             prior += output\_bytes;}
\DoxyCodeLine{4709         \}}
\DoxyCodeLine{4710         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4711             raw += 1;}
\DoxyCodeLine{4712             cur += 1;}
\DoxyCodeLine{4713             prior += 1;}
\DoxyCodeLine{4714         \}}
\DoxyCodeLine{4715 }
\DoxyCodeLine{4716         \textcolor{comment}{// this is a little gross, so that we don't switch per-\/pixel or per-\/component}}
\DoxyCodeLine{4717         \textcolor{keywordflow}{if} (depth < 8 || img\_n == out\_n) \{}
\DoxyCodeLine{4718             \textcolor{keywordtype}{int} nk = (\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} -\/ 1) * filter\_bytes;}
\DoxyCodeLine{4719 \textcolor{preprocessor}{\#define STBI\_\_CASE(f) \(\backslash\)}}
\DoxyCodeLine{4720 \textcolor{preprocessor}{             case f:     \(\backslash\)}}
\DoxyCodeLine{4721 \textcolor{preprocessor}{                for (k=0; k < nk; ++k)}}
\DoxyCodeLine{4722             \textcolor{keywordflow}{switch} (filter) \{}
\DoxyCodeLine{4723                 \textcolor{comment}{// "{}none"{} filter turns into a memcpy here; make that explicit.}}
\DoxyCodeLine{4724             \textcolor{keywordflow}{case} STBI\_\_F\_none:         memcpy(cur, raw, nk); \textcolor{keywordflow}{break};}
\DoxyCodeLine{4725                 STBI\_\_CASE(STBI\_\_F\_sub) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + cur[k -\/ filter\_bytes]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4726                 STBI\_\_CASE(STBI\_\_F\_up) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + prior[k]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4727                 STBI\_\_CASE(STBI\_\_F\_avg) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + ((prior[k] + cur[k -\/ filter\_bytes]) >> 1)); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4728                 STBI\_\_CASE(STBI\_\_F\_paeth) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + stbi\_\_paeth(cur[k -\/ filter\_bytes], prior[k], prior[k -\/ filter\_bytes])); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4729                 STBI\_\_CASE(STBI\_\_F\_avg\_first) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + (cur[k -\/ filter\_bytes] >> 1)); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4730                 STBI\_\_CASE(STBI\_\_F\_paeth\_first) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + stbi\_\_paeth(cur[k -\/ filter\_bytes], 0, 0)); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4731             \}}
\DoxyCodeLine{4732 \textcolor{preprocessor}{\#undef STBI\_\_CASE}}
\DoxyCodeLine{4733             raw += nk;}
\DoxyCodeLine{4734         \}}
\DoxyCodeLine{4735         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4736             STBI\_ASSERT(img\_n + 1 == out\_n);}
\DoxyCodeLine{4737 \textcolor{preprocessor}{\#define STBI\_\_CASE(f) \(\backslash\)}}
\DoxyCodeLine{4738 \textcolor{preprocessor}{             case f:     \(\backslash\)}}
\DoxyCodeLine{4739 \textcolor{preprocessor}{                for (i=x-\/1; i >= 1; -\/-\/i, cur[filter\_bytes]=255,raw+=filter\_bytes,cur+=output\_bytes,prior+=output\_bytes) \(\backslash\)}}
\DoxyCodeLine{4740 \textcolor{preprocessor}{                   for (k=0; k < filter\_bytes; ++k)}}
\DoxyCodeLine{4741             \textcolor{keywordflow}{switch} (filter) \{}
\DoxyCodeLine{4742                 STBI\_\_CASE(STBI\_\_F\_none) \{ cur[k] = raw[k]; \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4743                 STBI\_\_CASE(STBI\_\_F\_sub) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + cur[k -\/ output\_bytes]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4744                 STBI\_\_CASE(STBI\_\_F\_up) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + prior[k]); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4745                 STBI\_\_CASE(STBI\_\_F\_avg) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + ((prior[k] + cur[k -\/ output\_bytes]) >> 1)); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4746                 STBI\_\_CASE(STBI\_\_F\_paeth) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + stbi\_\_paeth(cur[k -\/ output\_bytes], prior[k], prior[k -\/ output\_bytes])); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4747                 STBI\_\_CASE(STBI\_\_F\_avg\_first) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + (cur[k -\/ output\_bytes] >> 1)); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4748                 STBI\_\_CASE(STBI\_\_F\_paeth\_first) \{ cur[k] = STBI\_\_BYTECAST(raw[k] + stbi\_\_paeth(cur[k -\/ output\_bytes], 0, 0)); \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{4749             \}}
\DoxyCodeLine{4750 \textcolor{preprocessor}{\#undef STBI\_\_CASE}}
\DoxyCodeLine{4751 }
\DoxyCodeLine{4752             \textcolor{comment}{// the loop above sets the high byte of the pixels' alpha, but for}}
\DoxyCodeLine{4753             \textcolor{comment}{// 16 bit png files we also need the low byte set. we'll do that here.}}
\DoxyCodeLine{4754             \textcolor{keywordflow}{if} (depth == 16) \{}
\DoxyCodeLine{4755                 cur = a-\/>out + stride * j; \textcolor{comment}{// start at the beginning of the row again}}
\DoxyCodeLine{4756                 \textcolor{keywordflow}{for} (i = 0; i < x; ++i, cur += output\_bytes) \{}
\DoxyCodeLine{4757                     cur[filter\_bytes + 1] = 255;}
\DoxyCodeLine{4758                 \}}
\DoxyCodeLine{4759             \}}
\DoxyCodeLine{4760         \}}
\DoxyCodeLine{4761     \}}
\DoxyCodeLine{4762 }
\DoxyCodeLine{4763     \textcolor{comment}{// we make a separate pass to expand bits to pixels; for performance,}}
\DoxyCodeLine{4764     \textcolor{comment}{// this could run two scanlines behind the above code, so it won't}}
\DoxyCodeLine{4765     \textcolor{comment}{// intefere with filtering but will still be in the cache.}}
\DoxyCodeLine{4766     \textcolor{keywordflow}{if} (depth < 8) \{}
\DoxyCodeLine{4767         \textcolor{keywordflow}{for} (j = 0; j < y; ++j) \{}
\DoxyCodeLine{4768             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* cur = a-\/>out + stride * j;}
\DoxyCodeLine{4769             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* in = a-\/>out + stride * j + x * out\_n -\/ img\_width\_bytes;}
\DoxyCodeLine{4770             \textcolor{comment}{// unpack 1/2/4-\/bit into a 8-\/bit buffer. allows us to keep the common 8-\/bit path optimal at minimal cost for 1/2/4-\/bit}}
\DoxyCodeLine{4771             \textcolor{comment}{// png guarante byte alignment, if width is not multiple of 8/4/2 we'll decode dummy trailing data that will be skipped in the later loop}}
\DoxyCodeLine{4772             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} scale = (color == 0) ? stbi\_\_depth\_scale\_table[depth] : 1; \textcolor{comment}{// scale grayscale values to 0..255 range}}
\DoxyCodeLine{4773 }
\DoxyCodeLine{4774             \textcolor{comment}{// note that the final byte might overshoot and write more data than desired.}}
\DoxyCodeLine{4775             \textcolor{comment}{// we can allocate enough data that this never writes out of memory, but it}}
\DoxyCodeLine{4776             \textcolor{comment}{// could also overwrite the next scanline. can it overwrite non-\/empty data}}
\DoxyCodeLine{4777             \textcolor{comment}{// on the next scanline? yes, consider 1-\/pixel-\/wide scanlines with 1-\/bit-\/per-\/pixel.}}
\DoxyCodeLine{4778             \textcolor{comment}{// so we need to explicitly clamp the final ones}}
\DoxyCodeLine{4779 }
\DoxyCodeLine{4780             \textcolor{keywordflow}{if} (depth == 4) \{}
\DoxyCodeLine{4781                 \textcolor{keywordflow}{for} (k = x * img\_n; k >= 2; k -\/= 2, ++in) \{}
\DoxyCodeLine{4782                     *cur++ = scale * ((*in >> 4));}
\DoxyCodeLine{4783                     *cur++ = scale * ((*in) \& 0x0f);}
\DoxyCodeLine{4784                 \}}
\DoxyCodeLine{4785                 \textcolor{keywordflow}{if} (k > 0) *cur++ = scale * ((*in >> 4));}
\DoxyCodeLine{4786             \}}
\DoxyCodeLine{4787             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (depth == 2) \{}
\DoxyCodeLine{4788                 \textcolor{keywordflow}{for} (k = x * img\_n; k >= 4; k -\/= 4, ++in) \{}
\DoxyCodeLine{4789                     *cur++ = scale * ((*in >> 6));}
\DoxyCodeLine{4790                     *cur++ = scale * ((*in >> 4) \& 0x03);}
\DoxyCodeLine{4791                     *cur++ = scale * ((*in >> 2) \& 0x03);}
\DoxyCodeLine{4792                     *cur++ = scale * ((*in) \& 0x03);}
\DoxyCodeLine{4793                 \}}
\DoxyCodeLine{4794                 \textcolor{keywordflow}{if} (k > 0) *cur++ = scale * ((*in >> 6));}
\DoxyCodeLine{4795                 \textcolor{keywordflow}{if} (k > 1) *cur++ = scale * ((*in >> 4) \& 0x03);}
\DoxyCodeLine{4796                 \textcolor{keywordflow}{if} (k > 2) *cur++ = scale * ((*in >> 2) \& 0x03);}
\DoxyCodeLine{4797             \}}
\DoxyCodeLine{4798             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (depth == 1) \{}
\DoxyCodeLine{4799                 \textcolor{keywordflow}{for} (k = x * img\_n; k >= 8; k -\/= 8, ++in) \{}
\DoxyCodeLine{4800                     *cur++ = scale * ((*in >> 7));}
\DoxyCodeLine{4801                     *cur++ = scale * ((*in >> 6) \& 0x01);}
\DoxyCodeLine{4802                     *cur++ = scale * ((*in >> 5) \& 0x01);}
\DoxyCodeLine{4803                     *cur++ = scale * ((*in >> 4) \& 0x01);}
\DoxyCodeLine{4804                     *cur++ = scale * ((*in >> 3) \& 0x01);}
\DoxyCodeLine{4805                     *cur++ = scale * ((*in >> 2) \& 0x01);}
\DoxyCodeLine{4806                     *cur++ = scale * ((*in >> 1) \& 0x01);}
\DoxyCodeLine{4807                     *cur++ = scale * ((*in) \& 0x01);}
\DoxyCodeLine{4808                 \}}
\DoxyCodeLine{4809                 \textcolor{keywordflow}{if} (k > 0) *cur++ = scale * ((*in >> 7));}
\DoxyCodeLine{4810                 \textcolor{keywordflow}{if} (k > 1) *cur++ = scale * ((*in >> 6) \& 0x01);}
\DoxyCodeLine{4811                 \textcolor{keywordflow}{if} (k > 2) *cur++ = scale * ((*in >> 5) \& 0x01);}
\DoxyCodeLine{4812                 \textcolor{keywordflow}{if} (k > 3) *cur++ = scale * ((*in >> 4) \& 0x01);}
\DoxyCodeLine{4813                 \textcolor{keywordflow}{if} (k > 4) *cur++ = scale * ((*in >> 3) \& 0x01);}
\DoxyCodeLine{4814                 \textcolor{keywordflow}{if} (k > 5) *cur++ = scale * ((*in >> 2) \& 0x01);}
\DoxyCodeLine{4815                 \textcolor{keywordflow}{if} (k > 6) *cur++ = scale * ((*in >> 1) \& 0x01);}
\DoxyCodeLine{4816             \}}
\DoxyCodeLine{4817             \textcolor{keywordflow}{if} (img\_n != out\_n) \{}
\DoxyCodeLine{4818                 \textcolor{keywordtype}{int} q;}
\DoxyCodeLine{4819                 \textcolor{comment}{// insert alpha = 255}}
\DoxyCodeLine{4820                 cur = a-\/>out + stride * j;}
\DoxyCodeLine{4821                 \textcolor{keywordflow}{if} (img\_n == 1) \{}
\DoxyCodeLine{4822                     \textcolor{keywordflow}{for} (q = x -\/ 1; q >= 0; -\/-\/q) \{}
\DoxyCodeLine{4823                         cur[q * 2 + 1] = 255;}
\DoxyCodeLine{4824                         cur[q * 2 + 0] = cur[q];}
\DoxyCodeLine{4825                     \}}
\DoxyCodeLine{4826                 \}}
\DoxyCodeLine{4827                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4828                     STBI\_ASSERT(img\_n == 3);}
\DoxyCodeLine{4829                     \textcolor{keywordflow}{for} (q = x -\/ 1; q >= 0; -\/-\/q) \{}
\DoxyCodeLine{4830                         cur[q * 4 + 3] = 255;}
\DoxyCodeLine{4831                         cur[q * 4 + 2] = cur[q * 3 + 2];}
\DoxyCodeLine{4832                         cur[q * 4 + 1] = cur[q * 3 + 1];}
\DoxyCodeLine{4833                         cur[q * 4 + 0] = cur[q * 3 + 0];}
\DoxyCodeLine{4834                     \}}
\DoxyCodeLine{4835                 \}}
\DoxyCodeLine{4836             \}}
\DoxyCodeLine{4837         \}}
\DoxyCodeLine{4838     \}}
\DoxyCodeLine{4839     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (depth == 16) \{}
\DoxyCodeLine{4840         \textcolor{comment}{// force the image data from big-\/endian to platform-\/native.}}
\DoxyCodeLine{4841         \textcolor{comment}{// this is done in a separate pass due to the decoding relying}}
\DoxyCodeLine{4842         \textcolor{comment}{// on the data being untouched, but could probably be done}}
\DoxyCodeLine{4843         \textcolor{comment}{// per-\/line during decode if care is taken.}}
\DoxyCodeLine{4844         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* cur = a-\/>out;}
\DoxyCodeLine{4845         stbi\_\_uint16* cur16 = (stbi\_\_uint16*)cur;}
\DoxyCodeLine{4846 }
\DoxyCodeLine{4847         \textcolor{keywordflow}{for} (i = 0; i < x * y * out\_n; ++i, cur16++, cur += 2) \{}
\DoxyCodeLine{4848             *cur16 = (cur[0] << 8) | cur[1];}
\DoxyCodeLine{4849         \}}
\DoxyCodeLine{4850     \}}
\DoxyCodeLine{4851 }
\DoxyCodeLine{4852     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4853 \}}
\DoxyCodeLine{4854 }
\DoxyCodeLine{4855 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_create\_png\_image(stbi\_\_png* a, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* image\_data, stbi\_\_uint32 image\_data\_len, \textcolor{keywordtype}{int} out\_n, \textcolor{keywordtype}{int} depth, \textcolor{keywordtype}{int} color, \textcolor{keywordtype}{int} interlaced)}
\DoxyCodeLine{4856 \{}
\DoxyCodeLine{4857     \textcolor{keywordtype}{int} bytes = (depth == 16 ? 2 : 1);}
\DoxyCodeLine{4858     \textcolor{keywordtype}{int} out\_bytes = out\_n * bytes;}
\DoxyCodeLine{4859     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* \textcolor{keyword}{final};}
\DoxyCodeLine{4860     \textcolor{keywordtype}{int} p;}
\DoxyCodeLine{4861     \textcolor{keywordflow}{if} (!interlaced)}
\DoxyCodeLine{4862         \textcolor{keywordflow}{return} stbi\_\_create\_png\_image\_raw(a, image\_data, image\_data\_len, out\_n, a-\/>s-\/>img\_x, a-\/>s-\/>img\_y, depth, color);}
\DoxyCodeLine{4863 }
\DoxyCodeLine{4864     \textcolor{comment}{// de-\/interlacing}}
\DoxyCodeLine{4865     \textcolor{keyword}{final} = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(a-\/>s-\/>img\_x, a-\/>s-\/>img\_y, out\_bytes, 0);}
\DoxyCodeLine{4866     \textcolor{keywordflow}{if} (!\textcolor{keyword}{final}) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4867     \textcolor{keywordflow}{for} (p = 0; p < 7; ++p) \{}
\DoxyCodeLine{4868         \textcolor{keywordtype}{int} xorig[] = \{ 0,4,0,2,0,1,0 \};}
\DoxyCodeLine{4869         \textcolor{keywordtype}{int} yorig[] = \{ 0,0,4,0,2,0,1 \};}
\DoxyCodeLine{4870         \textcolor{keywordtype}{int} xspc[] = \{ 8,8,4,4,2,2,1 \};}
\DoxyCodeLine{4871         \textcolor{keywordtype}{int} yspc[] = \{ 8,8,8,4,4,2,2 \};}
\DoxyCodeLine{4872         \textcolor{keywordtype}{int} i, j, x, y;}
\DoxyCodeLine{4873         \textcolor{comment}{// pass1\_x[4] = 0, pass1\_x[5] = 1, pass1\_x[12] = 1}}
\DoxyCodeLine{4874         x = (a-\/>s-\/>img\_x -\/ xorig[p] + xspc[p] -\/ 1) / xspc[p];}
\DoxyCodeLine{4875         y = (a-\/>s-\/>img\_y -\/ yorig[p] + yspc[p] -\/ 1) / yspc[p];}
\DoxyCodeLine{4876         \textcolor{keywordflow}{if} (x \&\& y) \{}
\DoxyCodeLine{4877             stbi\_\_uint32 img\_len = ((((a-\/>s-\/>img\_n * x * depth) + 7) >> 3) + 1) * y;}
\DoxyCodeLine{4878             \textcolor{keywordflow}{if} (!stbi\_\_create\_png\_image\_raw(a, image\_data, image\_data\_len, out\_n, x, y, depth, color)) \{}
\DoxyCodeLine{4879                 STBI\_FREE(\textcolor{keyword}{final});}
\DoxyCodeLine{4880                 \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4881             \}}
\DoxyCodeLine{4882             \textcolor{keywordflow}{for} (j = 0; j < y; ++j) \{}
\DoxyCodeLine{4883                 \textcolor{keywordflow}{for} (i = 0; i < x; ++i) \{}
\DoxyCodeLine{4884                     \textcolor{keywordtype}{int} out\_y = j * yspc[p] + yorig[p];}
\DoxyCodeLine{4885                     \textcolor{keywordtype}{int} out\_x = i * xspc[p] + xorig[p];}
\DoxyCodeLine{4886                     memcpy(\textcolor{keyword}{final} + out\_y * a-\/>s-\/>img\_x * out\_bytes + out\_x * out\_bytes,}
\DoxyCodeLine{4887                         a-\/>out + (j * x + i) * out\_bytes, out\_bytes);}
\DoxyCodeLine{4888                 \}}
\DoxyCodeLine{4889             \}}
\DoxyCodeLine{4890             STBI\_FREE(a-\/>out);}
\DoxyCodeLine{4891             image\_data += img\_len;}
\DoxyCodeLine{4892             image\_data\_len -\/= img\_len;}
\DoxyCodeLine{4893         \}}
\DoxyCodeLine{4894     \}}
\DoxyCodeLine{4895     a-\/>out = \textcolor{keyword}{final};}
\DoxyCodeLine{4896 }
\DoxyCodeLine{4897     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4898 \}}
\DoxyCodeLine{4899 }
\DoxyCodeLine{4900 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_compute\_transparency(stbi\_\_png* z, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} tc[3], \textcolor{keywordtype}{int} out\_n)}
\DoxyCodeLine{4901 \{}
\DoxyCodeLine{4902     stbi\_\_context* s = z-\/>s;}
\DoxyCodeLine{4903     stbi\_\_uint32 i, pixel\_count = s-\/>img\_x * s-\/>img\_y;}
\DoxyCodeLine{4904     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p = z-\/>out;}
\DoxyCodeLine{4905 }
\DoxyCodeLine{4906     \textcolor{comment}{// compute color-\/based transparency, assuming we've}}
\DoxyCodeLine{4907     \textcolor{comment}{// already got 255 as the alpha value in the output}}
\DoxyCodeLine{4908     STBI\_ASSERT(out\_n == 2 || out\_n == 4);}
\DoxyCodeLine{4909 }
\DoxyCodeLine{4910     \textcolor{keywordflow}{if} (out\_n == 2) \{}
\DoxyCodeLine{4911         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{4912             p[1] = (p[0] == tc[0] ? 0 : 255);}
\DoxyCodeLine{4913             p += 2;}
\DoxyCodeLine{4914         \}}
\DoxyCodeLine{4915     \}}
\DoxyCodeLine{4916     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4917         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{4918             \textcolor{keywordflow}{if} (p[0] == tc[0] \&\& p[1] == tc[1] \&\& p[2] == tc[2])}
\DoxyCodeLine{4919                 p[3] = 0;}
\DoxyCodeLine{4920             p += 4;}
\DoxyCodeLine{4921         \}}
\DoxyCodeLine{4922     \}}
\DoxyCodeLine{4923     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4924 \}}
\DoxyCodeLine{4925 }
\DoxyCodeLine{4926 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_compute\_transparency16(stbi\_\_png* z, stbi\_\_uint16 tc[3], \textcolor{keywordtype}{int} out\_n)}
\DoxyCodeLine{4927 \{}
\DoxyCodeLine{4928     stbi\_\_context* s = z-\/>s;}
\DoxyCodeLine{4929     stbi\_\_uint32 i, pixel\_count = s-\/>img\_x * s-\/>img\_y;}
\DoxyCodeLine{4930     stbi\_\_uint16* p = (stbi\_\_uint16*)z-\/>out;}
\DoxyCodeLine{4931 }
\DoxyCodeLine{4932     \textcolor{comment}{// compute color-\/based transparency, assuming we've}}
\DoxyCodeLine{4933     \textcolor{comment}{// already got 65535 as the alpha value in the output}}
\DoxyCodeLine{4934     STBI\_ASSERT(out\_n == 2 || out\_n == 4);}
\DoxyCodeLine{4935 }
\DoxyCodeLine{4936     \textcolor{keywordflow}{if} (out\_n == 2) \{}
\DoxyCodeLine{4937         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{4938             p[1] = (p[0] == tc[0] ? 0 : 65535);}
\DoxyCodeLine{4939             p += 2;}
\DoxyCodeLine{4940         \}}
\DoxyCodeLine{4941     \}}
\DoxyCodeLine{4942     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4943         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{4944             \textcolor{keywordflow}{if} (p[0] == tc[0] \&\& p[1] == tc[1] \&\& p[2] == tc[2])}
\DoxyCodeLine{4945                 p[3] = 0;}
\DoxyCodeLine{4946             p += 4;}
\DoxyCodeLine{4947         \}}
\DoxyCodeLine{4948     \}}
\DoxyCodeLine{4949     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4950 \}}
\DoxyCodeLine{4951 }
\DoxyCodeLine{4952 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_expand\_png\_palette(stbi\_\_png* a, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* palette, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} pal\_img\_n)}
\DoxyCodeLine{4953 \{}
\DoxyCodeLine{4954     stbi\_\_uint32 i, pixel\_count = a-\/>s-\/>img\_x * a-\/>s-\/>img\_y;}
\DoxyCodeLine{4955     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p, * temp\_out, * orig = a-\/>out;}
\DoxyCodeLine{4956 }
\DoxyCodeLine{4957     p = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad2(pixel\_count, pal\_img\_n, 0);}
\DoxyCodeLine{4958     \textcolor{keywordflow}{if} (p == NULL) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{4959 }
\DoxyCodeLine{4960     \textcolor{comment}{// between here and free(out) below, exitting would leak}}
\DoxyCodeLine{4961     temp\_out = p;}
\DoxyCodeLine{4962 }
\DoxyCodeLine{4963     \textcolor{keywordflow}{if} (pal\_img\_n == 3) \{}
\DoxyCodeLine{4964         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{4965             \textcolor{keywordtype}{int} n = orig[i] * 4;}
\DoxyCodeLine{4966             p[0] = palette[n];}
\DoxyCodeLine{4967             p[1] = palette[n + 1];}
\DoxyCodeLine{4968             p[2] = palette[n + 2];}
\DoxyCodeLine{4969             p += 3;}
\DoxyCodeLine{4970         \}}
\DoxyCodeLine{4971     \}}
\DoxyCodeLine{4972     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4973         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{4974             \textcolor{keywordtype}{int} n = orig[i] * 4;}
\DoxyCodeLine{4975             p[0] = palette[n];}
\DoxyCodeLine{4976             p[1] = palette[n + 1];}
\DoxyCodeLine{4977             p[2] = palette[n + 2];}
\DoxyCodeLine{4978             p[3] = palette[n + 3];}
\DoxyCodeLine{4979             p += 4;}
\DoxyCodeLine{4980         \}}
\DoxyCodeLine{4981     \}}
\DoxyCodeLine{4982     STBI\_FREE(a-\/>out);}
\DoxyCodeLine{4983     a-\/>out = temp\_out;}
\DoxyCodeLine{4984 }
\DoxyCodeLine{4985     STBI\_NOTUSED(len);}
\DoxyCodeLine{4986 }
\DoxyCodeLine{4987     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{4988 \}}
\DoxyCodeLine{4989 }
\DoxyCodeLine{4990 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_unpremultiply\_on\_load\_global = 0;}
\DoxyCodeLine{4991 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_de\_iphone\_flag\_global = 0;}
\DoxyCodeLine{4992 }
\DoxyCodeLine{4993 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_a3f02e0053e1c8d08a3ed436e6a82c7c9}{stbi\_set\_unpremultiply\_on\_load}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_unpremultiply)}
\DoxyCodeLine{4994 \{}
\DoxyCodeLine{4995     stbi\_\_unpremultiply\_on\_load\_global = flag\_true\_if\_should\_unpremultiply;}
\DoxyCodeLine{4996 \}}
\DoxyCodeLine{4997 }
\DoxyCodeLine{4998 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_a23525ef2b882f3de426b47ecf8d9151b}{stbi\_convert\_iphone\_png\_to\_rgb}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_convert)}
\DoxyCodeLine{4999 \{}
\DoxyCodeLine{5000     stbi\_\_de\_iphone\_flag\_global = flag\_true\_if\_should\_convert;}
\DoxyCodeLine{5001 \}}
\DoxyCodeLine{5002 }
\DoxyCodeLine{5003 \textcolor{preprocessor}{\#ifndef STBI\_THREAD\_LOCAL}}
\DoxyCodeLine{5004 \textcolor{preprocessor}{\#define stbi\_\_unpremultiply\_on\_load  stbi\_\_unpremultiply\_on\_load\_global}}
\DoxyCodeLine{5005 \textcolor{preprocessor}{\#define stbi\_\_de\_iphone\_flag  stbi\_\_de\_iphone\_flag\_global}}
\DoxyCodeLine{5006 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{5007 \textcolor{keyword}{static} STBI\_THREAD\_LOCAL \textcolor{keywordtype}{int} stbi\_\_unpremultiply\_on\_load\_local, stbi\_\_unpremultiply\_on\_load\_set;}
\DoxyCodeLine{5008 \textcolor{keyword}{static} STBI\_THREAD\_LOCAL \textcolor{keywordtype}{int} stbi\_\_de\_iphone\_flag\_local, stbi\_\_de\_iphone\_flag\_set;}
\DoxyCodeLine{5009 }
\DoxyCodeLine{5010 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} stbi\_\_unpremultiply\_on\_load\_thread(\textcolor{keywordtype}{int} flag\_true\_if\_should\_unpremultiply)}
\DoxyCodeLine{5011 \{}
\DoxyCodeLine{5012     stbi\_\_unpremultiply\_on\_load\_local = flag\_true\_if\_should\_unpremultiply;}
\DoxyCodeLine{5013     stbi\_\_unpremultiply\_on\_load\_set = 1;}
\DoxyCodeLine{5014 \}}
\DoxyCodeLine{5015 }
\DoxyCodeLine{5016 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{void} \mbox{\hyperlink{stb__image_8h_aff26696e30b62a40dd00bc12415343f6}{stbi\_convert\_iphone\_png\_to\_rgb\_thread}}(\textcolor{keywordtype}{int} flag\_true\_if\_should\_convert)}
\DoxyCodeLine{5017 \{}
\DoxyCodeLine{5018     stbi\_\_de\_iphone\_flag\_local = flag\_true\_if\_should\_convert;}
\DoxyCodeLine{5019     stbi\_\_de\_iphone\_flag\_set = 1;}
\DoxyCodeLine{5020 \}}
\DoxyCodeLine{5021 }
\DoxyCodeLine{5022 \textcolor{preprocessor}{\#define stbi\_\_unpremultiply\_on\_load  (stbi\_\_unpremultiply\_on\_load\_set           \(\backslash\)}}
\DoxyCodeLine{5023 \textcolor{preprocessor}{                                       ? stbi\_\_unpremultiply\_on\_load\_local      \(\backslash\)}}
\DoxyCodeLine{5024 \textcolor{preprocessor}{                                       : stbi\_\_unpremultiply\_on\_load\_global)}}
\DoxyCodeLine{5025 \textcolor{preprocessor}{\#define stbi\_\_de\_iphone\_flag  (stbi\_\_de\_iphone\_flag\_set                         \(\backslash\)}}
\DoxyCodeLine{5026 \textcolor{preprocessor}{                                ? stbi\_\_de\_iphone\_flag\_local                    \(\backslash\)}}
\DoxyCodeLine{5027 \textcolor{preprocessor}{                                : stbi\_\_de\_iphone\_flag\_global)}}
\DoxyCodeLine{5028 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_THREAD\_LOCAL}}
\DoxyCodeLine{5029 }
\DoxyCodeLine{5030 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_de\_iphone(stbi\_\_png* z)}
\DoxyCodeLine{5031 \{}
\DoxyCodeLine{5032     stbi\_\_context* s = z-\/>s;}
\DoxyCodeLine{5033     stbi\_\_uint32 i, pixel\_count = s-\/>img\_x * s-\/>img\_y;}
\DoxyCodeLine{5034     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p = z-\/>out;}
\DoxyCodeLine{5035 }
\DoxyCodeLine{5036     \textcolor{keywordflow}{if} (s-\/>img\_out\_n == 3) \{  \textcolor{comment}{// convert bgr to rgb}}
\DoxyCodeLine{5037         \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{5038             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} t = p[0];}
\DoxyCodeLine{5039             p[0] = p[2];}
\DoxyCodeLine{5040             p[2] = t;}
\DoxyCodeLine{5041             p += 3;}
\DoxyCodeLine{5042         \}}
\DoxyCodeLine{5043     \}}
\DoxyCodeLine{5044     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5045         STBI\_ASSERT(s-\/>img\_out\_n == 4);}
\DoxyCodeLine{5046         \textcolor{keywordflow}{if} (stbi\_\_unpremultiply\_on\_load) \{}
\DoxyCodeLine{5047             \textcolor{comment}{// convert bgr to rgb and unpremultiply}}
\DoxyCodeLine{5048             \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{5049                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} a = p[3];}
\DoxyCodeLine{5050                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} t = p[0];}
\DoxyCodeLine{5051                 \textcolor{keywordflow}{if} (a) \{}
\DoxyCodeLine{5052                     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} half = a / 2;}
\DoxyCodeLine{5053                     p[0] = (p[2] * 255 + half) / a;}
\DoxyCodeLine{5054                     p[1] = (p[1] * 255 + half) / a;}
\DoxyCodeLine{5055                     p[2] = (t * 255 + half) / a;}
\DoxyCodeLine{5056                 \}}
\DoxyCodeLine{5057                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5058                     p[0] = p[2];}
\DoxyCodeLine{5059                     p[2] = t;}
\DoxyCodeLine{5060                 \}}
\DoxyCodeLine{5061                 p += 4;}
\DoxyCodeLine{5062             \}}
\DoxyCodeLine{5063         \}}
\DoxyCodeLine{5064         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5065             \textcolor{comment}{// convert bgr to rgb}}
\DoxyCodeLine{5066             \textcolor{keywordflow}{for} (i = 0; i < pixel\_count; ++i) \{}
\DoxyCodeLine{5067                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} t = p[0];}
\DoxyCodeLine{5068                 p[0] = p[2];}
\DoxyCodeLine{5069                 p[2] = t;}
\DoxyCodeLine{5070                 p += 4;}
\DoxyCodeLine{5071             \}}
\DoxyCodeLine{5072         \}}
\DoxyCodeLine{5073     \}}
\DoxyCodeLine{5074 \}}
\DoxyCodeLine{5075 }
\DoxyCodeLine{5076 \textcolor{preprocessor}{\#define STBI\_\_PNG\_TYPE(a,b,c,d)  (((unsigned) (a) << 24) + ((unsigned) (b) << 16) + ((unsigned) (c) << 8) + (unsigned) (d))}}
\DoxyCodeLine{5077 }
\DoxyCodeLine{5078 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_parse\_png\_file(stbi\_\_png* z, \textcolor{keywordtype}{int} scan, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{5079 \{}
\DoxyCodeLine{5080     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} palette[1024], pal\_img\_n = 0;}
\DoxyCodeLine{5081     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} has\_trans = 0, tc[3] = \{ 0 \};}
\DoxyCodeLine{5082     stbi\_\_uint16 tc16[3];}
\DoxyCodeLine{5083     stbi\_\_uint32 ioff = 0, idata\_limit = 0, i, pal\_len = 0;}
\DoxyCodeLine{5084     \textcolor{keywordtype}{int} first = 1, k, interlace = 0, color = 0, is\_iphone = 0;}
\DoxyCodeLine{5085     stbi\_\_context* s = z-\/>s;}
\DoxyCodeLine{5086 }
\DoxyCodeLine{5087     z-\/>expanded = NULL;}
\DoxyCodeLine{5088     z-\/>idata = NULL;}
\DoxyCodeLine{5089     z-\/>out = NULL;}
\DoxyCodeLine{5090 }
\DoxyCodeLine{5091     \textcolor{keywordflow}{if} (!stbi\_\_check\_png\_header(s)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5092 }
\DoxyCodeLine{5093     \textcolor{keywordflow}{if} (scan == STBI\_\_SCAN\_type) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5094 }
\DoxyCodeLine{5095     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{5096         stbi\_\_pngchunk c = stbi\_\_get\_chunk\_header(s);}
\DoxyCodeLine{5097         \textcolor{keywordflow}{switch} (c.type) \{}
\DoxyCodeLine{5098         \textcolor{keywordflow}{case} STBI\_\_PNG\_TYPE(\textcolor{charliteral}{'C'}, \textcolor{charliteral}{'g'}, \textcolor{charliteral}{'B'}, \textcolor{charliteral}{'I'}):}
\DoxyCodeLine{5099             is\_iphone = 1;}
\DoxyCodeLine{5100             stbi\_\_skip(s, c.length);}
\DoxyCodeLine{5101             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5102         \textcolor{keywordflow}{case} STBI\_\_PNG\_TYPE(\textcolor{charliteral}{'I'}, \textcolor{charliteral}{'H'}, \textcolor{charliteral}{'D'}, \textcolor{charliteral}{'R'}): \{}
\DoxyCodeLine{5103             \textcolor{keywordtype}{int} comp, filter;}
\DoxyCodeLine{5104             \textcolor{keywordflow}{if} (!first) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}multiple IHDR"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5105             first = 0;}
\DoxyCodeLine{5106             \textcolor{keywordflow}{if} (c.length != 13) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad IHDR len"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5107             s-\/>img\_x = stbi\_\_get32be(s);}
\DoxyCodeLine{5108             s-\/>img\_y = stbi\_\_get32be(s);}
\DoxyCodeLine{5109             \textcolor{keywordflow}{if} (s-\/>img\_y > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{5110             \textcolor{keywordflow}{if} (s-\/>img\_x > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{5111             z-\/>depth = stbi\_\_get8(s);  \textcolor{keywordflow}{if} (z-\/>depth != 1 \&\& z-\/>depth != 2 \&\& z-\/>depth != 4 \&\& z-\/>depth != 8 \&\& z-\/>depth != 16)  \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}1/2/4/8/16-\/bit only"{}}, \textcolor{stringliteral}{"{}PNG not supported: 1/2/4/8/16-\/bit only"{}});}
\DoxyCodeLine{5112             color = stbi\_\_get8(s);  \textcolor{keywordflow}{if} (color > 6)         \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad ctype"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5113             \textcolor{keywordflow}{if} (color == 3 \&\& z-\/>depth == 16)                  \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad ctype"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5114             \textcolor{keywordflow}{if} (color == 3) pal\_img\_n = 3; \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (color \& 1) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad ctype"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5115             comp = stbi\_\_get8(s);  \textcolor{keywordflow}{if} (comp) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad comp method"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5116             filter = stbi\_\_get8(s);  \textcolor{keywordflow}{if} (filter) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad filter method"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5117             interlace = stbi\_\_get8(s); \textcolor{keywordflow}{if} (interlace > 1) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad interlace method"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5118             \textcolor{keywordflow}{if} (!s-\/>img\_x || !s-\/>img\_y) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}0-\/pixel image"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5119             \textcolor{keywordflow}{if} (!pal\_img\_n) \{}
\DoxyCodeLine{5120                 s-\/>img\_n = (color \& 2 ? 3 : 1) + (color \& 4 ? 1 : 0);}
\DoxyCodeLine{5121                 \textcolor{keywordflow}{if} ((1 << 30) / s-\/>img\_x / s-\/>img\_n < s-\/>img\_y) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Image too large to decode"{}});}
\DoxyCodeLine{5122                 \textcolor{keywordflow}{if} (scan == STBI\_\_SCAN\_header) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5123             \}}
\DoxyCodeLine{5124             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5125                 \textcolor{comment}{// if paletted, then pal\_n is our final components, and}}
\DoxyCodeLine{5126                 \textcolor{comment}{// img\_n is \# components to decompress/filter.}}
\DoxyCodeLine{5127                 s-\/>img\_n = 1;}
\DoxyCodeLine{5128                 \textcolor{keywordflow}{if} ((1 << 30) / s-\/>img\_x / 4 < s-\/>img\_y) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5129                 \textcolor{comment}{// if SCAN\_header, have to scan to see if we have a tRNS}}
\DoxyCodeLine{5130             \}}
\DoxyCodeLine{5131             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5132         \}}
\DoxyCodeLine{5133 }
\DoxyCodeLine{5134         \textcolor{keywordflow}{case} STBI\_\_PNG\_TYPE(\textcolor{charliteral}{'P'}, \textcolor{charliteral}{'L'}, \textcolor{charliteral}{'T'}, \textcolor{charliteral}{'E'}): \{}
\DoxyCodeLine{5135             \textcolor{keywordflow}{if} (first) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}first not IHDR"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5136             \textcolor{keywordflow}{if} (c.length > 256 * 3) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}invalid PLTE"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5137             pal\_len = c.length / 3;}
\DoxyCodeLine{5138             \textcolor{keywordflow}{if} (pal\_len * 3 != c.length) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}invalid PLTE"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5139             \textcolor{keywordflow}{for} (i = 0; i < pal\_len; ++i) \{}
\DoxyCodeLine{5140                 palette[i * 4 + 0] = stbi\_\_get8(s);}
\DoxyCodeLine{5141                 palette[i * 4 + 1] = stbi\_\_get8(s);}
\DoxyCodeLine{5142                 palette[i * 4 + 2] = stbi\_\_get8(s);}
\DoxyCodeLine{5143                 palette[i * 4 + 3] = 255;}
\DoxyCodeLine{5144             \}}
\DoxyCodeLine{5145             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5146         \}}
\DoxyCodeLine{5147 }
\DoxyCodeLine{5148         \textcolor{keywordflow}{case} STBI\_\_PNG\_TYPE(\textcolor{charliteral}{'t'}, \textcolor{charliteral}{'R'}, \textcolor{charliteral}{'N'}, \textcolor{charliteral}{'S'}): \{}
\DoxyCodeLine{5149             \textcolor{keywordflow}{if} (first) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}first not IHDR"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5150             \textcolor{keywordflow}{if} (z-\/>idata) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}tRNS after IDAT"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5151             \textcolor{keywordflow}{if} (pal\_img\_n) \{}
\DoxyCodeLine{5152                 \textcolor{keywordflow}{if} (scan == STBI\_\_SCAN\_header) \{ s-\/>img\_n = 4; \textcolor{keywordflow}{return} 1; \}}
\DoxyCodeLine{5153                 \textcolor{keywordflow}{if} (pal\_len == 0) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}tRNS before PLTE"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5154                 \textcolor{keywordflow}{if} (c.length > pal\_len) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad tRNS len"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5155                 pal\_img\_n = 4;}
\DoxyCodeLine{5156                 \textcolor{keywordflow}{for} (i = 0; i < c.length; ++i)}
\DoxyCodeLine{5157                     palette[i * 4 + 3] = stbi\_\_get8(s);}
\DoxyCodeLine{5158             \}}
\DoxyCodeLine{5159             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5160                 \textcolor{keywordflow}{if} (!(s-\/>img\_n \& 1)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}tRNS with alpha"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5161                 \textcolor{keywordflow}{if} (c.length != (stbi\_\_uint32)s-\/>img\_n * 2) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}bad tRNS len"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5162                 has\_trans = 1;}
\DoxyCodeLine{5163                 \textcolor{keywordflow}{if} (z-\/>depth == 16) \{}
\DoxyCodeLine{5164                     \textcolor{keywordflow}{for} (k = 0; k < s-\/>img\_n; ++k) tc16[k] = (stbi\_\_uint16)stbi\_\_get16be(s); \textcolor{comment}{// copy the values as-\/is}}
\DoxyCodeLine{5165                 \}}
\DoxyCodeLine{5166                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5167                     \textcolor{keywordflow}{for} (k = 0; k < s-\/>img\_n; ++k) tc[k] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})(stbi\_\_get16be(s) \& 255) * stbi\_\_depth\_scale\_table[z-\/>depth]; \textcolor{comment}{// non 8-\/bit images will be larger}}
\DoxyCodeLine{5168                 \}}
\DoxyCodeLine{5169             \}}
\DoxyCodeLine{5170             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5171         \}}
\DoxyCodeLine{5172 }
\DoxyCodeLine{5173         \textcolor{keywordflow}{case} STBI\_\_PNG\_TYPE(\textcolor{charliteral}{'I'}, \textcolor{charliteral}{'D'}, \textcolor{charliteral}{'A'}, \textcolor{charliteral}{'T'}): \{}
\DoxyCodeLine{5174             \textcolor{keywordflow}{if} (first) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}first not IHDR"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5175             \textcolor{keywordflow}{if} (pal\_img\_n \&\& !pal\_len) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}no PLTE"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5176             \textcolor{keywordflow}{if} (scan == STBI\_\_SCAN\_header) \{ s-\/>img\_n = pal\_img\_n; \textcolor{keywordflow}{return} 1; \}}
\DoxyCodeLine{5177             \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int})(ioff + c.length) < (\textcolor{keywordtype}{int})ioff) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5178             \textcolor{keywordflow}{if} (ioff + c.length > idata\_limit) \{}
\DoxyCodeLine{5179                 stbi\_\_uint32 idata\_limit\_old = idata\_limit;}
\DoxyCodeLine{5180                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p;}
\DoxyCodeLine{5181                 \textcolor{keywordflow}{if} (idata\_limit == 0) idata\_limit = c.length > 4096 ? c.length : 4096;}
\DoxyCodeLine{5182                 \textcolor{keywordflow}{while} (ioff + c.length > idata\_limit)}
\DoxyCodeLine{5183                     idata\_limit *= 2;}
\DoxyCodeLine{5184                 STBI\_NOTUSED(idata\_limit\_old);}
\DoxyCodeLine{5185                 p = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)STBI\_REALLOC\_SIZED(z-\/>idata, idata\_limit\_old, idata\_limit); \textcolor{keywordflow}{if} (p == NULL) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{5186                 z-\/>idata = p;}
\DoxyCodeLine{5187             \}}
\DoxyCodeLine{5188             \textcolor{keywordflow}{if} (!stbi\_\_getn(s, z-\/>idata + ioff, c.length)) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofdata"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5189             ioff += c.length;}
\DoxyCodeLine{5190             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5191         \}}
\DoxyCodeLine{5192 }
\DoxyCodeLine{5193         \textcolor{keywordflow}{case} STBI\_\_PNG\_TYPE(\textcolor{charliteral}{'I'}, \textcolor{charliteral}{'E'}, \textcolor{charliteral}{'N'}, \textcolor{charliteral}{'D'}): \{}
\DoxyCodeLine{5194             stbi\_\_uint32 raw\_len, bpl;}
\DoxyCodeLine{5195             \textcolor{keywordflow}{if} (first) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}first not IHDR"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5196             \textcolor{keywordflow}{if} (scan != STBI\_\_SCAN\_load) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5197             \textcolor{keywordflow}{if} (z-\/>idata == NULL) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}no IDAT"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5198             \textcolor{comment}{// initial guess for decoded data size to avoid unnecessary reallocs}}
\DoxyCodeLine{5199             bpl = (s-\/>img\_x * z-\/>depth + 7) / 8; \textcolor{comment}{// bytes per line, per component}}
\DoxyCodeLine{5200             raw\_len = bpl * s-\/>img\_y * s-\/>img\_n \textcolor{comment}{/* pixels */} + s-\/>img\_y \textcolor{comment}{/* filter mode per row */};}
\DoxyCodeLine{5201             z-\/>expanded = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)\mbox{\hyperlink{stb__image_8h_adc3de199aa29f7370a699ad545155541}{stbi\_zlib\_decode\_malloc\_guesssize\_headerflag}}((\textcolor{keywordtype}{char}*)z-\/>idata, ioff, raw\_len, (\textcolor{keywordtype}{int}*)\&raw\_len, !is\_iphone);}
\DoxyCodeLine{5202             \textcolor{keywordflow}{if} (z-\/>expanded == NULL) \textcolor{keywordflow}{return} 0; \textcolor{comment}{// zlib should set error}}
\DoxyCodeLine{5203             STBI\_FREE(z-\/>idata); z-\/>idata = NULL;}
\DoxyCodeLine{5204             \textcolor{keywordflow}{if} ((req\_comp == s-\/>img\_n + 1 \&\& req\_comp != 3 \&\& !pal\_img\_n) || has\_trans)}
\DoxyCodeLine{5205                 s-\/>img\_out\_n = s-\/>img\_n + 1;}
\DoxyCodeLine{5206             \textcolor{keywordflow}{else}}
\DoxyCodeLine{5207                 s-\/>img\_out\_n = s-\/>img\_n;}
\DoxyCodeLine{5208             \textcolor{keywordflow}{if} (!stbi\_\_create\_png\_image(z, z-\/>expanded, raw\_len, s-\/>img\_out\_n, z-\/>depth, color, interlace)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5209             \textcolor{keywordflow}{if} (has\_trans) \{}
\DoxyCodeLine{5210                 \textcolor{keywordflow}{if} (z-\/>depth == 16) \{}
\DoxyCodeLine{5211                     \textcolor{keywordflow}{if} (!stbi\_\_compute\_transparency16(z, tc16, s-\/>img\_out\_n)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5212                 \}}
\DoxyCodeLine{5213                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5214                     \textcolor{keywordflow}{if} (!stbi\_\_compute\_transparency(z, tc, s-\/>img\_out\_n)) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5215                 \}}
\DoxyCodeLine{5216             \}}
\DoxyCodeLine{5217             \textcolor{keywordflow}{if} (is\_iphone \&\& stbi\_\_de\_iphone\_flag \&\& s-\/>img\_out\_n > 2)}
\DoxyCodeLine{5218                 stbi\_\_de\_iphone(z);}
\DoxyCodeLine{5219             \textcolor{keywordflow}{if} (pal\_img\_n) \{}
\DoxyCodeLine{5220                 \textcolor{comment}{// pal\_img\_n == 3 or 4}}
\DoxyCodeLine{5221                 s-\/>img\_n = pal\_img\_n; \textcolor{comment}{// record the actual colors we had}}
\DoxyCodeLine{5222                 s-\/>img\_out\_n = pal\_img\_n;}
\DoxyCodeLine{5223                 \textcolor{keywordflow}{if} (req\_comp >= 3) s-\/>img\_out\_n = req\_comp;}
\DoxyCodeLine{5224                 \textcolor{keywordflow}{if} (!stbi\_\_expand\_png\_palette(z, palette, pal\_len, s-\/>img\_out\_n))}
\DoxyCodeLine{5225                     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5226             \}}
\DoxyCodeLine{5227             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (has\_trans) \{}
\DoxyCodeLine{5228                 \textcolor{comment}{// non-\/paletted image with tRNS -\/> source image has (constant) alpha}}
\DoxyCodeLine{5229                 ++s-\/>img\_n;}
\DoxyCodeLine{5230             \}}
\DoxyCodeLine{5231             STBI\_FREE(z-\/>expanded); z-\/>expanded = NULL;}
\DoxyCodeLine{5232             \textcolor{comment}{// end of PNG chunk, read and skip CRC}}
\DoxyCodeLine{5233             stbi\_\_get32be(s);}
\DoxyCodeLine{5234             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5235         \}}
\DoxyCodeLine{5236 }
\DoxyCodeLine{5237         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{5238             \textcolor{comment}{// if critical, fail}}
\DoxyCodeLine{5239             \textcolor{keywordflow}{if} (first) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}first not IHDR"{}}, \textcolor{stringliteral}{"{}Corrupt PNG"{}});}
\DoxyCodeLine{5240             \textcolor{keywordflow}{if} ((c.type \& (1 << 29)) == 0) \{}
\DoxyCodeLine{5241 \textcolor{preprocessor}{\#ifndef STBI\_NO\_FAILURE\_STRINGS}}
\DoxyCodeLine{5242                 \textcolor{comment}{// not threadsafe}}
\DoxyCodeLine{5243                 \textcolor{keyword}{static} \textcolor{keywordtype}{char} invalid\_chunk[] = \textcolor{stringliteral}{"{}XXXX PNG chunk not known"{}};}
\DoxyCodeLine{5244                 invalid\_chunk[0] = STBI\_\_BYTECAST(c.type >> 24);}
\DoxyCodeLine{5245                 invalid\_chunk[1] = STBI\_\_BYTECAST(c.type >> 16);}
\DoxyCodeLine{5246                 invalid\_chunk[2] = STBI\_\_BYTECAST(c.type >> 8);}
\DoxyCodeLine{5247                 invalid\_chunk[3] = STBI\_\_BYTECAST(c.type >> 0);}
\DoxyCodeLine{5248 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5249                 \textcolor{keywordflow}{return} stbi\_\_err(invalid\_chunk, \textcolor{stringliteral}{"{}PNG not supported: unknown PNG chunk type"{}});}
\DoxyCodeLine{5250             \}}
\DoxyCodeLine{5251             stbi\_\_skip(s, c.length);}
\DoxyCodeLine{5252             \textcolor{keywordflow}{break};}
\DoxyCodeLine{5253         \}}
\DoxyCodeLine{5254         \textcolor{comment}{// end of PNG chunk, read and skip CRC}}
\DoxyCodeLine{5255         stbi\_\_get32be(s);}
\DoxyCodeLine{5256     \}}
\DoxyCodeLine{5257 \}}
\DoxyCodeLine{5258 }
\DoxyCodeLine{5259 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_do\_png(stbi\_\_png* p, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* n, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{5260 \{}
\DoxyCodeLine{5261     \textcolor{keywordtype}{void}* result = NULL;}
\DoxyCodeLine{5262     \textcolor{keywordflow}{if} (req\_comp < 0 || req\_comp > 4) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad req\_comp"{}}, \textcolor{stringliteral}{"{}Internal error"{}});}
\DoxyCodeLine{5263     \textcolor{keywordflow}{if} (stbi\_\_parse\_png\_file(p, STBI\_\_SCAN\_load, req\_comp)) \{}
\DoxyCodeLine{5264         \textcolor{keywordflow}{if} (p-\/>depth <= 8)}
\DoxyCodeLine{5265             ri-\/>bits\_per\_channel = 8;}
\DoxyCodeLine{5266         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>depth == 16)}
\DoxyCodeLine{5267             ri-\/>bits\_per\_channel = 16;}
\DoxyCodeLine{5268         \textcolor{keywordflow}{else}}
\DoxyCodeLine{5269             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad bits\_per\_channel"{}}, \textcolor{stringliteral}{"{}PNG not supported: unsupported color depth"{}});}
\DoxyCodeLine{5270         result = p-\/>out;}
\DoxyCodeLine{5271         p-\/>out = NULL;}
\DoxyCodeLine{5272         \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != p-\/>s-\/>img\_out\_n) \{}
\DoxyCodeLine{5273             \textcolor{keywordflow}{if} (ri-\/>bits\_per\_channel == 8)}
\DoxyCodeLine{5274                 result = stbi\_\_convert\_format((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)result, p-\/>s-\/>img\_out\_n, req\_comp, p-\/>s-\/>img\_x, p-\/>s-\/>img\_y);}
\DoxyCodeLine{5275             \textcolor{keywordflow}{else}}
\DoxyCodeLine{5276                 result = stbi\_\_convert\_format16((stbi\_\_uint16*)result, p-\/>s-\/>img\_out\_n, req\_comp, p-\/>s-\/>img\_x, p-\/>s-\/>img\_y);}
\DoxyCodeLine{5277             p-\/>s-\/>img\_out\_n = req\_comp;}
\DoxyCodeLine{5278             \textcolor{keywordflow}{if} (result == NULL) \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{5279         \}}
\DoxyCodeLine{5280         *x = p-\/>s-\/>img\_x;}
\DoxyCodeLine{5281         *y = p-\/>s-\/>img\_y;}
\DoxyCodeLine{5282         \textcolor{keywordflow}{if} (n) *n = p-\/>s-\/>img\_n;}
\DoxyCodeLine{5283     \}}
\DoxyCodeLine{5284     STBI\_FREE(p-\/>out);      p-\/>out = NULL;}
\DoxyCodeLine{5285     STBI\_FREE(p-\/>expanded); p-\/>expanded = NULL;}
\DoxyCodeLine{5286     STBI\_FREE(p-\/>idata);    p-\/>idata = NULL;}
\DoxyCodeLine{5287 }
\DoxyCodeLine{5288     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{5289 \}}
\DoxyCodeLine{5290 }
\DoxyCodeLine{5291 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_png\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{5292 \{}
\DoxyCodeLine{5293     stbi\_\_png p;}
\DoxyCodeLine{5294     p.s = s;}
\DoxyCodeLine{5295     \textcolor{keywordflow}{return} stbi\_\_do\_png(\&p, x, y, comp, req\_comp, ri);}
\DoxyCodeLine{5296 \}}
\DoxyCodeLine{5297 }
\DoxyCodeLine{5298 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_png\_test(stbi\_\_context* s)}
\DoxyCodeLine{5299 \{}
\DoxyCodeLine{5300     \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{5301     r = stbi\_\_check\_png\_header(s);}
\DoxyCodeLine{5302     stbi\_\_rewind(s);}
\DoxyCodeLine{5303     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{5304 \}}
\DoxyCodeLine{5305 }
\DoxyCodeLine{5306 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_png\_info\_raw(stbi\_\_png* p, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{5307 \{}
\DoxyCodeLine{5308     \textcolor{keywordflow}{if} (!stbi\_\_parse\_png\_file(p, STBI\_\_SCAN\_header, 0)) \{}
\DoxyCodeLine{5309         stbi\_\_rewind(p-\/>s);}
\DoxyCodeLine{5310         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5311     \}}
\DoxyCodeLine{5312     \textcolor{keywordflow}{if} (x) *x = p-\/>s-\/>img\_x;}
\DoxyCodeLine{5313     \textcolor{keywordflow}{if} (y) *y = p-\/>s-\/>img\_y;}
\DoxyCodeLine{5314     \textcolor{keywordflow}{if} (comp) *comp = p-\/>s-\/>img\_n;}
\DoxyCodeLine{5315     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5316 \}}
\DoxyCodeLine{5317 }
\DoxyCodeLine{5318 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_png\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{5319 \{}
\DoxyCodeLine{5320     stbi\_\_png p;}
\DoxyCodeLine{5321     p.s = s;}
\DoxyCodeLine{5322     \textcolor{keywordflow}{return} stbi\_\_png\_info\_raw(\&p, x, y, comp);}
\DoxyCodeLine{5323 \}}
\DoxyCodeLine{5324 }
\DoxyCodeLine{5325 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_png\_is16(stbi\_\_context* s)}
\DoxyCodeLine{5326 \{}
\DoxyCodeLine{5327     stbi\_\_png p;}
\DoxyCodeLine{5328     p.s = s;}
\DoxyCodeLine{5329     \textcolor{keywordflow}{if} (!stbi\_\_png\_info\_raw(\&p, NULL, NULL, NULL))}
\DoxyCodeLine{5330         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5331     \textcolor{keywordflow}{if} (p.depth != 16) \{}
\DoxyCodeLine{5332         stbi\_\_rewind(p.s);}
\DoxyCodeLine{5333         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5334     \}}
\DoxyCodeLine{5335     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5336 \}}
\DoxyCodeLine{5337 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5338 }
\DoxyCodeLine{5339 \textcolor{comment}{// Microsoft/Windows BMP image}}
\DoxyCodeLine{5340 }
\DoxyCodeLine{5341 \textcolor{preprocessor}{\#ifndef STBI\_NO\_BMP}}
\DoxyCodeLine{5342 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bmp\_test\_raw(stbi\_\_context* s)}
\DoxyCodeLine{5343 \{}
\DoxyCodeLine{5344     \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{5345     \textcolor{keywordtype}{int} sz;}
\DoxyCodeLine{5346     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'B'}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5347     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'M'}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5348     stbi\_\_get32le(s); \textcolor{comment}{// discard filesize}}
\DoxyCodeLine{5349     stbi\_\_get16le(s); \textcolor{comment}{// discard reserved}}
\DoxyCodeLine{5350     stbi\_\_get16le(s); \textcolor{comment}{// discard reserved}}
\DoxyCodeLine{5351     stbi\_\_get32le(s); \textcolor{comment}{// discard data offset}}
\DoxyCodeLine{5352     sz = stbi\_\_get32le(s);}
\DoxyCodeLine{5353     r = (sz == 12 || sz == 40 || sz == 56 || sz == 108 || sz == 124);}
\DoxyCodeLine{5354     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{5355 \}}
\DoxyCodeLine{5356 }
\DoxyCodeLine{5357 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bmp\_test(stbi\_\_context* s)}
\DoxyCodeLine{5358 \{}
\DoxyCodeLine{5359     \textcolor{keywordtype}{int} r = stbi\_\_bmp\_test\_raw(s);}
\DoxyCodeLine{5360     stbi\_\_rewind(s);}
\DoxyCodeLine{5361     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{5362 \}}
\DoxyCodeLine{5363 }
\DoxyCodeLine{5364 }
\DoxyCodeLine{5365 \textcolor{comment}{// returns 0..31 for the highest set bit}}
\DoxyCodeLine{5366 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_high\_bit(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z)}
\DoxyCodeLine{5367 \{}
\DoxyCodeLine{5368     \textcolor{keywordtype}{int} n = 0;}
\DoxyCodeLine{5369     \textcolor{keywordflow}{if} (z == 0) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{5370     \textcolor{keywordflow}{if} (z >= 0x10000) \{ n += 16; z >>= 16; \}}
\DoxyCodeLine{5371     \textcolor{keywordflow}{if} (z >= 0x00100) \{ n += 8; z >>= 8; \}}
\DoxyCodeLine{5372     \textcolor{keywordflow}{if} (z >= 0x00010) \{ n += 4; z >>= 4; \}}
\DoxyCodeLine{5373     \textcolor{keywordflow}{if} (z >= 0x00004) \{ n += 2; z >>= 2; \}}
\DoxyCodeLine{5374     \textcolor{keywordflow}{if} (z >= 0x00002) \{ n += 1;\textcolor{comment}{/* >>=  1;*/} \}}
\DoxyCodeLine{5375     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{5376 \}}
\DoxyCodeLine{5377 }
\DoxyCodeLine{5378 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bitcount(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)}
\DoxyCodeLine{5379 \{}
\DoxyCodeLine{5380     a = (a \& 0x55555555) + ((a >> 1) \& 0x55555555); \textcolor{comment}{// max 2}}
\DoxyCodeLine{5381     a = (a \& 0x33333333) + ((a >> 2) \& 0x33333333); \textcolor{comment}{// max 4}}
\DoxyCodeLine{5382     a = (a + (a >> 4)) \& 0x0f0f0f0f; \textcolor{comment}{// max 8 per 4, now 8 bits}}
\DoxyCodeLine{5383     a = (a + (a >> 8)); \textcolor{comment}{// max 16 per 8 bits}}
\DoxyCodeLine{5384     a = (a + (a >> 16)); \textcolor{comment}{// max 32 per 8 bits}}
\DoxyCodeLine{5385     \textcolor{keywordflow}{return} a \& 0xff;}
\DoxyCodeLine{5386 \}}
\DoxyCodeLine{5387 }
\DoxyCodeLine{5388 \textcolor{comment}{// extract an arbitrarily-\/aligned N-\/bit value (N=bits)}}
\DoxyCodeLine{5389 \textcolor{comment}{// from v, and then make it 8-\/bits long and fractionally}}
\DoxyCodeLine{5390 \textcolor{comment}{// extend it to full full range.}}
\DoxyCodeLine{5391 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_shiftsigned(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} v, \textcolor{keywordtype}{int} shift, \textcolor{keywordtype}{int} bits)}
\DoxyCodeLine{5392 \{}
\DoxyCodeLine{5393     \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} mul\_table[9] = \{}
\DoxyCodeLine{5394        0,}
\DoxyCodeLine{5395        0xff\textcolor{comment}{/*0b11111111*/}, 0x55\textcolor{comment}{/*0b01010101*/}, 0x49\textcolor{comment}{/*0b01001001*/}, 0x11\textcolor{comment}{/*0b00010001*/},}
\DoxyCodeLine{5396        0x21\textcolor{comment}{/*0b00100001*/}, 0x41\textcolor{comment}{/*0b01000001*/}, 0x81\textcolor{comment}{/*0b10000001*/}, 0x01\textcolor{comment}{/*0b00000001*/},}
\DoxyCodeLine{5397     \};}
\DoxyCodeLine{5398     \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} shift\_table[9] = \{}
\DoxyCodeLine{5399        0, 0,0,1,0,2,4,6,0,}
\DoxyCodeLine{5400     \};}
\DoxyCodeLine{5401     \textcolor{keywordflow}{if} (shift < 0)}
\DoxyCodeLine{5402         v <<= -\/shift;}
\DoxyCodeLine{5403     \textcolor{keywordflow}{else}}
\DoxyCodeLine{5404         v >>= shift;}
\DoxyCodeLine{5405     STBI\_ASSERT(v < 256);}
\DoxyCodeLine{5406     v >>= (8 -\/ bits);}
\DoxyCodeLine{5407     STBI\_ASSERT(bits >= 0 \&\& bits <= 8);}
\DoxyCodeLine{5408     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})((unsigned)v * mul\_table[bits]) >> shift\_table[bits];}
\DoxyCodeLine{5409 \}}
\DoxyCodeLine{5410 }
\DoxyCodeLine{5411 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{5412 \{}
\DoxyCodeLine{5413     \textcolor{keywordtype}{int} \mbox{\hyperlink{main_8cpp_a00731ab471a2b38632427d0d80a82278}{bpp}}, offset, hsz;}
\DoxyCodeLine{5414     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} mr, mg, mb, ma, all\_a;}
\DoxyCodeLine{5415     \textcolor{keywordtype}{int} extra\_read;}
\DoxyCodeLine{5416 \} stbi\_\_bmp\_data;}
\DoxyCodeLine{5417 }
\DoxyCodeLine{5418 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bmp\_set\_mask\_defaults(stbi\_\_bmp\_data* info, \textcolor{keywordtype}{int} compress)}
\DoxyCodeLine{5419 \{}
\DoxyCodeLine{5420     \textcolor{comment}{// BI\_BITFIELDS specifies masks explicitly, don't override}}
\DoxyCodeLine{5421     \textcolor{keywordflow}{if} (compress == 3)}
\DoxyCodeLine{5422         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5423 }
\DoxyCodeLine{5424     \textcolor{keywordflow}{if} (compress == 0) \{}
\DoxyCodeLine{5425         \textcolor{keywordflow}{if} (info-\/>bpp == 16) \{}
\DoxyCodeLine{5426             info-\/>mr = 31u << 10;}
\DoxyCodeLine{5427             info-\/>mg = 31u << 5;}
\DoxyCodeLine{5428             info-\/>mb = 31u << 0;}
\DoxyCodeLine{5429         \}}
\DoxyCodeLine{5430         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info-\/>bpp == 32) \{}
\DoxyCodeLine{5431             info-\/>mr = 0xffu << 16;}
\DoxyCodeLine{5432             info-\/>mg = 0xffu << 8;}
\DoxyCodeLine{5433             info-\/>mb = 0xffu << 0;}
\DoxyCodeLine{5434             info-\/>ma = 0xffu << 24;}
\DoxyCodeLine{5435             info-\/>all\_a = 0; \textcolor{comment}{// if all\_a is 0 at end, then we loaded alpha channel but it was all 0}}
\DoxyCodeLine{5436         \}}
\DoxyCodeLine{5437         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5438             \textcolor{comment}{// otherwise, use defaults, which is all-\/0}}
\DoxyCodeLine{5439             info-\/>mr = info-\/>mg = info-\/>mb = info-\/>ma = 0;}
\DoxyCodeLine{5440         \}}
\DoxyCodeLine{5441         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{5442     \}}
\DoxyCodeLine{5443     \textcolor{keywordflow}{return} 0; \textcolor{comment}{// error}}
\DoxyCodeLine{5444 \}}
\DoxyCodeLine{5445 }
\DoxyCodeLine{5446 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_bmp\_parse\_header(stbi\_\_context* s, stbi\_\_bmp\_data* info)}
\DoxyCodeLine{5447 \{}
\DoxyCodeLine{5448     \textcolor{keywordtype}{int} hsz;}
\DoxyCodeLine{5449     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'B'} || stbi\_\_get8(s) != \textcolor{charliteral}{'M'}) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}not BMP"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}});}
\DoxyCodeLine{5450     stbi\_\_get32le(s); \textcolor{comment}{// discard filesize}}
\DoxyCodeLine{5451     stbi\_\_get16le(s); \textcolor{comment}{// discard reserved}}
\DoxyCodeLine{5452     stbi\_\_get16le(s); \textcolor{comment}{// discard reserved}}
\DoxyCodeLine{5453     info-\/>offset = stbi\_\_get32le(s);}
\DoxyCodeLine{5454     info-\/>hsz = hsz = stbi\_\_get32le(s);}
\DoxyCodeLine{5455     info-\/>mr = info-\/>mg = info-\/>mb = info-\/>ma = 0;}
\DoxyCodeLine{5456     info-\/>extra\_read = 14;}
\DoxyCodeLine{5457 }
\DoxyCodeLine{5458     \textcolor{keywordflow}{if} (info-\/>offset < 0) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad BMP"{}}, \textcolor{stringliteral}{"{}bad BMP"{}});}
\DoxyCodeLine{5459 }
\DoxyCodeLine{5460     \textcolor{keywordflow}{if} (hsz != 12 \&\& hsz != 40 \&\& hsz != 56 \&\& hsz != 108 \&\& hsz != 124) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}unknown BMP"{}}, \textcolor{stringliteral}{"{}BMP type not supported: unknown"{}});}
\DoxyCodeLine{5461     \textcolor{keywordflow}{if} (hsz == 12) \{}
\DoxyCodeLine{5462         s-\/>img\_x = stbi\_\_get16le(s);}
\DoxyCodeLine{5463         s-\/>img\_y = stbi\_\_get16le(s);}
\DoxyCodeLine{5464     \}}
\DoxyCodeLine{5465     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5466         s-\/>img\_x = stbi\_\_get32le(s);}
\DoxyCodeLine{5467         s-\/>img\_y = stbi\_\_get32le(s);}
\DoxyCodeLine{5468     \}}
\DoxyCodeLine{5469     \textcolor{keywordflow}{if} (stbi\_\_get16le(s) != 1) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad BMP"{}}, \textcolor{stringliteral}{"{}bad BMP"{}});}
\DoxyCodeLine{5470     info-\/>bpp = stbi\_\_get16le(s);}
\DoxyCodeLine{5471     \textcolor{keywordflow}{if} (hsz != 12) \{}
\DoxyCodeLine{5472         \textcolor{keywordtype}{int} compress = stbi\_\_get32le(s);}
\DoxyCodeLine{5473         \textcolor{keywordflow}{if} (compress == 1 || compress == 2) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}BMP RLE"{}}, \textcolor{stringliteral}{"{}BMP type not supported: RLE"{}});}
\DoxyCodeLine{5474         \textcolor{keywordflow}{if} (compress >= 4) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}BMP JPEG/PNG"{}}, \textcolor{stringliteral}{"{}BMP type not supported: unsupported compression"{}}); \textcolor{comment}{// this includes PNG/JPEG modes}}
\DoxyCodeLine{5475         \textcolor{keywordflow}{if} (compress == 3 \&\& info-\/>bpp != 16 \&\& info-\/>bpp != 32) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad BMP"{}}, \textcolor{stringliteral}{"{}bad BMP"{}}); \textcolor{comment}{// bitfields requires 16 or 32 bits/pixel}}
\DoxyCodeLine{5476         stbi\_\_get32le(s); \textcolor{comment}{// discard sizeof}}
\DoxyCodeLine{5477         stbi\_\_get32le(s); \textcolor{comment}{// discard hres}}
\DoxyCodeLine{5478         stbi\_\_get32le(s); \textcolor{comment}{// discard vres}}
\DoxyCodeLine{5479         stbi\_\_get32le(s); \textcolor{comment}{// discard colorsused}}
\DoxyCodeLine{5480         stbi\_\_get32le(s); \textcolor{comment}{// discard max important}}
\DoxyCodeLine{5481         \textcolor{keywordflow}{if} (hsz == 40 || hsz == 56) \{}
\DoxyCodeLine{5482             \textcolor{keywordflow}{if} (hsz == 56) \{}
\DoxyCodeLine{5483                 stbi\_\_get32le(s);}
\DoxyCodeLine{5484                 stbi\_\_get32le(s);}
\DoxyCodeLine{5485                 stbi\_\_get32le(s);}
\DoxyCodeLine{5486                 stbi\_\_get32le(s);}
\DoxyCodeLine{5487             \}}
\DoxyCodeLine{5488             \textcolor{keywordflow}{if} (info-\/>bpp == 16 || info-\/>bpp == 32) \{}
\DoxyCodeLine{5489                 \textcolor{keywordflow}{if} (compress == 0) \{}
\DoxyCodeLine{5490                     stbi\_\_bmp\_set\_mask\_defaults(info, compress);}
\DoxyCodeLine{5491                 \}}
\DoxyCodeLine{5492                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (compress == 3) \{}
\DoxyCodeLine{5493                     info-\/>mr = stbi\_\_get32le(s);}
\DoxyCodeLine{5494                     info-\/>mg = stbi\_\_get32le(s);}
\DoxyCodeLine{5495                     info-\/>mb = stbi\_\_get32le(s);}
\DoxyCodeLine{5496                     info-\/>extra\_read += 12;}
\DoxyCodeLine{5497                     \textcolor{comment}{// not documented, but generated by photoshop and handled by mspaint}}
\DoxyCodeLine{5498                     \textcolor{keywordflow}{if} (info-\/>mr == info-\/>mg \&\& info-\/>mg == info-\/>mb) \{}
\DoxyCodeLine{5499                         \textcolor{comment}{// ?!?!?}}
\DoxyCodeLine{5500                         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad BMP"{}}, \textcolor{stringliteral}{"{}bad BMP"{}});}
\DoxyCodeLine{5501                     \}}
\DoxyCodeLine{5502                 \}}
\DoxyCodeLine{5503                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{5504                     \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad BMP"{}}, \textcolor{stringliteral}{"{}bad BMP"{}});}
\DoxyCodeLine{5505             \}}
\DoxyCodeLine{5506         \}}
\DoxyCodeLine{5507         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5508             \textcolor{comment}{// V4/V5 header}}
\DoxyCodeLine{5509             \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{5510             \textcolor{keywordflow}{if} (hsz != 108 \&\& hsz != 124)}
\DoxyCodeLine{5511                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad BMP"{}}, \textcolor{stringliteral}{"{}bad BMP"{}});}
\DoxyCodeLine{5512             info-\/>mr = stbi\_\_get32le(s);}
\DoxyCodeLine{5513             info-\/>mg = stbi\_\_get32le(s);}
\DoxyCodeLine{5514             info-\/>mb = stbi\_\_get32le(s);}
\DoxyCodeLine{5515             info-\/>ma = stbi\_\_get32le(s);}
\DoxyCodeLine{5516             \textcolor{keywordflow}{if} (compress != 3) \textcolor{comment}{// override mr/mg/mb unless in BI\_BITFIELDS mode, as per docs}}
\DoxyCodeLine{5517                 stbi\_\_bmp\_set\_mask\_defaults(info, compress);}
\DoxyCodeLine{5518             stbi\_\_get32le(s); \textcolor{comment}{// discard color space}}
\DoxyCodeLine{5519             \textcolor{keywordflow}{for} (i = 0; i < 12; ++i)}
\DoxyCodeLine{5520                 stbi\_\_get32le(s); \textcolor{comment}{// discard color space parameters}}
\DoxyCodeLine{5521             \textcolor{keywordflow}{if} (hsz == 124) \{}
\DoxyCodeLine{5522                 stbi\_\_get32le(s); \textcolor{comment}{// discard rendering intent}}
\DoxyCodeLine{5523                 stbi\_\_get32le(s); \textcolor{comment}{// discard offset of profile data}}
\DoxyCodeLine{5524                 stbi\_\_get32le(s); \textcolor{comment}{// discard size of profile data}}
\DoxyCodeLine{5525                 stbi\_\_get32le(s); \textcolor{comment}{// discard reserved}}
\DoxyCodeLine{5526             \}}
\DoxyCodeLine{5527         \}}
\DoxyCodeLine{5528     \}}
\DoxyCodeLine{5529     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{void}*)1;}
\DoxyCodeLine{5530 \}}
\DoxyCodeLine{5531 }
\DoxyCodeLine{5532 }
\DoxyCodeLine{5533 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_bmp\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{5534 \{}
\DoxyCodeLine{5535     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out;}
\DoxyCodeLine{5536     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} mr = 0, mg = 0, mb = 0, ma = 0, all\_a;}
\DoxyCodeLine{5537     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} pal[256][4];}
\DoxyCodeLine{5538     \textcolor{keywordtype}{int} psize = 0, i, j, \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}};}
\DoxyCodeLine{5539     \textcolor{keywordtype}{int} flip\_vertically, pad, target;}
\DoxyCodeLine{5540     stbi\_\_bmp\_data info;}
\DoxyCodeLine{5541     STBI\_NOTUSED(ri);}
\DoxyCodeLine{5542 }
\DoxyCodeLine{5543     info.all\_a = 255;}
\DoxyCodeLine{5544     \textcolor{keywordflow}{if} (stbi\_\_bmp\_parse\_header(s, \&info) == NULL)}
\DoxyCodeLine{5545         \textcolor{keywordflow}{return} NULL; \textcolor{comment}{// error code already set}}
\DoxyCodeLine{5546 }
\DoxyCodeLine{5547     flip\_vertically = ((int)s-\/>img\_y) > 0;}
\DoxyCodeLine{5548     s-\/>img\_y = abs((\textcolor{keywordtype}{int})s-\/>img\_y);}
\DoxyCodeLine{5549 }
\DoxyCodeLine{5550     \textcolor{keywordflow}{if} (s-\/>img\_y > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{5551     \textcolor{keywordflow}{if} (s-\/>img\_x > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{5552 }
\DoxyCodeLine{5553     mr = info.mr;}
\DoxyCodeLine{5554     mg = info.mg;}
\DoxyCodeLine{5555     mb = info.mb;}
\DoxyCodeLine{5556     ma = info.ma;}
\DoxyCodeLine{5557     all\_a = info.all\_a;}
\DoxyCodeLine{5558 }
\DoxyCodeLine{5559     \textcolor{keywordflow}{if} (info.hsz == 12) \{}
\DoxyCodeLine{5560         \textcolor{keywordflow}{if} (info.bpp < 24)}
\DoxyCodeLine{5561             psize = (info.offset -\/ info.extra\_read -\/ 24) / 3;}
\DoxyCodeLine{5562     \}}
\DoxyCodeLine{5563     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5564         \textcolor{keywordflow}{if} (info.bpp < 16)}
\DoxyCodeLine{5565             psize = (info.offset -\/ info.extra\_read -\/ info.hsz) >> 2;}
\DoxyCodeLine{5566     \}}
\DoxyCodeLine{5567     \textcolor{keywordflow}{if} (psize == 0) \{}
\DoxyCodeLine{5568         \textcolor{keywordflow}{if} (info.offset != s-\/>callback\_already\_read + (s-\/>img\_buffer -\/ s-\/>img\_buffer\_original)) \{}
\DoxyCodeLine{5569             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad offset"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}});}
\DoxyCodeLine{5570         \}}
\DoxyCodeLine{5571     \}}
\DoxyCodeLine{5572 }
\DoxyCodeLine{5573     \textcolor{keywordflow}{if} (info.bpp == 24 \&\& ma == 0xff000000)}
\DoxyCodeLine{5574         s-\/>img\_n = 3;}
\DoxyCodeLine{5575     \textcolor{keywordflow}{else}}
\DoxyCodeLine{5576         s-\/>img\_n = ma ? 4 : 3;}
\DoxyCodeLine{5577     \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp >= 3) \textcolor{comment}{// we can directly decode 3 or 4}}
\DoxyCodeLine{5578         target = req\_comp;}
\DoxyCodeLine{5579     \textcolor{keywordflow}{else}}
\DoxyCodeLine{5580         target = s-\/>img\_n; \textcolor{comment}{// if they want monochrome, we'll post-\/convert}}
\DoxyCodeLine{5581 }
\DoxyCodeLine{5582      \textcolor{comment}{// sanity-\/check size}}
\DoxyCodeLine{5583     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(target, s-\/>img\_x, s-\/>img\_y, 0))}
\DoxyCodeLine{5584         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}});}
\DoxyCodeLine{5585 }
\DoxyCodeLine{5586     out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(target, s-\/>img\_x, s-\/>img\_y, 0);}
\DoxyCodeLine{5587     \textcolor{keywordflow}{if} (!out) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{5588     \textcolor{keywordflow}{if} (info.bpp < 16) \{}
\DoxyCodeLine{5589         \textcolor{keywordtype}{int} z = 0;}
\DoxyCodeLine{5590         \textcolor{keywordflow}{if} (psize == 0 || psize > 256) \{ STBI\_FREE(out); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}invalid"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}}); \}}
\DoxyCodeLine{5591         \textcolor{keywordflow}{for} (i = 0; i < psize; ++i) \{}
\DoxyCodeLine{5592             pal[i][2] = stbi\_\_get8(s);}
\DoxyCodeLine{5593             pal[i][1] = stbi\_\_get8(s);}
\DoxyCodeLine{5594             pal[i][0] = stbi\_\_get8(s);}
\DoxyCodeLine{5595             \textcolor{keywordflow}{if} (info.hsz != 12) stbi\_\_get8(s);}
\DoxyCodeLine{5596             pal[i][3] = 255;}
\DoxyCodeLine{5597         \}}
\DoxyCodeLine{5598         stbi\_\_skip(s, info.offset -\/ info.extra\_read -\/ info.hsz -\/ psize * (info.hsz == 12 ? 3 : 4));}
\DoxyCodeLine{5599         \textcolor{keywordflow}{if} (info.bpp == 1) \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = (s-\/>img\_x + 7) >> 3;}
\DoxyCodeLine{5600         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info.bpp == 4) \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = (s-\/>img\_x + 1) >> 1;}
\DoxyCodeLine{5601         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info.bpp == 8) \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = s-\/>img\_x;}
\DoxyCodeLine{5602         \textcolor{keywordflow}{else} \{ STBI\_FREE(out); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad bpp"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}}); \}}
\DoxyCodeLine{5603         pad = (-\/\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}) \& 3;}
\DoxyCodeLine{5604         \textcolor{keywordflow}{if} (info.bpp == 1) \{}
\DoxyCodeLine{5605             \textcolor{keywordflow}{for} (j = 0; j < (int)s-\/>img\_y; ++j) \{}
\DoxyCodeLine{5606                 \textcolor{keywordtype}{int} bit\_offset = 7, v = stbi\_\_get8(s);}
\DoxyCodeLine{5607                 \textcolor{keywordflow}{for} (i = 0; i < (int)s-\/>img\_x; ++i) \{}
\DoxyCodeLine{5608                     \textcolor{keywordtype}{int} color = (v >> bit\_offset) \& 0x1;}
\DoxyCodeLine{5609                     out[z++] = pal[color][0];}
\DoxyCodeLine{5610                     out[z++] = pal[color][1];}
\DoxyCodeLine{5611                     out[z++] = pal[color][2];}
\DoxyCodeLine{5612                     \textcolor{keywordflow}{if} (target == 4) out[z++] = 255;}
\DoxyCodeLine{5613                     \textcolor{keywordflow}{if} (i + 1 == (\textcolor{keywordtype}{int})s-\/>img\_x) \textcolor{keywordflow}{break};}
\DoxyCodeLine{5614                     \textcolor{keywordflow}{if} ((-\/-\/bit\_offset) < 0) \{}
\DoxyCodeLine{5615                         bit\_offset = 7;}
\DoxyCodeLine{5616                         v = stbi\_\_get8(s);}
\DoxyCodeLine{5617                     \}}
\DoxyCodeLine{5618                 \}}
\DoxyCodeLine{5619                 stbi\_\_skip(s, pad);}
\DoxyCodeLine{5620             \}}
\DoxyCodeLine{5621         \}}
\DoxyCodeLine{5622         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5623             \textcolor{keywordflow}{for} (j = 0; j < (int)s-\/>img\_y; ++j) \{}
\DoxyCodeLine{5624                 \textcolor{keywordflow}{for} (i = 0; i < (int)s-\/>img\_x; i += 2) \{}
\DoxyCodeLine{5625                     \textcolor{keywordtype}{int} v = stbi\_\_get8(s), v2 = 0;}
\DoxyCodeLine{5626                     \textcolor{keywordflow}{if} (info.bpp == 4) \{}
\DoxyCodeLine{5627                         v2 = v \& 15;}
\DoxyCodeLine{5628                         v >>= 4;}
\DoxyCodeLine{5629                     \}}
\DoxyCodeLine{5630                     out[z++] = pal[v][0];}
\DoxyCodeLine{5631                     out[z++] = pal[v][1];}
\DoxyCodeLine{5632                     out[z++] = pal[v][2];}
\DoxyCodeLine{5633                     \textcolor{keywordflow}{if} (target == 4) out[z++] = 255;}
\DoxyCodeLine{5634                     \textcolor{keywordflow}{if} (i + 1 == (\textcolor{keywordtype}{int})s-\/>img\_x) \textcolor{keywordflow}{break};}
\DoxyCodeLine{5635                     v = (info.bpp == 8) ? stbi\_\_get8(s) : v2;}
\DoxyCodeLine{5636                     out[z++] = pal[v][0];}
\DoxyCodeLine{5637                     out[z++] = pal[v][1];}
\DoxyCodeLine{5638                     out[z++] = pal[v][2];}
\DoxyCodeLine{5639                     \textcolor{keywordflow}{if} (target == 4) out[z++] = 255;}
\DoxyCodeLine{5640                 \}}
\DoxyCodeLine{5641                 stbi\_\_skip(s, pad);}
\DoxyCodeLine{5642             \}}
\DoxyCodeLine{5643         \}}
\DoxyCodeLine{5644     \}}
\DoxyCodeLine{5645     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5646         \textcolor{keywordtype}{int} rshift = 0, gshift = 0, bshift = 0, ashift = 0, rcount = 0, gcount = 0, bcount = 0, acount = 0;}
\DoxyCodeLine{5647         \textcolor{keywordtype}{int} z = 0;}
\DoxyCodeLine{5648         \textcolor{keywordtype}{int} easy = 0;}
\DoxyCodeLine{5649         stbi\_\_skip(s, info.offset -\/ info.extra\_read -\/ info.hsz);}
\DoxyCodeLine{5650         \textcolor{keywordflow}{if} (info.bpp == 24) \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = 3 * s-\/>img\_x;}
\DoxyCodeLine{5651         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info.bpp == 16) \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = 2 * s-\/>img\_x;}
\DoxyCodeLine{5652         \textcolor{keywordflow}{else} \textcolor{comment}{/* bpp = 32 and pad = 0 */} \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = 0;}
\DoxyCodeLine{5653         pad = (-\/\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}) \& 3;}
\DoxyCodeLine{5654         \textcolor{keywordflow}{if} (info.bpp == 24) \{}
\DoxyCodeLine{5655             easy = 1;}
\DoxyCodeLine{5656         \}}
\DoxyCodeLine{5657         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (info.bpp == 32) \{}
\DoxyCodeLine{5658             \textcolor{keywordflow}{if} (mb == 0xff \&\& mg == 0xff00 \&\& mr == 0x00ff0000 \&\& ma == 0xff000000)}
\DoxyCodeLine{5659                 easy = 2;}
\DoxyCodeLine{5660         \}}
\DoxyCodeLine{5661         \textcolor{keywordflow}{if} (!easy) \{}
\DoxyCodeLine{5662             \textcolor{keywordflow}{if} (!mr || !mg || !mb) \{ STBI\_FREE(out); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad masks"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}}); \}}
\DoxyCodeLine{5663             \textcolor{comment}{// right shift amt to put high bit in position \#7}}
\DoxyCodeLine{5664             rshift = stbi\_\_high\_bit(mr) -\/ 7; rcount = stbi\_\_bitcount(mr);}
\DoxyCodeLine{5665             gshift = stbi\_\_high\_bit(mg) -\/ 7; gcount = stbi\_\_bitcount(mg);}
\DoxyCodeLine{5666             bshift = stbi\_\_high\_bit(mb) -\/ 7; bcount = stbi\_\_bitcount(mb);}
\DoxyCodeLine{5667             ashift = stbi\_\_high\_bit(ma) -\/ 7; acount = stbi\_\_bitcount(ma);}
\DoxyCodeLine{5668             \textcolor{keywordflow}{if} (rcount > 8 || gcount > 8 || bcount > 8 || acount > 8) \{ STBI\_FREE(out); \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad masks"{}}, \textcolor{stringliteral}{"{}Corrupt BMP"{}}); \}}
\DoxyCodeLine{5669         \}}
\DoxyCodeLine{5670         \textcolor{keywordflow}{for} (j = 0; j < (int)s-\/>img\_y; ++j) \{}
\DoxyCodeLine{5671             \textcolor{keywordflow}{if} (easy) \{}
\DoxyCodeLine{5672                 \textcolor{keywordflow}{for} (i = 0; i < (int)s-\/>img\_x; ++i) \{}
\DoxyCodeLine{5673                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} a;}
\DoxyCodeLine{5674                     out[z + 2] = stbi\_\_get8(s);}
\DoxyCodeLine{5675                     out[z + 1] = stbi\_\_get8(s);}
\DoxyCodeLine{5676                     out[z + 0] = stbi\_\_get8(s);}
\DoxyCodeLine{5677                     z += 3;}
\DoxyCodeLine{5678                     a = (easy == 2 ? stbi\_\_get8(s) : 255);}
\DoxyCodeLine{5679                     all\_a |= a;}
\DoxyCodeLine{5680                     \textcolor{keywordflow}{if} (target == 4) out[z++] = a;}
\DoxyCodeLine{5681                 \}}
\DoxyCodeLine{5682             \}}
\DoxyCodeLine{5683             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5684                 \textcolor{keywordtype}{int} \mbox{\hyperlink{main_8cpp_a00731ab471a2b38632427d0d80a82278}{bpp}} = info.bpp;}
\DoxyCodeLine{5685                 \textcolor{keywordflow}{for} (i = 0; i < (int)s-\/>img\_x; ++i) \{}
\DoxyCodeLine{5686                     stbi\_\_uint32 v = (\mbox{\hyperlink{main_8cpp_a00731ab471a2b38632427d0d80a82278}{bpp}} == 16 ? (stbi\_\_uint32)stbi\_\_get16le(s) : stbi\_\_get32le(s));}
\DoxyCodeLine{5687                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a;}
\DoxyCodeLine{5688                     out[z++] = STBI\_\_BYTECAST(stbi\_\_shiftsigned(v \& mr, rshift, rcount));}
\DoxyCodeLine{5689                     out[z++] = STBI\_\_BYTECAST(stbi\_\_shiftsigned(v \& mg, gshift, gcount));}
\DoxyCodeLine{5690                     out[z++] = STBI\_\_BYTECAST(stbi\_\_shiftsigned(v \& mb, bshift, bcount));}
\DoxyCodeLine{5691                     a = (ma ? stbi\_\_shiftsigned(v \& ma, ashift, acount) : 255);}
\DoxyCodeLine{5692                     all\_a |= a;}
\DoxyCodeLine{5693                     \textcolor{keywordflow}{if} (target == 4) out[z++] = STBI\_\_BYTECAST(a);}
\DoxyCodeLine{5694                 \}}
\DoxyCodeLine{5695             \}}
\DoxyCodeLine{5696             stbi\_\_skip(s, pad);}
\DoxyCodeLine{5697         \}}
\DoxyCodeLine{5698     \}}
\DoxyCodeLine{5699 }
\DoxyCodeLine{5700     \textcolor{comment}{// if alpha channel is all 0s, replace with all 255s}}
\DoxyCodeLine{5701     \textcolor{keywordflow}{if} (target == 4 \&\& all\_a == 0)}
\DoxyCodeLine{5702         \textcolor{keywordflow}{for} (i = 4 * s-\/>img\_x * s-\/>img\_y -\/ 1; i >= 0; i -\/= 4)}
\DoxyCodeLine{5703             out[i] = 255;}
\DoxyCodeLine{5704 }
\DoxyCodeLine{5705     \textcolor{keywordflow}{if} (flip\_vertically) \{}
\DoxyCodeLine{5706         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} t;}
\DoxyCodeLine{5707         \textcolor{keywordflow}{for} (j = 0; j < (int)s-\/>img\_y >> 1; ++j) \{}
\DoxyCodeLine{5708             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p1 = out + j * s-\/>img\_x * target;}
\DoxyCodeLine{5709             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p2 = out + (s-\/>img\_y -\/ 1 -\/ j) * s-\/>img\_x * target;}
\DoxyCodeLine{5710             for (i = 0; i < (int)s-\/>img\_x * target; ++i) \{}
\DoxyCodeLine{5711                 t = p1[i]; p1[i] = p2[i]; p2[i] = t;}
\DoxyCodeLine{5712             \}}
\DoxyCodeLine{5713         \}}
\DoxyCodeLine{5714     \}}
\DoxyCodeLine{5715 }
\DoxyCodeLine{5716     \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != target) \{}
\DoxyCodeLine{5717         out = stbi\_\_convert\_format(out, target, req\_comp, s-\/>img\_x, s-\/>img\_y);}
\DoxyCodeLine{5718         \textcolor{keywordflow}{if} (out == NULL) \textcolor{keywordflow}{return} out; \textcolor{comment}{// stbi\_\_convert\_format frees input on failure}}
\DoxyCodeLine{5719     \}}
\DoxyCodeLine{5720 }
\DoxyCodeLine{5721     *x = s-\/>img\_x;}
\DoxyCodeLine{5722     *y = s-\/>img\_y;}
\DoxyCodeLine{5723     \textcolor{keywordflow}{if} (comp) *comp = s-\/>img\_n;}
\DoxyCodeLine{5724     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{5725 \}}
\DoxyCodeLine{5726 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5727 }
\DoxyCodeLine{5728 \textcolor{comment}{// Targa Truevision -\/ TGA}}
\DoxyCodeLine{5729 \textcolor{comment}{// by Jonathan Dummer}}
\DoxyCodeLine{5730 \textcolor{preprocessor}{\#ifndef STBI\_NO\_TGA}}
\DoxyCodeLine{5731 \textcolor{comment}{// returns STBI\_rgb or whatever, 0 on error}}
\DoxyCodeLine{5732 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_tga\_get\_comp(\textcolor{keywordtype}{int} bits\_per\_pixel, \textcolor{keywordtype}{int} is\_grey, \textcolor{keywordtype}{int}* is\_rgb16)}
\DoxyCodeLine{5733 \{}
\DoxyCodeLine{5734     \textcolor{comment}{// only RGB or RGBA (incl. 16bit) or grey allowed}}
\DoxyCodeLine{5735     \textcolor{keywordflow}{if} (is\_rgb16) *is\_rgb16 = 0;}
\DoxyCodeLine{5736     \textcolor{keywordflow}{switch} (bits\_per\_pixel) \{}
\DoxyCodeLine{5737     \textcolor{keywordflow}{case} 8:  \textcolor{keywordflow}{return} \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5ad1eb95ca1fa7706bf732bf35a0ed40aa}{STBI\_grey}};}
\DoxyCodeLine{5738     \textcolor{keywordflow}{case} 16: \textcolor{keywordflow}{if} (is\_grey) \textcolor{keywordflow}{return} \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5af5829d16d4cca6077465c5abd346e2f8}{STBI\_grey\_alpha}};}
\DoxyCodeLine{5739         \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{5740     \textcolor{keywordflow}{case} 15: \textcolor{keywordflow}{if} (is\_rgb16) *is\_rgb16 = 1;}
\DoxyCodeLine{5741         \textcolor{keywordflow}{return} \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5aa59123e5d0af25f9b1539f5cf1facddf}{STBI\_rgb}};}
\DoxyCodeLine{5742     \textcolor{keywordflow}{case} 24: \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{5743     \textcolor{keywordflow}{case} 32: \textcolor{keywordflow}{return} bits\_per\_pixel / 8;}
\DoxyCodeLine{5744     \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5745     \}}
\DoxyCodeLine{5746 \}}
\DoxyCodeLine{5747 }
\DoxyCodeLine{5748 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_tga\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{5749 \{}
\DoxyCodeLine{5750     \textcolor{keywordtype}{int} tga\_w, tga\_h, tga\_comp, tga\_image\_type, tga\_bits\_per\_pixel, tga\_colormap\_bpp;}
\DoxyCodeLine{5751     \textcolor{keywordtype}{int} sz, tga\_colormap\_type;}
\DoxyCodeLine{5752     stbi\_\_get8(s);                   \textcolor{comment}{// discard Offset}}
\DoxyCodeLine{5753     tga\_colormap\_type = stbi\_\_get8(s); \textcolor{comment}{// colormap type}}
\DoxyCodeLine{5754     \textcolor{keywordflow}{if} (tga\_colormap\_type > 1) \{}
\DoxyCodeLine{5755         stbi\_\_rewind(s);}
\DoxyCodeLine{5756         \textcolor{keywordflow}{return} 0;      \textcolor{comment}{// only RGB or indexed allowed}}
\DoxyCodeLine{5757     \}}
\DoxyCodeLine{5758     tga\_image\_type = stbi\_\_get8(s); \textcolor{comment}{// image type}}
\DoxyCodeLine{5759     \textcolor{keywordflow}{if} (tga\_colormap\_type == 1) \{ \textcolor{comment}{// colormapped (paletted) image}}
\DoxyCodeLine{5760         \textcolor{keywordflow}{if} (tga\_image\_type != 1 \&\& tga\_image\_type != 9) \{}
\DoxyCodeLine{5761             stbi\_\_rewind(s);}
\DoxyCodeLine{5762             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5763         \}}
\DoxyCodeLine{5764         stbi\_\_skip(s, 4);       \textcolor{comment}{// skip index of first colormap entry and number of entries}}
\DoxyCodeLine{5765         sz = stbi\_\_get8(s);    \textcolor{comment}{//   check bits per palette color entry}}
\DoxyCodeLine{5766         \textcolor{keywordflow}{if} ((sz != 8) \&\& (sz != 15) \&\& (sz != 16) \&\& (sz != 24) \&\& (sz != 32)) \{}
\DoxyCodeLine{5767             stbi\_\_rewind(s);}
\DoxyCodeLine{5768             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5769         \}}
\DoxyCodeLine{5770         stbi\_\_skip(s, 4);       \textcolor{comment}{// skip image x and y origin}}
\DoxyCodeLine{5771         tga\_colormap\_bpp = sz;}
\DoxyCodeLine{5772     \}}
\DoxyCodeLine{5773     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// "{}normal"{} image w/o colormap -\/ only RGB or grey allowed, +/-\/ RLE}}
\DoxyCodeLine{5774         \textcolor{keywordflow}{if} ((tga\_image\_type != 2) \&\& (tga\_image\_type != 3) \&\& (tga\_image\_type != 10) \&\& (tga\_image\_type != 11)) \{}
\DoxyCodeLine{5775             stbi\_\_rewind(s);}
\DoxyCodeLine{5776             \textcolor{keywordflow}{return} 0; \textcolor{comment}{// only RGB or grey allowed, +/-\/ RLE}}
\DoxyCodeLine{5777         \}}
\DoxyCodeLine{5778         stbi\_\_skip(s, 9); \textcolor{comment}{// skip colormap specification and image x/y origin}}
\DoxyCodeLine{5779         tga\_colormap\_bpp = 0;}
\DoxyCodeLine{5780     \}}
\DoxyCodeLine{5781     tga\_w = stbi\_\_get16le(s);}
\DoxyCodeLine{5782     \textcolor{keywordflow}{if} (tga\_w < 1) \{}
\DoxyCodeLine{5783         stbi\_\_rewind(s);}
\DoxyCodeLine{5784         \textcolor{keywordflow}{return} 0;   \textcolor{comment}{// test width}}
\DoxyCodeLine{5785     \}}
\DoxyCodeLine{5786     tga\_h = stbi\_\_get16le(s);}
\DoxyCodeLine{5787     \textcolor{keywordflow}{if} (tga\_h < 1) \{}
\DoxyCodeLine{5788         stbi\_\_rewind(s);}
\DoxyCodeLine{5789         \textcolor{keywordflow}{return} 0;   \textcolor{comment}{// test height}}
\DoxyCodeLine{5790     \}}
\DoxyCodeLine{5791     tga\_bits\_per\_pixel = stbi\_\_get8(s); \textcolor{comment}{// bits per pixel}}
\DoxyCodeLine{5792     stbi\_\_get8(s); \textcolor{comment}{// ignore alpha bits}}
\DoxyCodeLine{5793     \textcolor{keywordflow}{if} (tga\_colormap\_bpp != 0) \{}
\DoxyCodeLine{5794         \textcolor{keywordflow}{if} ((tga\_bits\_per\_pixel != 8) \&\& (tga\_bits\_per\_pixel != 16)) \{}
\DoxyCodeLine{5795             \textcolor{comment}{// when using a colormap, tga\_bits\_per\_pixel is the size of the indexes}}
\DoxyCodeLine{5796             \textcolor{comment}{// I don't think anything but 8 or 16bit indexes makes sense}}
\DoxyCodeLine{5797             stbi\_\_rewind(s);}
\DoxyCodeLine{5798             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5799         \}}
\DoxyCodeLine{5800         tga\_comp = stbi\_\_tga\_get\_comp(tga\_colormap\_bpp, 0, NULL);}
\DoxyCodeLine{5801     \}}
\DoxyCodeLine{5802     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5803         tga\_comp = stbi\_\_tga\_get\_comp(tga\_bits\_per\_pixel, (tga\_image\_type == 3) || (tga\_image\_type == 11), NULL);}
\DoxyCodeLine{5804     \}}
\DoxyCodeLine{5805     \textcolor{keywordflow}{if} (!tga\_comp) \{}
\DoxyCodeLine{5806         stbi\_\_rewind(s);}
\DoxyCodeLine{5807         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{5808     \}}
\DoxyCodeLine{5809     \textcolor{keywordflow}{if} (x) *x = tga\_w;}
\DoxyCodeLine{5810     \textcolor{keywordflow}{if} (y) *y = tga\_h;}
\DoxyCodeLine{5811     \textcolor{keywordflow}{if} (comp) *comp = tga\_comp;}
\DoxyCodeLine{5812     \textcolor{keywordflow}{return} 1;                   \textcolor{comment}{// seems to have passed everything}}
\DoxyCodeLine{5813 \}}
\DoxyCodeLine{5814 }
\DoxyCodeLine{5815 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_tga\_test(stbi\_\_context* s)}
\DoxyCodeLine{5816 \{}
\DoxyCodeLine{5817     \textcolor{keywordtype}{int} res = 0;}
\DoxyCodeLine{5818     \textcolor{keywordtype}{int} sz, tga\_color\_type;}
\DoxyCodeLine{5819     stbi\_\_get8(s);      \textcolor{comment}{//   discard Offset}}
\DoxyCodeLine{5820     tga\_color\_type = stbi\_\_get8(s);   \textcolor{comment}{//   color type}}
\DoxyCodeLine{5821     \textcolor{keywordflow}{if} (tga\_color\_type > 1) \textcolor{keywordflow}{goto} errorEnd;   \textcolor{comment}{//   only RGB or indexed allowed}}
\DoxyCodeLine{5822     sz = stbi\_\_get8(s);   \textcolor{comment}{//   image type}}
\DoxyCodeLine{5823     \textcolor{keywordflow}{if} (tga\_color\_type == 1) \{ \textcolor{comment}{// colormapped (paletted) image}}
\DoxyCodeLine{5824         \textcolor{keywordflow}{if} (sz != 1 \&\& sz != 9) \textcolor{keywordflow}{goto} errorEnd; \textcolor{comment}{// colortype 1 demands image type 1 or 9}}
\DoxyCodeLine{5825         stbi\_\_skip(s, 4);       \textcolor{comment}{// skip index of first colormap entry and number of entries}}
\DoxyCodeLine{5826         sz = stbi\_\_get8(s);    \textcolor{comment}{//   check bits per palette color entry}}
\DoxyCodeLine{5827         \textcolor{keywordflow}{if} ((sz != 8) \&\& (sz != 15) \&\& (sz != 16) \&\& (sz != 24) \&\& (sz != 32)) \textcolor{keywordflow}{goto} errorEnd;}
\DoxyCodeLine{5828         stbi\_\_skip(s, 4);       \textcolor{comment}{// skip image x and y origin}}
\DoxyCodeLine{5829     \}}
\DoxyCodeLine{5830     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// "{}normal"{} image w/o colormap}}
\DoxyCodeLine{5831         \textcolor{keywordflow}{if} ((sz != 2) \&\& (sz != 3) \&\& (sz != 10) \&\& (sz != 11)) \textcolor{keywordflow}{goto} errorEnd; \textcolor{comment}{// only RGB or grey allowed, +/-\/ RLE}}
\DoxyCodeLine{5832         stbi\_\_skip(s, 9); \textcolor{comment}{// skip colormap specification and image x/y origin}}
\DoxyCodeLine{5833     \}}
\DoxyCodeLine{5834     \textcolor{keywordflow}{if} (stbi\_\_get16le(s) < 1) \textcolor{keywordflow}{goto} errorEnd;      \textcolor{comment}{//   test width}}
\DoxyCodeLine{5835     \textcolor{keywordflow}{if} (stbi\_\_get16le(s) < 1) \textcolor{keywordflow}{goto} errorEnd;      \textcolor{comment}{//   test height}}
\DoxyCodeLine{5836     sz = stbi\_\_get8(s);   \textcolor{comment}{//   bits per pixel}}
\DoxyCodeLine{5837     \textcolor{keywordflow}{if} ((tga\_color\_type == 1) \&\& (sz != 8) \&\& (sz != 16)) \textcolor{keywordflow}{goto} errorEnd; \textcolor{comment}{// for colormapped images, bpp is size of an index}}
\DoxyCodeLine{5838     \textcolor{keywordflow}{if} ((sz != 8) \&\& (sz != 15) \&\& (sz != 16) \&\& (sz != 24) \&\& (sz != 32)) \textcolor{keywordflow}{goto} errorEnd;}
\DoxyCodeLine{5839 }
\DoxyCodeLine{5840     res = 1; \textcolor{comment}{// if we got this far, everything's good and we can return 1 instead of 0}}
\DoxyCodeLine{5841 }
\DoxyCodeLine{5842 errorEnd:}
\DoxyCodeLine{5843     stbi\_\_rewind(s);}
\DoxyCodeLine{5844     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{5845 \}}
\DoxyCodeLine{5846 }
\DoxyCodeLine{5847 \textcolor{comment}{// read 16bit value and convert to 24bit RGB}}
\DoxyCodeLine{5848 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_tga\_read\_rgb16(stbi\_\_context* s, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out)}
\DoxyCodeLine{5849 \{}
\DoxyCodeLine{5850     stbi\_\_uint16 px = (stbi\_\_uint16)stbi\_\_get16le(s);}
\DoxyCodeLine{5851     stbi\_\_uint16 fiveBitMask = 31;}
\DoxyCodeLine{5852     \textcolor{comment}{// we have 3 channels with 5bits each}}
\DoxyCodeLine{5853     \textcolor{keywordtype}{int} r = (px >> 10) \& fiveBitMask;}
\DoxyCodeLine{5854     \textcolor{keywordtype}{int} g = (px >> 5) \& fiveBitMask;}
\DoxyCodeLine{5855     \textcolor{keywordtype}{int} b = px \& fiveBitMask;}
\DoxyCodeLine{5856     \textcolor{comment}{// Note that this saves the data in RGB(A) order, so it doesn't need to be swapped later}}
\DoxyCodeLine{5857     out[0] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})((r * 255) / 31);}
\DoxyCodeLine{5858     out[1] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})((g * 255) / 31);}
\DoxyCodeLine{5859     out[2] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})((b * 255) / 31);}
\DoxyCodeLine{5860 }
\DoxyCodeLine{5861     \textcolor{comment}{// some people claim that the most significant bit might be used for alpha}}
\DoxyCodeLine{5862     \textcolor{comment}{// (possibly if an alpha-\/bit is set in the "{}image descriptor byte"{})}}
\DoxyCodeLine{5863     \textcolor{comment}{// but that only made 16bit test images completely translucent..}}
\DoxyCodeLine{5864     \textcolor{comment}{// so let's treat all 15 and 16bit TGAs as RGB with no alpha.}}
\DoxyCodeLine{5865 \}}
\DoxyCodeLine{5866 }
\DoxyCodeLine{5867 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_tga\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{5868 \{}
\DoxyCodeLine{5869     \textcolor{comment}{//   read in the TGA header stuff}}
\DoxyCodeLine{5870     \textcolor{keywordtype}{int} tga\_offset = stbi\_\_get8(s);}
\DoxyCodeLine{5871     \textcolor{keywordtype}{int} tga\_indexed = stbi\_\_get8(s);}
\DoxyCodeLine{5872     \textcolor{keywordtype}{int} tga\_image\_type = stbi\_\_get8(s);}
\DoxyCodeLine{5873     \textcolor{keywordtype}{int} tga\_is\_RLE = 0;}
\DoxyCodeLine{5874     \textcolor{keywordtype}{int} tga\_palette\_start = stbi\_\_get16le(s);}
\DoxyCodeLine{5875     \textcolor{keywordtype}{int} tga\_palette\_len = stbi\_\_get16le(s);}
\DoxyCodeLine{5876     \textcolor{keywordtype}{int} tga\_palette\_bits = stbi\_\_get8(s);}
\DoxyCodeLine{5877     \textcolor{keywordtype}{int} tga\_x\_origin = stbi\_\_get16le(s);}
\DoxyCodeLine{5878     \textcolor{keywordtype}{int} tga\_y\_origin = stbi\_\_get16le(s);}
\DoxyCodeLine{5879     \textcolor{keywordtype}{int} tga\_width = stbi\_\_get16le(s);}
\DoxyCodeLine{5880     \textcolor{keywordtype}{int} tga\_height = stbi\_\_get16le(s);}
\DoxyCodeLine{5881     \textcolor{keywordtype}{int} tga\_bits\_per\_pixel = stbi\_\_get8(s);}
\DoxyCodeLine{5882     \textcolor{keywordtype}{int} tga\_comp, tga\_rgb16 = 0;}
\DoxyCodeLine{5883     \textcolor{keywordtype}{int} tga\_inverted = stbi\_\_get8(s);}
\DoxyCodeLine{5884     \textcolor{comment}{// int tga\_alpha\_bits = tga\_inverted \& 15; // the 4 lowest bits -\/ unused (useless?)}}
\DoxyCodeLine{5885     \textcolor{comment}{//   image data}}
\DoxyCodeLine{5886     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* tga\_data;}
\DoxyCodeLine{5887     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* tga\_palette = NULL;}
\DoxyCodeLine{5888     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{5889     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} raw\_data[4] = \{ 0 \};}
\DoxyCodeLine{5890     \textcolor{keywordtype}{int} RLE\_count = 0;}
\DoxyCodeLine{5891     \textcolor{keywordtype}{int} RLE\_repeating = 0;}
\DoxyCodeLine{5892     \textcolor{keywordtype}{int} read\_next\_pixel = 1;}
\DoxyCodeLine{5893     STBI\_NOTUSED(ri);}
\DoxyCodeLine{5894     STBI\_NOTUSED(tga\_x\_origin); \textcolor{comment}{// @TODO}}
\DoxyCodeLine{5895     STBI\_NOTUSED(tga\_y\_origin); \textcolor{comment}{// @TODO}}
\DoxyCodeLine{5896 }
\DoxyCodeLine{5897     \textcolor{keywordflow}{if} (tga\_height > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{5898     \textcolor{keywordflow}{if} (tga\_width > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{5899 }
\DoxyCodeLine{5900     \textcolor{comment}{//   do a tiny bit of precessing}}
\DoxyCodeLine{5901     \textcolor{keywordflow}{if} (tga\_image\_type >= 8)}
\DoxyCodeLine{5902     \{}
\DoxyCodeLine{5903         tga\_image\_type -\/= 8;}
\DoxyCodeLine{5904         tga\_is\_RLE = 1;}
\DoxyCodeLine{5905     \}}
\DoxyCodeLine{5906     tga\_inverted = 1 -\/ ((tga\_inverted >> 5) \& 1);}
\DoxyCodeLine{5907 }
\DoxyCodeLine{5908     \textcolor{comment}{//   If I'm paletted, then I'll use the number of bits from the palette}}
\DoxyCodeLine{5909     \textcolor{keywordflow}{if} (tga\_indexed) tga\_comp = stbi\_\_tga\_get\_comp(tga\_palette\_bits, 0, \&tga\_rgb16);}
\DoxyCodeLine{5910     \textcolor{keywordflow}{else} tga\_comp = stbi\_\_tga\_get\_comp(tga\_bits\_per\_pixel, (tga\_image\_type == 3), \&tga\_rgb16);}
\DoxyCodeLine{5911 }
\DoxyCodeLine{5912     \textcolor{keywordflow}{if} (!tga\_comp) \textcolor{comment}{// shouldn't really happen, stbi\_\_tga\_test() should have ensured basic consistency}}
\DoxyCodeLine{5913         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad format"{}}, \textcolor{stringliteral}{"{}Can't find out TGA pixelformat"{}});}
\DoxyCodeLine{5914 }
\DoxyCodeLine{5915     \textcolor{comment}{//   tga info}}
\DoxyCodeLine{5916     *x = tga\_width;}
\DoxyCodeLine{5917     *y = tga\_height;}
\DoxyCodeLine{5918     \textcolor{keywordflow}{if} (comp) *comp = tga\_comp;}
\DoxyCodeLine{5919 }
\DoxyCodeLine{5920     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(tga\_width, tga\_height, tga\_comp, 0))}
\DoxyCodeLine{5921         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Corrupt TGA"{}});}
\DoxyCodeLine{5922 }
\DoxyCodeLine{5923     tga\_data = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)stbi\_\_malloc\_mad3(tga\_width, tga\_height, tga\_comp, 0);}
\DoxyCodeLine{5924     \textcolor{keywordflow}{if} (!tga\_data) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{5925 }
\DoxyCodeLine{5926     \textcolor{comment}{// skip to the data's starting position (offset usually = 0)}}
\DoxyCodeLine{5927     stbi\_\_skip(s, tga\_offset);}
\DoxyCodeLine{5928 }
\DoxyCodeLine{5929     \textcolor{keywordflow}{if} (!tga\_indexed \&\& !tga\_is\_RLE \&\& !tga\_rgb16) \{}
\DoxyCodeLine{5930         \textcolor{keywordflow}{for} (i = 0; i < tga\_height; ++i) \{}
\DoxyCodeLine{5931             \textcolor{keywordtype}{int} row = tga\_inverted ? tga\_height -\/ i -\/ 1 : i;}
\DoxyCodeLine{5932             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* tga\_row = tga\_data + row * tga\_width * tga\_comp;}
\DoxyCodeLine{5933             stbi\_\_getn(s, tga\_row, tga\_width * tga\_comp);}
\DoxyCodeLine{5934         \}}
\DoxyCodeLine{5935     \}}
\DoxyCodeLine{5936     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5937         \textcolor{comment}{//   do I need to load a palette?}}
\DoxyCodeLine{5938         \textcolor{keywordflow}{if} (tga\_indexed)}
\DoxyCodeLine{5939         \{}
\DoxyCodeLine{5940             \textcolor{keywordflow}{if} (tga\_palette\_len == 0) \{  \textcolor{comment}{/* you have to have at least one entry! */}}
\DoxyCodeLine{5941                 STBI\_FREE(tga\_data);}
\DoxyCodeLine{5942                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad palette"{}}, \textcolor{stringliteral}{"{}Corrupt TGA"{}});}
\DoxyCodeLine{5943             \}}
\DoxyCodeLine{5944 }
\DoxyCodeLine{5945             \textcolor{comment}{//   any data to skip? (offset usually = 0)}}
\DoxyCodeLine{5946             stbi\_\_skip(s, tga\_palette\_start);}
\DoxyCodeLine{5947             \textcolor{comment}{//   load the palette}}
\DoxyCodeLine{5948             tga\_palette = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)stbi\_\_malloc\_mad2(tga\_palette\_len, tga\_comp, 0);}
\DoxyCodeLine{5949             \textcolor{keywordflow}{if} (!tga\_palette) \{}
\DoxyCodeLine{5950                 STBI\_FREE(tga\_data);}
\DoxyCodeLine{5951                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{5952             \}}
\DoxyCodeLine{5953             \textcolor{keywordflow}{if} (tga\_rgb16) \{}
\DoxyCodeLine{5954                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* pal\_entry = tga\_palette;}
\DoxyCodeLine{5955                 STBI\_ASSERT(tga\_comp == \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5aa59123e5d0af25f9b1539f5cf1facddf}{STBI\_rgb}});}
\DoxyCodeLine{5956                 \textcolor{keywordflow}{for} (i = 0; i < tga\_palette\_len; ++i) \{}
\DoxyCodeLine{5957                     stbi\_\_tga\_read\_rgb16(s, pal\_entry);}
\DoxyCodeLine{5958                     pal\_entry += tga\_comp;}
\DoxyCodeLine{5959                 \}}
\DoxyCodeLine{5960             \}}
\DoxyCodeLine{5961             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!stbi\_\_getn(s, tga\_palette, tga\_palette\_len * tga\_comp)) \{}
\DoxyCodeLine{5962                 STBI\_FREE(tga\_data);}
\DoxyCodeLine{5963                 STBI\_FREE(tga\_palette);}
\DoxyCodeLine{5964                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad palette"{}}, \textcolor{stringliteral}{"{}Corrupt TGA"{}});}
\DoxyCodeLine{5965             \}}
\DoxyCodeLine{5966         \}}
\DoxyCodeLine{5967         \textcolor{comment}{//   load the data}}
\DoxyCodeLine{5968         \textcolor{keywordflow}{for} (i = 0; i < tga\_width * tga\_height; ++i)}
\DoxyCodeLine{5969         \{}
\DoxyCodeLine{5970             \textcolor{comment}{//   if I'm in RLE mode, do I need to get a RLE stbi\_\_pngchunk?}}
\DoxyCodeLine{5971             \textcolor{keywordflow}{if} (tga\_is\_RLE)}
\DoxyCodeLine{5972             \{}
\DoxyCodeLine{5973                 \textcolor{keywordflow}{if} (RLE\_count == 0)}
\DoxyCodeLine{5974                 \{}
\DoxyCodeLine{5975                     \textcolor{comment}{//   yep, get the next byte as a RLE command}}
\DoxyCodeLine{5976                     \textcolor{keywordtype}{int} RLE\_cmd = stbi\_\_get8(s);}
\DoxyCodeLine{5977                     RLE\_count = 1 + (RLE\_cmd \& 127);}
\DoxyCodeLine{5978                     RLE\_repeating = RLE\_cmd >> 7;}
\DoxyCodeLine{5979                     read\_next\_pixel = 1;}
\DoxyCodeLine{5980                 \}}
\DoxyCodeLine{5981                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!RLE\_repeating)}
\DoxyCodeLine{5982                 \{}
\DoxyCodeLine{5983                     read\_next\_pixel = 1;}
\DoxyCodeLine{5984                 \}}
\DoxyCodeLine{5985             \}}
\DoxyCodeLine{5986             \textcolor{keywordflow}{else}}
\DoxyCodeLine{5987             \{}
\DoxyCodeLine{5988                 read\_next\_pixel = 1;}
\DoxyCodeLine{5989             \}}
\DoxyCodeLine{5990             \textcolor{comment}{//   OK, if I need to read a pixel, do it now}}
\DoxyCodeLine{5991             \textcolor{keywordflow}{if} (read\_next\_pixel)}
\DoxyCodeLine{5992             \{}
\DoxyCodeLine{5993                 \textcolor{comment}{//   load however much data we did have}}
\DoxyCodeLine{5994                 \textcolor{keywordflow}{if} (tga\_indexed)}
\DoxyCodeLine{5995                 \{}
\DoxyCodeLine{5996                     \textcolor{comment}{// read in index, then perform the lookup}}
\DoxyCodeLine{5997                     \textcolor{keywordtype}{int} pal\_idx = (tga\_bits\_per\_pixel == 8) ? stbi\_\_get8(s) : stbi\_\_get16le(s);}
\DoxyCodeLine{5998                     \textcolor{keywordflow}{if} (pal\_idx >= tga\_palette\_len) \{}
\DoxyCodeLine{5999                         \textcolor{comment}{// invalid index}}
\DoxyCodeLine{6000                         pal\_idx = 0;}
\DoxyCodeLine{6001                     \}}
\DoxyCodeLine{6002                     pal\_idx *= tga\_comp;}
\DoxyCodeLine{6003                     \textcolor{keywordflow}{for} (j = 0; j < tga\_comp; ++j) \{}
\DoxyCodeLine{6004                         raw\_data[j] = tga\_palette[pal\_idx + j];}
\DoxyCodeLine{6005                     \}}
\DoxyCodeLine{6006                 \}}
\DoxyCodeLine{6007                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tga\_rgb16) \{}
\DoxyCodeLine{6008                     STBI\_ASSERT(tga\_comp == \mbox{\hyperlink{stb__image_8h_a99fb83031ce9923c84392b4e92f956b5aa59123e5d0af25f9b1539f5cf1facddf}{STBI\_rgb}});}
\DoxyCodeLine{6009                     stbi\_\_tga\_read\_rgb16(s, raw\_data);}
\DoxyCodeLine{6010                 \}}
\DoxyCodeLine{6011                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6012                     \textcolor{comment}{//   read in the data raw}}
\DoxyCodeLine{6013                     \textcolor{keywordflow}{for} (j = 0; j < tga\_comp; ++j) \{}
\DoxyCodeLine{6014                         raw\_data[j] = stbi\_\_get8(s);}
\DoxyCodeLine{6015                     \}}
\DoxyCodeLine{6016                 \}}
\DoxyCodeLine{6017                 \textcolor{comment}{//   clear the reading flag for the next pixel}}
\DoxyCodeLine{6018                 read\_next\_pixel = 0;}
\DoxyCodeLine{6019             \} \textcolor{comment}{// end of reading a pixel}}
\DoxyCodeLine{6020 }
\DoxyCodeLine{6021             \textcolor{comment}{// copy data}}
\DoxyCodeLine{6022             \textcolor{keywordflow}{for} (j = 0; j < tga\_comp; ++j)}
\DoxyCodeLine{6023                 tga\_data[i * tga\_comp + j] = raw\_data[j];}
\DoxyCodeLine{6024 }
\DoxyCodeLine{6025             \textcolor{comment}{//   in case we're in RLE mode, keep counting down}}
\DoxyCodeLine{6026             -\/-\/RLE\_count;}
\DoxyCodeLine{6027         \}}
\DoxyCodeLine{6028         \textcolor{comment}{//   do I need to invert the image?}}
\DoxyCodeLine{6029         \textcolor{keywordflow}{if} (tga\_inverted)}
\DoxyCodeLine{6030         \{}
\DoxyCodeLine{6031             \textcolor{keywordflow}{for} (j = 0; j * 2 < tga\_height; ++j)}
\DoxyCodeLine{6032             \{}
\DoxyCodeLine{6033                 \textcolor{keywordtype}{int} index1 = j * tga\_width * tga\_comp;}
\DoxyCodeLine{6034                 \textcolor{keywordtype}{int} index2 = (tga\_height -\/ 1 -\/ j) * tga\_width * tga\_comp;}
\DoxyCodeLine{6035                 \textcolor{keywordflow}{for} (i = tga\_width * tga\_comp; i > 0; -\/-\/i)}
\DoxyCodeLine{6036                 \{}
\DoxyCodeLine{6037                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} temp = tga\_data[index1];}
\DoxyCodeLine{6038                     tga\_data[index1] = tga\_data[index2];}
\DoxyCodeLine{6039                     tga\_data[index2] = temp;}
\DoxyCodeLine{6040                     ++index1;}
\DoxyCodeLine{6041                     ++index2;}
\DoxyCodeLine{6042                 \}}
\DoxyCodeLine{6043             \}}
\DoxyCodeLine{6044         \}}
\DoxyCodeLine{6045         \textcolor{comment}{//   clear my palette, if I had one}}
\DoxyCodeLine{6046         \textcolor{keywordflow}{if} (tga\_palette != NULL)}
\DoxyCodeLine{6047         \{}
\DoxyCodeLine{6048             STBI\_FREE(tga\_palette);}
\DoxyCodeLine{6049         \}}
\DoxyCodeLine{6050     \}}
\DoxyCodeLine{6051 }
\DoxyCodeLine{6052     \textcolor{comment}{// swap RGB -\/ if the source data was RGB16, it already is in the right order}}
\DoxyCodeLine{6053     \textcolor{keywordflow}{if} (tga\_comp >= 3 \&\& !tga\_rgb16)}
\DoxyCodeLine{6054     \{}
\DoxyCodeLine{6055         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* tga\_pixel = tga\_data;}
\DoxyCodeLine{6056         \textcolor{keywordflow}{for} (i = 0; i < tga\_width * tga\_height; ++i)}
\DoxyCodeLine{6057         \{}
\DoxyCodeLine{6058             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} temp = tga\_pixel[0];}
\DoxyCodeLine{6059             tga\_pixel[0] = tga\_pixel[2];}
\DoxyCodeLine{6060             tga\_pixel[2] = temp;}
\DoxyCodeLine{6061             tga\_pixel += tga\_comp;}
\DoxyCodeLine{6062         \}}
\DoxyCodeLine{6063     \}}
\DoxyCodeLine{6064 }
\DoxyCodeLine{6065     \textcolor{comment}{// convert to target component count}}
\DoxyCodeLine{6066     \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != tga\_comp)}
\DoxyCodeLine{6067         tga\_data = stbi\_\_convert\_format(tga\_data, tga\_comp, req\_comp, tga\_width, tga\_height);}
\DoxyCodeLine{6068 }
\DoxyCodeLine{6069     \textcolor{comment}{//   the things I do to get rid of an error message, and yet keep}}
\DoxyCodeLine{6070     \textcolor{comment}{//   Microsoft's C compilers happy... [8\string^(}}
\DoxyCodeLine{6071     tga\_palette\_start = tga\_palette\_len = tga\_palette\_bits =}
\DoxyCodeLine{6072         tga\_x\_origin = tga\_y\_origin = 0;}
\DoxyCodeLine{6073     STBI\_NOTUSED(tga\_palette\_start);}
\DoxyCodeLine{6074     \textcolor{comment}{//   OK, done}}
\DoxyCodeLine{6075     \textcolor{keywordflow}{return} tga\_data;}
\DoxyCodeLine{6076 \}}
\DoxyCodeLine{6077 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6078 }
\DoxyCodeLine{6079 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{6080 \textcolor{comment}{// Photoshop PSD loader -\/-\/ PD by Thatcher Ulrich, integration by Nicolas Schulz, tweaked by STB}}
\DoxyCodeLine{6081 }
\DoxyCodeLine{6082 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PSD}}
\DoxyCodeLine{6083 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_psd\_test(stbi\_\_context* s)}
\DoxyCodeLine{6084 \{}
\DoxyCodeLine{6085     \textcolor{keywordtype}{int} r = (stbi\_\_get32be(s) == 0x38425053);}
\DoxyCodeLine{6086     stbi\_\_rewind(s);}
\DoxyCodeLine{6087     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{6088 \}}
\DoxyCodeLine{6089 }
\DoxyCodeLine{6090 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_psd\_decode\_rle(stbi\_\_context* s, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p, \textcolor{keywordtype}{int} pixelCount)}
\DoxyCodeLine{6091 \{}
\DoxyCodeLine{6092     \textcolor{keywordtype}{int} count, nleft, len;}
\DoxyCodeLine{6093 }
\DoxyCodeLine{6094     count = 0;}
\DoxyCodeLine{6095     \textcolor{keywordflow}{while} ((nleft = pixelCount -\/ count) > 0) \{}
\DoxyCodeLine{6096         len = stbi\_\_get8(s);}
\DoxyCodeLine{6097         \textcolor{keywordflow}{if} (len == 128) \{}
\DoxyCodeLine{6098             \textcolor{comment}{// No-\/op.}}
\DoxyCodeLine{6099         \}}
\DoxyCodeLine{6100         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (len < 128) \{}
\DoxyCodeLine{6101             \textcolor{comment}{// Copy next len+1 bytes literally.}}
\DoxyCodeLine{6102             len++;}
\DoxyCodeLine{6103             \textcolor{keywordflow}{if} (len > nleft) \textcolor{keywordflow}{return} 0; \textcolor{comment}{// corrupt data}}
\DoxyCodeLine{6104             count += len;}
\DoxyCodeLine{6105             \textcolor{keywordflow}{while} (len) \{}
\DoxyCodeLine{6106                 *p = stbi\_\_get8(s);}
\DoxyCodeLine{6107                 p += 4;}
\DoxyCodeLine{6108                 len-\/-\/;}
\DoxyCodeLine{6109             \}}
\DoxyCodeLine{6110         \}}
\DoxyCodeLine{6111         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (len > 128) \{}
\DoxyCodeLine{6112             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}   val;}
\DoxyCodeLine{6113             \textcolor{comment}{// Next -\/len+1 bytes in the dest are replicated from next source byte.}}
\DoxyCodeLine{6114             \textcolor{comment}{// (Interpret len as a negative 8-\/bit int.)}}
\DoxyCodeLine{6115             len = 257 -\/ len;}
\DoxyCodeLine{6116             \textcolor{keywordflow}{if} (len > nleft) \textcolor{keywordflow}{return} 0; \textcolor{comment}{// corrupt data}}
\DoxyCodeLine{6117             val = stbi\_\_get8(s);}
\DoxyCodeLine{6118             count += len;}
\DoxyCodeLine{6119             \textcolor{keywordflow}{while} (len) \{}
\DoxyCodeLine{6120                 *p = val;}
\DoxyCodeLine{6121                 p += 4;}
\DoxyCodeLine{6122                 len-\/-\/;}
\DoxyCodeLine{6123             \}}
\DoxyCodeLine{6124         \}}
\DoxyCodeLine{6125     \}}
\DoxyCodeLine{6126 }
\DoxyCodeLine{6127     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6128 \}}
\DoxyCodeLine{6129 }
\DoxyCodeLine{6130 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_psd\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri, \textcolor{keywordtype}{int} bpc)}
\DoxyCodeLine{6131 \{}
\DoxyCodeLine{6132     \textcolor{keywordtype}{int} pixelCount;}
\DoxyCodeLine{6133     \textcolor{keywordtype}{int} channelCount, compression;}
\DoxyCodeLine{6134     \textcolor{keywordtype}{int} channel, i;}
\DoxyCodeLine{6135     \textcolor{keywordtype}{int} bitdepth;}
\DoxyCodeLine{6136     \textcolor{keywordtype}{int} w, h;}
\DoxyCodeLine{6137     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out;}
\DoxyCodeLine{6138     STBI\_NOTUSED(ri);}
\DoxyCodeLine{6139 }
\DoxyCodeLine{6140     \textcolor{comment}{// Check identifier}}
\DoxyCodeLine{6141     \textcolor{keywordflow}{if} (stbi\_\_get32be(s) != 0x38425053)   \textcolor{comment}{// "{}8BPS"{}}}
\DoxyCodeLine{6142         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}not PSD"{}}, \textcolor{stringliteral}{"{}Corrupt PSD image"{}});}
\DoxyCodeLine{6143 }
\DoxyCodeLine{6144     \textcolor{comment}{// Check file type version.}}
\DoxyCodeLine{6145     \textcolor{keywordflow}{if} (stbi\_\_get16be(s) != 1)}
\DoxyCodeLine{6146         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}wrong version"{}}, \textcolor{stringliteral}{"{}Unsupported version of PSD image"{}});}
\DoxyCodeLine{6147 }
\DoxyCodeLine{6148     \textcolor{comment}{// Skip 6 reserved bytes.}}
\DoxyCodeLine{6149     stbi\_\_skip(s, 6);}
\DoxyCodeLine{6150 }
\DoxyCodeLine{6151     \textcolor{comment}{// Read the number of channels (R, G, B, A, etc).}}
\DoxyCodeLine{6152     channelCount = stbi\_\_get16be(s);}
\DoxyCodeLine{6153     \textcolor{keywordflow}{if} (channelCount < 0 || channelCount > 16)}
\DoxyCodeLine{6154         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}wrong channel count"{}}, \textcolor{stringliteral}{"{}Unsupported number of channels in PSD image"{}});}
\DoxyCodeLine{6155 }
\DoxyCodeLine{6156     \textcolor{comment}{// Read the rows and columns of the image.}}
\DoxyCodeLine{6157     h = stbi\_\_get32be(s);}
\DoxyCodeLine{6158     w = stbi\_\_get32be(s);}
\DoxyCodeLine{6159 }
\DoxyCodeLine{6160     \textcolor{keywordflow}{if} (h > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{6161     \textcolor{keywordflow}{if} (w > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{6162 }
\DoxyCodeLine{6163     \textcolor{comment}{// Make sure the depth is 8 bits.}}
\DoxyCodeLine{6164     bitdepth = stbi\_\_get16be(s);}
\DoxyCodeLine{6165     \textcolor{keywordflow}{if} (bitdepth != 8 \&\& bitdepth != 16)}
\DoxyCodeLine{6166         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}unsupported bit depth"{}}, \textcolor{stringliteral}{"{}PSD bit depth is not 8 or 16 bit"{}});}
\DoxyCodeLine{6167 }
\DoxyCodeLine{6168     \textcolor{comment}{// Make sure the color mode is RGB.}}
\DoxyCodeLine{6169     \textcolor{comment}{// Valid options are:}}
\DoxyCodeLine{6170     \textcolor{comment}{//   0: Bitmap}}
\DoxyCodeLine{6171     \textcolor{comment}{//   1: Grayscale}}
\DoxyCodeLine{6172     \textcolor{comment}{//   2: Indexed color}}
\DoxyCodeLine{6173     \textcolor{comment}{//   3: RGB color}}
\DoxyCodeLine{6174     \textcolor{comment}{//   4: CMYK color}}
\DoxyCodeLine{6175     \textcolor{comment}{//   7: Multichannel}}
\DoxyCodeLine{6176     \textcolor{comment}{//   8: Duotone}}
\DoxyCodeLine{6177     \textcolor{comment}{//   9: Lab color}}
\DoxyCodeLine{6178     \textcolor{keywordflow}{if} (stbi\_\_get16be(s) != 3)}
\DoxyCodeLine{6179         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}wrong color format"{}}, \textcolor{stringliteral}{"{}PSD is not in RGB color format"{}});}
\DoxyCodeLine{6180 }
\DoxyCodeLine{6181     \textcolor{comment}{// Skip the Mode Data.  (It's the palette for indexed color; other info for other modes.)}}
\DoxyCodeLine{6182     stbi\_\_skip(s, stbi\_\_get32be(s));}
\DoxyCodeLine{6183 }
\DoxyCodeLine{6184     \textcolor{comment}{// Skip the image resources.  (resolution, pen tool paths, etc)}}
\DoxyCodeLine{6185     stbi\_\_skip(s, stbi\_\_get32be(s));}
\DoxyCodeLine{6186 }
\DoxyCodeLine{6187     \textcolor{comment}{// Skip the reserved data.}}
\DoxyCodeLine{6188     stbi\_\_skip(s, stbi\_\_get32be(s));}
\DoxyCodeLine{6189 }
\DoxyCodeLine{6190     \textcolor{comment}{// Find out if the data is compressed.}}
\DoxyCodeLine{6191     \textcolor{comment}{// Known values:}}
\DoxyCodeLine{6192     \textcolor{comment}{//   0: no compression}}
\DoxyCodeLine{6193     \textcolor{comment}{//   1: RLE compressed}}
\DoxyCodeLine{6194     compression = stbi\_\_get16be(s);}
\DoxyCodeLine{6195     \textcolor{keywordflow}{if} (compression > 1)}
\DoxyCodeLine{6196         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad compression"{}}, \textcolor{stringliteral}{"{}PSD has an unknown compression format"{}});}
\DoxyCodeLine{6197 }
\DoxyCodeLine{6198     \textcolor{comment}{// Check size}}
\DoxyCodeLine{6199     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(4, w, h, 0))}
\DoxyCodeLine{6200         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Corrupt PSD"{}});}
\DoxyCodeLine{6201 }
\DoxyCodeLine{6202     \textcolor{comment}{// Create the destination image.}}
\DoxyCodeLine{6203 }
\DoxyCodeLine{6204     \textcolor{keywordflow}{if} (!compression \&\& bitdepth == 16 \&\& bpc == 16) \{}
\DoxyCodeLine{6205         out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(8, w, h, 0);}
\DoxyCodeLine{6206         ri-\/>bits\_per\_channel = 16;}
\DoxyCodeLine{6207     \}}
\DoxyCodeLine{6208     \textcolor{keywordflow}{else}}
\DoxyCodeLine{6209         out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(4 * w * h);}
\DoxyCodeLine{6210 }
\DoxyCodeLine{6211     \textcolor{keywordflow}{if} (!out) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{6212     pixelCount = w * h;}
\DoxyCodeLine{6213 }
\DoxyCodeLine{6214     \textcolor{comment}{// Initialize the data to zero.}}
\DoxyCodeLine{6215     \textcolor{comment}{//memset( out, 0, pixelCount * 4 );}}
\DoxyCodeLine{6216 }
\DoxyCodeLine{6217     \textcolor{comment}{// Finally, the image data.}}
\DoxyCodeLine{6218     \textcolor{keywordflow}{if} (compression) \{}
\DoxyCodeLine{6219         \textcolor{comment}{// RLE as used by .PSD and .TIFF}}
\DoxyCodeLine{6220         \textcolor{comment}{// Loop until you get the number of unpacked bytes you are expecting:}}
\DoxyCodeLine{6221         \textcolor{comment}{//     Read the next source byte into n.}}
\DoxyCodeLine{6222         \textcolor{comment}{//     If n is between 0 and 127 inclusive, copy the next n+1 bytes literally.}}
\DoxyCodeLine{6223         \textcolor{comment}{//     Else if n is between -\/127 and -\/1 inclusive, copy the next byte -\/n+1 times.}}
\DoxyCodeLine{6224         \textcolor{comment}{//     Else if n is 128, noop.}}
\DoxyCodeLine{6225         \textcolor{comment}{// Endloop}}
\DoxyCodeLine{6226 }
\DoxyCodeLine{6227         \textcolor{comment}{// The RLE-\/compressed data is preceded by a 2-\/byte data count for each row in the data,}}
\DoxyCodeLine{6228         \textcolor{comment}{// which we're going to just skip.}}
\DoxyCodeLine{6229         stbi\_\_skip(s, h * channelCount * 2);}
\DoxyCodeLine{6230 }
\DoxyCodeLine{6231         \textcolor{comment}{// Read the RLE data by channel.}}
\DoxyCodeLine{6232         \textcolor{keywordflow}{for} (channel = 0; channel < 4; channel++) \{}
\DoxyCodeLine{6233             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p;}
\DoxyCodeLine{6234 }
\DoxyCodeLine{6235             p = out + channel;}
\DoxyCodeLine{6236             \textcolor{keywordflow}{if} (channel >= channelCount) \{}
\DoxyCodeLine{6237                 \textcolor{comment}{// Fill this channel with default data.}}
\DoxyCodeLine{6238                 \textcolor{keywordflow}{for} (i = 0; i < pixelCount; i++, p += 4)}
\DoxyCodeLine{6239                     *p = (channel == 3 ? 255 : 0);}
\DoxyCodeLine{6240             \}}
\DoxyCodeLine{6241             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6242                 \textcolor{comment}{// Read the RLE data.}}
\DoxyCodeLine{6243                 \textcolor{keywordflow}{if} (!stbi\_\_psd\_decode\_rle(s, p, pixelCount)) \{}
\DoxyCodeLine{6244                     STBI\_FREE(out);}
\DoxyCodeLine{6245                     \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}corrupt"{}}, \textcolor{stringliteral}{"{}bad RLE data"{}});}
\DoxyCodeLine{6246                 \}}
\DoxyCodeLine{6247             \}}
\DoxyCodeLine{6248         \}}
\DoxyCodeLine{6249 }
\DoxyCodeLine{6250     \}}
\DoxyCodeLine{6251     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6252         \textcolor{comment}{// We're at the raw image data.  It's each channel in order (Red, Green, Blue, Alpha, ...)}}
\DoxyCodeLine{6253         \textcolor{comment}{// where each channel consists of an 8-\/bit (or 16-\/bit) value for each pixel in the image.}}
\DoxyCodeLine{6254 }
\DoxyCodeLine{6255         \textcolor{comment}{// Read the data by channel.}}
\DoxyCodeLine{6256         \textcolor{keywordflow}{for} (channel = 0; channel < 4; channel++) \{}
\DoxyCodeLine{6257             \textcolor{keywordflow}{if} (channel >= channelCount) \{}
\DoxyCodeLine{6258                 \textcolor{comment}{// Fill this channel with default data.}}
\DoxyCodeLine{6259                 \textcolor{keywordflow}{if} (bitdepth == 16 \&\& bpc == 16) \{}
\DoxyCodeLine{6260                     stbi\_\_uint16* q = ((stbi\_\_uint16*)out) + channel;}
\DoxyCodeLine{6261                     stbi\_\_uint16 val = channel == 3 ? 65535 : 0;}
\DoxyCodeLine{6262                     \textcolor{keywordflow}{for} (i = 0; i < pixelCount; i++, q += 4)}
\DoxyCodeLine{6263                         *q = val;}
\DoxyCodeLine{6264                 \}}
\DoxyCodeLine{6265                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6266                     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p = out + channel;}
\DoxyCodeLine{6267                     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} val = channel == 3 ? 255 : 0;}
\DoxyCodeLine{6268                     \textcolor{keywordflow}{for} (i = 0; i < pixelCount; i++, p += 4)}
\DoxyCodeLine{6269                         *p = val;}
\DoxyCodeLine{6270                 \}}
\DoxyCodeLine{6271             \}}
\DoxyCodeLine{6272             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6273                 \textcolor{keywordflow}{if} (ri-\/>bits\_per\_channel == 16) \{    \textcolor{comment}{// output bpc}}
\DoxyCodeLine{6274                     stbi\_\_uint16* q = ((stbi\_\_uint16*)out) + channel;}
\DoxyCodeLine{6275                     \textcolor{keywordflow}{for} (i = 0; i < pixelCount; i++, q += 4)}
\DoxyCodeLine{6276                         *q = (stbi\_\_uint16)stbi\_\_get16be(s);}
\DoxyCodeLine{6277                 \}}
\DoxyCodeLine{6278                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6279                     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p = out + channel;}
\DoxyCodeLine{6280                     \textcolor{keywordflow}{if} (bitdepth == 16) \{  \textcolor{comment}{// input bpc}}
\DoxyCodeLine{6281                         \textcolor{keywordflow}{for} (i = 0; i < pixelCount; i++, p += 4)}
\DoxyCodeLine{6282                             *p = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})(stbi\_\_get16be(s) >> 8);}
\DoxyCodeLine{6283                     \}}
\DoxyCodeLine{6284                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6285                         \textcolor{keywordflow}{for} (i = 0; i < pixelCount; i++, p += 4)}
\DoxyCodeLine{6286                             *p = stbi\_\_get8(s);}
\DoxyCodeLine{6287                     \}}
\DoxyCodeLine{6288                 \}}
\DoxyCodeLine{6289             \}}
\DoxyCodeLine{6290         \}}
\DoxyCodeLine{6291     \}}
\DoxyCodeLine{6292 }
\DoxyCodeLine{6293     \textcolor{comment}{// remove weird white matte from PSD}}
\DoxyCodeLine{6294     \textcolor{keywordflow}{if} (channelCount >= 4) \{}
\DoxyCodeLine{6295         \textcolor{keywordflow}{if} (ri-\/>bits\_per\_channel == 16) \{}
\DoxyCodeLine{6296             \textcolor{keywordflow}{for} (i = 0; i < w * h; ++i) \{}
\DoxyCodeLine{6297                 stbi\_\_uint16* pixel = (stbi\_\_uint16*)out + 4 * i;}
\DoxyCodeLine{6298                 \textcolor{keywordflow}{if} (pixel[3] != 0 \&\& pixel[3] != 65535) \{}
\DoxyCodeLine{6299                     \textcolor{keywordtype}{float} a = pixel[3] / 65535.0f;}
\DoxyCodeLine{6300                     \textcolor{keywordtype}{float} ra = 1.0f / a;}
\DoxyCodeLine{6301                     \textcolor{keywordtype}{float} inv\_a = 65535.0f * (1 -\/ ra);}
\DoxyCodeLine{6302                     pixel[0] = (stbi\_\_uint16)(pixel[0] * ra + inv\_a);}
\DoxyCodeLine{6303                     pixel[1] = (stbi\_\_uint16)(pixel[1] * ra + inv\_a);}
\DoxyCodeLine{6304                     pixel[2] = (stbi\_\_uint16)(pixel[2] * ra + inv\_a);}
\DoxyCodeLine{6305                 \}}
\DoxyCodeLine{6306             \}}
\DoxyCodeLine{6307         \}}
\DoxyCodeLine{6308         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6309             \textcolor{keywordflow}{for} (i = 0; i < w * h; ++i) \{}
\DoxyCodeLine{6310                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* pixel = out + 4 * i;}
\DoxyCodeLine{6311                 \textcolor{keywordflow}{if} (pixel[3] != 0 \&\& pixel[3] != 255) \{}
\DoxyCodeLine{6312                     \textcolor{keywordtype}{float} a = pixel[3] / 255.0f;}
\DoxyCodeLine{6313                     \textcolor{keywordtype}{float} ra = 1.0f / a;}
\DoxyCodeLine{6314                     \textcolor{keywordtype}{float} inv\_a = 255.0f * (1 -\/ ra);}
\DoxyCodeLine{6315                     pixel[0] = (\textcolor{keywordtype}{unsigned} char)(pixel[0] * ra + inv\_a);}
\DoxyCodeLine{6316                     pixel[1] = (\textcolor{keywordtype}{unsigned} char)(pixel[1] * ra + inv\_a);}
\DoxyCodeLine{6317                     pixel[2] = (\textcolor{keywordtype}{unsigned} char)(pixel[2] * ra + inv\_a);}
\DoxyCodeLine{6318                 \}}
\DoxyCodeLine{6319             \}}
\DoxyCodeLine{6320         \}}
\DoxyCodeLine{6321     \}}
\DoxyCodeLine{6322 }
\DoxyCodeLine{6323     \textcolor{comment}{// convert to desired output format}}
\DoxyCodeLine{6324     \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != 4) \{}
\DoxyCodeLine{6325         \textcolor{keywordflow}{if} (ri-\/>bits\_per\_channel == 16)}
\DoxyCodeLine{6326             out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_convert\_format16((stbi\_\_uint16*)out, 4, req\_comp, w, h);}
\DoxyCodeLine{6327         \textcolor{keywordflow}{else}}
\DoxyCodeLine{6328             out = stbi\_\_convert\_format(out, 4, req\_comp, w, h);}
\DoxyCodeLine{6329         \textcolor{keywordflow}{if} (out == NULL) \textcolor{keywordflow}{return} out; \textcolor{comment}{// stbi\_\_convert\_format frees input on failure}}
\DoxyCodeLine{6330     \}}
\DoxyCodeLine{6331 }
\DoxyCodeLine{6332     \textcolor{keywordflow}{if} (comp) *comp = 4;}
\DoxyCodeLine{6333     *y = h;}
\DoxyCodeLine{6334     *x = w;}
\DoxyCodeLine{6335 }
\DoxyCodeLine{6336     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{6337 \}}
\DoxyCodeLine{6338 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6339 }
\DoxyCodeLine{6340 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{6341 \textcolor{comment}{// Softimage PIC loader}}
\DoxyCodeLine{6342 \textcolor{comment}{// by Tom Seddon}}
\DoxyCodeLine{6343 \textcolor{comment}{//}}
\DoxyCodeLine{6344 \textcolor{comment}{// See http://softimage.wiki.softimage.com/index.php/INFO:\_PIC\_file\_format}}
\DoxyCodeLine{6345 \textcolor{comment}{// See http://ozviz.wasp.uwa.edu.au/\string~pbourke/dataformats/softimagepic/}}
\DoxyCodeLine{6346 }
\DoxyCodeLine{6347 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PIC}}
\DoxyCodeLine{6348 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pic\_is4(stbi\_\_context* s, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* str)}
\DoxyCodeLine{6349 \{}
\DoxyCodeLine{6350     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{6351     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i)}
\DoxyCodeLine{6352         \textcolor{keywordflow}{if} (stbi\_\_get8(s) != (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})str[i])}
\DoxyCodeLine{6353             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6354 }
\DoxyCodeLine{6355     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6356 \}}
\DoxyCodeLine{6357 }
\DoxyCodeLine{6358 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pic\_test\_core(stbi\_\_context* s)}
\DoxyCodeLine{6359 \{}
\DoxyCodeLine{6360     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{6361 }
\DoxyCodeLine{6362     \textcolor{keywordflow}{if} (!stbi\_\_pic\_is4(s, \textcolor{stringliteral}{"{}\(\backslash\)x53\(\backslash\)x80\(\backslash\)xF6\(\backslash\)x34"{}}))}
\DoxyCodeLine{6363         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6364 }
\DoxyCodeLine{6365     \textcolor{keywordflow}{for} (i = 0; i < 84; ++i)}
\DoxyCodeLine{6366         stbi\_\_get8(s);}
\DoxyCodeLine{6367 }
\DoxyCodeLine{6368     \textcolor{keywordflow}{if} (!stbi\_\_pic\_is4(s, \textcolor{stringliteral}{"{}PICT"{}}))}
\DoxyCodeLine{6369         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6370 }
\DoxyCodeLine{6371     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6372 \}}
\DoxyCodeLine{6373 }
\DoxyCodeLine{6374 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{6375 \{}
\DoxyCodeLine{6376     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} size, type, channel;}
\DoxyCodeLine{6377 \} stbi\_\_pic\_packet;}
\DoxyCodeLine{6378 }
\DoxyCodeLine{6379 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_readval(stbi\_\_context* s, \textcolor{keywordtype}{int} channel, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* dest)}
\DoxyCodeLine{6380 \{}
\DoxyCodeLine{6381     \textcolor{keywordtype}{int} mask = 0x80, i;}
\DoxyCodeLine{6382 }
\DoxyCodeLine{6383     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i, mask >>= 1) \{}
\DoxyCodeLine{6384         \textcolor{keywordflow}{if} (channel \& mask) \{}
\DoxyCodeLine{6385             \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s)) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}PIC file too short"{}});}
\DoxyCodeLine{6386             dest[i] = stbi\_\_get8(s);}
\DoxyCodeLine{6387         \}}
\DoxyCodeLine{6388     \}}
\DoxyCodeLine{6389 }
\DoxyCodeLine{6390     \textcolor{keywordflow}{return} dest;}
\DoxyCodeLine{6391 \}}
\DoxyCodeLine{6392 }
\DoxyCodeLine{6393 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_copyval(\textcolor{keywordtype}{int} channel, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* dest, \textcolor{keyword}{const} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* src)}
\DoxyCodeLine{6394 \{}
\DoxyCodeLine{6395     \textcolor{keywordtype}{int} mask = 0x80, i;}
\DoxyCodeLine{6396 }
\DoxyCodeLine{6397     \textcolor{keywordflow}{for} (i = 0; i < 4; ++i, mask >>= 1)}
\DoxyCodeLine{6398         \textcolor{keywordflow}{if} (channel \& mask)}
\DoxyCodeLine{6399             dest[i] = src[i];}
\DoxyCodeLine{6400 \}}
\DoxyCodeLine{6401 }
\DoxyCodeLine{6402 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_pic\_load\_core(stbi\_\_context* s, \textcolor{keywordtype}{int} \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}}, \textcolor{keywordtype}{int}* comp, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* result)}
\DoxyCodeLine{6403 \{}
\DoxyCodeLine{6404     \textcolor{keywordtype}{int} act\_comp = 0, num\_packets = 0, y, chained;}
\DoxyCodeLine{6405     stbi\_\_pic\_packet packets[10];}
\DoxyCodeLine{6406 }
\DoxyCodeLine{6407     \textcolor{comment}{// this will (should...) cater for even some bizarre stuff like having data}}
\DoxyCodeLine{6408      \textcolor{comment}{// for the same channel in multiple packets.}}
\DoxyCodeLine{6409     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{6410         stbi\_\_pic\_packet* packet;}
\DoxyCodeLine{6411 }
\DoxyCodeLine{6412         \textcolor{keywordflow}{if} (num\_packets == \textcolor{keyword}{sizeof}(packets) / \textcolor{keyword}{sizeof}(packets[0]))}
\DoxyCodeLine{6413             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad format"{}}, \textcolor{stringliteral}{"{}too many packets"{}});}
\DoxyCodeLine{6414 }
\DoxyCodeLine{6415         packet = \&packets[num\_packets++];}
\DoxyCodeLine{6416 }
\DoxyCodeLine{6417         chained = stbi\_\_get8(s);}
\DoxyCodeLine{6418         packet-\/>size = stbi\_\_get8(s);}
\DoxyCodeLine{6419         packet-\/>type = stbi\_\_get8(s);}
\DoxyCodeLine{6420         packet-\/>channel = stbi\_\_get8(s);}
\DoxyCodeLine{6421 }
\DoxyCodeLine{6422         act\_comp |= packet-\/>channel;}
\DoxyCodeLine{6423 }
\DoxyCodeLine{6424         \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s))          \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}file too short (reading packets)"{}});}
\DoxyCodeLine{6425         \textcolor{keywordflow}{if} (packet-\/>size != 8)  \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad format"{}}, \textcolor{stringliteral}{"{}packet isn't 8bpp"{}});}
\DoxyCodeLine{6426     \} \textcolor{keywordflow}{while} (chained);}
\DoxyCodeLine{6427 }
\DoxyCodeLine{6428     *comp = (act\_comp \& 0x10 ? 4 : 3); \textcolor{comment}{// has alpha channel?}}
\DoxyCodeLine{6429 }
\DoxyCodeLine{6430     \textcolor{keywordflow}{for} (y = 0; y < \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}}; ++y) \{}
\DoxyCodeLine{6431         \textcolor{keywordtype}{int} packet\_idx;}
\DoxyCodeLine{6432 }
\DoxyCodeLine{6433         \textcolor{keywordflow}{for} (packet\_idx = 0; packet\_idx < num\_packets; ++packet\_idx) \{}
\DoxyCodeLine{6434             stbi\_\_pic\_packet* packet = \&packets[packet\_idx];}
\DoxyCodeLine{6435             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* dest = result + y * \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} * 4;}
\DoxyCodeLine{6436 }
\DoxyCodeLine{6437             \textcolor{keywordflow}{switch} (packet-\/>type) \{}
\DoxyCodeLine{6438             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{6439                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad format"{}}, \textcolor{stringliteral}{"{}packet has bad compression type"{}});}
\DoxyCodeLine{6440 }
\DoxyCodeLine{6441             \textcolor{keywordflow}{case} 0: \{\textcolor{comment}{//uncompressed}}
\DoxyCodeLine{6442                 \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{6443 }
\DoxyCodeLine{6444                 \textcolor{keywordflow}{for} (x = 0; x < \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}; ++x, dest += 4)}
\DoxyCodeLine{6445                     \textcolor{keywordflow}{if} (!stbi\_\_readval(s, packet-\/>channel, dest))}
\DoxyCodeLine{6446                         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6447                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{6448             \}}
\DoxyCodeLine{6449 }
\DoxyCodeLine{6450             \textcolor{keywordflow}{case} 1:\textcolor{comment}{//Pure RLE}}
\DoxyCodeLine{6451             \{}
\DoxyCodeLine{6452                 \textcolor{keywordtype}{int} left = \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}, i;}
\DoxyCodeLine{6453 }
\DoxyCodeLine{6454                 \textcolor{keywordflow}{while} (left > 0) \{}
\DoxyCodeLine{6455                     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} count, \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}}[4];}
\DoxyCodeLine{6456 }
\DoxyCodeLine{6457                     count = stbi\_\_get8(s);}
\DoxyCodeLine{6458                     \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s))   \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}file too short (pure read count)"{}});}
\DoxyCodeLine{6459 }
\DoxyCodeLine{6460                     \textcolor{keywordflow}{if} (count > left)}
\DoxyCodeLine{6461                         count = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})left;}
\DoxyCodeLine{6462 }
\DoxyCodeLine{6463                     \textcolor{keywordflow}{if} (!stbi\_\_readval(s, packet-\/>channel, value))  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6464 }
\DoxyCodeLine{6465                     \textcolor{keywordflow}{for} (i = 0; i < count; ++i, dest += 4)}
\DoxyCodeLine{6466                         stbi\_\_copyval(packet-\/>channel, dest, value);}
\DoxyCodeLine{6467                     left -\/= count;}
\DoxyCodeLine{6468                 \}}
\DoxyCodeLine{6469             \}}
\DoxyCodeLine{6470             \textcolor{keywordflow}{break};}
\DoxyCodeLine{6471 }
\DoxyCodeLine{6472             \textcolor{keywordflow}{case} 2: \{\textcolor{comment}{//Mixed RLE}}
\DoxyCodeLine{6473                 \textcolor{keywordtype}{int} left = \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}};}
\DoxyCodeLine{6474                 \textcolor{keywordflow}{while} (left > 0) \{}
\DoxyCodeLine{6475                     \textcolor{keywordtype}{int} count = stbi\_\_get8(s), i;}
\DoxyCodeLine{6476                     \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s))  \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}file too short (mixed read count)"{}});}
\DoxyCodeLine{6477 }
\DoxyCodeLine{6478                     \textcolor{keywordflow}{if} (count >= 128) \{ \textcolor{comment}{// Repeated}}
\DoxyCodeLine{6479                         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}}[4];}
\DoxyCodeLine{6480 }
\DoxyCodeLine{6481                         \textcolor{keywordflow}{if} (count == 128)}
\DoxyCodeLine{6482                             count = stbi\_\_get16be(s);}
\DoxyCodeLine{6483                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{6484                             count -\/= 127;}
\DoxyCodeLine{6485                         \textcolor{keywordflow}{if} (count > left)}
\DoxyCodeLine{6486                             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}scanline overrun"{}});}
\DoxyCodeLine{6487 }
\DoxyCodeLine{6488                         \textcolor{keywordflow}{if} (!stbi\_\_readval(s, packet-\/>channel, value))}
\DoxyCodeLine{6489                             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6490 }
\DoxyCodeLine{6491                         \textcolor{keywordflow}{for} (i = 0; i < count; ++i, dest += 4)}
\DoxyCodeLine{6492                             stbi\_\_copyval(packet-\/>channel, dest, value);}
\DoxyCodeLine{6493                     \}}
\DoxyCodeLine{6494                     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Raw}}
\DoxyCodeLine{6495                         ++count;}
\DoxyCodeLine{6496                         \textcolor{keywordflow}{if} (count > left) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}scanline overrun"{}});}
\DoxyCodeLine{6497 }
\DoxyCodeLine{6498                         \textcolor{keywordflow}{for} (i = 0; i < count; ++i, dest += 4)}
\DoxyCodeLine{6499                             \textcolor{keywordflow}{if} (!stbi\_\_readval(s, packet-\/>channel, dest))}
\DoxyCodeLine{6500                                 \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6501                     \}}
\DoxyCodeLine{6502                     left -\/= count;}
\DoxyCodeLine{6503                 \}}
\DoxyCodeLine{6504                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{6505             \}}
\DoxyCodeLine{6506             \}}
\DoxyCodeLine{6507         \}}
\DoxyCodeLine{6508     \}}
\DoxyCodeLine{6509 }
\DoxyCodeLine{6510     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{6511 \}}
\DoxyCodeLine{6512 }
\DoxyCodeLine{6513 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_pic\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* px, \textcolor{keywordtype}{int}* py, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{6514 \{}
\DoxyCodeLine{6515     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* result;}
\DoxyCodeLine{6516     \textcolor{keywordtype}{int} i, x, y, internal\_comp;}
\DoxyCodeLine{6517     STBI\_NOTUSED(ri);}
\DoxyCodeLine{6518 }
\DoxyCodeLine{6519     \textcolor{keywordflow}{if} (!comp) comp = \&internal\_comp;}
\DoxyCodeLine{6520 }
\DoxyCodeLine{6521     \textcolor{keywordflow}{for} (i = 0; i < 92; ++i)}
\DoxyCodeLine{6522         stbi\_\_get8(s);}
\DoxyCodeLine{6523 }
\DoxyCodeLine{6524     x = stbi\_\_get16be(s);}
\DoxyCodeLine{6525     y = stbi\_\_get16be(s);}
\DoxyCodeLine{6526 }
\DoxyCodeLine{6527     \textcolor{keywordflow}{if} (y > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{6528     \textcolor{keywordflow}{if} (x > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{6529 }
\DoxyCodeLine{6530     \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s))  \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad file"{}}, \textcolor{stringliteral}{"{}file too short (pic header)"{}});}
\DoxyCodeLine{6531     \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(x, y, 4, 0)) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}PIC image too large to decode"{}});}
\DoxyCodeLine{6532 }
\DoxyCodeLine{6533     stbi\_\_get32be(s); \textcolor{comment}{//skip `ratio'}}
\DoxyCodeLine{6534     stbi\_\_get16be(s); \textcolor{comment}{//skip `fields'}}
\DoxyCodeLine{6535     stbi\_\_get16be(s); \textcolor{comment}{//skip `pad'}}
\DoxyCodeLine{6536 }
\DoxyCodeLine{6537     \textcolor{comment}{// intermediate buffer is RGBA}}
\DoxyCodeLine{6538     result = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad3(x, y, 4, 0);}
\DoxyCodeLine{6539     \textcolor{keywordflow}{if} (!result) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{6540     memset(result, 0xff, x * y * 4);}
\DoxyCodeLine{6541 }
\DoxyCodeLine{6542     \textcolor{keywordflow}{if} (!stbi\_\_pic\_load\_core(s, x, y, comp, result)) \{}
\DoxyCodeLine{6543         STBI\_FREE(result);}
\DoxyCodeLine{6544         result = 0;}
\DoxyCodeLine{6545     \}}
\DoxyCodeLine{6546     *px = x;}
\DoxyCodeLine{6547     *py = y;}
\DoxyCodeLine{6548     \textcolor{keywordflow}{if} (req\_comp == 0) req\_comp = *comp;}
\DoxyCodeLine{6549     result = stbi\_\_convert\_format(result, 4, req\_comp, x, y);}
\DoxyCodeLine{6550 }
\DoxyCodeLine{6551     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{6552 \}}
\DoxyCodeLine{6553 }
\DoxyCodeLine{6554 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pic\_test(stbi\_\_context* s)}
\DoxyCodeLine{6555 \{}
\DoxyCodeLine{6556     \textcolor{keywordtype}{int} r = stbi\_\_pic\_test\_core(s);}
\DoxyCodeLine{6557     stbi\_\_rewind(s);}
\DoxyCodeLine{6558     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{6559 \}}
\DoxyCodeLine{6560 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6561 }
\DoxyCodeLine{6562 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{6563 \textcolor{comment}{// GIF loader -\/-\/ public domain by Jean-\/Marc Lienher -\/-\/ simplified/shrunk by stb}}
\DoxyCodeLine{6564 }
\DoxyCodeLine{6565 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{6566 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{6567 \{}
\DoxyCodeLine{6568     stbi\_\_int16 prefix;}
\DoxyCodeLine{6569     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} first;}
\DoxyCodeLine{6570     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} suffix;}
\DoxyCodeLine{6571 \} stbi\_\_gif\_lzw;}
\DoxyCodeLine{6572 }
\DoxyCodeLine{6573 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{6574 \{}
\DoxyCodeLine{6575     \textcolor{keywordtype}{int} w, h;}
\DoxyCodeLine{6576     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out;                 \textcolor{comment}{// output buffer (always 4 components)}}
\DoxyCodeLine{6577     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* background;          \textcolor{comment}{// The current "{}background"{} as far as a gif is concerned}}
\DoxyCodeLine{6578     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* history;}
\DoxyCodeLine{6579     \textcolor{keywordtype}{int} flags, bgindex, ratio, transparent, eflags;}
\DoxyCodeLine{6580     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}  pal[256][4];}
\DoxyCodeLine{6581     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} lpal[256][4];}
\DoxyCodeLine{6582     stbi\_\_gif\_lzw codes[8192];}
\DoxyCodeLine{6583     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* color\_table;}
\DoxyCodeLine{6584     \textcolor{keywordtype}{int} parse, step;}
\DoxyCodeLine{6585     \textcolor{keywordtype}{int} lflags;}
\DoxyCodeLine{6586     \textcolor{keywordtype}{int} start\_x, start\_y;}
\DoxyCodeLine{6587     \textcolor{keywordtype}{int} max\_x, max\_y;}
\DoxyCodeLine{6588     \textcolor{keywordtype}{int} cur\_x, cur\_y;}
\DoxyCodeLine{6589     \textcolor{keywordtype}{int} line\_size;}
\DoxyCodeLine{6590     \textcolor{keywordtype}{int} delay;}
\DoxyCodeLine{6591 \} stbi\_\_gif;}
\DoxyCodeLine{6592 }
\DoxyCodeLine{6593 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_gif\_test\_raw(stbi\_\_context* s)}
\DoxyCodeLine{6594 \{}
\DoxyCodeLine{6595     \textcolor{keywordtype}{int} sz;}
\DoxyCodeLine{6596     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'G'} || stbi\_\_get8(s) != \textcolor{charliteral}{'I'} || stbi\_\_get8(s) != \textcolor{charliteral}{'F'} || stbi\_\_get8(s) != \textcolor{charliteral}{'8'}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6597     sz = stbi\_\_get8(s);}
\DoxyCodeLine{6598     \textcolor{keywordflow}{if} (sz != \textcolor{charliteral}{'9'} \&\& sz != \textcolor{charliteral}{'7'}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6599     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'a'}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6600     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6601 \}}
\DoxyCodeLine{6602 }
\DoxyCodeLine{6603 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_gif\_test(stbi\_\_context* s)}
\DoxyCodeLine{6604 \{}
\DoxyCodeLine{6605     \textcolor{keywordtype}{int} r = stbi\_\_gif\_test\_raw(s);}
\DoxyCodeLine{6606     stbi\_\_rewind(s);}
\DoxyCodeLine{6607     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{6608 \}}
\DoxyCodeLine{6609 }
\DoxyCodeLine{6610 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_gif\_parse\_colortable(stbi\_\_context* s, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} pal[256][4], \textcolor{keywordtype}{int} num\_entries, \textcolor{keywordtype}{int} transp)}
\DoxyCodeLine{6611 \{}
\DoxyCodeLine{6612     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{6613     \textcolor{keywordflow}{for} (i = 0; i < num\_entries; ++i) \{}
\DoxyCodeLine{6614         pal[i][2] = stbi\_\_get8(s);}
\DoxyCodeLine{6615         pal[i][1] = stbi\_\_get8(s);}
\DoxyCodeLine{6616         pal[i][0] = stbi\_\_get8(s);}
\DoxyCodeLine{6617         pal[i][3] = transp == i ? 0 : 255;}
\DoxyCodeLine{6618     \}}
\DoxyCodeLine{6619 \}}
\DoxyCodeLine{6620 }
\DoxyCodeLine{6621 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_gif\_header(stbi\_\_context* s, stbi\_\_gif* g, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} is\_info)}
\DoxyCodeLine{6622 \{}
\DoxyCodeLine{6623     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} version;}
\DoxyCodeLine{6624     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'G'} || stbi\_\_get8(s) != \textcolor{charliteral}{'I'} || stbi\_\_get8(s) != \textcolor{charliteral}{'F'} || stbi\_\_get8(s) != \textcolor{charliteral}{'8'})}
\DoxyCodeLine{6625         \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}not GIF"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6626 }
\DoxyCodeLine{6627     version = stbi\_\_get8(s);}
\DoxyCodeLine{6628     \textcolor{keywordflow}{if} (version != \textcolor{charliteral}{'7'} \&\& version != \textcolor{charliteral}{'9'})    \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}not GIF"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6629     \textcolor{keywordflow}{if} (stbi\_\_get8(s) != \textcolor{charliteral}{'a'})                \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}not GIF"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6630 }
\DoxyCodeLine{6631     stbi\_\_g\_failure\_reason = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{6632     g-\/>w = stbi\_\_get16le(s);}
\DoxyCodeLine{6633     g-\/>h = stbi\_\_get16le(s);}
\DoxyCodeLine{6634     g-\/>flags = stbi\_\_get8(s);}
\DoxyCodeLine{6635     g-\/>bgindex = stbi\_\_get8(s);}
\DoxyCodeLine{6636     g-\/>ratio = stbi\_\_get8(s);}
\DoxyCodeLine{6637     g-\/>transparent = -\/1;}
\DoxyCodeLine{6638 }
\DoxyCodeLine{6639     \textcolor{keywordflow}{if} (g-\/>w > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{6640     \textcolor{keywordflow}{if} (g-\/>h > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{6641 }
\DoxyCodeLine{6642     \textcolor{keywordflow}{if} (comp != 0) *comp = 4;  \textcolor{comment}{// can't actually tell whether it's 3 or 4 until we parse the comments}}
\DoxyCodeLine{6643 }
\DoxyCodeLine{6644     \textcolor{keywordflow}{if} (is\_info) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6645 }
\DoxyCodeLine{6646     \textcolor{keywordflow}{if} (g-\/>flags \& 0x80)}
\DoxyCodeLine{6647         stbi\_\_gif\_parse\_colortable(s, g-\/>pal, 2 << (g-\/>flags \& 7), -\/1);}
\DoxyCodeLine{6648 }
\DoxyCodeLine{6649     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6650 \}}
\DoxyCodeLine{6651 }
\DoxyCodeLine{6652 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_gif\_info\_raw(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{6653 \{}
\DoxyCodeLine{6654     stbi\_\_gif* g = (stbi\_\_gif*)stbi\_\_malloc(\textcolor{keyword}{sizeof}(stbi\_\_gif));}
\DoxyCodeLine{6655     \textcolor{keywordflow}{if} (!g) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{6656     \textcolor{keywordflow}{if} (!stbi\_\_gif\_header(s, g, comp, 1)) \{}
\DoxyCodeLine{6657         STBI\_FREE(g);}
\DoxyCodeLine{6658         stbi\_\_rewind(s);}
\DoxyCodeLine{6659         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{6660     \}}
\DoxyCodeLine{6661     \textcolor{keywordflow}{if} (x) *x = g-\/>w;}
\DoxyCodeLine{6662     \textcolor{keywordflow}{if} (y) *y = g-\/>h;}
\DoxyCodeLine{6663     STBI\_FREE(g);}
\DoxyCodeLine{6664     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{6665 \}}
\DoxyCodeLine{6666 }
\DoxyCodeLine{6667 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_out\_gif\_code(stbi\_\_gif* g, stbi\_\_uint16 code)}
\DoxyCodeLine{6668 \{}
\DoxyCodeLine{6669     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* p, * c;}
\DoxyCodeLine{6670     \textcolor{keywordtype}{int} idx;}
\DoxyCodeLine{6671 }
\DoxyCodeLine{6672     \textcolor{comment}{// recurse to decode the prefixes, since the linked-\/list is backwards,}}
\DoxyCodeLine{6673     \textcolor{comment}{// and working backwards through an interleaved image would be nasty}}
\DoxyCodeLine{6674     \textcolor{keywordflow}{if} (g-\/>codes[code].prefix >= 0)}
\DoxyCodeLine{6675         stbi\_\_out\_gif\_code(g, g-\/>codes[code].prefix);}
\DoxyCodeLine{6676 }
\DoxyCodeLine{6677     \textcolor{keywordflow}{if} (g-\/>cur\_y >= g-\/>max\_y) \textcolor{keywordflow}{return};}
\DoxyCodeLine{6678 }
\DoxyCodeLine{6679     idx = g-\/>cur\_x + g-\/>cur\_y;}
\DoxyCodeLine{6680     p = \&g-\/>out[idx];}
\DoxyCodeLine{6681     g-\/>history[idx / 4] = 1;}
\DoxyCodeLine{6682 }
\DoxyCodeLine{6683     c = \&g-\/>color\_table[g-\/>codes[code].suffix * 4];}
\DoxyCodeLine{6684     \textcolor{keywordflow}{if} (c[3] > 128) \{ \textcolor{comment}{// don't render transparent pixels;}}
\DoxyCodeLine{6685         p[0] = c[2];}
\DoxyCodeLine{6686         p[1] = c[1];}
\DoxyCodeLine{6687         p[2] = c[0];}
\DoxyCodeLine{6688         p[3] = c[3];}
\DoxyCodeLine{6689     \}}
\DoxyCodeLine{6690     g-\/>cur\_x += 4;}
\DoxyCodeLine{6691 }
\DoxyCodeLine{6692     \textcolor{keywordflow}{if} (g-\/>cur\_x >= g-\/>max\_x) \{}
\DoxyCodeLine{6693         g-\/>cur\_x = g-\/>start\_x;}
\DoxyCodeLine{6694         g-\/>cur\_y += g-\/>step;}
\DoxyCodeLine{6695 }
\DoxyCodeLine{6696         \textcolor{keywordflow}{while} (g-\/>cur\_y >= g-\/>max\_y \&\& g-\/>parse > 0) \{}
\DoxyCodeLine{6697             g-\/>step = (1 << g-\/>parse) * g-\/>line\_size;}
\DoxyCodeLine{6698             g-\/>cur\_y = g-\/>start\_y + (g-\/>step >> 1);}
\DoxyCodeLine{6699             -\/-\/g-\/>parse;}
\DoxyCodeLine{6700         \}}
\DoxyCodeLine{6701     \}}
\DoxyCodeLine{6702 \}}
\DoxyCodeLine{6703 }
\DoxyCodeLine{6704 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_process\_gif\_raster(stbi\_\_context* s, stbi\_\_gif* g)}
\DoxyCodeLine{6705 \{}
\DoxyCodeLine{6706     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} lzw\_cs;}
\DoxyCodeLine{6707     stbi\_\_int32 len, init\_code;}
\DoxyCodeLine{6708     stbi\_\_uint32 first;}
\DoxyCodeLine{6709     stbi\_\_int32 codesize, codemask, avail, oldcode, bits, valid\_bits, clear;}
\DoxyCodeLine{6710     stbi\_\_gif\_lzw* p;}
\DoxyCodeLine{6711 }
\DoxyCodeLine{6712     lzw\_cs = stbi\_\_get8(s);}
\DoxyCodeLine{6713     \textcolor{keywordflow}{if} (lzw\_cs > 12) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6714     clear = 1 << lzw\_cs;}
\DoxyCodeLine{6715     first = 1;}
\DoxyCodeLine{6716     codesize = lzw\_cs + 1;}
\DoxyCodeLine{6717     codemask = (1 << codesize) -\/ 1;}
\DoxyCodeLine{6718     bits = 0;}
\DoxyCodeLine{6719     valid\_bits = 0;}
\DoxyCodeLine{6720     \textcolor{keywordflow}{for} (init\_code = 0; init\_code < clear; init\_code++) \{}
\DoxyCodeLine{6721         g-\/>codes[init\_code].prefix = -\/1;}
\DoxyCodeLine{6722         g-\/>codes[init\_code].first = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})init\_code;}
\DoxyCodeLine{6723         g-\/>codes[init\_code].suffix = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})init\_code;}
\DoxyCodeLine{6724     \}}
\DoxyCodeLine{6725 }
\DoxyCodeLine{6726     \textcolor{comment}{// support no starting clear code}}
\DoxyCodeLine{6727     avail = clear + 2;}
\DoxyCodeLine{6728     oldcode = -\/1;}
\DoxyCodeLine{6729 }
\DoxyCodeLine{6730     len = 0;}
\DoxyCodeLine{6731     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{6732         \textcolor{keywordflow}{if} (valid\_bits < codesize) \{}
\DoxyCodeLine{6733             \textcolor{keywordflow}{if} (len == 0) \{}
\DoxyCodeLine{6734                 len = stbi\_\_get8(s); \textcolor{comment}{// start new block}}
\DoxyCodeLine{6735                 \textcolor{keywordflow}{if} (len == 0)}
\DoxyCodeLine{6736                     \textcolor{keywordflow}{return} g-\/>out;}
\DoxyCodeLine{6737             \}}
\DoxyCodeLine{6738             -\/-\/len;}
\DoxyCodeLine{6739             bits |= (stbi\_\_int32)stbi\_\_get8(s) << valid\_bits;}
\DoxyCodeLine{6740             valid\_bits += 8;}
\DoxyCodeLine{6741         \}}
\DoxyCodeLine{6742         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6743             stbi\_\_int32 code = bits \& codemask;}
\DoxyCodeLine{6744             bits >>= codesize;}
\DoxyCodeLine{6745             valid\_bits -\/= codesize;}
\DoxyCodeLine{6746             \textcolor{comment}{// @OPTIMIZE: is there some way we can accelerate the non-\/clear path?}}
\DoxyCodeLine{6747             \textcolor{keywordflow}{if} (code == clear) \{  \textcolor{comment}{// clear code}}
\DoxyCodeLine{6748                 codesize = lzw\_cs + 1;}
\DoxyCodeLine{6749                 codemask = (1 << codesize) -\/ 1;}
\DoxyCodeLine{6750                 avail = clear + 2;}
\DoxyCodeLine{6751                 oldcode = -\/1;}
\DoxyCodeLine{6752                 first = 0;}
\DoxyCodeLine{6753             \}}
\DoxyCodeLine{6754             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == clear + 1) \{ \textcolor{comment}{// end of stream code}}
\DoxyCodeLine{6755                 stbi\_\_skip(s, len);}
\DoxyCodeLine{6756                 \textcolor{keywordflow}{while} ((len = stbi\_\_get8(s)) > 0)}
\DoxyCodeLine{6757                     stbi\_\_skip(s, len);}
\DoxyCodeLine{6758                 \textcolor{keywordflow}{return} g-\/>out;}
\DoxyCodeLine{6759             \}}
\DoxyCodeLine{6760             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code <= avail) \{}
\DoxyCodeLine{6761                 \textcolor{keywordflow}{if} (first) \{}
\DoxyCodeLine{6762                     \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}no clear code"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6763                 \}}
\DoxyCodeLine{6764 }
\DoxyCodeLine{6765                 \textcolor{keywordflow}{if} (oldcode >= 0) \{}
\DoxyCodeLine{6766                     p = \&g-\/>codes[avail++];}
\DoxyCodeLine{6767                     \textcolor{keywordflow}{if} (avail > 8192) \{}
\DoxyCodeLine{6768                         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too many codes"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6769                     \}}
\DoxyCodeLine{6770 }
\DoxyCodeLine{6771                     p-\/>prefix = (stbi\_\_int16)oldcode;}
\DoxyCodeLine{6772                     p-\/>first = g-\/>codes[oldcode].first;}
\DoxyCodeLine{6773                     p-\/>suffix = (code == avail) ? p-\/>first : g-\/>codes[code].first;}
\DoxyCodeLine{6774                 \}}
\DoxyCodeLine{6775                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == avail)}
\DoxyCodeLine{6776                     \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}illegal code in raster"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6777 }
\DoxyCodeLine{6778                 stbi\_\_out\_gif\_code(g, (stbi\_\_uint16)code);}
\DoxyCodeLine{6779 }
\DoxyCodeLine{6780                 \textcolor{keywordflow}{if} ((avail \& codemask) == 0 \&\& avail <= 0x0FFF) \{}
\DoxyCodeLine{6781                     codesize++;}
\DoxyCodeLine{6782                     codemask = (1 << codesize) -\/ 1;}
\DoxyCodeLine{6783                 \}}
\DoxyCodeLine{6784 }
\DoxyCodeLine{6785                 oldcode = code;}
\DoxyCodeLine{6786             \}}
\DoxyCodeLine{6787             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6788                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}illegal code in raster"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6789             \}}
\DoxyCodeLine{6790         \}}
\DoxyCodeLine{6791     \}}
\DoxyCodeLine{6792 \}}
\DoxyCodeLine{6793 }
\DoxyCodeLine{6794 \textcolor{comment}{// this function is designed to support animated gifs, although stb\_image doesn't support it}}
\DoxyCodeLine{6795 \textcolor{comment}{// two back is the image from two frames ago, used for a very specific disposal format}}
\DoxyCodeLine{6796 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* stbi\_\_gif\_load\_next(stbi\_\_context* s, stbi\_\_gif* g, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* two\_back)}
\DoxyCodeLine{6797 \{}
\DoxyCodeLine{6798     \textcolor{keywordtype}{int} dispose;}
\DoxyCodeLine{6799     \textcolor{keywordtype}{int} first\_frame;}
\DoxyCodeLine{6800     \textcolor{keywordtype}{int} pi;}
\DoxyCodeLine{6801     \textcolor{keywordtype}{int} pcount;}
\DoxyCodeLine{6802     STBI\_NOTUSED(req\_comp);}
\DoxyCodeLine{6803 }
\DoxyCodeLine{6804     \textcolor{comment}{// on first frame, any non-\/written pixels get the background colour (non-\/transparent)}}
\DoxyCodeLine{6805     first\_frame = 0;}
\DoxyCodeLine{6806     \textcolor{keywordflow}{if} (g-\/>out == 0) \{}
\DoxyCodeLine{6807         \textcolor{keywordflow}{if} (!stbi\_\_gif\_header(s, g, comp, 0)) \textcolor{keywordflow}{return} 0; \textcolor{comment}{// stbi\_\_g\_failure\_reason set by stbi\_\_gif\_header}}
\DoxyCodeLine{6808         \textcolor{keywordflow}{if} (!stbi\_\_mad3sizes\_valid(4, g-\/>w, g-\/>h, 0))}
\DoxyCodeLine{6809             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}GIF image is too large"{}});}
\DoxyCodeLine{6810         pcount = g-\/>w * g-\/>h;}
\DoxyCodeLine{6811         g-\/>out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(4 * pcount);}
\DoxyCodeLine{6812         g-\/>background = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(4 * pcount);}
\DoxyCodeLine{6813         g-\/>history = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(pcount);}
\DoxyCodeLine{6814         \textcolor{keywordflow}{if} (!g-\/>out || !g-\/>background || !g-\/>history)}
\DoxyCodeLine{6815             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{6816 }
\DoxyCodeLine{6817         \textcolor{comment}{// image is treated as "{}transparent"{} at the start -\/ ie, nothing overwrites the current background;}}
\DoxyCodeLine{6818         \textcolor{comment}{// background colour is only used for pixels that are not rendered first frame, after that "{}background"{}}}
\DoxyCodeLine{6819         \textcolor{comment}{// color refers to the color that was there the previous frame.}}
\DoxyCodeLine{6820         memset(g-\/>out, 0x00, 4 * pcount);}
\DoxyCodeLine{6821         memset(g-\/>background, 0x00, 4 * pcount); \textcolor{comment}{// state of the background (starts transparent)}}
\DoxyCodeLine{6822         memset(g-\/>history, 0x00, pcount);        \textcolor{comment}{// pixels that were affected previous frame}}
\DoxyCodeLine{6823         first\_frame = 1;}
\DoxyCodeLine{6824     \}}
\DoxyCodeLine{6825     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6826         \textcolor{comment}{// second frame -\/ how do we dispose of the previous one?}}
\DoxyCodeLine{6827         dispose = (g-\/>eflags \& 0x1C) >> 2;}
\DoxyCodeLine{6828         pcount = g-\/>w * g-\/>h;}
\DoxyCodeLine{6829 }
\DoxyCodeLine{6830         \textcolor{keywordflow}{if} ((dispose == 3) \&\& (two\_back == 0)) \{}
\DoxyCodeLine{6831             dispose = 2; \textcolor{comment}{// if I don't have an image to revert back to, default to the old background}}
\DoxyCodeLine{6832         \}}
\DoxyCodeLine{6833 }
\DoxyCodeLine{6834         \textcolor{keywordflow}{if} (dispose == 3) \{ \textcolor{comment}{// use previous graphic}}
\DoxyCodeLine{6835             \textcolor{keywordflow}{for} (pi = 0; pi < pcount; ++pi) \{}
\DoxyCodeLine{6836                 \textcolor{keywordflow}{if} (g-\/>history[pi]) \{}
\DoxyCodeLine{6837                     memcpy(\&g-\/>out[pi * 4], \&two\_back[pi * 4], 4);}
\DoxyCodeLine{6838                 \}}
\DoxyCodeLine{6839             \}}
\DoxyCodeLine{6840         \}}
\DoxyCodeLine{6841         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dispose == 2) \{}
\DoxyCodeLine{6842             \textcolor{comment}{// restore what was changed last frame to background before that frame;}}
\DoxyCodeLine{6843             \textcolor{keywordflow}{for} (pi = 0; pi < pcount; ++pi) \{}
\DoxyCodeLine{6844                 \textcolor{keywordflow}{if} (g-\/>history[pi]) \{}
\DoxyCodeLine{6845                     memcpy(\&g-\/>out[pi * 4], \&g-\/>background[pi * 4], 4);}
\DoxyCodeLine{6846                 \}}
\DoxyCodeLine{6847             \}}
\DoxyCodeLine{6848         \}}
\DoxyCodeLine{6849         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6850             \textcolor{comment}{// This is a non-\/disposal case eithe way, so just}}
\DoxyCodeLine{6851             \textcolor{comment}{// leave the pixels as is, and they will become the new background}}
\DoxyCodeLine{6852             \textcolor{comment}{// 1: do not dispose}}
\DoxyCodeLine{6853             \textcolor{comment}{// 0:  not specified.}}
\DoxyCodeLine{6854         \}}
\DoxyCodeLine{6855 }
\DoxyCodeLine{6856         \textcolor{comment}{// background is what out is after the undoing of the previou frame;}}
\DoxyCodeLine{6857         memcpy(g-\/>background, g-\/>out, 4 * g-\/>w * g-\/>h);}
\DoxyCodeLine{6858     \}}
\DoxyCodeLine{6859 }
\DoxyCodeLine{6860     \textcolor{comment}{// clear my history;}}
\DoxyCodeLine{6861     memset(g-\/>history, 0x00, g-\/>w * g-\/>h);        \textcolor{comment}{// pixels that were affected previous frame}}
\DoxyCodeLine{6862 }
\DoxyCodeLine{6863     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{6864         \textcolor{keywordtype}{int} tag = stbi\_\_get8(s);}
\DoxyCodeLine{6865         \textcolor{keywordflow}{switch} (tag) \{}
\DoxyCodeLine{6866         \textcolor{keywordflow}{case} 0x2C: \textcolor{comment}{/* Image Descriptor */}}
\DoxyCodeLine{6867         \{}
\DoxyCodeLine{6868             stbi\_\_int32 x, y, w, h;}
\DoxyCodeLine{6869             \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* o;}
\DoxyCodeLine{6870 }
\DoxyCodeLine{6871             x = stbi\_\_get16le(s);}
\DoxyCodeLine{6872             y = stbi\_\_get16le(s);}
\DoxyCodeLine{6873             w = stbi\_\_get16le(s);}
\DoxyCodeLine{6874             h = stbi\_\_get16le(s);}
\DoxyCodeLine{6875             \textcolor{keywordflow}{if} (((x + w) > (g-\/>w)) || ((y + h) > (g-\/>h)))}
\DoxyCodeLine{6876                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}bad Image Descriptor"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6877 }
\DoxyCodeLine{6878             g-\/>line\_size = g-\/>w * 4;}
\DoxyCodeLine{6879             g-\/>start\_x = x * 4;}
\DoxyCodeLine{6880             g-\/>start\_y = y * g-\/>line\_size;}
\DoxyCodeLine{6881             g-\/>max\_x = g-\/>start\_x + w * 4;}
\DoxyCodeLine{6882             g-\/>max\_y = g-\/>start\_y + h * g-\/>line\_size;}
\DoxyCodeLine{6883             g-\/>cur\_x = g-\/>start\_x;}
\DoxyCodeLine{6884             g-\/>cur\_y = g-\/>start\_y;}
\DoxyCodeLine{6885 }
\DoxyCodeLine{6886             \textcolor{comment}{// if the width of the specified rectangle is 0, that means}}
\DoxyCodeLine{6887             \textcolor{comment}{// we may not see *any* pixels or the image is malformed;}}
\DoxyCodeLine{6888             \textcolor{comment}{// to make sure this is caught, move the current y down to}}
\DoxyCodeLine{6889             \textcolor{comment}{// max\_y (which is what out\_gif\_code checks).}}
\DoxyCodeLine{6890             \textcolor{keywordflow}{if} (w == 0)}
\DoxyCodeLine{6891                 g-\/>cur\_y = g-\/>max\_y;}
\DoxyCodeLine{6892 }
\DoxyCodeLine{6893             g-\/>lflags = stbi\_\_get8(s);}
\DoxyCodeLine{6894 }
\DoxyCodeLine{6895             \textcolor{keywordflow}{if} (g-\/>lflags \& 0x40) \{}
\DoxyCodeLine{6896                 g-\/>step = 8 * g-\/>line\_size; \textcolor{comment}{// first interlaced spacing}}
\DoxyCodeLine{6897                 g-\/>parse = 3;}
\DoxyCodeLine{6898             \}}
\DoxyCodeLine{6899             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6900                 g-\/>step = g-\/>line\_size;}
\DoxyCodeLine{6901                 g-\/>parse = 0;}
\DoxyCodeLine{6902             \}}
\DoxyCodeLine{6903 }
\DoxyCodeLine{6904             \textcolor{keywordflow}{if} (g-\/>lflags \& 0x80) \{}
\DoxyCodeLine{6905                 stbi\_\_gif\_parse\_colortable(s, g-\/>lpal, 2 << (g-\/>lflags \& 7), g-\/>eflags \& 0x01 ? g-\/>transparent : -\/1);}
\DoxyCodeLine{6906                 g-\/>color\_table = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)g-\/>lpal;}
\DoxyCodeLine{6907             \}}
\DoxyCodeLine{6908             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (g-\/>flags \& 0x80) \{}
\DoxyCodeLine{6909                 g-\/>color\_table = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)g-\/>pal;}
\DoxyCodeLine{6910             \}}
\DoxyCodeLine{6911             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6912                 \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}missing color table"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6913 }
\DoxyCodeLine{6914             o = stbi\_\_process\_gif\_raster(s, g);}
\DoxyCodeLine{6915             \textcolor{keywordflow}{if} (!o) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{6916 }
\DoxyCodeLine{6917             \textcolor{comment}{// if this was the first frame,}}
\DoxyCodeLine{6918             pcount = g-\/>w * g-\/>h;}
\DoxyCodeLine{6919             \textcolor{keywordflow}{if} (first\_frame \&\& (g-\/>bgindex > 0)) \{}
\DoxyCodeLine{6920                 \textcolor{comment}{// if first frame, any pixel not drawn to gets the background color}}
\DoxyCodeLine{6921                 \textcolor{keywordflow}{for} (pi = 0; pi < pcount; ++pi) \{}
\DoxyCodeLine{6922                     \textcolor{keywordflow}{if} (g-\/>history[pi] == 0) \{}
\DoxyCodeLine{6923                         g-\/>pal[g-\/>bgindex][3] = 255; \textcolor{comment}{// just in case it was made transparent, undo that; It will be reset next frame if need be;}}
\DoxyCodeLine{6924                         memcpy(\&g-\/>out[pi * 4], \&g-\/>pal[g-\/>bgindex], 4);}
\DoxyCodeLine{6925                     \}}
\DoxyCodeLine{6926                 \}}
\DoxyCodeLine{6927             \}}
\DoxyCodeLine{6928 }
\DoxyCodeLine{6929             \textcolor{keywordflow}{return} o;}
\DoxyCodeLine{6930         \}}
\DoxyCodeLine{6931 }
\DoxyCodeLine{6932         \textcolor{keywordflow}{case} 0x21: \textcolor{comment}{// Comment Extension.}}
\DoxyCodeLine{6933         \{}
\DoxyCodeLine{6934             \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{6935             \textcolor{keywordtype}{int} ext = stbi\_\_get8(s);}
\DoxyCodeLine{6936             \textcolor{keywordflow}{if} (ext == 0xF9) \{ \textcolor{comment}{// Graphic Control Extension.}}
\DoxyCodeLine{6937                 len = stbi\_\_get8(s);}
\DoxyCodeLine{6938                 \textcolor{keywordflow}{if} (len == 4) \{}
\DoxyCodeLine{6939                     g-\/>eflags = stbi\_\_get8(s);}
\DoxyCodeLine{6940                     g-\/>delay = 10 * stbi\_\_get16le(s); \textcolor{comment}{// delay -\/ 1/100th of a second, saving as 1/1000ths.}}
\DoxyCodeLine{6941 }
\DoxyCodeLine{6942                     \textcolor{comment}{// unset old transparent}}
\DoxyCodeLine{6943                     \textcolor{keywordflow}{if} (g-\/>transparent >= 0) \{}
\DoxyCodeLine{6944                         g-\/>pal[g-\/>transparent][3] = 255;}
\DoxyCodeLine{6945                     \}}
\DoxyCodeLine{6946                     \textcolor{keywordflow}{if} (g-\/>eflags \& 0x01) \{}
\DoxyCodeLine{6947                         g-\/>transparent = stbi\_\_get8(s);}
\DoxyCodeLine{6948                         \textcolor{keywordflow}{if} (g-\/>transparent >= 0) \{}
\DoxyCodeLine{6949                             g-\/>pal[g-\/>transparent][3] = 0;}
\DoxyCodeLine{6950                         \}}
\DoxyCodeLine{6951                     \}}
\DoxyCodeLine{6952                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6953                         \textcolor{comment}{// don't need transparent}}
\DoxyCodeLine{6954                         stbi\_\_skip(s, 1);}
\DoxyCodeLine{6955                         g-\/>transparent = -\/1;}
\DoxyCodeLine{6956                     \}}
\DoxyCodeLine{6957                 \}}
\DoxyCodeLine{6958                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{6959                     stbi\_\_skip(s, len);}
\DoxyCodeLine{6960                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{6961                 \}}
\DoxyCodeLine{6962             \}}
\DoxyCodeLine{6963             \textcolor{keywordflow}{while} ((len = stbi\_\_get8(s)) != 0) \{}
\DoxyCodeLine{6964                 stbi\_\_skip(s, len);}
\DoxyCodeLine{6965             \}}
\DoxyCodeLine{6966             \textcolor{keywordflow}{break};}
\DoxyCodeLine{6967         \}}
\DoxyCodeLine{6968 }
\DoxyCodeLine{6969         \textcolor{keywordflow}{case} 0x3B: \textcolor{comment}{// gif stream termination code}}
\DoxyCodeLine{6970             \textcolor{keywordflow}{return} (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)s; \textcolor{comment}{// using '1' causes warning on some compilers}}
\DoxyCodeLine{6971 }
\DoxyCodeLine{6972         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{6973             \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}unknown code"{}}, \textcolor{stringliteral}{"{}Corrupt GIF"{}});}
\DoxyCodeLine{6974         \}}
\DoxyCodeLine{6975     \}}
\DoxyCodeLine{6976 \}}
\DoxyCodeLine{6977 }
\DoxyCodeLine{6978 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_load\_gif\_main\_outofmem(stbi\_\_gif* g, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out, \textcolor{keywordtype}{int}** delays)}
\DoxyCodeLine{6979 \{}
\DoxyCodeLine{6980     STBI\_FREE(g-\/>out);}
\DoxyCodeLine{6981     STBI\_FREE(g-\/>history);}
\DoxyCodeLine{6982     STBI\_FREE(g-\/>background);}
\DoxyCodeLine{6983 }
\DoxyCodeLine{6984     \textcolor{keywordflow}{if} (out) STBI\_FREE(out);}
\DoxyCodeLine{6985     \textcolor{keywordflow}{if} (delays \&\& *delays) STBI\_FREE(*delays);}
\DoxyCodeLine{6986     \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{6987 \}}
\DoxyCodeLine{6988 }
\DoxyCodeLine{6989 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_load\_gif\_main(stbi\_\_context* s, \textcolor{keywordtype}{int}** delays, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* z, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{6990 \{}
\DoxyCodeLine{6991     \textcolor{keywordflow}{if} (stbi\_\_gif\_test(s)) \{}
\DoxyCodeLine{6992         \textcolor{keywordtype}{int} layers = 0;}
\DoxyCodeLine{6993         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* u = 0;}
\DoxyCodeLine{6994         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out = 0;}
\DoxyCodeLine{6995         \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* two\_back = 0;}
\DoxyCodeLine{6996         stbi\_\_gif g;}
\DoxyCodeLine{6997         \textcolor{keywordtype}{int} stride;}
\DoxyCodeLine{6998         \textcolor{keywordtype}{int} out\_size = 0;}
\DoxyCodeLine{6999         \textcolor{keywordtype}{int} delays\_size = 0;}
\DoxyCodeLine{7000 }
\DoxyCodeLine{7001         STBI\_NOTUSED(out\_size);}
\DoxyCodeLine{7002         STBI\_NOTUSED(delays\_size);}
\DoxyCodeLine{7003 }
\DoxyCodeLine{7004         memset(\&g, 0, \textcolor{keyword}{sizeof}(g));}
\DoxyCodeLine{7005         \textcolor{keywordflow}{if} (delays) \{}
\DoxyCodeLine{7006             *delays = 0;}
\DoxyCodeLine{7007         \}}
\DoxyCodeLine{7008 }
\DoxyCodeLine{7009         \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{7010             u = stbi\_\_gif\_load\_next(s, \&g, comp, req\_comp, two\_back);}
\DoxyCodeLine{7011             \textcolor{keywordflow}{if} (u == (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)s) u = 0;  \textcolor{comment}{// end of animated gif marker}}
\DoxyCodeLine{7012 }
\DoxyCodeLine{7013             \textcolor{keywordflow}{if} (u) \{}
\DoxyCodeLine{7014                 *x = g.w;}
\DoxyCodeLine{7015                 *y = g.h;}
\DoxyCodeLine{7016                 ++layers;}
\DoxyCodeLine{7017                 stride = g.w * g.h * 4;}
\DoxyCodeLine{7018 }
\DoxyCodeLine{7019                 \textcolor{keywordflow}{if} (out) \{}
\DoxyCodeLine{7020                     \textcolor{keywordtype}{void}* tmp = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)STBI\_REALLOC\_SIZED(out, out\_size, layers * stride);}
\DoxyCodeLine{7021                     \textcolor{keywordflow}{if} (!tmp)}
\DoxyCodeLine{7022                         \textcolor{keywordflow}{return} stbi\_\_load\_gif\_main\_outofmem(\&g, out, delays);}
\DoxyCodeLine{7023                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7024                         out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)tmp;}
\DoxyCodeLine{7025                         out\_size = layers * stride;}
\DoxyCodeLine{7026                     \}}
\DoxyCodeLine{7027 }
\DoxyCodeLine{7028                     \textcolor{keywordflow}{if} (delays) \{}
\DoxyCodeLine{7029                         \textcolor{keywordtype}{int}* new\_delays = (\textcolor{keywordtype}{int}*)STBI\_REALLOC\_SIZED(*delays, delays\_size, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * layers);}
\DoxyCodeLine{7030                         \textcolor{keywordflow}{if} (!new\_delays)}
\DoxyCodeLine{7031                             \textcolor{keywordflow}{return} stbi\_\_load\_gif\_main\_outofmem(\&g, out, delays);}
\DoxyCodeLine{7032                         *delays = new\_delays;}
\DoxyCodeLine{7033                         delays\_size = layers * \textcolor{keyword}{sizeof}(int);}
\DoxyCodeLine{7034                     \}}
\DoxyCodeLine{7035                 \}}
\DoxyCodeLine{7036                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7037                     out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc(layers * stride);}
\DoxyCodeLine{7038                     \textcolor{keywordflow}{if} (!out)}
\DoxyCodeLine{7039                         \textcolor{keywordflow}{return} stbi\_\_load\_gif\_main\_outofmem(\&g, out, delays);}
\DoxyCodeLine{7040                     out\_size = layers * stride;}
\DoxyCodeLine{7041                     \textcolor{keywordflow}{if} (delays) \{}
\DoxyCodeLine{7042                         *delays = (\textcolor{keywordtype}{int}*)stbi\_\_malloc(layers * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{7043                         \textcolor{keywordflow}{if} (!*delays)}
\DoxyCodeLine{7044                             \textcolor{keywordflow}{return} stbi\_\_load\_gif\_main\_outofmem(\&g, out, delays);}
\DoxyCodeLine{7045                         delays\_size = layers * \textcolor{keyword}{sizeof}(int);}
\DoxyCodeLine{7046                     \}}
\DoxyCodeLine{7047                 \}}
\DoxyCodeLine{7048                 memcpy(out + ((layers -\/ 1) * stride), u, stride);}
\DoxyCodeLine{7049                 \textcolor{keywordflow}{if} (layers >= 2) \{}
\DoxyCodeLine{7050                     two\_back = out -\/ 2 * stride;}
\DoxyCodeLine{7051                 \}}
\DoxyCodeLine{7052 }
\DoxyCodeLine{7053                 \textcolor{keywordflow}{if} (delays) \{}
\DoxyCodeLine{7054                     (*delays)[layers -\/ 1U] = g.delay;}
\DoxyCodeLine{7055                 \}}
\DoxyCodeLine{7056             \}}
\DoxyCodeLine{7057         \} \textcolor{keywordflow}{while} (u != 0);}
\DoxyCodeLine{7058 }
\DoxyCodeLine{7059         \textcolor{comment}{// free temp buffer;}}
\DoxyCodeLine{7060         STBI\_FREE(g.out);}
\DoxyCodeLine{7061         STBI\_FREE(g.history);}
\DoxyCodeLine{7062         STBI\_FREE(g.background);}
\DoxyCodeLine{7063 }
\DoxyCodeLine{7064         \textcolor{comment}{// do the final conversion after loading everything;}}
\DoxyCodeLine{7065         \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != 4)}
\DoxyCodeLine{7066             out = stbi\_\_convert\_format(out, 4, req\_comp, layers * g.w, g.h);}
\DoxyCodeLine{7067 }
\DoxyCodeLine{7068         *z = layers;}
\DoxyCodeLine{7069         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{7070     \}}
\DoxyCodeLine{7071     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7072         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}not GIF"{}}, \textcolor{stringliteral}{"{}Image was not as a gif type."{}});}
\DoxyCodeLine{7073     \}}
\DoxyCodeLine{7074 \}}
\DoxyCodeLine{7075 }
\DoxyCodeLine{7076 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_gif\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{7077 \{}
\DoxyCodeLine{7078     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* u = 0;}
\DoxyCodeLine{7079     stbi\_\_gif g;}
\DoxyCodeLine{7080     memset(\&g, 0, \textcolor{keyword}{sizeof}(g));}
\DoxyCodeLine{7081     STBI\_NOTUSED(ri);}
\DoxyCodeLine{7082 }
\DoxyCodeLine{7083     u = stbi\_\_gif\_load\_next(s, \&g, comp, req\_comp, 0);}
\DoxyCodeLine{7084     \textcolor{keywordflow}{if} (u == (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)s) u = 0;  \textcolor{comment}{// end of animated gif marker}}
\DoxyCodeLine{7085     \textcolor{keywordflow}{if} (u) \{}
\DoxyCodeLine{7086         *x = g.w;}
\DoxyCodeLine{7087         *y = g.h;}
\DoxyCodeLine{7088 }
\DoxyCodeLine{7089         \textcolor{comment}{// moved conversion to after successful load so that the same}}
\DoxyCodeLine{7090         \textcolor{comment}{// can be done for multiple frames.}}
\DoxyCodeLine{7091         \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != 4)}
\DoxyCodeLine{7092             u = stbi\_\_convert\_format(u, 4, req\_comp, g.w, g.h);}
\DoxyCodeLine{7093     \}}
\DoxyCodeLine{7094     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (g.out) \{}
\DoxyCodeLine{7095         \textcolor{comment}{// if there was an error and we allocated an image buffer, free it!}}
\DoxyCodeLine{7096         STBI\_FREE(g.out);}
\DoxyCodeLine{7097     \}}
\DoxyCodeLine{7098 }
\DoxyCodeLine{7099     \textcolor{comment}{// free buffers needed for multiple frame loading;}}
\DoxyCodeLine{7100     STBI\_FREE(g.history);}
\DoxyCodeLine{7101     STBI\_FREE(g.background);}
\DoxyCodeLine{7102 }
\DoxyCodeLine{7103     \textcolor{keywordflow}{return} u;}
\DoxyCodeLine{7104 \}}
\DoxyCodeLine{7105 }
\DoxyCodeLine{7106 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_gif\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7107 \{}
\DoxyCodeLine{7108     \textcolor{keywordflow}{return} stbi\_\_gif\_info\_raw(s, x, y, comp);}
\DoxyCodeLine{7109 \}}
\DoxyCodeLine{7110 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7111 }
\DoxyCodeLine{7112 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{7113 \textcolor{comment}{// Radiance RGBE HDR loader}}
\DoxyCodeLine{7114 \textcolor{comment}{// originally by Nicolas Schulz}}
\DoxyCodeLine{7115 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{7116 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_hdr\_test\_core(stbi\_\_context* s, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* signature)}
\DoxyCodeLine{7117 \{}
\DoxyCodeLine{7118     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{7119     \textcolor{keywordflow}{for} (i = 0; signature[i]; ++i)}
\DoxyCodeLine{7120         \textcolor{keywordflow}{if} (stbi\_\_get8(s) != signature[i])}
\DoxyCodeLine{7121             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7122     stbi\_\_rewind(s);}
\DoxyCodeLine{7123     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7124 \}}
\DoxyCodeLine{7125 }
\DoxyCodeLine{7126 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_hdr\_test(stbi\_\_context* s)}
\DoxyCodeLine{7127 \{}
\DoxyCodeLine{7128     \textcolor{keywordtype}{int} r = stbi\_\_hdr\_test\_core(s, \textcolor{stringliteral}{"{}\#?RADIANCE\(\backslash\)n"{}});}
\DoxyCodeLine{7129     stbi\_\_rewind(s);}
\DoxyCodeLine{7130     \textcolor{keywordflow}{if} (!r) \{}
\DoxyCodeLine{7131         r = stbi\_\_hdr\_test\_core(s, \textcolor{stringliteral}{"{}\#?RGBE\(\backslash\)n"{}});}
\DoxyCodeLine{7132         stbi\_\_rewind(s);}
\DoxyCodeLine{7133     \}}
\DoxyCodeLine{7134     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{7135 \}}
\DoxyCodeLine{7136 }
\DoxyCodeLine{7137 \textcolor{preprocessor}{\#define STBI\_\_HDR\_BUFLEN  1024}}
\DoxyCodeLine{7138 \textcolor{keyword}{static} \textcolor{keywordtype}{char}* stbi\_\_hdr\_gettoken(stbi\_\_context* z, \textcolor{keywordtype}{char}* buffer)}
\DoxyCodeLine{7139 \{}
\DoxyCodeLine{7140     \textcolor{keywordtype}{int} len = 0;}
\DoxyCodeLine{7141     \textcolor{keywordtype}{char} c = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{7142 }
\DoxyCodeLine{7143     c = (char)stbi\_\_get8(z);}
\DoxyCodeLine{7144 }
\DoxyCodeLine{7145     \textcolor{keywordflow}{while} (!stbi\_\_at\_eof(z) \&\& c != \textcolor{charliteral}{'\(\backslash\)n'}) \{}
\DoxyCodeLine{7146         buffer[len++] = c;}
\DoxyCodeLine{7147         \textcolor{keywordflow}{if} (len == STBI\_\_HDR\_BUFLEN -\/ 1) \{}
\DoxyCodeLine{7148             \textcolor{comment}{// flush to end of line}}
\DoxyCodeLine{7149             \textcolor{keywordflow}{while} (!stbi\_\_at\_eof(z) \&\& stbi\_\_get8(z) != \textcolor{charliteral}{'\(\backslash\)n'})}
\DoxyCodeLine{7150                 ;}
\DoxyCodeLine{7151             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7152         \}}
\DoxyCodeLine{7153         c = (char)stbi\_\_get8(z);}
\DoxyCodeLine{7154     \}}
\DoxyCodeLine{7155 }
\DoxyCodeLine{7156     buffer[len] = 0;}
\DoxyCodeLine{7157     \textcolor{keywordflow}{return} buffer;}
\DoxyCodeLine{7158 \}}
\DoxyCodeLine{7159 }
\DoxyCodeLine{7160 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_hdr\_convert(\textcolor{keywordtype}{float}* output, \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* input, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{7161 \{}
\DoxyCodeLine{7162     \textcolor{keywordflow}{if} (input[3] != 0) \{}
\DoxyCodeLine{7163         \textcolor{keywordtype}{float} f1;}
\DoxyCodeLine{7164         \textcolor{comment}{// Exponent}}
\DoxyCodeLine{7165         f1 = (float)ldexp(1.0f, input[3] -\/ (\textcolor{keywordtype}{int})(128 + 8));}
\DoxyCodeLine{7166         \textcolor{keywordflow}{if} (req\_comp <= 2)}
\DoxyCodeLine{7167             output[0] = (input[0] + input[1] + input[2]) * f1 / 3;}
\DoxyCodeLine{7168         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7169             output[0] = input[0] * f1;}
\DoxyCodeLine{7170             output[1] = input[1] * f1;}
\DoxyCodeLine{7171             output[2] = input[2] * f1;}
\DoxyCodeLine{7172         \}}
\DoxyCodeLine{7173         \textcolor{keywordflow}{if} (req\_comp == 2) output[1] = 1;}
\DoxyCodeLine{7174         \textcolor{keywordflow}{if} (req\_comp == 4) output[3] = 1;}
\DoxyCodeLine{7175     \}}
\DoxyCodeLine{7176     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7177         \textcolor{keywordflow}{switch} (req\_comp) \{}
\DoxyCodeLine{7178         \textcolor{keywordflow}{case} 4: output[3] = 1; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{7179         \textcolor{keywordflow}{case} 3: output[0] = output[1] = output[2] = 0;}
\DoxyCodeLine{7180             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7181         \textcolor{keywordflow}{case} 2: output[1] = 1; \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{7182         \textcolor{keywordflow}{case} 1: output[0] = 0;}
\DoxyCodeLine{7183             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7184         \}}
\DoxyCodeLine{7185     \}}
\DoxyCodeLine{7186 \}}
\DoxyCodeLine{7187 }
\DoxyCodeLine{7188 \textcolor{keyword}{static} \textcolor{keywordtype}{float}* stbi\_\_hdr\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{7189 \{}
\DoxyCodeLine{7190     \textcolor{keywordtype}{char} buffer[STBI\_\_HDR\_BUFLEN];}
\DoxyCodeLine{7191     \textcolor{keywordtype}{char}* token;}
\DoxyCodeLine{7192     \textcolor{keywordtype}{int} valid = 0;}
\DoxyCodeLine{7193     \textcolor{keywordtype}{int} \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}, \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}};}
\DoxyCodeLine{7194     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* scanline;}
\DoxyCodeLine{7195     \textcolor{keywordtype}{float}* hdr\_data;}
\DoxyCodeLine{7196     \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{7197     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} count, \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}};}
\DoxyCodeLine{7198     \textcolor{keywordtype}{int} i, j, k, c1, c2, z;}
\DoxyCodeLine{7199     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* headerToken;}
\DoxyCodeLine{7200     STBI\_NOTUSED(ri);}
\DoxyCodeLine{7201 }
\DoxyCodeLine{7202     \textcolor{comment}{// Check identifier}}
\DoxyCodeLine{7203     headerToken = stbi\_\_hdr\_gettoken(s, buffer);}
\DoxyCodeLine{7204     \textcolor{keywordflow}{if} (strcmp(headerToken, \textcolor{stringliteral}{"{}\#?RADIANCE"{}}) != 0 \&\& strcmp(headerToken, \textcolor{stringliteral}{"{}\#?RGBE"{}}) != 0)}
\DoxyCodeLine{7205         \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}not HDR"{}}, \textcolor{stringliteral}{"{}Corrupt HDR image"{}});}
\DoxyCodeLine{7206 }
\DoxyCodeLine{7207     \textcolor{comment}{// Parse header}}
\DoxyCodeLine{7208     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7209         token = stbi\_\_hdr\_gettoken(s, buffer);}
\DoxyCodeLine{7210         \textcolor{keywordflow}{if} (token[0] == 0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{7211         \textcolor{keywordflow}{if} (strcmp(token, \textcolor{stringliteral}{"{}FORMAT=32-\/bit\_rle\_rgbe"{}}) == 0) valid = 1;}
\DoxyCodeLine{7212     \}}
\DoxyCodeLine{7213 }
\DoxyCodeLine{7214     \textcolor{keywordflow}{if} (!valid)    \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}unsupported format"{}}, \textcolor{stringliteral}{"{}Unsupported HDR format"{}});}
\DoxyCodeLine{7215 }
\DoxyCodeLine{7216     \textcolor{comment}{// Parse width and height}}
\DoxyCodeLine{7217     \textcolor{comment}{// can't use sscanf() if we're not using stdio!}}
\DoxyCodeLine{7218     token = stbi\_\_hdr\_gettoken(s, buffer);}
\DoxyCodeLine{7219     \textcolor{keywordflow}{if} (strncmp(token, \textcolor{stringliteral}{"{}-\/Y "{}}, 3))  \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}unsupported data layout"{}}, \textcolor{stringliteral}{"{}Unsupported HDR format"{}});}
\DoxyCodeLine{7220     token += 3;}
\DoxyCodeLine{7221     \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}} = (int)strtol(token, \&token, 10);}
\DoxyCodeLine{7222     \textcolor{keywordflow}{while} (*token == \textcolor{charliteral}{' '}) ++token;}
\DoxyCodeLine{7223     \textcolor{keywordflow}{if} (strncmp(token, \textcolor{stringliteral}{"{}+X "{}}, 3))  \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}unsupported data layout"{}}, \textcolor{stringliteral}{"{}Unsupported HDR format"{}});}
\DoxyCodeLine{7224     token += 3;}
\DoxyCodeLine{7225     \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} = (int)strtol(token, NULL, 10);}
\DoxyCodeLine{7226 }
\DoxyCodeLine{7227     \textcolor{keywordflow}{if} (\mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}} > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{7228     \textcolor{keywordflow}{if} (\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{7229 }
\DoxyCodeLine{7230     *x = \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}};}
\DoxyCodeLine{7231     *y = \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}};}
\DoxyCodeLine{7232 }
\DoxyCodeLine{7233     \textcolor{keywordflow}{if} (comp) *comp = 3;}
\DoxyCodeLine{7234     \textcolor{keywordflow}{if} (req\_comp == 0) req\_comp = 3;}
\DoxyCodeLine{7235 }
\DoxyCodeLine{7236     \textcolor{keywordflow}{if} (!stbi\_\_mad4sizes\_valid(\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}, \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}}, req\_comp, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}), 0))}
\DoxyCodeLine{7237         \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}HDR image is too large"{}});}
\DoxyCodeLine{7238 }
\DoxyCodeLine{7239     \textcolor{comment}{// Read data}}
\DoxyCodeLine{7240     hdr\_data = (\textcolor{keywordtype}{float}*)stbi\_\_malloc\_mad4(\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}, \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}}, req\_comp, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}), 0);}
\DoxyCodeLine{7241     \textcolor{keywordflow}{if} (!hdr\_data)}
\DoxyCodeLine{7242         \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{7243 }
\DoxyCodeLine{7244     \textcolor{comment}{// Load image data}}
\DoxyCodeLine{7245     \textcolor{comment}{// image data is stored as some number of sca}}
\DoxyCodeLine{7246     \textcolor{keywordflow}{if} (width < 8 || width >= 32768) \{}
\DoxyCodeLine{7247         \textcolor{comment}{// Read flat data}}
\DoxyCodeLine{7248         \textcolor{keywordflow}{for} (j = 0; j < \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}}; ++j) \{}
\DoxyCodeLine{7249             \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}; ++i) \{}
\DoxyCodeLine{7250                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} rgbe[4];}
\DoxyCodeLine{7251             main\_decode\_loop:}
\DoxyCodeLine{7252                 stbi\_\_getn(s, rgbe, 4);}
\DoxyCodeLine{7253                 stbi\_\_hdr\_convert(hdr\_data + j * \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} * req\_comp + i * req\_comp, rgbe, req\_comp);}
\DoxyCodeLine{7254             \}}
\DoxyCodeLine{7255         \}}
\DoxyCodeLine{7256     \}}
\DoxyCodeLine{7257     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7258         \textcolor{comment}{// Read RLE-\/encoded data}}
\DoxyCodeLine{7259         scanline = NULL;}
\DoxyCodeLine{7260 }
\DoxyCodeLine{7261         \textcolor{keywordflow}{for} (j = 0; j < \mbox{\hyperlink{main_8cpp_ad12fc34ce789bce6c8a05d8a17138534}{height}}; ++j) \{}
\DoxyCodeLine{7262             c1 = stbi\_\_get8(s);}
\DoxyCodeLine{7263             c2 = stbi\_\_get8(s);}
\DoxyCodeLine{7264             len = stbi\_\_get8(s);}
\DoxyCodeLine{7265             \textcolor{keywordflow}{if} (c1 != 2 || c2 != 2 || (len \& 0x80)) \{}
\DoxyCodeLine{7266                 \textcolor{comment}{// not run-\/length encoded, so we have to actually use THIS data as a decoded}}
\DoxyCodeLine{7267                 \textcolor{comment}{// pixel (note this can't be a valid pixel-\/-\/one of RGB must be >= 128)}}
\DoxyCodeLine{7268                 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} rgbe[4];}
\DoxyCodeLine{7269                 rgbe[0] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})c1;}
\DoxyCodeLine{7270                 rgbe[1] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})c2;}
\DoxyCodeLine{7271                 rgbe[2] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})len;}
\DoxyCodeLine{7272                 rgbe[3] = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}})stbi\_\_get8(s);}
\DoxyCodeLine{7273                 stbi\_\_hdr\_convert(hdr\_data, rgbe, req\_comp);}
\DoxyCodeLine{7274                 i = 1;}
\DoxyCodeLine{7275                 j = 0;}
\DoxyCodeLine{7276                 STBI\_FREE(scanline);}
\DoxyCodeLine{7277                 \textcolor{keywordflow}{goto} main\_decode\_loop; \textcolor{comment}{// yes, this makes no sense}}
\DoxyCodeLine{7278             \}}
\DoxyCodeLine{7279             len <<= 8;}
\DoxyCodeLine{7280             len |= stbi\_\_get8(s);}
\DoxyCodeLine{7281             \textcolor{keywordflow}{if} (len != \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}) \{ STBI\_FREE(hdr\_data); STBI\_FREE(scanline); \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}invalid decoded scanline length"{}}, \textcolor{stringliteral}{"{}corrupt HDR"{}}); \}}
\DoxyCodeLine{7282             \textcolor{keywordflow}{if} (scanline == NULL) \{}
\DoxyCodeLine{7283                 scanline = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad2(\mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}, 4, 0);}
\DoxyCodeLine{7284                 \textcolor{keywordflow}{if} (!scanline) \{}
\DoxyCodeLine{7285                     STBI\_FREE(hdr\_data);}
\DoxyCodeLine{7286                     \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{7287                 \}}
\DoxyCodeLine{7288             \}}
\DoxyCodeLine{7289 }
\DoxyCodeLine{7290             \textcolor{keywordflow}{for} (k = 0; k < 4; ++k) \{}
\DoxyCodeLine{7291                 \textcolor{keywordtype}{int} nleft;}
\DoxyCodeLine{7292                 i = 0;}
\DoxyCodeLine{7293                 \textcolor{keywordflow}{while} ((nleft = \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} -\/ i) > 0) \{}
\DoxyCodeLine{7294                     count = stbi\_\_get8(s);}
\DoxyCodeLine{7295                     \textcolor{keywordflow}{if} (count > 128) \{}
\DoxyCodeLine{7296                         \textcolor{comment}{// Run}}
\DoxyCodeLine{7297                         \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}} = stbi\_\_get8(s);}
\DoxyCodeLine{7298                         count -\/= 128;}
\DoxyCodeLine{7299                         \textcolor{keywordflow}{if} (count > nleft) \{ STBI\_FREE(hdr\_data); STBI\_FREE(scanline); \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}corrupt"{}}, \textcolor{stringliteral}{"{}bad RLE data in HDR"{}}); \}}
\DoxyCodeLine{7300                         \textcolor{keywordflow}{for} (z = 0; z < count; ++z)}
\DoxyCodeLine{7301                             scanline[i++ * 4 + k] = value;}
\DoxyCodeLine{7302                     \}}
\DoxyCodeLine{7303                     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{7304                         \textcolor{comment}{// Dump}}
\DoxyCodeLine{7305                         \textcolor{keywordflow}{if} (count > nleft) \{ STBI\_FREE(hdr\_data); STBI\_FREE(scanline); \textcolor{keywordflow}{return} stbi\_\_errpf(\textcolor{stringliteral}{"{}corrupt"{}}, \textcolor{stringliteral}{"{}bad RLE data in HDR"{}}); \}}
\DoxyCodeLine{7306                         \textcolor{keywordflow}{for} (z = 0; z < count; ++z)}
\DoxyCodeLine{7307                             scanline[i++ * 4 + k] = stbi\_\_get8(s);}
\DoxyCodeLine{7308                     \}}
\DoxyCodeLine{7309                 \}}
\DoxyCodeLine{7310             \}}
\DoxyCodeLine{7311             \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}}; ++i)}
\DoxyCodeLine{7312                 stbi\_\_hdr\_convert(hdr\_data + (j * \mbox{\hyperlink{main_8cpp_a2474a5474cbff19523a51eb1de01cda4}{width}} + i) * req\_comp, scanline + i * 4, req\_comp);}
\DoxyCodeLine{7313         \}}
\DoxyCodeLine{7314         \textcolor{keywordflow}{if} (scanline)}
\DoxyCodeLine{7315             STBI\_FREE(scanline);}
\DoxyCodeLine{7316     \}}
\DoxyCodeLine{7317 }
\DoxyCodeLine{7318     \textcolor{keywordflow}{return} hdr\_data;}
\DoxyCodeLine{7319 \}}
\DoxyCodeLine{7320 }
\DoxyCodeLine{7321 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_hdr\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7322 \{}
\DoxyCodeLine{7323     \textcolor{keywordtype}{char} buffer[STBI\_\_HDR\_BUFLEN];}
\DoxyCodeLine{7324     \textcolor{keywordtype}{char}* token;}
\DoxyCodeLine{7325     \textcolor{keywordtype}{int} valid = 0;}
\DoxyCodeLine{7326     \textcolor{keywordtype}{int} dummy;}
\DoxyCodeLine{7327 }
\DoxyCodeLine{7328     \textcolor{keywordflow}{if} (!x) x = \&dummy;}
\DoxyCodeLine{7329     \textcolor{keywordflow}{if} (!y) y = \&dummy;}
\DoxyCodeLine{7330     \textcolor{keywordflow}{if} (!comp) comp = \&dummy;}
\DoxyCodeLine{7331 }
\DoxyCodeLine{7332     \textcolor{keywordflow}{if} (stbi\_\_hdr\_test(s) == 0) \{}
\DoxyCodeLine{7333         stbi\_\_rewind(s);}
\DoxyCodeLine{7334         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7335     \}}
\DoxyCodeLine{7336 }
\DoxyCodeLine{7337     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7338         token = stbi\_\_hdr\_gettoken(s, buffer);}
\DoxyCodeLine{7339         \textcolor{keywordflow}{if} (token[0] == 0) \textcolor{keywordflow}{break};}
\DoxyCodeLine{7340         \textcolor{keywordflow}{if} (strcmp(token, \textcolor{stringliteral}{"{}FORMAT=32-\/bit\_rle\_rgbe"{}}) == 0) valid = 1;}
\DoxyCodeLine{7341     \}}
\DoxyCodeLine{7342 }
\DoxyCodeLine{7343     \textcolor{keywordflow}{if} (!valid) \{}
\DoxyCodeLine{7344         stbi\_\_rewind(s);}
\DoxyCodeLine{7345         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7346     \}}
\DoxyCodeLine{7347     token = stbi\_\_hdr\_gettoken(s, buffer);}
\DoxyCodeLine{7348     \textcolor{keywordflow}{if} (strncmp(token, \textcolor{stringliteral}{"{}-\/Y "{}}, 3)) \{}
\DoxyCodeLine{7349         stbi\_\_rewind(s);}
\DoxyCodeLine{7350         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7351     \}}
\DoxyCodeLine{7352     token += 3;}
\DoxyCodeLine{7353     *y = (int)strtol(token, \&token, 10);}
\DoxyCodeLine{7354     \textcolor{keywordflow}{while} (*token == \textcolor{charliteral}{' '}) ++token;}
\DoxyCodeLine{7355     \textcolor{keywordflow}{if} (strncmp(token, \textcolor{stringliteral}{"{}+X "{}}, 3)) \{}
\DoxyCodeLine{7356         stbi\_\_rewind(s);}
\DoxyCodeLine{7357         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7358     \}}
\DoxyCodeLine{7359     token += 3;}
\DoxyCodeLine{7360     *x = (int)strtol(token, NULL, 10);}
\DoxyCodeLine{7361     *comp = 3;}
\DoxyCodeLine{7362     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7363 \}}
\DoxyCodeLine{7364 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_NO\_HDR}}
\DoxyCodeLine{7365 }
\DoxyCodeLine{7366 \textcolor{preprocessor}{\#ifndef STBI\_NO\_BMP}}
\DoxyCodeLine{7367 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_bmp\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7368 \{}
\DoxyCodeLine{7369     \textcolor{keywordtype}{void}* p;}
\DoxyCodeLine{7370     stbi\_\_bmp\_data info;}
\DoxyCodeLine{7371 }
\DoxyCodeLine{7372     info.all\_a = 255;}
\DoxyCodeLine{7373     p = stbi\_\_bmp\_parse\_header(s, \&info);}
\DoxyCodeLine{7374     \textcolor{keywordflow}{if} (p == NULL) \{}
\DoxyCodeLine{7375         stbi\_\_rewind(s);}
\DoxyCodeLine{7376         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7377     \}}
\DoxyCodeLine{7378     \textcolor{keywordflow}{if} (x) *x = s-\/>img\_x;}
\DoxyCodeLine{7379     \textcolor{keywordflow}{if} (y) *y = s-\/>img\_y;}
\DoxyCodeLine{7380     \textcolor{keywordflow}{if} (comp) \{}
\DoxyCodeLine{7381         \textcolor{keywordflow}{if} (info.bpp == 24 \&\& info.ma == 0xff000000)}
\DoxyCodeLine{7382             *comp = 3;}
\DoxyCodeLine{7383         \textcolor{keywordflow}{else}}
\DoxyCodeLine{7384             *comp = info.ma ? 4 : 3;}
\DoxyCodeLine{7385     \}}
\DoxyCodeLine{7386     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7387 \}}
\DoxyCodeLine{7388 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7389 }
\DoxyCodeLine{7390 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PSD}}
\DoxyCodeLine{7391 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_psd\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7392 \{}
\DoxyCodeLine{7393     \textcolor{keywordtype}{int} channelCount, dummy, depth;}
\DoxyCodeLine{7394     \textcolor{keywordflow}{if} (!x) x = \&dummy;}
\DoxyCodeLine{7395     \textcolor{keywordflow}{if} (!y) y = \&dummy;}
\DoxyCodeLine{7396     \textcolor{keywordflow}{if} (!comp) comp = \&dummy;}
\DoxyCodeLine{7397     \textcolor{keywordflow}{if} (stbi\_\_get32be(s) != 0x38425053) \{}
\DoxyCodeLine{7398         stbi\_\_rewind(s);}
\DoxyCodeLine{7399         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7400     \}}
\DoxyCodeLine{7401     \textcolor{keywordflow}{if} (stbi\_\_get16be(s) != 1) \{}
\DoxyCodeLine{7402         stbi\_\_rewind(s);}
\DoxyCodeLine{7403         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7404     \}}
\DoxyCodeLine{7405     stbi\_\_skip(s, 6);}
\DoxyCodeLine{7406     channelCount = stbi\_\_get16be(s);}
\DoxyCodeLine{7407     \textcolor{keywordflow}{if} (channelCount < 0 || channelCount > 16) \{}
\DoxyCodeLine{7408         stbi\_\_rewind(s);}
\DoxyCodeLine{7409         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7410     \}}
\DoxyCodeLine{7411     *y = stbi\_\_get32be(s);}
\DoxyCodeLine{7412     *x = stbi\_\_get32be(s);}
\DoxyCodeLine{7413     depth = stbi\_\_get16be(s);}
\DoxyCodeLine{7414     \textcolor{keywordflow}{if} (depth != 8 \&\& depth != 16) \{}
\DoxyCodeLine{7415         stbi\_\_rewind(s);}
\DoxyCodeLine{7416         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7417     \}}
\DoxyCodeLine{7418     \textcolor{keywordflow}{if} (stbi\_\_get16be(s) != 3) \{}
\DoxyCodeLine{7419         stbi\_\_rewind(s);}
\DoxyCodeLine{7420         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7421     \}}
\DoxyCodeLine{7422     *comp = 4;}
\DoxyCodeLine{7423     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7424 \}}
\DoxyCodeLine{7425 }
\DoxyCodeLine{7426 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_psd\_is16(stbi\_\_context* s)}
\DoxyCodeLine{7427 \{}
\DoxyCodeLine{7428     \textcolor{keywordtype}{int} channelCount, depth;}
\DoxyCodeLine{7429     \textcolor{keywordflow}{if} (stbi\_\_get32be(s) != 0x38425053) \{}
\DoxyCodeLine{7430         stbi\_\_rewind(s);}
\DoxyCodeLine{7431         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7432     \}}
\DoxyCodeLine{7433     \textcolor{keywordflow}{if} (stbi\_\_get16be(s) != 1) \{}
\DoxyCodeLine{7434         stbi\_\_rewind(s);}
\DoxyCodeLine{7435         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7436     \}}
\DoxyCodeLine{7437     stbi\_\_skip(s, 6);}
\DoxyCodeLine{7438     channelCount = stbi\_\_get16be(s);}
\DoxyCodeLine{7439     \textcolor{keywordflow}{if} (channelCount < 0 || channelCount > 16) \{}
\DoxyCodeLine{7440         stbi\_\_rewind(s);}
\DoxyCodeLine{7441         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7442     \}}
\DoxyCodeLine{7443     STBI\_NOTUSED(stbi\_\_get32be(s));}
\DoxyCodeLine{7444     STBI\_NOTUSED(stbi\_\_get32be(s));}
\DoxyCodeLine{7445     depth = stbi\_\_get16be(s);}
\DoxyCodeLine{7446     \textcolor{keywordflow}{if} (depth != 16) \{}
\DoxyCodeLine{7447         stbi\_\_rewind(s);}
\DoxyCodeLine{7448         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7449     \}}
\DoxyCodeLine{7450     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7451 \}}
\DoxyCodeLine{7452 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7453 }
\DoxyCodeLine{7454 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PIC}}
\DoxyCodeLine{7455 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pic\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7456 \{}
\DoxyCodeLine{7457     \textcolor{keywordtype}{int} act\_comp = 0, num\_packets = 0, chained, dummy;}
\DoxyCodeLine{7458     stbi\_\_pic\_packet packets[10];}
\DoxyCodeLine{7459 }
\DoxyCodeLine{7460     \textcolor{keywordflow}{if} (!x) x = \&dummy;}
\DoxyCodeLine{7461     \textcolor{keywordflow}{if} (!y) y = \&dummy;}
\DoxyCodeLine{7462     \textcolor{keywordflow}{if} (!comp) comp = \&dummy;}
\DoxyCodeLine{7463 }
\DoxyCodeLine{7464     \textcolor{keywordflow}{if} (!stbi\_\_pic\_is4(s, \textcolor{stringliteral}{"{}\(\backslash\)x53\(\backslash\)x80\(\backslash\)xF6\(\backslash\)x34"{}})) \{}
\DoxyCodeLine{7465         stbi\_\_rewind(s);}
\DoxyCodeLine{7466         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7467     \}}
\DoxyCodeLine{7468 }
\DoxyCodeLine{7469     stbi\_\_skip(s, 88);}
\DoxyCodeLine{7470 }
\DoxyCodeLine{7471     *x = stbi\_\_get16be(s);}
\DoxyCodeLine{7472     *y = stbi\_\_get16be(s);}
\DoxyCodeLine{7473     \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s)) \{}
\DoxyCodeLine{7474         stbi\_\_rewind(s);}
\DoxyCodeLine{7475         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7476     \}}
\DoxyCodeLine{7477     \textcolor{keywordflow}{if} ((*x) != 0 \&\& (1 << 28) / (*x) < (*y)) \{}
\DoxyCodeLine{7478         stbi\_\_rewind(s);}
\DoxyCodeLine{7479         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7480     \}}
\DoxyCodeLine{7481 }
\DoxyCodeLine{7482     stbi\_\_skip(s, 8);}
\DoxyCodeLine{7483 }
\DoxyCodeLine{7484     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{7485         stbi\_\_pic\_packet* packet;}
\DoxyCodeLine{7486 }
\DoxyCodeLine{7487         \textcolor{keywordflow}{if} (num\_packets == \textcolor{keyword}{sizeof}(packets) / \textcolor{keyword}{sizeof}(packets[0]))}
\DoxyCodeLine{7488             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7489 }
\DoxyCodeLine{7490         packet = \&packets[num\_packets++];}
\DoxyCodeLine{7491         chained = stbi\_\_get8(s);}
\DoxyCodeLine{7492         packet-\/>size = stbi\_\_get8(s);}
\DoxyCodeLine{7493         packet-\/>type = stbi\_\_get8(s);}
\DoxyCodeLine{7494         packet-\/>channel = stbi\_\_get8(s);}
\DoxyCodeLine{7495         act\_comp |= packet-\/>channel;}
\DoxyCodeLine{7496 }
\DoxyCodeLine{7497         \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s)) \{}
\DoxyCodeLine{7498             stbi\_\_rewind(s);}
\DoxyCodeLine{7499             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7500         \}}
\DoxyCodeLine{7501         \textcolor{keywordflow}{if} (packet-\/>size != 8) \{}
\DoxyCodeLine{7502             stbi\_\_rewind(s);}
\DoxyCodeLine{7503             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7504         \}}
\DoxyCodeLine{7505     \} \textcolor{keywordflow}{while} (chained);}
\DoxyCodeLine{7506 }
\DoxyCodeLine{7507     *comp = (act\_comp \& 0x10 ? 4 : 3);}
\DoxyCodeLine{7508 }
\DoxyCodeLine{7509     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7510 \}}
\DoxyCodeLine{7511 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7512 }
\DoxyCodeLine{7513 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{7514 \textcolor{comment}{// Portable Gray Map and Portable Pixel Map loader}}
\DoxyCodeLine{7515 \textcolor{comment}{// by Ken Miller}}
\DoxyCodeLine{7516 \textcolor{comment}{//}}
\DoxyCodeLine{7517 \textcolor{comment}{// PGM: http://netpbm.sourceforge.net/doc/pgm.html}}
\DoxyCodeLine{7518 \textcolor{comment}{// PPM: http://netpbm.sourceforge.net/doc/ppm.html}}
\DoxyCodeLine{7519 \textcolor{comment}{//}}
\DoxyCodeLine{7520 \textcolor{comment}{// Known limitations:}}
\DoxyCodeLine{7521 \textcolor{comment}{//    Does not support comments in the header section}}
\DoxyCodeLine{7522 \textcolor{comment}{//    Does not support ASCII image data (formats P2 and P3)}}
\DoxyCodeLine{7523 }
\DoxyCodeLine{7524 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNM}}
\DoxyCodeLine{7525 }
\DoxyCodeLine{7526 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_test(stbi\_\_context* s)}
\DoxyCodeLine{7527 \{}
\DoxyCodeLine{7528     \textcolor{keywordtype}{char} p, t;}
\DoxyCodeLine{7529     p = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7530     t = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7531     \textcolor{keywordflow}{if} (p != \textcolor{charliteral}{'P'} || (t != \textcolor{charliteral}{'5'} \&\& t != \textcolor{charliteral}{'6'})) \{}
\DoxyCodeLine{7532         stbi\_\_rewind(s);}
\DoxyCodeLine{7533         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7534     \}}
\DoxyCodeLine{7535     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7536 \}}
\DoxyCodeLine{7537 }
\DoxyCodeLine{7538 \textcolor{keyword}{static} \textcolor{keywordtype}{void}* stbi\_\_pnm\_load(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp, \textcolor{keywordtype}{int} req\_comp, stbi\_\_result\_info* ri)}
\DoxyCodeLine{7539 \{}
\DoxyCodeLine{7540     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}* out;}
\DoxyCodeLine{7541     STBI\_NOTUSED(ri);}
\DoxyCodeLine{7542 }
\DoxyCodeLine{7543     ri-\/>bits\_per\_channel = stbi\_\_pnm\_info(s, (\textcolor{keywordtype}{int}*)\&s-\/>img\_x, (\textcolor{keywordtype}{int}*)\&s-\/>img\_y, (\textcolor{keywordtype}{int}*)\&s-\/>img\_n);}
\DoxyCodeLine{7544     \textcolor{keywordflow}{if} (ri-\/>bits\_per\_channel == 0)}
\DoxyCodeLine{7545         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7546 }
\DoxyCodeLine{7547     \textcolor{keywordflow}{if} (s-\/>img\_y > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{7548     \textcolor{keywordflow}{if} (s-\/>img\_x > STBI\_MAX\_DIMENSIONS) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}Very large image (corrupt?)"{}});}
\DoxyCodeLine{7549 }
\DoxyCodeLine{7550     *x = s-\/>img\_x;}
\DoxyCodeLine{7551     *y = s-\/>img\_y;}
\DoxyCodeLine{7552     \textcolor{keywordflow}{if} (comp) *comp = s-\/>img\_n;}
\DoxyCodeLine{7553 }
\DoxyCodeLine{7554     \textcolor{keywordflow}{if} (!stbi\_\_mad4sizes\_valid(s-\/>img\_n, s-\/>img\_x, s-\/>img\_y, ri-\/>bits\_per\_channel / 8, 0))}
\DoxyCodeLine{7555         \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}too large"{}}, \textcolor{stringliteral}{"{}PNM too large"{}});}
\DoxyCodeLine{7556 }
\DoxyCodeLine{7557     out = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)stbi\_\_malloc\_mad4(s-\/>img\_n, s-\/>img\_x, s-\/>img\_y, ri-\/>bits\_per\_channel / 8, 0);}
\DoxyCodeLine{7558     \textcolor{keywordflow}{if} (!out) \textcolor{keywordflow}{return} stbi\_\_errpuc(\textcolor{stringliteral}{"{}outofmem"{}}, \textcolor{stringliteral}{"{}Out of memory"{}});}
\DoxyCodeLine{7559     stbi\_\_getn(s, out, s-\/>img\_n * s-\/>img\_x * s-\/>img\_y * (ri-\/>bits\_per\_channel / 8));}
\DoxyCodeLine{7560 }
\DoxyCodeLine{7561     \textcolor{keywordflow}{if} (req\_comp \&\& req\_comp != s-\/>img\_n) \{}
\DoxyCodeLine{7562         out = stbi\_\_convert\_format(out, s-\/>img\_n, req\_comp, s-\/>img\_x, s-\/>img\_y);}
\DoxyCodeLine{7563         \textcolor{keywordflow}{if} (out == NULL) \textcolor{keywordflow}{return} out; \textcolor{comment}{// stbi\_\_convert\_format frees input on failure}}
\DoxyCodeLine{7564     \}}
\DoxyCodeLine{7565     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{7566 \}}
\DoxyCodeLine{7567 }
\DoxyCodeLine{7568 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_isspace(\textcolor{keywordtype}{char} c)}
\DoxyCodeLine{7569 \{}
\DoxyCodeLine{7570     \textcolor{keywordflow}{return} c == \textcolor{charliteral}{' '} || c == \textcolor{charliteral}{'\(\backslash\)t'} || c == \textcolor{charliteral}{'\(\backslash\)n'} || c == \textcolor{charliteral}{'\(\backslash\)v'} || c == \textcolor{charliteral}{'\(\backslash\)f'} || c == \textcolor{charliteral}{'\(\backslash\)r'};}
\DoxyCodeLine{7571 \}}
\DoxyCodeLine{7572 }
\DoxyCodeLine{7573 \textcolor{keyword}{static} \textcolor{keywordtype}{void}     stbi\_\_pnm\_skip\_whitespace(stbi\_\_context* s, \textcolor{keywordtype}{char}* c)}
\DoxyCodeLine{7574 \{}
\DoxyCodeLine{7575     \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{7576         \textcolor{keywordflow}{while} (!stbi\_\_at\_eof(s) \&\& stbi\_\_pnm\_isspace(*c))}
\DoxyCodeLine{7577             *c = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7578 }
\DoxyCodeLine{7579         \textcolor{keywordflow}{if} (stbi\_\_at\_eof(s) || *c != \textcolor{charliteral}{'\#'})}
\DoxyCodeLine{7580             \textcolor{keywordflow}{break};}
\DoxyCodeLine{7581 }
\DoxyCodeLine{7582         \textcolor{keywordflow}{while} (!stbi\_\_at\_eof(s) \&\& *c != \textcolor{charliteral}{'\(\backslash\)n'} \&\& *c != \textcolor{charliteral}{'\(\backslash\)r'})}
\DoxyCodeLine{7583             *c = (\textcolor{keywordtype}{char})stbi\_\_get8(s);}
\DoxyCodeLine{7584     \}}
\DoxyCodeLine{7585 \}}
\DoxyCodeLine{7586 }
\DoxyCodeLine{7587 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_isdigit(\textcolor{keywordtype}{char} c)}
\DoxyCodeLine{7588 \{}
\DoxyCodeLine{7589     \textcolor{keywordflow}{return} c >= \textcolor{charliteral}{'0'} \&\& c <= \textcolor{charliteral}{'9'};}
\DoxyCodeLine{7590 \}}
\DoxyCodeLine{7591 }
\DoxyCodeLine{7592 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_getinteger(stbi\_\_context* s, \textcolor{keywordtype}{char}* c)}
\DoxyCodeLine{7593 \{}
\DoxyCodeLine{7594     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}} = 0;}
\DoxyCodeLine{7595 }
\DoxyCodeLine{7596     \textcolor{keywordflow}{while} (!stbi\_\_at\_eof(s) \&\& stbi\_\_pnm\_isdigit(*c)) \{}
\DoxyCodeLine{7597         \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}} = \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}} * 10 + (*c -\/ \textcolor{charliteral}{'0'});}
\DoxyCodeLine{7598         *c = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7599     \}}
\DoxyCodeLine{7600 }
\DoxyCodeLine{7601     \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacenlohmann_1_1detail_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804}{value}};}
\DoxyCodeLine{7602 \}}
\DoxyCodeLine{7603 }
\DoxyCodeLine{7604 \textcolor{keyword}{static} \textcolor{keywordtype}{int}      stbi\_\_pnm\_info(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7605 \{}
\DoxyCodeLine{7606     \textcolor{keywordtype}{int} maxv, dummy;}
\DoxyCodeLine{7607     \textcolor{keywordtype}{char} c, p, t;}
\DoxyCodeLine{7608 }
\DoxyCodeLine{7609     \textcolor{keywordflow}{if} (!x) x = \&dummy;}
\DoxyCodeLine{7610     \textcolor{keywordflow}{if} (!y) y = \&dummy;}
\DoxyCodeLine{7611     \textcolor{keywordflow}{if} (!comp) comp = \&dummy;}
\DoxyCodeLine{7612 }
\DoxyCodeLine{7613     stbi\_\_rewind(s);}
\DoxyCodeLine{7614 }
\DoxyCodeLine{7615     \textcolor{comment}{// Get identifier}}
\DoxyCodeLine{7616     p = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7617     t = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7618     \textcolor{keywordflow}{if} (p != \textcolor{charliteral}{'P'} || (t != \textcolor{charliteral}{'5'} \&\& t != \textcolor{charliteral}{'6'})) \{}
\DoxyCodeLine{7619         stbi\_\_rewind(s);}
\DoxyCodeLine{7620         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7621     \}}
\DoxyCodeLine{7622 }
\DoxyCodeLine{7623     *comp = (t == \textcolor{charliteral}{'6'}) ? 3 : 1;  \textcolor{comment}{// '5' is 1-\/component .pgm; '6' is 3-\/component .ppm}}
\DoxyCodeLine{7624 }
\DoxyCodeLine{7625     c = (char)stbi\_\_get8(s);}
\DoxyCodeLine{7626     stbi\_\_pnm\_skip\_whitespace(s, \&c);}
\DoxyCodeLine{7627 }
\DoxyCodeLine{7628     *x = stbi\_\_pnm\_getinteger(s, \&c); \textcolor{comment}{// read width}}
\DoxyCodeLine{7629     stbi\_\_pnm\_skip\_whitespace(s, \&c);}
\DoxyCodeLine{7630 }
\DoxyCodeLine{7631     *y = stbi\_\_pnm\_getinteger(s, \&c); \textcolor{comment}{// read height}}
\DoxyCodeLine{7632     stbi\_\_pnm\_skip\_whitespace(s, \&c);}
\DoxyCodeLine{7633 }
\DoxyCodeLine{7634     maxv = stbi\_\_pnm\_getinteger(s, \&c);  \textcolor{comment}{// read max value}}
\DoxyCodeLine{7635     \textcolor{keywordflow}{if} (maxv > 65535)}
\DoxyCodeLine{7636         \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}max value > 65535"{}}, \textcolor{stringliteral}{"{}PPM image supports only 8-\/bit and 16-\/bit images"{}});}
\DoxyCodeLine{7637     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (maxv > 255)}
\DoxyCodeLine{7638         \textcolor{keywordflow}{return} 16;}
\DoxyCodeLine{7639     \textcolor{keywordflow}{else}}
\DoxyCodeLine{7640         \textcolor{keywordflow}{return} 8;}
\DoxyCodeLine{7641 \}}
\DoxyCodeLine{7642 }
\DoxyCodeLine{7643 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pnm\_is16(stbi\_\_context* s)}
\DoxyCodeLine{7644 \{}
\DoxyCodeLine{7645     \textcolor{keywordflow}{if} (stbi\_\_pnm\_info(s, NULL, NULL, NULL) == 16)}
\DoxyCodeLine{7646         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7647     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7648 \}}
\DoxyCodeLine{7649 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7650 }
\DoxyCodeLine{7651 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_info\_main(stbi\_\_context* s, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7652 \{}
\DoxyCodeLine{7653 \textcolor{preprocessor}{\#ifndef STBI\_NO\_JPEG}}
\DoxyCodeLine{7654     \textcolor{keywordflow}{if} (stbi\_\_jpeg\_info(s, x, y, comp)) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7655 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7656 }
\DoxyCodeLine{7657 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNG}}
\DoxyCodeLine{7658     \textcolor{keywordflow}{if} (stbi\_\_png\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7659 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7660 }
\DoxyCodeLine{7661 \textcolor{preprocessor}{\#ifndef STBI\_NO\_GIF}}
\DoxyCodeLine{7662     \textcolor{keywordflow}{if} (stbi\_\_gif\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7663 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7664 }
\DoxyCodeLine{7665 \textcolor{preprocessor}{\#ifndef STBI\_NO\_BMP}}
\DoxyCodeLine{7666     \textcolor{keywordflow}{if} (stbi\_\_bmp\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7667 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7668 }
\DoxyCodeLine{7669 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PSD}}
\DoxyCodeLine{7670     \textcolor{keywordflow}{if} (stbi\_\_psd\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7671 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7672 }
\DoxyCodeLine{7673 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PIC}}
\DoxyCodeLine{7674     \textcolor{keywordflow}{if} (stbi\_\_pic\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7675 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7676 }
\DoxyCodeLine{7677 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNM}}
\DoxyCodeLine{7678     \textcolor{keywordflow}{if} (stbi\_\_pnm\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7679 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7680 }
\DoxyCodeLine{7681 \textcolor{preprocessor}{\#ifndef STBI\_NO\_HDR}}
\DoxyCodeLine{7682     \textcolor{keywordflow}{if} (stbi\_\_hdr\_info(s, x, y, comp))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7683 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7684 }
\DoxyCodeLine{7685     \textcolor{comment}{// test tga last because it's a crappy test!}}
\DoxyCodeLine{7686 \textcolor{preprocessor}{\#ifndef STBI\_NO\_TGA}}
\DoxyCodeLine{7687     \textcolor{keywordflow}{if} (stbi\_\_tga\_info(s, x, y, comp))}
\DoxyCodeLine{7688         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7689 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7690     \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}unknown image type"{}}, \textcolor{stringliteral}{"{}Image not of any known type, or corrupt"{}});}
\DoxyCodeLine{7691 \}}
\DoxyCodeLine{7692 }
\DoxyCodeLine{7693 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_is\_16\_main(stbi\_\_context* s)}
\DoxyCodeLine{7694 \{}
\DoxyCodeLine{7695 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNG}}
\DoxyCodeLine{7696     \textcolor{keywordflow}{if} (stbi\_\_png\_is16(s))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7697 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7698 }
\DoxyCodeLine{7699 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PSD}}
\DoxyCodeLine{7700     \textcolor{keywordflow}{if} (stbi\_\_psd\_is16(s))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7701 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7702 }
\DoxyCodeLine{7703 \textcolor{preprocessor}{\#ifndef STBI\_NO\_PNM}}
\DoxyCodeLine{7704     \textcolor{keywordflow}{if} (stbi\_\_pnm\_is16(s))  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{7705 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7706     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{7707 \}}
\DoxyCodeLine{7708 }
\DoxyCodeLine{7709 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{7710 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_aede708cca1304520b2afcf4d5eb61d70}{stbi\_info}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7711 \{}
\DoxyCodeLine{7712     FILE* f = stbi\_\_fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{7713     \textcolor{keywordtype}{int} result;}
\DoxyCodeLine{7714     \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}can't fopen"{}}, \textcolor{stringliteral}{"{}Unable to open file"{}});}
\DoxyCodeLine{7715     result = \mbox{\hyperlink{stb__image_8h_a28abedef4a0a93909332080df6be0021}{stbi\_info\_from\_file}}(f, x, y, comp);}
\DoxyCodeLine{7716     fclose(f);}
\DoxyCodeLine{7717     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{7718 \}}
\DoxyCodeLine{7719 }
\DoxyCodeLine{7720 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a28abedef4a0a93909332080df6be0021}{stbi\_info\_from\_file}}(FILE* f, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7721 \{}
\DoxyCodeLine{7722     \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{7723     stbi\_\_context s;}
\DoxyCodeLine{7724     \textcolor{keywordtype}{long} pos = ftell(f);}
\DoxyCodeLine{7725     stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{7726     r = stbi\_\_info\_main(\&s, x, y, comp);}
\DoxyCodeLine{7727     fseek(f, pos, SEEK\_SET);}
\DoxyCodeLine{7728     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{7729 \}}
\DoxyCodeLine{7730 }
\DoxyCodeLine{7731 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a7d9af55a35382c011cc186f7b62c00af}{stbi\_is\_16\_bit}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const}* filename)}
\DoxyCodeLine{7732 \{}
\DoxyCodeLine{7733     FILE* f = stbi\_\_fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{7734     \textcolor{keywordtype}{int} result;}
\DoxyCodeLine{7735     \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} stbi\_\_err(\textcolor{stringliteral}{"{}can't fopen"{}}, \textcolor{stringliteral}{"{}Unable to open file"{}});}
\DoxyCodeLine{7736     result = \mbox{\hyperlink{stb__image_8h_a42fa266b80bfde22a0781ba2112d1c62}{stbi\_is\_16\_bit\_from\_file}}(f);}
\DoxyCodeLine{7737     fclose(f);}
\DoxyCodeLine{7738     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{7739 \}}
\DoxyCodeLine{7740 }
\DoxyCodeLine{7741 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a42fa266b80bfde22a0781ba2112d1c62}{stbi\_is\_16\_bit\_from\_file}}(FILE* f)}
\DoxyCodeLine{7742 \{}
\DoxyCodeLine{7743     \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{7744     stbi\_\_context s;}
\DoxyCodeLine{7745     \textcolor{keywordtype}{long} pos = ftell(f);}
\DoxyCodeLine{7746     stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{7747     r = stbi\_\_is\_16\_main(\&s);}
\DoxyCodeLine{7748     fseek(f, pos, SEEK\_SET);}
\DoxyCodeLine{7749     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{7750 \}}
\DoxyCodeLine{7751 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_NO\_STDIO}}
\DoxyCodeLine{7752 }
\DoxyCodeLine{7753 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_acfef077febce3bc3f1f339de478f3315}{stbi\_info\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7754 \{}
\DoxyCodeLine{7755     stbi\_\_context s;}
\DoxyCodeLine{7756     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{7757     \textcolor{keywordflow}{return} stbi\_\_info\_main(\&s, x, y, comp);}
\DoxyCodeLine{7758 \}}
\DoxyCodeLine{7759 }
\DoxyCodeLine{7760 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a86291c64cb663f41a34647d5e1abf363}{stbi\_info\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* c, \textcolor{keywordtype}{void}* user, \textcolor{keywordtype}{int}* x, \textcolor{keywordtype}{int}* y, \textcolor{keywordtype}{int}* comp)}
\DoxyCodeLine{7761 \{}
\DoxyCodeLine{7762     stbi\_\_context s;}
\DoxyCodeLine{7763     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}*)c, user);}
\DoxyCodeLine{7764     \textcolor{keywordflow}{return} stbi\_\_info\_main(\&s, x, y, comp);}
\DoxyCodeLine{7765 \}}
\DoxyCodeLine{7766 }
\DoxyCodeLine{7767 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a548d486e07e0eb95671cb200d3a9530f}{stbi\_is\_16\_bit\_from\_memory}}(\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const}* buffer, \textcolor{keywordtype}{int} len)}
\DoxyCodeLine{7768 \{}
\DoxyCodeLine{7769     stbi\_\_context s;}
\DoxyCodeLine{7770     stbi\_\_start\_mem(\&s, buffer, len);}
\DoxyCodeLine{7771     \textcolor{keywordflow}{return} stbi\_\_is\_16\_main(\&s);}
\DoxyCodeLine{7772 \}}
\DoxyCodeLine{7773 }
\DoxyCodeLine{7774 \mbox{\hyperlink{stb__image_8h_a2d9ec9850cd12aefe7641b456266a4c2}{STBIDEF}} \textcolor{keywordtype}{int} \mbox{\hyperlink{stb__image_8h_a990e0e38ab6e600bd9cbf5d30abd2f8f}{stbi\_is\_16\_bit\_from\_callbacks}}(\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const}* c, \textcolor{keywordtype}{void}* user)}
\DoxyCodeLine{7775 \{}
\DoxyCodeLine{7776     stbi\_\_context s;}
\DoxyCodeLine{7777     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}}*)c, user);}
\DoxyCodeLine{7778     \textcolor{keywordflow}{return} stbi\_\_is\_16\_main(\&s);}
\DoxyCodeLine{7779 \}}
\DoxyCodeLine{7780 }
\DoxyCodeLine{7781 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STB\_IMAGE\_IMPLEMENTATION}}
\DoxyCodeLine{7782 }
\DoxyCodeLine{7783 \textcolor{comment}{/*}}
\DoxyCodeLine{7784 \textcolor{comment}{   revision history:}}
\DoxyCodeLine{7785 \textcolor{comment}{      2.20  (2019-\/02-\/07) support utf8 filenames in Windows; fix warnings and platform ifdefs}}
\DoxyCodeLine{7786 \textcolor{comment}{      2.19  (2018-\/02-\/11) fix warning}}
\DoxyCodeLine{7787 \textcolor{comment}{      2.18  (2018-\/01-\/30) fix warnings}}
\DoxyCodeLine{7788 \textcolor{comment}{      2.17  (2018-\/01-\/29) change sbti\_\_shiftsigned to avoid clang -\/O2 bug}}
\DoxyCodeLine{7789 \textcolor{comment}{                         1-\/bit BMP}}
\DoxyCodeLine{7790 \textcolor{comment}{                         *\_is\_16\_bit api}}
\DoxyCodeLine{7791 \textcolor{comment}{                         avoid warnings}}
\DoxyCodeLine{7792 \textcolor{comment}{      2.16  (2017-\/07-\/23) all functions have 16-\/bit variants;}}
\DoxyCodeLine{7793 \textcolor{comment}{                         STBI\_NO\_STDIO works again;}}
\DoxyCodeLine{7794 \textcolor{comment}{                         compilation fixes;}}
\DoxyCodeLine{7795 \textcolor{comment}{                         fix rounding in unpremultiply;}}
\DoxyCodeLine{7796 \textcolor{comment}{                         optimize vertical flip;}}
\DoxyCodeLine{7797 \textcolor{comment}{                         disable raw\_len validation;}}
\DoxyCodeLine{7798 \textcolor{comment}{                         documentation fixes}}
\DoxyCodeLine{7799 \textcolor{comment}{      2.15  (2017-\/03-\/18) fix png-\/1,2,4 bug; now all Imagenet JPGs decode;}}
\DoxyCodeLine{7800 \textcolor{comment}{                         warning fixes; disable run-\/time SSE detection on gcc;}}
\DoxyCodeLine{7801 \textcolor{comment}{                         uniform handling of optional "{}return"{} values;}}
\DoxyCodeLine{7802 \textcolor{comment}{                         thread-\/safe initialization of zlib tables}}
\DoxyCodeLine{7803 \textcolor{comment}{      2.14  (2017-\/03-\/03) remove deprecated STBI\_JPEG\_OLD; fixes for Imagenet JPGs}}
\DoxyCodeLine{7804 \textcolor{comment}{      2.13  (2016-\/11-\/29) add 16-\/bit API, only supported for PNG right now}}
\DoxyCodeLine{7805 \textcolor{comment}{      2.12  (2016-\/04-\/02) fix typo in 2.11 PSD fix that caused crashes}}
\DoxyCodeLine{7806 \textcolor{comment}{      2.11  (2016-\/04-\/02) allocate large structures on the stack}}
\DoxyCodeLine{7807 \textcolor{comment}{                         remove white matting for transparent PSD}}
\DoxyCodeLine{7808 \textcolor{comment}{                         fix reported channel count for PNG \& BMP}}
\DoxyCodeLine{7809 \textcolor{comment}{                         re-\/enable SSE2 in non-\/gcc 64-\/bit}}
\DoxyCodeLine{7810 \textcolor{comment}{                         support RGB-\/formatted JPEG}}
\DoxyCodeLine{7811 \textcolor{comment}{                         read 16-\/bit PNGs (only as 8-\/bit)}}
\DoxyCodeLine{7812 \textcolor{comment}{      2.10  (2016-\/01-\/22) avoid warning introduced in 2.09 by STBI\_REALLOC\_SIZED}}
\DoxyCodeLine{7813 \textcolor{comment}{      2.09  (2016-\/01-\/16) allow comments in PNM files}}
\DoxyCodeLine{7814 \textcolor{comment}{                         16-\/bit-\/per-\/pixel TGA (not bit-\/per-\/component)}}
\DoxyCodeLine{7815 \textcolor{comment}{                         info() for TGA could break due to .hdr handling}}
\DoxyCodeLine{7816 \textcolor{comment}{                         info() for BMP to shares code instead of sloppy parse}}
\DoxyCodeLine{7817 \textcolor{comment}{                         can use STBI\_REALLOC\_SIZED if allocator doesn't support realloc}}
\DoxyCodeLine{7818 \textcolor{comment}{                         code cleanup}}
\DoxyCodeLine{7819 \textcolor{comment}{      2.08  (2015-\/09-\/13) fix to 2.07 cleanup, reading RGB PSD as RGBA}}
\DoxyCodeLine{7820 \textcolor{comment}{      2.07  (2015-\/09-\/13) fix compiler warnings}}
\DoxyCodeLine{7821 \textcolor{comment}{                         partial animated GIF support}}
\DoxyCodeLine{7822 \textcolor{comment}{                         limited 16-\/bpc PSD support}}
\DoxyCodeLine{7823 \textcolor{comment}{                         \#ifdef unused functions}}
\DoxyCodeLine{7824 \textcolor{comment}{                         bug with < 92 byte PIC,PNM,HDR,TGA}}
\DoxyCodeLine{7825 \textcolor{comment}{      2.06  (2015-\/04-\/19) fix bug where PSD returns wrong '*comp' value}}
\DoxyCodeLine{7826 \textcolor{comment}{      2.05  (2015-\/04-\/19) fix bug in progressive JPEG handling, fix warning}}
\DoxyCodeLine{7827 \textcolor{comment}{      2.04  (2015-\/04-\/15) try to re-\/enable SIMD on MinGW 64-\/bit}}
\DoxyCodeLine{7828 \textcolor{comment}{      2.03  (2015-\/04-\/12) extra corruption checking (mmozeiko)}}
\DoxyCodeLine{7829 \textcolor{comment}{                         stbi\_set\_flip\_vertically\_on\_load (nguillemot)}}
\DoxyCodeLine{7830 \textcolor{comment}{                         fix NEON support; fix mingw support}}
\DoxyCodeLine{7831 \textcolor{comment}{      2.02  (2015-\/01-\/19) fix incorrect assert, fix warning}}
\DoxyCodeLine{7832 \textcolor{comment}{      2.01  (2015-\/01-\/17) fix various warnings; suppress SIMD on gcc 32-\/bit without -\/msse2}}
\DoxyCodeLine{7833 \textcolor{comment}{      2.00b (2014-\/12-\/25) fix STBI\_MALLOC in progressive JPEG}}
\DoxyCodeLine{7834 \textcolor{comment}{      2.00  (2014-\/12-\/25) optimize JPG, including x86 SSE2 \& NEON SIMD (ryg)}}
\DoxyCodeLine{7835 \textcolor{comment}{                         progressive JPEG (stb)}}
\DoxyCodeLine{7836 \textcolor{comment}{                         PGM/PPM support (Ken Miller)}}
\DoxyCodeLine{7837 \textcolor{comment}{                         STBI\_MALLOC,STBI\_REALLOC,STBI\_FREE}}
\DoxyCodeLine{7838 \textcolor{comment}{                         GIF bugfix -\/-\/ seemingly never worked}}
\DoxyCodeLine{7839 \textcolor{comment}{                         STBI\_NO\_*, STBI\_ONLY\_*}}
\DoxyCodeLine{7840 \textcolor{comment}{      1.48  (2014-\/12-\/14) fix incorrectly-\/named assert()}}
\DoxyCodeLine{7841 \textcolor{comment}{      1.47  (2014-\/12-\/14) 1/2/4-\/bit PNG support, both direct and paletted (Omar Cornut \& stb)}}
\DoxyCodeLine{7842 \textcolor{comment}{                         optimize PNG (ryg)}}
\DoxyCodeLine{7843 \textcolor{comment}{                         fix bug in interlaced PNG with user-\/specified channel count (stb)}}
\DoxyCodeLine{7844 \textcolor{comment}{      1.46  (2014-\/08-\/26)}}
\DoxyCodeLine{7845 \textcolor{comment}{              fix broken tRNS chunk (colorkey-\/style transparency) in non-\/paletted PNG}}
\DoxyCodeLine{7846 \textcolor{comment}{      1.45  (2014-\/08-\/16)}}
\DoxyCodeLine{7847 \textcolor{comment}{              fix MSVC-\/ARM internal compiler error by wrapping malloc}}
\DoxyCodeLine{7848 \textcolor{comment}{      1.44  (2014-\/08-\/07)}}
\DoxyCodeLine{7849 \textcolor{comment}{              various warning fixes from Ronny Chevalier}}
\DoxyCodeLine{7850 \textcolor{comment}{      1.43  (2014-\/07-\/15)}}
\DoxyCodeLine{7851 \textcolor{comment}{              fix MSVC-\/only compiler problem in code changed in 1.42}}
\DoxyCodeLine{7852 \textcolor{comment}{      1.42  (2014-\/07-\/09)}}
\DoxyCodeLine{7853 \textcolor{comment}{              don't define \_CRT\_SECURE\_NO\_WARNINGS (affects user code)}}
\DoxyCodeLine{7854 \textcolor{comment}{              fixes to stbi\_\_cleanup\_jpeg path}}
\DoxyCodeLine{7855 \textcolor{comment}{              added STBI\_ASSERT to avoid requiring assert.h}}
\DoxyCodeLine{7856 \textcolor{comment}{      1.41  (2014-\/06-\/25)}}
\DoxyCodeLine{7857 \textcolor{comment}{              fix search\&replace from 1.36 that messed up comments/error messages}}
\DoxyCodeLine{7858 \textcolor{comment}{      1.40  (2014-\/06-\/22)}}
\DoxyCodeLine{7859 \textcolor{comment}{              fix gcc struct-\/initialization warning}}
\DoxyCodeLine{7860 \textcolor{comment}{      1.39  (2014-\/06-\/15)}}
\DoxyCodeLine{7861 \textcolor{comment}{              fix to TGA optimization when req\_comp != number of components in TGA;}}
\DoxyCodeLine{7862 \textcolor{comment}{              fix to GIF loading because BMP wasn't rewinding (whoops, no GIFs in my test suite)}}
\DoxyCodeLine{7863 \textcolor{comment}{              add support for BMP version 5 (more ignored fields)}}
\DoxyCodeLine{7864 \textcolor{comment}{      1.38  (2014-\/06-\/06)}}
\DoxyCodeLine{7865 \textcolor{comment}{              suppress MSVC warnings on integer casts truncating values}}
\DoxyCodeLine{7866 \textcolor{comment}{              fix accidental rename of 'skip' field of I/O}}
\DoxyCodeLine{7867 \textcolor{comment}{      1.37  (2014-\/06-\/04)}}
\DoxyCodeLine{7868 \textcolor{comment}{              remove duplicate typedef}}
\DoxyCodeLine{7869 \textcolor{comment}{      1.36  (2014-\/06-\/03)}}
\DoxyCodeLine{7870 \textcolor{comment}{              convert to header file single-\/file library}}
\DoxyCodeLine{7871 \textcolor{comment}{              if de-\/iphone isn't set, load iphone images color-\/swapped instead of returning NULL}}
\DoxyCodeLine{7872 \textcolor{comment}{      1.35  (2014-\/05-\/27)}}
\DoxyCodeLine{7873 \textcolor{comment}{              various warnings}}
\DoxyCodeLine{7874 \textcolor{comment}{              fix broken STBI\_SIMD path}}
\DoxyCodeLine{7875 \textcolor{comment}{              fix bug where stbi\_load\_from\_file no longer left file pointer in correct place}}
\DoxyCodeLine{7876 \textcolor{comment}{              fix broken non-\/easy path for 32-\/bit BMP (possibly never used)}}
\DoxyCodeLine{7877 \textcolor{comment}{              TGA optimization by Arseny Kapoulkine}}
\DoxyCodeLine{7878 \textcolor{comment}{      1.34  (unknown)}}
\DoxyCodeLine{7879 \textcolor{comment}{              use STBI\_NOTUSED in stbi\_\_resample\_row\_generic(), fix one more leak in tga failure case}}
\DoxyCodeLine{7880 \textcolor{comment}{      1.33  (2011-\/07-\/14)}}
\DoxyCodeLine{7881 \textcolor{comment}{              make stbi\_is\_hdr work in STBI\_NO\_HDR (as specified), minor compiler-\/friendly improvements}}
\DoxyCodeLine{7882 \textcolor{comment}{      1.32  (2011-\/07-\/13)}}
\DoxyCodeLine{7883 \textcolor{comment}{              support for "{}info"{} function for all supported filetypes (SpartanJ)}}
\DoxyCodeLine{7884 \textcolor{comment}{      1.31  (2011-\/06-\/20)}}
\DoxyCodeLine{7885 \textcolor{comment}{              a few more leak fixes, bug in PNG handling (SpartanJ)}}
\DoxyCodeLine{7886 \textcolor{comment}{      1.30  (2011-\/06-\/11)}}
\DoxyCodeLine{7887 \textcolor{comment}{              added ability to load files via callbacks to accomidate custom input streams (Ben Wenger)}}
\DoxyCodeLine{7888 \textcolor{comment}{              removed deprecated format-\/specific test/load functions}}
\DoxyCodeLine{7889 \textcolor{comment}{              removed support for installable file formats (stbi\_loader) -\/-\/ would have been broken for IO callbacks anyway}}
\DoxyCodeLine{7890 \textcolor{comment}{              error cases in bmp and tga give messages and don't leak (Raymond Barbiero, grisha)}}
\DoxyCodeLine{7891 \textcolor{comment}{              fix inefficiency in decoding 32-\/bit BMP (David Woo)}}
\DoxyCodeLine{7892 \textcolor{comment}{      1.29  (2010-\/08-\/16)}}
\DoxyCodeLine{7893 \textcolor{comment}{              various warning fixes from Aurelien Pocheville}}
\DoxyCodeLine{7894 \textcolor{comment}{      1.28  (2010-\/08-\/01)}}
\DoxyCodeLine{7895 \textcolor{comment}{              fix bug in GIF palette transparency (SpartanJ)}}
\DoxyCodeLine{7896 \textcolor{comment}{      1.27  (2010-\/08-\/01)}}
\DoxyCodeLine{7897 \textcolor{comment}{              cast-\/to-\/stbi\_uc to fix warnings}}
\DoxyCodeLine{7898 \textcolor{comment}{      1.26  (2010-\/07-\/24)}}
\DoxyCodeLine{7899 \textcolor{comment}{              fix bug in file buffering for PNG reported by SpartanJ}}
\DoxyCodeLine{7900 \textcolor{comment}{      1.25  (2010-\/07-\/17)}}
\DoxyCodeLine{7901 \textcolor{comment}{              refix trans\_data warning (Won Chun)}}
\DoxyCodeLine{7902 \textcolor{comment}{      1.24  (2010-\/07-\/12)}}
\DoxyCodeLine{7903 \textcolor{comment}{              perf improvements reading from files on platforms with lock-\/heavy fgetc()}}
\DoxyCodeLine{7904 \textcolor{comment}{              minor perf improvements for jpeg}}
\DoxyCodeLine{7905 \textcolor{comment}{              deprecated type-\/specific functions so we'll get feedback if they're needed}}
\DoxyCodeLine{7906 \textcolor{comment}{              attempt to fix trans\_data warning (Won Chun)}}
\DoxyCodeLine{7907 \textcolor{comment}{      1.23    fixed bug in iPhone support}}
\DoxyCodeLine{7908 \textcolor{comment}{      1.22  (2010-\/07-\/10)}}
\DoxyCodeLine{7909 \textcolor{comment}{              removed image *writing* support}}
\DoxyCodeLine{7910 \textcolor{comment}{              stbi\_info support from Jetro Lauha}}
\DoxyCodeLine{7911 \textcolor{comment}{              GIF support from Jean-\/Marc Lienher}}
\DoxyCodeLine{7912 \textcolor{comment}{              iPhone PNG-\/extensions from James Brown}}
\DoxyCodeLine{7913 \textcolor{comment}{              warning-\/fixes from Nicolas Schulz and Janez Zemva (i.stbi\_\_err. Janez (U+017D)emva)}}
\DoxyCodeLine{7914 \textcolor{comment}{      1.21    fix use of 'stbi\_uc' in header (reported by jon blow)}}
\DoxyCodeLine{7915 \textcolor{comment}{      1.20    added support for Softimage PIC, by Tom Seddon}}
\DoxyCodeLine{7916 \textcolor{comment}{      1.19    bug in interlaced PNG corruption check (found by ryg)}}
\DoxyCodeLine{7917 \textcolor{comment}{      1.18  (2008-\/08-\/02)}}
\DoxyCodeLine{7918 \textcolor{comment}{              fix a threading bug (local mutable static)}}
\DoxyCodeLine{7919 \textcolor{comment}{      1.17    support interlaced PNG}}
\DoxyCodeLine{7920 \textcolor{comment}{      1.16    major bugfix -\/ stbi\_\_convert\_format converted one too many pixels}}
\DoxyCodeLine{7921 \textcolor{comment}{      1.15    initialize some fields for thread safety}}
\DoxyCodeLine{7922 \textcolor{comment}{      1.14    fix threadsafe conversion bug}}
\DoxyCodeLine{7923 \textcolor{comment}{              header-\/file-\/only version (\#define STBI\_HEADER\_FILE\_ONLY before including)}}
\DoxyCodeLine{7924 \textcolor{comment}{      1.13    threadsafe}}
\DoxyCodeLine{7925 \textcolor{comment}{      1.12    const qualifiers in the API}}
\DoxyCodeLine{7926 \textcolor{comment}{      1.11    Support installable IDCT, colorspace conversion routines}}
\DoxyCodeLine{7927 \textcolor{comment}{      1.10    Fixes for 64-\/bit (don't use "{}unsigned long"{})}}
\DoxyCodeLine{7928 \textcolor{comment}{              optimized upsampling by Fabian "{}ryg"{} Giesen}}
\DoxyCodeLine{7929 \textcolor{comment}{      1.09    Fix format-\/conversion for PSD code (bad global variables!)}}
\DoxyCodeLine{7930 \textcolor{comment}{      1.08    Thatcher Ulrich's PSD code integrated by Nicolas Schulz}}
\DoxyCodeLine{7931 \textcolor{comment}{      1.07    attempt to fix C++ warning/errors again}}
\DoxyCodeLine{7932 \textcolor{comment}{      1.06    attempt to fix C++ warning/errors again}}
\DoxyCodeLine{7933 \textcolor{comment}{      1.05    fix TGA loading to return correct *comp and use good luminance calc}}
\DoxyCodeLine{7934 \textcolor{comment}{      1.04    default float alpha is 1, not 255; use 'void *' for stbi\_image\_free}}
\DoxyCodeLine{7935 \textcolor{comment}{      1.03    bugfixes to STBI\_NO\_STDIO, STBI\_NO\_HDR}}
\DoxyCodeLine{7936 \textcolor{comment}{      1.02    support for (subset of) HDR files, float interface for preferred access to them}}
\DoxyCodeLine{7937 \textcolor{comment}{      1.01    fix bug: possible bug in handling right-\/side up bmps... not sure}}
\DoxyCodeLine{7938 \textcolor{comment}{              fix bug: the stbi\_\_bmp\_load() and stbi\_\_tga\_load() functions didn't work at all}}
\DoxyCodeLine{7939 \textcolor{comment}{      1.00    interface to zlib that skips zlib header}}
\DoxyCodeLine{7940 \textcolor{comment}{      0.99    correct handling of alpha in palette}}
\DoxyCodeLine{7941 \textcolor{comment}{      0.98    TGA loader by lonesock; dynamically add loaders (untested)}}
\DoxyCodeLine{7942 \textcolor{comment}{      0.97    jpeg errors on too large a file; also catch another malloc failure}}
\DoxyCodeLine{7943 \textcolor{comment}{      0.96    fix detection of invalid v value -\/ particleman@mollyrocket forum}}
\DoxyCodeLine{7944 \textcolor{comment}{      0.95    during header scan, seek to markers in case of padding}}
\DoxyCodeLine{7945 \textcolor{comment}{      0.94    STBI\_NO\_STDIO to disable stdio usage; rename all \#defines the same}}
\DoxyCodeLine{7946 \textcolor{comment}{      0.93    handle jpegtran output; verbose errors}}
\DoxyCodeLine{7947 \textcolor{comment}{      0.92    read 4,8,16,24,32-\/bit BMP files of several formats}}
\DoxyCodeLine{7948 \textcolor{comment}{      0.91    output 24-\/bit Windows 3.0 BMP files}}
\DoxyCodeLine{7949 \textcolor{comment}{      0.90    fix a few more warnings; bump version number to approach 1.0}}
\DoxyCodeLine{7950 \textcolor{comment}{      0.61    bugfixes due to Marc LeBlanc, Christopher Lloyd}}
\DoxyCodeLine{7951 \textcolor{comment}{      0.60    fix compiling as c++}}
\DoxyCodeLine{7952 \textcolor{comment}{      0.59    fix warnings: merge Dave Moore's -\/Wall fixes}}
\DoxyCodeLine{7953 \textcolor{comment}{      0.58    fix bug: zlib uncompressed mode len/nlen was wrong endian}}
\DoxyCodeLine{7954 \textcolor{comment}{      0.57    fix bug: jpg last huffman symbol before marker was >9 bits but less than 16 available}}
\DoxyCodeLine{7955 \textcolor{comment}{      0.56    fix bug: zlib uncompressed mode len vs. nlen}}
\DoxyCodeLine{7956 \textcolor{comment}{      0.55    fix bug: restart\_interval not initialized to 0}}
\DoxyCodeLine{7957 \textcolor{comment}{      0.54    allow NULL for 'int *comp'}}
\DoxyCodeLine{7958 \textcolor{comment}{      0.53    fix bug in png 3-\/>4; speedup png decoding}}
\DoxyCodeLine{7959 \textcolor{comment}{      0.52    png handles req\_comp=3,4 directly; minor cleanup; jpeg comments}}
\DoxyCodeLine{7960 \textcolor{comment}{      0.51    obey req\_comp requests, 1-\/component jpegs return as 1-\/component,}}
\DoxyCodeLine{7961 \textcolor{comment}{              on 'test' only check type, not whether we support this variant}}
\DoxyCodeLine{7962 \textcolor{comment}{      0.50  (2006-\/11-\/19)}}
\DoxyCodeLine{7963 \textcolor{comment}{              first released version}}
\DoxyCodeLine{7964 \textcolor{comment}{*/}}
\DoxyCodeLine{7965 }
\DoxyCodeLine{7966 }
\DoxyCodeLine{7967 \textcolor{comment}{/*}}
\DoxyCodeLine{7968 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{7969 \textcolor{comment}{This software is available under 2 licenses -\/-\/ choose whichever you prefer.}}
\DoxyCodeLine{7970 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{7971 \textcolor{comment}{ALTERNATIVE A -\/ MIT License}}
\DoxyCodeLine{7972 \textcolor{comment}{Copyright (c) 2017 Sean Barrett}}
\DoxyCodeLine{7973 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{7974 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{7975 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{7976 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{7977 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{7978 \textcolor{comment}{so, subject to the following conditions:}}
\DoxyCodeLine{7979 \textcolor{comment}{The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{7980 \textcolor{comment}{copies or substantial portions of the Software.}}
\DoxyCodeLine{7981 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{7982 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{7983 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{7984 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{7985 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{7986 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{7987 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{7988 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{7989 \textcolor{comment}{ALTERNATIVE B -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{7990 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{7991 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{7992 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{7993 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{7994 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{7995 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{7996 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{7997 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{7998 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{7999 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{8000 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{8001 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{8002 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{8003 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{8004 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{8005 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{8006 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{8007 \textcolor{comment}{*/}}

\end{DoxyCode}
